{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.3", "generated_at": "2025-03-14T21:41:36.134532Z", "invocation_id": "40a16131-d1bf-42a0-886f-18c5c74c1676", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T21:41:21.872112Z", "completed_at": "2025-03-14T21:41:21.874134Z"}, {"name": "execute", "started_at": "2025-03-14T21:41:21.887370Z", "completed_at": "2025-03-14T21:41:26.215294Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.345976114273071, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb02b5-0004-bb9d-0005-db4b0001b1de"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.crb_kpi.churned_new_customers", "compiled": true, "compiled_code": "SELECT \r\n    customer_id, \r\n    'new' AS customer_status, \r\n    MIN(payment_month_clean) AS first_transaction_month\r\nFROM public.stg_transactions\r\nGROUP BY customer_id\r\nHAVING MIN(payment_month_clean) IS NOT NULL\r\n\r\nUNION ALL\r\n\r\nSELECT \r\n    customer_id, \r\n    'churned' AS customer_status, \r\n    MAX(payment_month_clean) AS last_transaction_month\r\nFROM public.stg_transactions\r\nGROUP BY customer_id\r\nHAVING MAX(payment_month_clean) < DATEADD(MONTH, -6, CURRENT_DATE)", "relation_name": "CRBFITNESS.PUBLIC.churned_new_customers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T21:41:26.222886Z", "completed_at": "2025-03-14T21:41:26.222886Z"}, {"name": "execute", "started_at": "2025-03-14T21:41:26.222886Z", "completed_at": "2025-03-14T21:41:26.845708Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6228220462799072, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb02b5-0004-bb9d-0005-db4b0001b1e2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.crb_kpi.cross_sell_product_churn", "compiled": true, "compiled_code": "SELECT \r\n    t.customer_id, \r\n    c.customer_name_clean, \r\n    p.product_family_clean, \r\n    COUNT(DISTINCT p.product_family_clean) AS cross_sell_count\r\nFROM public.stg_transactions t\r\nLEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id\r\nLEFT JOIN public.stg_products p ON t.product_id = p.product_id\r\nGROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean\r\nORDER BY cross_sell_count DESC\r\nLIMIT 10", "relation_name": "CRBFITNESS.PUBLIC.cross_sell_product_churn", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T21:41:26.867992Z", "completed_at": "2025-03-14T21:41:26.873206Z"}, {"name": "execute", "started_at": "2025-03-14T21:41:26.873206Z", "completed_at": "2025-03-14T21:41:27.464238Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6041364669799805, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb02b5-0004-c152-0005-db4b0001a1ca"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.crb_kpi.net_nrr_grr", "compiled": true, "compiled_code": "SELECT \r\n    SUM(CASE WHEN payment_month_clean >= DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END) AS current_revenue,\r\n    SUM(CASE WHEN payment_month_clean < DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END) AS previous_revenue,\r\n    (SUM(CASE WHEN payment_month_clean >= DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END) * 1.0 /\r\n     NULLIF(SUM(CASE WHEN payment_month_clean < DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END), 0)) AS NRR,\r\n    (SUM(CASE WHEN payment_month_clean >= DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END) * 1.0 /\r\n     NULLIF(SUM(CASE WHEN payment_month_clean >= DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END), 0)) AS GRR\r\nFROM public.stg_transactions", "relation_name": "CRBFITNESS.PUBLIC.net_nrr_grr", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T21:41:27.480872Z", "completed_at": "2025-03-14T21:41:27.483253Z"}, {"name": "execute", "started_at": "2025-03-14T21:41:27.483253Z", "completed_at": "2025-03-14T21:41:28.328324Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8502581119537354, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb02b5-0004-c0bd-0005-db4b00017802"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.crb_kpi.new_logos", "compiled": true, "compiled_code": "SELECT \r\n    customer_id, \r\n    MIN(payment_month_clean) AS first_fiscal_year\r\nFROM public.stg_transactions\r\nGROUP BY customer_id", "relation_name": "CRBFITNESS.PUBLIC.new_logos", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T21:41:28.336114Z", "completed_at": "2025-03-14T21:41:28.337799Z"}, {"name": "execute", "started_at": "2025-03-14T21:41:28.341815Z", "completed_at": "2025-03-14T21:41:29.055119Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7231392860412598, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb02b5-0004-bb9d-0005-db4b0001b1e6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.crb_kpi.ranked_customers", "compiled": true, "compiled_code": "SELECT \r\n    t.customer_id, \r\n    c.customer_name_clean, \r\n    SUM(t.revenue) AS total_revenue,\r\n    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank\r\nFROM public.stg_transactions t\r\nLEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id\r\nGROUP BY t.customer_id, c.customer_name_clean\r\nORDER BY total_revenue DESC", "relation_name": "CRBFITNESS.PUBLIC.ranked_customers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T21:41:29.068622Z", "completed_at": "2025-03-14T21:41:29.071346Z"}, {"name": "execute", "started_at": "2025-03-14T21:41:29.078376Z", "completed_at": "2025-03-14T21:41:30.530116Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4655711650848389, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb02b5-0004-c144-0005-db4b00018752"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.crb_kpi.ranked_products", "compiled": true, "compiled_code": "SELECT \r\n    p.product_family_clean, \r\n    SUM(t.revenue) AS total_revenue,\r\n    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank\r\nFROM public.stg_transactions t\r\nLEFT JOIN public.stg_products p ON t.product_id = p.product_id\r\nGROUP BY p.product_family_clean\r\nORDER BY total_revenue DESC", "relation_name": "CRBFITNESS.PUBLIC.ranked_products", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T21:41:30.549603Z", "completed_at": "2025-03-14T21:41:30.551826Z"}, {"name": "execute", "started_at": "2025-03-14T21:41:30.551826Z", "completed_at": "2025-03-14T21:41:31.284785Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7378659248352051, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb02b5-0004-c152-0005-db4b0001a1ce"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.crb_kpi.revenue_lost", "compiled": true, "compiled_code": "SELECT \r\n    t.payment_month_clean AS period, \r\n    SUM(t.revenue) AS total_revenue_lost\r\nFROM public.stg_transactions t\r\nWHERE t.customer_id IN (\r\n    SELECT customer_id \r\n    FROM public.stg_transactions \r\n    GROUP BY customer_id \r\n    HAVING MAX(payment_month_clean) < DATEADD(MONTH, -6, CURRENT_DATE)\r\n)\r\nGROUP BY t.payment_month_clean\r\nORDER BY t.payment_month_clean", "relation_name": "CRBFITNESS.PUBLIC.revenue_lost", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T21:41:31.297700Z", "completed_at": "2025-03-14T21:41:31.300022Z"}, {"name": "execute", "started_at": "2025-03-14T21:41:31.300022Z", "completed_at": "2025-03-14T21:41:32.325014Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.030268907546997, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb02b5-0004-c0bd-0005-db4b00017806"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.crb_kpi.stg_customers", "compiled": true, "compiled_code": "WITH raw AS (\r\n    SELECT * FROM public.customers\r\n    WHERE customer_id IS NOT NULL  -- Remove rows where customer_id is NULL\r\n      AND customername IS NOT NULL -- Remove rows where customername is NULL\r\n)\r\nSELECT \r\n    customer_id,\r\n    COALESCE(TRIM(LOWER(customername)), 'Unknown') AS customer_name_clean -- Handle NULLs\r\nFROM raw", "relation_name": "CRBFITNESS.PUBLIC.stg_customers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T21:41:32.335950Z", "completed_at": "2025-03-14T21:41:32.343777Z"}, {"name": "execute", "started_at": "2025-03-14T21:41:32.346641Z", "completed_at": "2025-03-14T21:41:33.636667Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3013150691986084, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb02b5-0004-bb9d-0005-db4b0001b1ea"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.crb_kpi.stg_products", "compiled": true, "compiled_code": "WITH raw AS ( \r\n    SELECT * FROM public.products\r\n    WHERE product_id IS NOT NULL  -- Remove rows where product_id is NULL\r\n      AND product_family IS NOT NULL -- Remove rows where product_family is NULL\r\n)\r\nSELECT \r\n    product_id,\r\n    COALESCE(TRIM(LOWER(product_family)), 'Unknown') AS product_family_clean -- Handle NULLs\r\nFROM raw", "relation_name": "CRBFITNESS.PUBLIC.stg_products", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T21:41:33.636667Z", "completed_at": "2025-03-14T21:41:33.652319Z"}, {"name": "execute", "started_at": "2025-03-14T21:41:33.652319Z", "completed_at": "2025-03-14T21:41:34.194808Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5581409931182861, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb02b5-0004-c144-0005-db4b00018756"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.crb_kpi.stg_transactions", "compiled": true, "compiled_code": "WITH raw AS (\r\n    SELECT * FROM public.transactions\r\n    WHERE customer_id IS NOT NULL  \r\n      AND product_id IS NOT NULL  \r\n      AND revenue IS NOT NULL  \r\n      AND payment_month IS NOT NULL  \r\n)\r\nSELECT \r\n    customer_id,\r\n    product_id,\r\n    CAST(COALESCE(revenue, 0) AS FLOAT) AS revenue,  -- Handle NULL revenue\r\n    TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') AS payment_month_clean  -- Convert VARCHAR to TIMESTAMP\r\nFROM raw", "relation_name": "CRBFITNESS.PUBLIC.stg_transactions", "batch_results": null}], "elapsed_time": 18.406925916671753, "args": {"log_file_max_bytes": 10485760, "quiet": false, "print": true, "which": "run", "cache_selected_only": false, "populate_cache": true, "exclude": [], "require_nested_cumulative_type_params": false, "macro_debugging": false, "require_explicit_package_overrides_for_builtin_materializations": true, "static_parser": true, "vars": {}, "require_resource_names_without_spaces": false, "warn_error_options": {"include": [], "exclude": []}, "log_path": "C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs", "invocation_command": "dbt run", "profiles_dir": "C:\\Users\\ADMIN\\.dbt", "use_colors_file": true, "log_format_file": "debug", "require_yaml_configuration_for_mf_time_spines": false, "send_anonymous_usage_stats": true, "source_freshness_run_project_hooks": false, "printer_width": 80, "indirect_selection": "eager", "skip_nodes_if_on_run_start_fails": false, "introspect": true, "log_format": "default", "defer": false, "log_level_file": "debug", "log_level": "info", "show_resource_report": false, "use_colors": true, "empty": false, "strict_mode": false, "partial_parse_file_diff": true, "require_batched_execution_for_custom_microbatch_strategy": false, "version_check": true, "favor_state": false, "state_modified_compare_more_unrendered_values": false, "write_json": true, "state_modified_compare_vars": false, "project_dir": "C:\\Users\\ADMIN\\crb_project\\crb_kpi", "select": [], "partial_parse": true}}