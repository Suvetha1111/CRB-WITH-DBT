[0m16:08:24.497198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE79AEE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE7BE22D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE7BE0F50>]}


============================== 16:08:24.497198 | edcb36c3-a122-4458-b1cd-a0bdbf235bbd ==============================
[0m16:08:24.497198 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:08:24.497198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:08:24.530678 [info ] [MainThread]: dbt version: 1.9.3
[0m16:08:24.530678 [info ] [MainThread]: python version: 3.11.9
[0m16:08:24.530678 [info ] [MainThread]: python path: C:\users\admin\crb_project\venv\Scripts\python.exe
[0m16:08:24.530678 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m16:08:24.947898 [info ] [MainThread]: Using profiles dir at C:\Users\ADMIN\.dbt
[0m16:08:24.947898 [info ] [MainThread]: Using profiles.yml file at C:\Users\ADMIN\.dbt\profiles.yml
[0m16:08:24.947898 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\ADMIN\crb_project\crb_kpi\dbt_project.yml
[0m16:08:24.947898 [info ] [MainThread]: adapter type: snowflake
[0m16:08:24.947898 [info ] [MainThread]: adapter version: 1.9.2
[0m16:08:25.107974 [info ] [MainThread]: Configuration:
[0m16:08:25.107974 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:08:25.107974 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:08:25.107974 [info ] [MainThread]: Required dependencies:
[0m16:08:25.116063 [debug] [MainThread]: Executing "git --help"
[0m16:08:25.180775 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:08:25.180775 [debug] [MainThread]: STDERR: "b''"
[0m16:08:25.180775 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:08:25.193789 [info ] [MainThread]: Connection:
[0m16:08:25.193789 [info ] [MainThread]:   account: MAEYKSE-KSB03468
[0m16:08:25.193789 [info ] [MainThread]:   user: SUVETHAS
[0m16:08:25.198644 [info ] [MainThread]:   database: CRBFITNESS
[0m16:08:25.202161 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m16:08:25.203721 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m16:08:25.203721 [info ] [MainThread]:   schema: PUBLIC
[0m16:08:25.203721 [info ] [MainThread]:   authenticator: None
[0m16:08:25.203721 [info ] [MainThread]:   oauth_client_id: None
[0m16:08:25.203721 [info ] [MainThread]:   query_tag: None
[0m16:08:25.203721 [info ] [MainThread]:   client_session_keep_alive: False
[0m16:08:25.212885 [info ] [MainThread]:   host: None
[0m16:08:25.212885 [info ] [MainThread]:   port: None
[0m16:08:25.216738 [info ] [MainThread]:   proxy_host: None
[0m16:08:25.216738 [info ] [MainThread]:   proxy_port: None
[0m16:08:25.216738 [info ] [MainThread]:   protocol: None
[0m16:08:25.216738 [info ] [MainThread]:   connect_retries: 1
[0m16:08:25.216738 [info ] [MainThread]:   connect_timeout: None
[0m16:08:25.216738 [info ] [MainThread]:   retry_on_database_errors: False
[0m16:08:25.216738 [info ] [MainThread]:   retry_all: False
[0m16:08:25.228610 [info ] [MainThread]:   insecure_mode: False
[0m16:08:25.229872 [info ] [MainThread]:   reuse_connections: True
[0m16:08:25.236175 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:08:25.737777 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m16:08:30.790885 [debug] [MainThread]: Using snowflake connection "debug"
[0m16:08:30.790885 [debug] [MainThread]: On debug: select 1 as id
[0m16:08:30.790885 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:08:33.867903 [debug] [MainThread]: SQL status: SUCCESS 1 in 3.084 seconds
[0m16:08:33.867903 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:08:33.867903 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:08:33.884803 [debug] [MainThread]: Command `dbt debug` succeeded at 16:08:33.884803 after 9.58 seconds
[0m16:08:33.884803 [debug] [MainThread]: Connection 'debug' was left open.
[0m16:08:33.884803 [debug] [MainThread]: On debug: Close
[0m16:08:34.533998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE7BEE2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE2662B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE2661F90>]}
[0m16:08:34.533998 [debug] [MainThread]: Flushing usage events
[0m16:08:35.857351 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:00:40.967840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFB119C750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFB1187950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFB1187A90>]}


============================== 18:00:40.983802 | 7e25f335-e81e-4bf2-83e3-86e816915470 ==============================
[0m18:00:40.983802 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:00:40.983802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt seed', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:00:45.851979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e25f335-e81e-4bf2-83e3-86e816915470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFAD8FFCD0>]}
[0m18:00:45.953046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e25f335-e81e-4bf2-83e3-86e816915470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFB1D644D0>]}
[0m18:00:45.966061 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:00:46.697937 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:00:46.703062 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:00:46.703439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7e25f335-e81e-4bf2-83e3-86e816915470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFB20F5710>]}
[0m18:00:46.738094 [error] [MainThread]: Encountered an error:
'utf-8' codec can't decode byte 0xe9 in position 6441: invalid continuation byte
[0m18:00:46.754650 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\ADMIN\crb_project\crb_kpi\venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ADMIN\crb_project\crb_kpi\venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ADMIN\crb_project\crb_kpi\venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ADMIN\crb_project\crb_kpi\venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ADMIN\crb_project\crb_kpi\venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ADMIN\crb_project\crb_kpi\venv\Lib\site-packages\dbt\cli\requires.py", line 327, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "C:\Users\ADMIN\crb_project\crb_kpi\venv\Lib\site-packages\dbt\cli\requires.py", line 351, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "C:\Users\ADMIN\crb_project\crb_kpi\venv\Lib\site-packages\dbt\parser\manifest.py", line 2069, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ADMIN\crb_project\crb_kpi\venv\Lib\site-packages\dbt\parser\manifest.py", line 312, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "C:\Users\ADMIN\crb_project\crb_kpi\venv\Lib\site-packages\dbt\parser\manifest.py", line 359, in load
    file_reader.read_files()
  File "C:\Users\ADMIN\crb_project\crb_kpi\venv\Lib\site-packages\dbt\parser\read_files.py", line 212, in read_files
    self.read_files_for_project(project, file_types)
  File "C:\Users\ADMIN\crb_project\crb_kpi\venv\Lib\site-packages\dbt\parser\read_files.py", line 219, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ADMIN\crb_project\crb_kpi\venv\Lib\site-packages\dbt\parser\read_files.py", line 167, in read_files_for_parser
    source_files = get_source_files(
                   ^^^^^^^^^^^^^^^^^
  File "C:\Users\ADMIN\crb_project\crb_kpi\venv\Lib\site-packages\dbt\parser\read_files.py", line 148, in get_source_files
    fb_list.append(load_seed_source_file(fp, project.project_name))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ADMIN\crb_project\crb_kpi\venv\Lib\site-packages\dbt\parser\read_files.py", line 130, in load_seed_source_file
    file_contents = load_file_contents(match.absolute_path, strip=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ADMIN\crb_project\crb_kpi\venv\Lib\site-packages\dbt_common\record.py", line 448, in record_replay_wrapper
    return func_to_record(*call_args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ADMIN\crb_project\crb_kpi\venv\Lib\site-packages\dbt_common\clients\system.py", line 178, in load_file_contents
    to_return = handle.read().decode("utf-8")
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 6441: invalid continuation byte

[0m18:00:46.768739 [debug] [MainThread]: Command `dbt seed` failed at 18:00:46.768739 after 5.95 seconds
[0m18:00:46.768739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFB0ECEBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFB0FC1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFB2489FD0>]}
[0m18:00:46.776772 [debug] [MainThread]: Flushing usage events
[0m18:00:48.230154 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:49:25.951170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023719F8CB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023719FE2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023719FE2650>]}


============================== 19:49:25.961187 | 059c5729-6ce2-4d65-9b2b-f7bf53af3d01 ==============================
[0m19:49:25.961187 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:49:25.963187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m19:49:25.985292 [info ] [MainThread]: dbt version: 1.9.3
[0m19:49:25.985292 [info ] [MainThread]: python version: 3.11.9
[0m19:49:26.000125 [info ] [MainThread]: python path: C:\users\admin\crb_project\venv\Scripts\python.exe
[0m19:49:26.003176 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m19:49:26.449023 [info ] [MainThread]: Using profiles dir at C:\Users\ADMIN\.dbt
[0m19:49:26.449023 [info ] [MainThread]: Using profiles.yml file at C:\Users\ADMIN\.dbt\profiles.yml
[0m19:49:26.465193 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\ADMIN\crb_project\crb_kpi\dbt_project.yml
[0m19:49:26.476863 [info ] [MainThread]: adapter type: snowflake
[0m19:49:26.478861 [info ] [MainThread]: adapter version: 1.9.2
[0m19:49:26.615789 [info ] [MainThread]: Configuration:
[0m19:49:26.631430 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:49:26.631430 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:49:26.631430 [info ] [MainThread]: Required dependencies:
[0m19:49:26.631430 [debug] [MainThread]: Executing "git --help"
[0m19:49:26.721866 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:49:26.722869 [debug] [MainThread]: STDERR: "b''"
[0m19:49:26.724863 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:49:26.725854 [info ] [MainThread]: Connection:
[0m19:49:26.727521 [info ] [MainThread]:   account: MAEYKSE-KSB03468
[0m19:49:26.729547 [info ] [MainThread]:   user: SUVETHAS
[0m19:49:26.731545 [info ] [MainThread]:   database: CRBFITNESS
[0m19:49:26.733545 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m19:49:26.735545 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m19:49:26.736017 [info ] [MainThread]:   schema: PUBLIC
[0m19:49:26.736017 [info ] [MainThread]:   authenticator: None
[0m19:49:26.736017 [info ] [MainThread]:   oauth_client_id: None
[0m19:49:26.736017 [info ] [MainThread]:   query_tag: None
[0m19:49:26.736017 [info ] [MainThread]:   client_session_keep_alive: False
[0m19:49:26.736017 [info ] [MainThread]:   host: None
[0m19:49:26.750237 [info ] [MainThread]:   port: None
[0m19:49:26.751471 [info ] [MainThread]:   proxy_host: None
[0m19:49:26.751471 [info ] [MainThread]:   proxy_port: None
[0m19:49:26.751471 [info ] [MainThread]:   protocol: None
[0m19:49:26.751471 [info ] [MainThread]:   connect_retries: 1
[0m19:49:26.751471 [info ] [MainThread]:   connect_timeout: None
[0m19:49:26.751471 [info ] [MainThread]:   retry_on_database_errors: False
[0m19:49:26.751471 [info ] [MainThread]:   retry_all: False
[0m19:49:26.767668 [info ] [MainThread]:   insecure_mode: False
[0m19:49:26.767668 [info ] [MainThread]:   reuse_connections: True
[0m19:49:26.767668 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:49:27.634588 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m19:49:32.803540 [debug] [MainThread]: Using snowflake connection "debug"
[0m19:49:32.804566 [debug] [MainThread]: On debug: select 1 as id
[0m19:49:32.805542 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:49:35.635505 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.839 seconds
[0m19:49:35.647639 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:49:35.647639 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:49:35.651270 [debug] [MainThread]: Command `dbt debug` succeeded at 19:49:35.651270 after 9.83 seconds
[0m19:49:35.651270 [debug] [MainThread]: Connection 'debug' was left open.
[0m19:49:35.651270 [debug] [MainThread]: On debug: Close
[0m19:49:36.647075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023714A62C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023719FB39D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023719CBBDD0>]}
[0m19:49:36.647075 [debug] [MainThread]: Flushing usage events
[0m19:49:37.821795 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:50:11.957433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0C8E8C490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0C8E8C350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0C8E8D150>]}


============================== 19:50:11.960452 | f2a4ea4d-84a6-4daa-96ee-6a36f42098b3 ==============================
[0m19:50:11.960452 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:50:11.960452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m19:50:12.618375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2a4ea4d-84a6-4daa-96ee-6a36f42098b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0C98E7A10>]}
[0m19:50:12.696705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2a4ea4d-84a6-4daa-96ee-6a36f42098b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0C786D210>]}
[0m19:50:12.696705 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:50:13.337866 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:50:13.337866 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:50:13.353490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f2a4ea4d-84a6-4daa-96ee-6a36f42098b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0C9CC2E90>]}
[0m19:50:17.011481 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m19:50:17.014014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2a4ea4d-84a6-4daa-96ee-6a36f42098b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0CA141790>]}
[0m19:50:17.135753 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m19:50:17.142309 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m19:50:17.263383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2a4ea4d-84a6-4daa-96ee-6a36f42098b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0CA693750>]}
[0m19:50:17.263383 [info ] [MainThread]: Found 4 models, 3 seeds, 474 macros
[0m19:50:17.269631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2a4ea4d-84a6-4daa-96ee-6a36f42098b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0CA297950>]}
[0m19:50:17.271896 [info ] [MainThread]: 
[0m19:50:17.275916 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:50:17.275916 [info ] [MainThread]: 
[0m19:50:17.275916 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:50:17.275916 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m19:50:17.415708 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m19:50:17.415708 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m19:50:17.418011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:19.768813 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.365 seconds
[0m19:50:19.785468 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m19:50:19.800494 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m19:50:19.800494 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m19:50:19.800494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:21.853831 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.054 seconds
[0m19:50:21.869454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2a4ea4d-84a6-4daa-96ee-6a36f42098b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0CA3145D0>]}
[0m19:50:21.869454 [debug] [Thread-1 (]: Began running node seed.crb_kpi.customers
[0m19:50:21.869454 [info ] [Thread-1 (]: 1 of 3 START seed file PUBLIC.customers ........................................ [RUN]
[0m19:50:21.885080 [debug] [Thread-1 (]: Acquiring new snowflake connection 'seed.crb_kpi.customers'
[0m19:50:21.885080 [debug] [Thread-1 (]: Began compiling node seed.crb_kpi.customers
[0m19:50:21.885080 [debug] [Thread-1 (]: Began executing node seed.crb_kpi.customers
[0m19:50:21.973143 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.customers"
[0m19:50:21.974143 [debug] [Thread-1 (]: On seed.crb_kpi.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.customers"} */
create table CRBFITNESS.PUBLIC.customers (company text,customer id integer,customername text)
[0m19:50:21.975578 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:50:24.317028 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00fc-0004-c144-0005-db4b00018006
[0m19:50:24.317028 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 67 unexpected 'integer'.
syntax error line 1 at position 74 unexpected ','.
syntax error line 1 at position 88 unexpected 'text'.
syntax error line 1 at position 92 unexpected ')'.
[0m19:50:24.321846 [debug] [Thread-1 (]: Database Error in seed customers (seeds\customers.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 67 unexpected 'integer'.
  syntax error line 1 at position 74 unexpected ','.
  syntax error line 1 at position 88 unexpected 'text'.
  syntax error line 1 at position 92 unexpected ')'.
[0m19:50:24.332867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a4ea4d-84a6-4daa-96ee-6a36f42098b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0CAC2C810>]}
[0m19:50:24.332867 [error] [Thread-1 (]: 1 of 3 ERROR loading seed file PUBLIC.customers ................................ [[31mERROR[0m in 2.44s]
[0m19:50:24.332867 [debug] [Thread-1 (]: Finished running node seed.crb_kpi.customers
[0m19:50:24.332867 [debug] [Thread-1 (]: Began running node seed.crb_kpi.products
[0m19:50:24.332867 [debug] [Thread-4 (]: Marking all children of 'seed.crb_kpi.customers' to be skipped because of status 'error'.  Reason: Database Error in seed customers (seeds\customers.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 67 unexpected 'integer'.
  syntax error line 1 at position 74 unexpected ','.
  syntax error line 1 at position 88 unexpected 'text'.
  syntax error line 1 at position 92 unexpected ')'..
[0m19:50:24.332867 [info ] [Thread-1 (]: 2 of 3 START seed file PUBLIC.products ......................................... [RUN]
[0m19:50:24.332867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.crb_kpi.customers, now seed.crb_kpi.products)
[0m19:50:24.332867 [debug] [Thread-1 (]: Began compiling node seed.crb_kpi.products
[0m19:50:24.332867 [debug] [Thread-1 (]: Began executing node seed.crb_kpi.products
[0m19:50:24.348520 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.products"
[0m19:50:24.348520 [debug] [Thread-1 (]: On seed.crb_kpi.products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.products"} */
create table CRBFITNESS.PUBLIC.products (product id text,PRODUCT_Family text,product sub family text)
[0m19:50:24.786954 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00fc-0004-bb9d-0000-0005db4bdaa5
[0m19:50:24.786954 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 52 unexpected 'text'.
syntax error line 1 at position 56 unexpected ','.
syntax error line 1 at position 72 unexpected 'text'.
syntax error line 1 at position 85 unexpected 'sub'.
syntax error line 1 at position 96 unexpected 'text'.
syntax error line 1 at position 100 unexpected ')'.
[0m19:50:24.786954 [debug] [Thread-1 (]: Database Error in seed products (seeds\products.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 52 unexpected 'text'.
  syntax error line 1 at position 56 unexpected ','.
  syntax error line 1 at position 72 unexpected 'text'.
  syntax error line 1 at position 85 unexpected 'sub'.
  syntax error line 1 at position 96 unexpected 'text'.
  syntax error line 1 at position 100 unexpected ')'.
[0m19:50:24.803234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a4ea4d-84a6-4daa-96ee-6a36f42098b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0CB049490>]}
[0m19:50:24.804257 [error] [Thread-1 (]: 2 of 3 ERROR loading seed file PUBLIC.products ................................. [[31mERROR[0m in 0.47s]
[0m19:50:24.806250 [debug] [Thread-1 (]: Finished running node seed.crb_kpi.products
[0m19:50:24.807256 [debug] [Thread-1 (]: Began running node seed.crb_kpi.transactions
[0m19:50:24.809251 [debug] [Thread-4 (]: Marking all children of 'seed.crb_kpi.products' to be skipped because of status 'error'.  Reason: Database Error in seed products (seeds\products.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 52 unexpected 'text'.
  syntax error line 1 at position 56 unexpected ','.
  syntax error line 1 at position 72 unexpected 'text'.
  syntax error line 1 at position 85 unexpected 'sub'.
  syntax error line 1 at position 96 unexpected 'text'.
  syntax error line 1 at position 100 unexpected ')'..
[0m19:50:24.809860 [info ] [Thread-1 (]: 3 of 3 START seed file PUBLIC.transactions ..................................... [RUN]
[0m19:50:24.812752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.crb_kpi.products, now seed.crb_kpi.transactions)
[0m19:50:24.813761 [debug] [Thread-1 (]: Began compiling node seed.crb_kpi.transactions
[0m19:50:24.814753 [debug] [Thread-1 (]: Began executing node seed.crb_kpi.transactions
[0m19:50:29.007874 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m19:50:29.007874 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
create table CRBFITNESS.PUBLIC.transactions (customer_id integer,product_id text,payment_month text,revenue_type integer,revenue float8,quantity integer,dimension 1 text,dimension 2 text,dimension 3 text,dimension 4 text,dimension 5 text,dimension 6 text,dimension 7 text,dimension 8 text,dimension 9 text,dimension 10 text,companies text)
[0m19:50:30.306773 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00fc-0004-c144-0005-db4b0001800a
[0m19:50:30.306773 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 163 unexpected '1'.
syntax error line 1 at position 180 unexpected '2'.
syntax error line 1 at position 197 unexpected '3'.
syntax error line 1 at position 214 unexpected '4'.
syntax error line 1 at position 231 unexpected '5'.
syntax error line 1 at position 248 unexpected '6'.
syntax error line 1 at position 265 unexpected '7'.
syntax error line 1 at position 282 unexpected '8'.
syntax error line 1 at position 299 unexpected '9'.
syntax error line 1 at position 316 unexpected '10'.
[0m19:50:30.306773 [debug] [Thread-1 (]: Database Error in seed transactions (seeds\transactions.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 163 unexpected '1'.
  syntax error line 1 at position 180 unexpected '2'.
  syntax error line 1 at position 197 unexpected '3'.
  syntax error line 1 at position 214 unexpected '4'.
  syntax error line 1 at position 231 unexpected '5'.
  syntax error line 1 at position 248 unexpected '6'.
  syntax error line 1 at position 265 unexpected '7'.
  syntax error line 1 at position 282 unexpected '8'.
  syntax error line 1 at position 299 unexpected '9'.
  syntax error line 1 at position 316 unexpected '10'.
[0m19:50:30.306773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a4ea4d-84a6-4daa-96ee-6a36f42098b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0CB448850>]}
[0m19:50:30.322419 [error] [Thread-1 (]: 3 of 3 ERROR loading seed file PUBLIC.transactions ............................. [[31mERROR[0m in 5.50s]
[0m19:50:30.322419 [debug] [Thread-1 (]: Finished running node seed.crb_kpi.transactions
[0m19:50:30.322419 [debug] [Thread-4 (]: Marking all children of 'seed.crb_kpi.transactions' to be skipped because of status 'error'.  Reason: Database Error in seed transactions (seeds\transactions.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 163 unexpected '1'.
  syntax error line 1 at position 180 unexpected '2'.
  syntax error line 1 at position 197 unexpected '3'.
  syntax error line 1 at position 214 unexpected '4'.
  syntax error line 1 at position 231 unexpected '5'.
  syntax error line 1 at position 248 unexpected '6'.
  syntax error line 1 at position 265 unexpected '7'.
  syntax error line 1 at position 282 unexpected '8'.
  syntax error line 1 at position 299 unexpected '9'.
  syntax error line 1 at position 316 unexpected '10'..
[0m19:50:30.329557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:50:30.329557 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m19:50:30.329557 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m19:50:31.263918 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m19:50:31.263918 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m19:50:31.907001 [debug] [MainThread]: Connection 'seed.crb_kpi.transactions' was left open.
[0m19:50:31.907001 [debug] [MainThread]: On seed.crb_kpi.transactions: Close
[0m19:50:32.533863 [info ] [MainThread]: 
[0m19:50:32.533863 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 15.26 seconds (15.26s).
[0m19:50:32.549512 [debug] [MainThread]: Command end result
[0m19:50:32.587674 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m19:50:32.587674 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m19:50:32.604468 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m19:50:32.604468 [info ] [MainThread]: 
[0m19:50:32.604468 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m19:50:32.618984 [info ] [MainThread]: 
[0m19:50:32.621327 [error] [MainThread]:   Database Error in seed customers (seeds\customers.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 67 unexpected 'integer'.
  syntax error line 1 at position 74 unexpected ','.
  syntax error line 1 at position 88 unexpected 'text'.
  syntax error line 1 at position 92 unexpected ')'.
[0m19:50:32.624831 [info ] [MainThread]: 
[0m19:50:32.626832 [error] [MainThread]:   Database Error in seed products (seeds\products.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 52 unexpected 'text'.
  syntax error line 1 at position 56 unexpected ','.
  syntax error line 1 at position 72 unexpected 'text'.
  syntax error line 1 at position 85 unexpected 'sub'.
  syntax error line 1 at position 96 unexpected 'text'.
  syntax error line 1 at position 100 unexpected ')'.
[0m19:50:32.629842 [info ] [MainThread]: 
[0m19:50:32.631832 [error] [MainThread]:   Database Error in seed transactions (seeds\transactions.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 163 unexpected '1'.
  syntax error line 1 at position 180 unexpected '2'.
  syntax error line 1 at position 197 unexpected '3'.
  syntax error line 1 at position 214 unexpected '4'.
  syntax error line 1 at position 231 unexpected '5'.
  syntax error line 1 at position 248 unexpected '6'.
  syntax error line 1 at position 265 unexpected '7'.
  syntax error line 1 at position 282 unexpected '8'.
  syntax error line 1 at position 299 unexpected '9'.
  syntax error line 1 at position 316 unexpected '10'.
[0m19:50:32.638028 [info ] [MainThread]: 
[0m19:50:32.642048 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m19:50:32.647780 [debug] [MainThread]: Command `dbt seed` failed at 19:50:32.646791 after 20.79 seconds
[0m19:50:32.648791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0C3862D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0C3862050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0C3862BD0>]}
[0m19:50:32.650780 [debug] [MainThread]: Flushing usage events
[0m19:50:33.973052 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:52:45.649410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BA4A8CA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BA4AC9090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BA4A8DB50>]}


============================== 19:52:45.664978 | 84cf6436-0073-4cb3-b7d8-f2c321270e2b ==============================
[0m19:52:45.664978 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:52:45.664978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:52:46.277494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84cf6436-0073-4cb3-b7d8-f2c321270e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BA573C190>]}
[0m19:52:46.339955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84cf6436-0073-4cb3-b7d8-f2c321270e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BA565D910>]}
[0m19:52:46.355583 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:52:46.997256 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:52:47.262885 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:52:47.262885 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:52:47.262885 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m19:52:47.330475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84cf6436-0073-4cb3-b7d8-f2c321270e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BA5E6C8D0>]}
[0m19:52:47.426381 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m19:52:47.426381 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m19:52:47.473254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84cf6436-0073-4cb3-b7d8-f2c321270e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BA5F9F750>]}
[0m19:52:47.473254 [info ] [MainThread]: Found 4 models, 3 seeds, 474 macros
[0m19:52:47.473254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84cf6436-0073-4cb3-b7d8-f2c321270e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BA2A18C50>]}
[0m19:52:47.473254 [info ] [MainThread]: 
[0m19:52:47.473254 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:52:47.485632 [info ] [MainThread]: 
[0m19:52:47.486161 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:52:47.496667 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m19:52:47.626392 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m19:52:47.626392 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m19:52:47.626392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:50.843186 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.219 seconds
[0m19:52:50.859737 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m19:52:50.874761 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m19:52:50.874761 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m19:52:50.874761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:52.723537 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.845 seconds
[0m19:52:52.723537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84cf6436-0073-4cb3-b7d8-f2c321270e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BA5665690>]}
[0m19:52:52.739805 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m19:52:52.739805 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m19:52:52.739805 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.stg_customers'
[0m19:52:52.739805 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m19:52:52.763638 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m19:52:52.763638 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m19:52:52.832139 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m19:52:52.840039 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m19:52:52.841039 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customer_name)) AS customer_name_clean,
    region
FROM raw;
[0m19:52:52.842038 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:52:54.606969 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00fe-0004-c0bd-0005-db4b00017066
[0m19:52:54.606969 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 8 unexpected ';'.
[0m19:52:54.616706 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql
[0m19:52:54.622719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84cf6436-0073-4cb3-b7d8-f2c321270e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BA638E310>]}
[0m19:52:54.622719 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model PUBLIC.stg_customers ...................... [[31mERROR[0m in 1.88s]
[0m19:52:54.622719 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m19:52:54.622719 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m19:52:54.622719 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql.
[0m19:52:54.622719 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m19:52:54.635144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m19:52:54.635144 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m19:52:54.644620 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m19:52:54.646445 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m19:52:54.646445 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m19:52:54.661128 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m19:52:54.663376 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_name)) AS product_name_clean,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw;
[0m19:52:55.062735 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00fe-0004-bde4-0000-0005db4bf185
[0m19:52:55.062735 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 8 unexpected ';'.
[0m19:52:55.066615 [debug] [Thread-1 (]: Database Error in model stg_products (models\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql
[0m19:52:55.066615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84cf6436-0073-4cb3-b7d8-f2c321270e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BA651E4D0>]}
[0m19:52:55.070180 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model PUBLIC.stg_products ....................... [[31mERROR[0m in 0.43s]
[0m19:52:55.071808 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m19:52:55.072368 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m19:52:55.072368 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_products (models\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql.
[0m19:52:55.072368 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m19:52:55.075457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m19:52:55.076259 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m19:52:55.076259 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m19:52:55.076259 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m19:52:55.085452 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m19:52:55.089788 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m19:52:55.090801 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.transactions
)
SELECT 
    transaction_id,
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TRY_CAST(payment_date AS DATE) AS payment_date
FROM raw;
[0m19:52:55.594564 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00fe-0004-bb9f-0000-0005db4bbe8d
[0m19:52:55.594564 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 8 unexpected ';'.
[0m19:52:55.594564 [debug] [Thread-1 (]: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql
[0m19:52:55.594564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84cf6436-0073-4cb3-b7d8-f2c321270e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BA5BE5C10>]}
[0m19:52:55.610215 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model PUBLIC.stg_transactions ................... [[31mERROR[0m in 0.52s]
[0m19:52:55.610215 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m19:52:55.610215 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_transactions' to be skipped because of status 'error'.  Reason: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql.
[0m19:52:55.610215 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m19:52:55.610215 [info ] [Thread-1 (]: 4 of 4 SKIP relation PUBLIC.customer_revenue_bridge ............................ [[33mSKIP[0m]
[0m19:52:55.610215 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m19:52:55.625095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:52:55.627296 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m19:52:55.627296 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m19:52:56.282556 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m19:52:56.282556 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m19:52:56.909713 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m19:52:56.909713 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m19:52:57.539188 [info ] [MainThread]: 
[0m19:52:57.539188 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 10.05 seconds (10.05s).
[0m19:52:57.547886 [debug] [MainThread]: Command end result
[0m19:52:57.597108 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m19:52:57.597108 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m19:52:57.623061 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m19:52:57.624026 [info ] [MainThread]: 
[0m19:52:57.626019 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m19:52:57.628017 [info ] [MainThread]: 
[0m19:52:57.630389 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql
[0m19:52:57.632976 [info ] [MainThread]: 
[0m19:52:57.635210 [error] [MainThread]:   Database Error in model stg_products (models\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql
[0m19:52:57.637158 [info ] [MainThread]: 
[0m19:52:57.639156 [error] [MainThread]:   Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql
[0m19:52:57.641159 [info ] [MainThread]: 
[0m19:52:57.643294 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m19:52:57.646407 [debug] [MainThread]: Command `dbt run` failed at 19:52:57.645989 after 12.10 seconds
[0m19:52:57.647897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BA4AEF190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B9F612D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B9F612BD0>]}
[0m19:52:57.648924 [debug] [MainThread]: Flushing usage events
[0m19:52:58.969478 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:02:26.451929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED5F58E0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED5F58DB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED5F58C750>]}


============================== 20:02:26.467586 | 8fff10c3-9dd8-4797-ba8e-c207c2671b39 ==============================
[0m20:02:26.467586 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:02:26.467586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:02:27.156850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fff10c3-9dd8-4797-ba8e-c207c2671b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED5F5D8A50>]}
[0m20:02:27.235250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fff10c3-9dd8-4797-ba8e-c207c2671b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED6015DC10>]}
[0m20:02:27.235250 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:02:27.847879 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:02:28.097565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:02:28.097565 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://seeds\products.csv
[0m20:02:28.097565 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://seeds\customers.csv
[0m20:02:28.379334 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m20:02:28.394958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fff10c3-9dd8-4797-ba8e-c207c2671b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED60166C50>]}
[0m20:02:28.508378 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m20:02:28.508378 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m20:02:28.573157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fff10c3-9dd8-4797-ba8e-c207c2671b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED60E23C10>]}
[0m20:02:28.573157 [info ] [MainThread]: Found 4 models, 3 seeds, 474 macros
[0m20:02:28.573157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fff10c3-9dd8-4797-ba8e-c207c2671b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED60D20A50>]}
[0m20:02:28.587676 [info ] [MainThread]: 
[0m20:02:28.587676 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:02:28.590489 [info ] [MainThread]: 
[0m20:02:28.592991 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:02:28.592991 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m20:02:28.802203 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m20:02:28.802203 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m20:02:28.802203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:30.953118 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.143 seconds
[0m20:02:30.953720 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m20:02:30.969241 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m20:02:30.969241 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m20:02:30.969241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:32.802783 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.824 seconds
[0m20:02:32.802783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fff10c3-9dd8-4797-ba8e-c207c2671b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED60165A90>]}
[0m20:02:32.818391 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m20:02:32.818391 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m20:02:32.818391 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.stg_customers'
[0m20:02:32.818391 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m20:02:32.845728 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m20:02:32.850614 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m20:02:32.911402 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m20:02:32.913373 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m20:02:32.914381 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customer_name)) AS customer_name_clean,
    region
FROM raw;
[0m20:02:32.915404 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:02:34.821533 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0108-0004-bde4-0000-0005db4bf18d
[0m20:02:34.822533 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 8 unexpected ';'.
[0m20:02:34.827204 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql
[0m20:02:34.834451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fff10c3-9dd8-4797-ba8e-c207c2671b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED614D6A90>]}
[0m20:02:34.834451 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model PUBLIC.stg_customers ...................... [[31mERROR[0m in 2.01s]
[0m20:02:34.834451 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m20:02:34.841463 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m20:02:34.841463 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql.
[0m20:02:34.841463 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m20:02:34.847825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m20:02:34.849308 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m20:02:34.849308 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m20:02:34.860020 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m20:02:34.861340 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m20:02:34.861340 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m20:02:34.861340 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_name)) AS product_name_clean,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw;
[0m20:02:35.389168 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0108-0004-bb9f-0000-0005db4bbe91
[0m20:02:35.389168 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 8 unexpected ';'.
[0m20:02:35.389168 [debug] [Thread-1 (]: Database Error in model stg_products (models\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql
[0m20:02:35.389168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fff10c3-9dd8-4797-ba8e-c207c2671b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED614CB590>]}
[0m20:02:35.404791 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model PUBLIC.stg_products ....................... [[31mERROR[0m in 0.54s]
[0m20:02:35.404791 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m20:02:35.404791 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m20:02:35.404791 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_products (models\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql.
[0m20:02:35.404791 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m20:02:35.414594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m20:02:35.416623 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m20:02:35.426984 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m20:02:35.431719 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m20:02:35.431719 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m20:02:35.444496 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m20:02:35.447040 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.transactions
)
SELECT 
    transaction_id,
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TRY_CAST(payment_date AS DATE) AS payment_date
FROM raw;
[0m20:02:35.838784 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0108-0004-c0bd-0005-db4b0001706a
[0m20:02:35.838784 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 8 unexpected ';'.
[0m20:02:35.855705 [debug] [Thread-1 (]: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql
[0m20:02:35.860310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fff10c3-9dd8-4797-ba8e-c207c2671b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED6185B090>]}
[0m20:02:35.861298 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model PUBLIC.stg_transactions ................... [[31mERROR[0m in 0.45s]
[0m20:02:35.863302 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m20:02:35.865297 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_transactions' to be skipped because of status 'error'.  Reason: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql.
[0m20:02:35.867316 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m20:02:35.868733 [info ] [Thread-1 (]: 4 of 4 SKIP relation PUBLIC.customer_revenue_bridge ............................ [[33mSKIP[0m]
[0m20:02:35.870750 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m20:02:35.874192 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:02:35.876753 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m20:02:35.878748 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m20:02:36.502802 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m20:02:36.502802 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m20:02:37.132894 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m20:02:37.132894 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m20:02:37.985936 [info ] [MainThread]: 
[0m20:02:37.987940 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 9.39 seconds (9.39s).
[0m20:02:37.991983 [debug] [MainThread]: Command end result
[0m20:02:38.011199 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m20:02:38.027795 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m20:02:38.027795 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m20:02:38.027795 [info ] [MainThread]: 
[0m20:02:38.043609 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m20:02:38.045587 [info ] [MainThread]: 
[0m20:02:38.046168 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql
[0m20:02:38.046168 [info ] [MainThread]: 
[0m20:02:38.046168 [error] [MainThread]:   Database Error in model stg_products (models\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql
[0m20:02:38.046168 [info ] [MainThread]: 
[0m20:02:38.046168 [error] [MainThread]:   Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql
[0m20:02:38.061327 [info ] [MainThread]: 
[0m20:02:38.064322 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m20:02:38.064322 [debug] [MainThread]: Command `dbt run` failed at 20:02:38.064322 after 11.75 seconds
[0m20:02:38.064322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED5F5EED10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED5F483110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED5F47BD50>]}
[0m20:02:38.064322 [debug] [MainThread]: Flushing usage events
[0m20:02:39.583987 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:03:04.382060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D33958CA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3395E2010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D33958DB50>]}


============================== 20:03:04.390598 | a45d98e3-2174-47e2-bf05-326398c06048 ==============================
[0m20:03:04.390598 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:03:04.390598 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:03:05.001544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a45d98e3-2174-47e2-bf05-326398c06048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D335D14210>]}
[0m20:03:05.065512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a45d98e3-2174-47e2-bf05-326398c06048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D337F6D290>]}
[0m20:03:05.065512 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:03:05.835785 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:03:06.115928 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m20:03:06.115928 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_products.sql
[0m20:03:06.115928 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_customers.sql
[0m20:03:06.115928 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_transactions.sql
[0m20:03:06.460697 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m20:03:06.476598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a45d98e3-2174-47e2-bf05-326398c06048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D33A454210>]}
[0m20:03:06.594775 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m20:03:06.594775 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m20:03:06.626064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a45d98e3-2174-47e2-bf05-326398c06048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D33AE77410>]}
[0m20:03:06.626064 [info ] [MainThread]: Found 4 models, 3 seeds, 474 macros
[0m20:03:06.626064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a45d98e3-2174-47e2-bf05-326398c06048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D33AD35710>]}
[0m20:03:06.626064 [info ] [MainThread]: 
[0m20:03:06.626064 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:03:06.641436 [info ] [MainThread]: 
[0m20:03:06.645257 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:03:06.646226 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m20:03:06.853858 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m20:03:06.853858 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m20:03:06.853858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:09.064311 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.198 seconds
[0m20:03:09.064311 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m20:03:09.081380 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m20:03:09.081380 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m20:03:09.081380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:11.385468 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.292 seconds
[0m20:03:11.385468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a45d98e3-2174-47e2-bf05-326398c06048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D33569D150>]}
[0m20:03:11.385468 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m20:03:11.385468 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m20:03:11.385468 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.stg_customers'
[0m20:03:11.397456 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m20:03:11.412587 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m20:03:11.413856 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m20:03:11.446175 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m20:03:11.446175 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m20:03:11.446175 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customer_name)) AS customer_name_clean,
    region
FROM raw
  );
[0m20:03:11.461249 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:03:13.370643 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0109-0004-c144-0005-db4b00018016
[0m20:03:13.370643 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CRBFITNESS.PUBLIC.CUSTOMERS' does not exist or not authorized.
[0m20:03:13.376656 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql
[0m20:03:13.376656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a45d98e3-2174-47e2-bf05-326398c06048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D33A9487D0>]}
[0m20:03:13.376656 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model PUBLIC.stg_customers ...................... [[31mERROR[0m in 1.99s]
[0m20:03:13.389360 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m20:03:13.389360 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m20:03:13.392374 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql.
[0m20:03:13.392374 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m20:03:13.399216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m20:03:13.399216 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m20:03:13.399216 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m20:03:13.399216 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m20:03:13.413755 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m20:03:13.413755 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m20:03:13.413755 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_name)) AS product_name_clean,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m20:03:13.824156 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0109-0004-c0bd-0005-db4b00017072
[0m20:03:13.824156 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CRBFITNESS.PUBLIC.PRODUCTS' does not exist or not authorized.
[0m20:03:13.824156 [debug] [Thread-1 (]: Database Error in model stg_products (models\staging\stg_products.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.PUBLIC.PRODUCTS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql
[0m20:03:13.824156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a45d98e3-2174-47e2-bf05-326398c06048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D33B4F9310>]}
[0m20:03:13.824156 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model PUBLIC.stg_products ....................... [[31mERROR[0m in 0.43s]
[0m20:03:13.839771 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m20:03:13.839771 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m20:03:13.839771 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_products (models\staging\stg_products.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.PUBLIC.PRODUCTS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql.
[0m20:03:13.839771 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m20:03:13.839771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m20:03:13.847260 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m20:03:13.848789 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m20:03:13.848789 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m20:03:13.863135 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m20:03:13.863135 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m20:03:13.863135 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.transactions
)
SELECT 
    transaction_id,
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TRY_CAST(payment_date AS DATE) AS payment_date
FROM raw
  );
[0m20:03:14.387671 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0109-0004-bb9d-0000-0005db4bdaa9
[0m20:03:14.395919 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CRBFITNESS.PUBLIC.TRANSACTIONS' does not exist or not authorized.
[0m20:03:14.402907 [debug] [Thread-1 (]: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.PUBLIC.TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql
[0m20:03:14.404915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a45d98e3-2174-47e2-bf05-326398c06048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D33A9C1E50>]}
[0m20:03:14.406911 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model PUBLIC.stg_transactions ................... [[31mERROR[0m in 0.56s]
[0m20:03:14.408905 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m20:03:14.409905 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_transactions' to be skipped because of status 'error'.  Reason: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.PUBLIC.TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql.
[0m20:03:14.411084 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m20:03:14.411084 [info ] [Thread-1 (]: 4 of 4 SKIP relation PUBLIC.customer_revenue_bridge ............................ [[33mSKIP[0m]
[0m20:03:14.411084 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m20:03:14.411084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:03:14.411084 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m20:03:14.411084 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m20:03:15.195665 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m20:03:15.195665 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m20:03:15.887678 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m20:03:15.887678 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m20:03:16.718095 [info ] [MainThread]: 
[0m20:03:16.718095 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 10.07 seconds (10.07s).
[0m20:03:16.731498 [debug] [MainThread]: Command end result
[0m20:03:16.770801 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m20:03:16.779243 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m20:03:16.783154 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m20:03:16.783154 [info ] [MainThread]: 
[0m20:03:16.794584 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m20:03:16.797248 [info ] [MainThread]: 
[0m20:03:16.797248 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql
[0m20:03:16.801423 [info ] [MainThread]: 
[0m20:03:16.801423 [error] [MainThread]:   Database Error in model stg_products (models\staging\stg_products.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.PUBLIC.PRODUCTS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql
[0m20:03:16.801423 [info ] [MainThread]: 
[0m20:03:16.801423 [error] [MainThread]:   Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.PUBLIC.TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql
[0m20:03:16.814337 [info ] [MainThread]: 
[0m20:03:16.815673 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m20:03:16.820293 [debug] [MainThread]: Command `dbt run` failed at 20:03:16.820293 after 12.55 seconds
[0m20:03:16.820293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D334062C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3395E2190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3340E2E90>]}
[0m20:03:16.820293 [debug] [MainThread]: Flushing usage events
[0m20:03:18.128098 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:03:43.345010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204DCC8E390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204DCC8D890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204DCC8D8D0>]}


============================== 20:03:43.360654 | 30564556-4aea-4534-a76f-3c883885d5eb ==============================
[0m20:03:43.360654 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:03:43.360654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:03:43.955364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30564556-4aea-4534-a76f-3c883885d5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204DCEB8C90>]}
[0m20:03:44.033472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30564556-4aea-4534-a76f-3c883885d5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204DB66D490>]}
[0m20:03:44.049095 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:03:44.660576 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:03:44.881962 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:03:44.896498 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:03:44.897512 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m20:03:44.964320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30564556-4aea-4534-a76f-3c883885d5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204DCCE6B10>]}
[0m20:03:45.060502 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m20:03:45.076481 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m20:03:45.107797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30564556-4aea-4534-a76f-3c883885d5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204DDD75950>]}
[0m20:03:45.107797 [info ] [MainThread]: Found 4 models, 3 seeds, 474 macros
[0m20:03:45.107797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30564556-4aea-4534-a76f-3c883885d5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204DDDB85D0>]}
[0m20:03:45.124838 [info ] [MainThread]: 
[0m20:03:45.130904 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:03:45.131395 [info ] [MainThread]: 
[0m20:03:45.131395 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:03:45.131395 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m20:03:45.278309 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m20:03:45.278309 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m20:03:45.278309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:47.969806 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.693 seconds
[0m20:03:47.986264 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m20:03:48.001288 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m20:03:48.001288 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m20:03:48.001288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:49.977303 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.975 seconds
[0m20:03:49.977303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30564556-4aea-4534-a76f-3c883885d5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204DD945490>]}
[0m20:03:49.996778 [debug] [Thread-1 (]: Began running node seed.crb_kpi.customers
[0m20:03:49.996778 [info ] [Thread-1 (]: 1 of 3 START seed file PUBLIC.customers ........................................ [RUN]
[0m20:03:49.996778 [debug] [Thread-1 (]: Acquiring new snowflake connection 'seed.crb_kpi.customers'
[0m20:03:49.996778 [debug] [Thread-1 (]: Began compiling node seed.crb_kpi.customers
[0m20:03:49.996778 [debug] [Thread-1 (]: Began executing node seed.crb_kpi.customers
[0m20:03:50.100783 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.customers"
[0m20:03:50.101787 [debug] [Thread-1 (]: On seed.crb_kpi.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.customers"} */
create table CRBFITNESS.PUBLIC.customers (company text,customer_id integer,customername text)
[0m20:03:50.102778 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:03:52.044059 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.942 seconds
[0m20:03:52.093443 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.customers"
[0m20:03:52.093443 [debug] [Thread-1 (]: On seed.crb_kpi.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.customers"} */
BEGIN
[0m20:03:52.551251 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.457 seconds
[0m20:03:52.611116 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.customers"
[0m20:03:52.611116 [debug] [Thread-1 (]: On seed.crb_kpi.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.customers"} */
insert into CRBFITNESS.PUBLIC.customers (company, customer_id, customername) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)...
[0m20:03:54.071550 [debug] [Thread-1 (]: SQL status: SUCCESS 1762 in 1.457 seconds
[0m20:03:54.071550 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.customers"
[0m20:03:54.071550 [debug] [Thread-1 (]: On seed.crb_kpi.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.customers"} */
COMMIT
[0m20:03:54.775072 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.699 seconds
[0m20:03:54.790688 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.crb_kpi.customers"
[0m20:03:54.823424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30564556-4aea-4534-a76f-3c883885d5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204DE7715D0>]}
[0m20:03:54.823424 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file PUBLIC.customers .................................... [[32mINSERT 1762[0m in 4.83s]
[0m20:03:54.840174 [debug] [Thread-1 (]: Finished running node seed.crb_kpi.customers
[0m20:03:54.840174 [debug] [Thread-1 (]: Began running node seed.crb_kpi.products
[0m20:03:54.840174 [info ] [Thread-1 (]: 2 of 3 START seed file PUBLIC.products ......................................... [RUN]
[0m20:03:54.840174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.crb_kpi.customers, now seed.crb_kpi.products)
[0m20:03:54.840174 [debug] [Thread-1 (]: Began compiling node seed.crb_kpi.products
[0m20:03:54.840174 [debug] [Thread-1 (]: Began executing node seed.crb_kpi.products
[0m20:03:54.856630 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.products"
[0m20:03:54.857621 [debug] [Thread-1 (]: On seed.crb_kpi.products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.products"} */
create table CRBFITNESS.PUBLIC.products (product_id text,PRODUCT_Family text,product_sub_family text)
[0m20:03:55.418170 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.566 seconds
[0m20:03:55.418170 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.products"
[0m20:03:55.433738 [debug] [Thread-1 (]: On seed.crb_kpi.products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.products"} */
BEGIN
[0m20:03:55.873592 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.444 seconds
[0m20:03:55.873592 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.products"
[0m20:03:55.873592 [debug] [Thread-1 (]: On seed.crb_kpi.products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.products"} */
insert into CRBFITNESS.PUBLIC.products (product_id, PRODUCT_Family, product_sub_family) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),...
[0m20:03:56.860437 [debug] [Thread-1 (]: SQL status: SUCCESS 119 in 0.986 seconds
[0m20:03:56.860437 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.products"
[0m20:03:56.876013 [debug] [Thread-1 (]: On seed.crb_kpi.products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.products"} */
COMMIT
[0m20:03:57.472431 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.600 seconds
[0m20:03:57.472431 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.crb_kpi.products"
[0m20:03:57.472431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30564556-4aea-4534-a76f-3c883885d5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204DE772610>]}
[0m20:03:57.488009 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file PUBLIC.products ..................................... [[32mINSERT 119[0m in 2.63s]
[0m20:03:57.488009 [debug] [Thread-1 (]: Finished running node seed.crb_kpi.products
[0m20:03:57.488009 [debug] [Thread-1 (]: Began running node seed.crb_kpi.transactions
[0m20:03:57.488009 [info ] [Thread-1 (]: 3 of 3 START seed file PUBLIC.transactions ..................................... [RUN]
[0m20:03:57.488009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.crb_kpi.products, now seed.crb_kpi.transactions)
[0m20:03:57.498455 [debug] [Thread-1 (]: Began compiling node seed.crb_kpi.transactions
[0m20:03:57.499449 [debug] [Thread-1 (]: Began executing node seed.crb_kpi.transactions
[0m20:04:01.784909 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:04:01.784909 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
create table CRBFITNESS.PUBLIC.transactions (customer_id integer,product_id text,payment_month text,revenue_type integer,revenue float8,quantity integer,dimension_1 text,dimension_2 text,dimension_3 text,dimension_4 text,dimension 5 text,dimension_6 text,dimension_7 text,dimension_8 text,dimension_9 text,dimension_10 text,companies text)
[0m20:04:02.200195 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb010a-0004-bde4-0000-0005db4bf199
[0m20:04:02.201163 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 231 unexpected '5'.
[0m20:04:02.201163 [debug] [Thread-1 (]: Database Error in seed transactions (seeds\transactions.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 231 unexpected '5'.
[0m20:04:02.208180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30564556-4aea-4534-a76f-3c883885d5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204DEAD1210>]}
[0m20:04:02.208180 [error] [Thread-1 (]: 3 of 3 ERROR loading seed file PUBLIC.transactions ............................. [[31mERROR[0m in 4.72s]
[0m20:04:02.208180 [debug] [Thread-1 (]: Finished running node seed.crb_kpi.transactions
[0m20:04:02.208180 [debug] [Thread-4 (]: Marking all children of 'seed.crb_kpi.transactions' to be skipped because of status 'error'.  Reason: Database Error in seed transactions (seeds\transactions.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 231 unexpected '5'..
[0m20:04:02.208180 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:04:02.208180 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m20:04:02.208180 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m20:04:03.102669 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m20:04:03.118238 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m20:04:03.729277 [debug] [MainThread]: Connection 'seed.crb_kpi.transactions' was left open.
[0m20:04:03.729277 [debug] [MainThread]: On seed.crb_kpi.transactions: Close
[0m20:04:04.372020 [info ] [MainThread]: 
[0m20:04:04.387680 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 19.24 seconds (19.24s).
[0m20:04:04.391358 [debug] [MainThread]: Command end result
[0m20:04:04.454494 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m20:04:04.457482 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m20:04:04.465007 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m20:04:04.465007 [info ] [MainThread]: 
[0m20:04:04.467503 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:04:04.467503 [info ] [MainThread]: 
[0m20:04:04.467503 [error] [MainThread]:   Database Error in seed transactions (seeds\transactions.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 231 unexpected '5'.
[0m20:04:04.467503 [info ] [MainThread]: 
[0m20:04:04.467503 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:04:04.474183 [debug] [MainThread]: Command `dbt seed` failed at 20:04:04.474183 after 21.25 seconds
[0m20:04:04.475984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204DCCF2C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204D7812D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204D7812050>]}
[0m20:04:04.475984 [debug] [MainThread]: Flushing usage events
[0m20:04:05.785345 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:04:33.655277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206A318E410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206A318D6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206A318CA10>]}


============================== 20:04:33.662297 | 79424133-1e2c-4293-898a-ab03811ea0dd ==============================
[0m20:04:33.662297 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:04:33.662297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:04:34.256011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79424133-1e2c-4293-898a-ab03811ea0dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206A31B1E50>]}
[0m20:04:34.334158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79424133-1e2c-4293-898a-ab03811ea0dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206A1B6D210>]}
[0m20:04:34.341522 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:04:34.979655 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:04:35.214434 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:04:35.214434 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:04:35.217623 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m20:04:35.284484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79424133-1e2c-4293-898a-ab03811ea0dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206A45AAF50>]}
[0m20:04:35.414430 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m20:04:35.424493 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m20:04:35.476218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79424133-1e2c-4293-898a-ab03811ea0dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206A4003C50>]}
[0m20:04:35.476218 [info ] [MainThread]: Found 4 models, 3 seeds, 474 macros
[0m20:04:35.476218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79424133-1e2c-4293-898a-ab03811ea0dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206A3420B90>]}
[0m20:04:35.476218 [info ] [MainThread]: 
[0m20:04:35.476218 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:04:35.486649 [info ] [MainThread]: 
[0m20:04:35.488945 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:04:35.498813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m20:04:35.662508 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m20:04:35.662508 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m20:04:35.662508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:37.709458 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.040 seconds
[0m20:04:37.713377 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m20:04:37.724402 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m20:04:37.724402 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m20:04:37.724402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:39.777722 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.051 seconds
[0m20:04:39.777722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79424133-1e2c-4293-898a-ab03811ea0dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206A44F0890>]}
[0m20:04:39.793344 [debug] [Thread-1 (]: Began running node seed.crb_kpi.customers
[0m20:04:39.793344 [info ] [Thread-1 (]: 1 of 3 START seed file PUBLIC.customers ........................................ [RUN]
[0m20:04:39.793344 [debug] [Thread-1 (]: Acquiring new snowflake connection 'seed.crb_kpi.customers'
[0m20:04:39.793344 [debug] [Thread-1 (]: Began compiling node seed.crb_kpi.customers
[0m20:04:39.793344 [debug] [Thread-1 (]: Began executing node seed.crb_kpi.customers
[0m20:04:39.882047 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.customers"
[0m20:04:39.882047 [debug] [Thread-1 (]: On seed.crb_kpi.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.customers"} */
BEGIN
[0m20:04:39.882047 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:04:41.689721 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.809 seconds
[0m20:04:41.689721 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.customers"
[0m20:04:41.705366 [debug] [Thread-1 (]: On seed.crb_kpi.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.customers"} */
truncate table "CRBFITNESS"."PUBLIC"."CUSTOMERS"
  ;
[0m20:04:42.459737 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.758 seconds
[0m20:04:42.459737 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.customers"
[0m20:04:42.459737 [debug] [Thread-1 (]: On seed.crb_kpi.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.customers"} */
COMMIT
[0m20:04:43.432797 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.964 seconds
[0m20:04:43.479973 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.customers"
[0m20:04:43.479973 [debug] [Thread-1 (]: On seed.crb_kpi.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.customers"} */
BEGIN
[0m20:04:43.885297 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.407 seconds
[0m20:04:43.963355 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.customers"
[0m20:04:43.963355 [debug] [Thread-1 (]: On seed.crb_kpi.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.customers"} */
insert into CRBFITNESS.PUBLIC.customers (company, customer_id, customername) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)...
[0m20:04:45.000830 [debug] [Thread-1 (]: SQL status: SUCCESS 1762 in 1.031 seconds
[0m20:04:45.000830 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.customers"
[0m20:04:45.000830 [debug] [Thread-1 (]: On seed.crb_kpi.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.customers"} */
COMMIT
[0m20:04:45.641184 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.647 seconds
[0m20:04:45.657494 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.crb_kpi.customers"
[0m20:04:45.688167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79424133-1e2c-4293-898a-ab03811ea0dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206A4C81110>]}
[0m20:04:45.688167 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file PUBLIC.customers .................................... [[32mINSERT 1762[0m in 5.89s]
[0m20:04:45.688167 [debug] [Thread-1 (]: Finished running node seed.crb_kpi.customers
[0m20:04:45.688167 [debug] [Thread-1 (]: Began running node seed.crb_kpi.products
[0m20:04:45.688167 [info ] [Thread-1 (]: 2 of 3 START seed file PUBLIC.products ......................................... [RUN]
[0m20:04:45.688167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.crb_kpi.customers, now seed.crb_kpi.products)
[0m20:04:45.702184 [debug] [Thread-1 (]: Began compiling node seed.crb_kpi.products
[0m20:04:45.702184 [debug] [Thread-1 (]: Began executing node seed.crb_kpi.products
[0m20:04:45.707642 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.products"
[0m20:04:45.707642 [debug] [Thread-1 (]: On seed.crb_kpi.products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.products"} */
BEGIN
[0m20:04:46.081554 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.376 seconds
[0m20:04:46.081554 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.products"
[0m20:04:46.081554 [debug] [Thread-1 (]: On seed.crb_kpi.products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.products"} */
truncate table "CRBFITNESS"."PUBLIC"."PRODUCTS"
  ;
[0m20:04:46.803244 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.708 seconds
[0m20:04:46.803244 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.products"
[0m20:04:46.803244 [debug] [Thread-1 (]: On seed.crb_kpi.products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.products"} */
COMMIT
[0m20:04:47.477145 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.683 seconds
[0m20:04:47.492717 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.products"
[0m20:04:47.492717 [debug] [Thread-1 (]: On seed.crb_kpi.products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.products"} */
BEGIN
[0m20:04:47.869574 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.382 seconds
[0m20:04:47.886298 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.products"
[0m20:04:47.886298 [debug] [Thread-1 (]: On seed.crb_kpi.products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.products"} */
insert into CRBFITNESS.PUBLIC.products (product_id, PRODUCT_Family, product_sub_family) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),...
[0m20:04:48.621589 [debug] [Thread-1 (]: SQL status: SUCCESS 119 in 0.746 seconds
[0m20:04:48.637077 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.products"
[0m20:04:48.637077 [debug] [Thread-1 (]: On seed.crb_kpi.products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.products"} */
COMMIT
[0m20:04:49.218256 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.582 seconds
[0m20:04:49.218256 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.crb_kpi.products"
[0m20:04:49.218256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79424133-1e2c-4293-898a-ab03811ea0dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206A403CA10>]}
[0m20:04:49.218256 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file PUBLIC.products ..................................... [[32mINSERT 119[0m in 3.53s]
[0m20:04:49.235049 [debug] [Thread-1 (]: Finished running node seed.crb_kpi.products
[0m20:04:49.235049 [debug] [Thread-1 (]: Began running node seed.crb_kpi.transactions
[0m20:04:49.235049 [info ] [Thread-1 (]: 3 of 3 START seed file PUBLIC.transactions ..................................... [RUN]
[0m20:04:49.238764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.crb_kpi.products, now seed.crb_kpi.transactions)
[0m20:04:49.242437 [debug] [Thread-1 (]: Began compiling node seed.crb_kpi.transactions
[0m20:04:49.243861 [debug] [Thread-1 (]: Began executing node seed.crb_kpi.transactions
[0m20:04:53.528427 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:04:53.528427 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
create table CRBFITNESS.PUBLIC.transactions (customer_id integer,product_id text,payment_month text,revenue_type integer,revenue float8,quantity integer,dimension_1 text,dimension_2 text,dimension_3 text,dimension_4 text,dimension_5 text,dimension_6 text,dimension_7 text,dimension_8 text,dimension_9 text,dimension_10 text,companies text)
[0m20:04:54.032469 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.506 seconds
[0m20:04:54.531956 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:04:54.531956 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m20:04:54.927970 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.384 seconds
[0m20:05:17.129911 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:05:17.129911 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m20:05:21.632132 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 4.501 seconds
[0m20:05:21.632132 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:05:21.632132 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m20:05:22.242339 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.599 seconds
[0m20:05:22.712568 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:05:22.712568 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m20:05:23.166979 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.445 seconds
[0m20:05:50.571159 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:05:50.571159 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m20:05:55.615940 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.041 seconds
[0m20:05:55.617947 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:05:55.618938 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m20:05:56.381240 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.762 seconds
[0m20:05:56.984756 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:05:56.985758 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m20:05:57.343612 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.356 seconds
[0m20:06:24.799653 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:06:24.800671 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m20:06:29.341155 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 4.540 seconds
[0m20:06:29.341155 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:06:29.341155 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m20:06:29.953530 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.618 seconds
[0m20:06:30.420997 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:06:30.420997 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m20:06:30.864804 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.431 seconds
[0m20:06:55.825307 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:06:55.827302 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m20:07:00.662079 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 4.834 seconds
[0m20:07:00.664077 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:07:00.665083 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m20:07:01.255899 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.589 seconds
[0m20:07:01.836796 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:07:01.837799 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m20:07:02.203482 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.364 seconds
[0m20:07:28.052371 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:07:28.053377 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m20:07:33.625609 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.571 seconds
[0m20:07:33.628332 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:07:33.629816 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m20:07:34.224049 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.593 seconds
[0m20:07:34.880500 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:07:34.880500 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m20:07:35.275074 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.397 seconds
[0m20:08:01.184710 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:08:01.185711 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m20:08:06.314707 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.128 seconds
[0m20:08:06.316715 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:08:06.317713 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m20:08:07.023257 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.704 seconds
[0m20:08:07.655466 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:08:07.657476 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m20:08:08.046331 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.387 seconds
[0m20:08:34.711189 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:08:34.711189 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m20:08:40.130745 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.409 seconds
[0m20:08:40.130745 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:08:40.130745 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m20:08:40.732517 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m20:08:41.252337 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:08:41.253118 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m20:08:41.660671 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m20:09:06.155813 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:09:06.155813 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m20:09:11.273812 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.112 seconds
[0m20:09:11.275817 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:09:11.277815 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m20:09:11.863947 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m20:09:12.421737 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:09:12.421737 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m20:09:12.850917 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.426 seconds
[0m20:09:40.220220 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:09:40.222208 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m20:09:45.197407 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 4.975 seconds
[0m20:09:45.199946 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:09:45.201206 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m20:09:46.140739 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.938 seconds
[0m20:09:46.742550 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:09:46.745426 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m20:09:47.224887 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.477 seconds
[0m20:10:14.870231 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:10:14.870231 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m20:10:19.870078 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 4.987 seconds
[0m20:10:19.870078 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:10:19.870078 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m20:10:20.686396 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.823 seconds
[0m20:10:21.207937 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:10:21.207937 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m20:10:21.654449 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.433 seconds
[0m20:10:47.032717 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:10:47.032717 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m20:10:52.388237 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.344 seconds
[0m20:10:52.388237 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:10:52.388237 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m20:10:53.015990 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m20:10:53.487496 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:10:53.487496 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m20:10:53.973479 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.480 seconds
[0m20:11:19.243745 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:11:19.243745 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m20:11:24.060215 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 4.816 seconds
[0m20:11:24.060215 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:11:24.075229 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m20:11:25.017617 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.941 seconds
[0m20:11:25.472454 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:11:25.488082 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m20:11:25.974819 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.489 seconds
[0m20:11:51.052785 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:11:51.052785 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m20:11:56.317771 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.275 seconds
[0m20:11:56.317771 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:11:56.333393 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m20:11:56.867890 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.547 seconds
[0m20:11:57.447429 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:11:57.447429 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m20:11:57.855311 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.401 seconds
[0m20:12:23.492934 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:12:23.492934 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m20:12:28.724116 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.228 seconds
[0m20:12:28.724116 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:12:28.733639 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m20:12:29.341180 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.606 seconds
[0m20:12:29.850201 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:12:29.850201 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m20:12:30.258488 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.406 seconds
[0m20:12:54.442066 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:12:54.442066 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m20:13:00.378967 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.933 seconds
[0m20:13:00.378967 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:13:00.378967 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m20:13:01.008908 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.622 seconds
[0m20:13:01.555721 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:13:01.555721 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m20:13:01.934467 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.386 seconds
[0m20:13:25.661834 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:13:25.661834 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m20:13:30.338185 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 4.672 seconds
[0m20:13:30.348031 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:13:30.348031 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m20:13:31.090380 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.753 seconds
[0m20:13:31.591244 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:13:31.606871 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m20:13:32.000482 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.403 seconds
[0m20:13:59.673839 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:13:59.674840 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m20:14:05.215324 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.539 seconds
[0m20:14:05.217361 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:14:05.219320 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m20:14:06.015157 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.794 seconds
[0m20:14:06.809090 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:14:06.810102 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m20:14:07.683925 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.871 seconds
[0m20:14:37.681722 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:14:37.682785 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m20:14:42.352571 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 4.669 seconds
[0m20:14:42.356005 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:14:42.358033 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m20:14:43.122896 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.763 seconds
[0m20:14:43.339709 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:14:43.340714 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m20:14:43.958618 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.617 seconds
[0m20:14:47.383949 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:14:47.385934 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m20:14:49.453505 [debug] [Thread-1 (]: SQL status: SUCCESS 3290 in 2.067 seconds
[0m20:14:49.455509 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m20:14:49.457527 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m20:14:50.421254 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.962 seconds
[0m20:14:50.426269 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.crb_kpi.transactions"
[0m20:14:50.445079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79424133-1e2c-4293-898a-ab03811ea0dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206A67ECA90>]}
[0m20:14:50.446075 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file PUBLIC.transactions ................................. [[32mINSERT 183290[0m in 601.21s]
[0m20:14:50.450121 [debug] [Thread-1 (]: Finished running node seed.crb_kpi.transactions
[0m20:14:50.454861 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:50.456855 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m20:14:50.457860 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m20:14:53.179885 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m20:14:53.182052 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m20:14:55.158349 [debug] [MainThread]: Connection 'seed.crb_kpi.transactions' was left open.
[0m20:14:55.160352 [debug] [MainThread]: On seed.crb_kpi.transactions: Close
[0m20:14:56.099702 [info ] [MainThread]: 
[0m20:14:56.101708 [info ] [MainThread]: Finished running 3 seeds in 0 hours 10 minutes and 20.61 seconds (620.61s).
[0m20:14:56.105706 [debug] [MainThread]: Command end result
[0m20:14:56.206655 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m20:14:56.213659 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m20:14:56.230066 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m20:14:56.231095 [info ] [MainThread]: 
[0m20:14:56.234760 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:14:56.236786 [info ] [MainThread]: 
[0m20:14:56.239787 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:14:56.243807 [debug] [MainThread]: Command `dbt seed` succeeded at 20:14:56.243807 after 622.68 seconds
[0m20:14:56.244791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206A2EBBDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002069DCE2E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002069DC62C10>]}
[0m20:14:56.245792 [debug] [MainThread]: Flushing usage events
[0m20:14:57.646969 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:16:18.509592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D4A8CA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D46AEBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D46AE850>]}


============================== 20:16:18.509592 | 12f7c7cc-acee-443b-a743-7293f7f8ca26 ==============================
[0m20:16:18.509592 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:16:18.525218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:16:19.181153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12f7c7cc-acee-443b-a743-7293f7f8ca26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D57A1D50>]}
[0m20:16:19.260378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12f7c7cc-acee-443b-a743-7293f7f8ca26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D565DA50>]}
[0m20:16:19.260378 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:16:19.873959 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:16:20.124727 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:16:20.124727 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:16:20.124727 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m20:16:20.176475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12f7c7cc-acee-443b-a743-7293f7f8ca26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D56D6E10>]}
[0m20:16:20.268686 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m20:16:20.284505 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m20:16:20.347895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12f7c7cc-acee-443b-a743-7293f7f8ca26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D5BE49D0>]}
[0m20:16:20.347895 [info ] [MainThread]: Found 4 models, 3 seeds, 474 macros
[0m20:16:20.360307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12f7c7cc-acee-443b-a743-7293f7f8ca26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D4AE2690>]}
[0m20:16:20.363824 [info ] [MainThread]: 
[0m20:16:20.363824 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:16:20.368440 [info ] [MainThread]: 
[0m20:16:20.369781 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:16:20.369781 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m20:16:20.535203 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m20:16:20.535203 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m20:16:20.535203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:22.758663 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.225 seconds
[0m20:16:22.758663 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m20:16:22.789790 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m20:16:22.789790 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m20:16:22.789790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:24.813946 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.019 seconds
[0m20:16:24.818057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12f7c7cc-acee-443b-a743-7293f7f8ca26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D5BF1290>]}
[0m20:16:24.829474 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m20:16:24.829474 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m20:16:24.834722 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.stg_customers'
[0m20:16:24.834722 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m20:16:24.856501 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m20:16:24.856501 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m20:16:24.916467 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m20:16:24.919463 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m20:16:24.920444 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customer_name)) AS customer_name_clean,
    region
FROM raw
  );
[0m20:16:24.921473 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:16:26.978624 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0116-0004-c0bd-0005-db4b000170ce
[0m20:16:26.978624 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 15
invalid identifier 'CUSTOMER_NAME'
[0m20:16:26.993643 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 9 at position 15
  invalid identifier 'CUSTOMER_NAME'
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql
[0m20:16:26.993643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12f7c7cc-acee-443b-a743-7293f7f8ca26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D601A450>]}
[0m20:16:26.993643 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model PUBLIC.stg_customers ...................... [[31mERROR[0m in 2.16s]
[0m20:16:26.993643 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m20:16:27.009289 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m20:16:27.009289 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 9 at position 15
  invalid identifier 'CUSTOMER_NAME'
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql.
[0m20:16:27.009289 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m20:16:27.016331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m20:16:27.017570 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m20:16:27.023013 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m20:16:27.023013 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m20:16:27.037227 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m20:16:27.040431 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m20:16:27.040431 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_name)) AS product_name_clean,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m20:16:27.415757 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0116-0004-bb9d-0000-0005db4bdaf5
[0m20:16:27.415757 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 15
invalid identifier 'PRODUCT_NAME'
[0m20:16:27.415757 [debug] [Thread-1 (]: Database Error in model stg_products (models\staging\stg_products.sql)
  000904 (42000): SQL compilation error: error line 9 at position 15
  invalid identifier 'PRODUCT_NAME'
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql
[0m20:16:27.415757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12f7c7cc-acee-443b-a743-7293f7f8ca26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D653CB10>]}
[0m20:16:27.415757 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model PUBLIC.stg_products ....................... [[31mERROR[0m in 0.40s]
[0m20:16:27.415757 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m20:16:27.415757 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m20:16:27.415757 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_products (models\staging\stg_products.sql)
  000904 (42000): SQL compilation error: error line 9 at position 15
  invalid identifier 'PRODUCT_NAME'
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql.
[0m20:16:27.415757 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m20:16:27.433043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m20:16:27.434328 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m20:16:27.440158 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m20:16:27.440158 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m20:16:27.440158 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m20:16:27.458320 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m20:16:27.458912 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.transactions
)
SELECT 
    transaction_id,
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TRY_CAST(payment_date AS DATE) AS payment_date
FROM raw
  );
[0m20:16:27.993671 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0116-0004-bde4-0000-0005db4bf1d5
[0m20:16:27.993671 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 4
invalid identifier 'TRANSACTION_ID'
[0m20:16:27.993671 [debug] [Thread-1 (]: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'TRANSACTION_ID'
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql
[0m20:16:27.993671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12f7c7cc-acee-443b-a743-7293f7f8ca26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D6523D50>]}
[0m20:16:27.993671 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model PUBLIC.stg_transactions ................... [[31mERROR[0m in 0.56s]
[0m20:16:28.009279 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m20:16:28.009279 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_transactions' to be skipped because of status 'error'.  Reason: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'TRANSACTION_ID'
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql.
[0m20:16:28.009279 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m20:16:28.009279 [info ] [Thread-1 (]: 4 of 4 SKIP relation PUBLIC.customer_revenue_bridge ............................ [[33mSKIP[0m]
[0m20:16:28.009279 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m20:16:28.019195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:16:28.022733 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m20:16:28.022733 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m20:16:28.686523 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m20:16:28.702068 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m20:16:29.360865 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m20:16:29.360865 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m20:16:29.987924 [info ] [MainThread]: 
[0m20:16:29.987924 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 9.62 seconds (9.62s).
[0m20:16:30.002435 [debug] [MainThread]: Command end result
[0m20:16:30.038038 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m20:16:30.054692 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m20:16:30.070375 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m20:16:30.071194 [info ] [MainThread]: 
[0m20:16:30.071194 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m20:16:30.071194 [info ] [MainThread]: 
[0m20:16:30.071194 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 9 at position 15
  invalid identifier 'CUSTOMER_NAME'
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql
[0m20:16:30.078459 [info ] [MainThread]: 
[0m20:16:30.078459 [error] [MainThread]:   Database Error in model stg_products (models\staging\stg_products.sql)
  000904 (42000): SQL compilation error: error line 9 at position 15
  invalid identifier 'PRODUCT_NAME'
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql
[0m20:16:30.078459 [info ] [MainThread]: 
[0m20:16:30.078459 [error] [MainThread]:   Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'TRANSACTION_ID'
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql
[0m20:16:30.089126 [info ] [MainThread]: 
[0m20:16:30.091416 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m20:16:30.091416 [debug] [MainThread]: Command `dbt run` failed at 20:16:30.091416 after 11.70 seconds
[0m20:16:30.091416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D4AC85D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213CF612C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213CF692E90>]}
[0m20:16:30.091416 [debug] [MainThread]: Flushing usage events
[0m20:16:31.558726 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:19:41.944679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBB08CED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBACAE850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBB0E37D0>]}


============================== 20:19:41.960327 | ea3f2704-7668-430d-8693-91b3e8c91b85 ==============================
[0m20:19:41.960327 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:19:41.960327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:19:42.648927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea3f2704-7668-430d-8693-91b3e8c91b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB9392E10>]}
[0m20:19:42.728091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea3f2704-7668-430d-8693-91b3e8c91b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBBC5DA50>]}
[0m20:19:42.728091 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:19:43.370133 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:19:43.620127 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:19:43.620127 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://seeds\customers.csv
[0m20:19:43.921446 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m20:19:43.921446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea3f2704-7668-430d-8693-91b3e8c91b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBC5B2190>]}
[0m20:19:44.046531 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m20:19:44.062153 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m20:19:44.104722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea3f2704-7668-430d-8693-91b3e8c91b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBC55FFD0>]}
[0m20:19:44.104722 [info ] [MainThread]: Found 4 models, 3 seeds, 474 macros
[0m20:19:44.104722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea3f2704-7668-430d-8693-91b3e8c91b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBC5D74D0>]}
[0m20:19:44.109705 [info ] [MainThread]: 
[0m20:19:44.109705 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:19:44.114558 [info ] [MainThread]: 
[0m20:19:44.116562 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:19:44.125821 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m20:19:44.360612 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m20:19:44.360612 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m20:19:44.360612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:46.572944 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.211 seconds
[0m20:19:46.579721 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m20:19:46.588750 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m20:19:46.604393 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m20:19:46.604393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:48.438588 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.845 seconds
[0m20:19:48.451142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea3f2704-7668-430d-8693-91b3e8c91b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBC5E5450>]}
[0m20:19:48.462478 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m20:19:48.462478 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m20:19:48.466993 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.stg_customers'
[0m20:19:48.466993 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m20:19:48.485559 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m20:19:48.489995 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m20:19:48.548691 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m20:19:48.551688 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m20:19:48.552695 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customer_name)) AS customer_name_clean,
    region
FROM raw
  );
[0m20:19:48.553698 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:19:50.537912 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0119-0004-c0bd-0005-db4b000170d6
[0m20:19:50.537912 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 15
invalid identifier 'CUSTOMER_NAME'
[0m20:19:50.537912 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 9 at position 15
  invalid identifier 'CUSTOMER_NAME'
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql
[0m20:19:50.537912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea3f2704-7668-430d-8693-91b3e8c91b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBCEEFAD0>]}
[0m20:19:50.553830 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model PUBLIC.stg_customers ...................... [[31mERROR[0m in 2.07s]
[0m20:19:50.556400 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m20:19:50.556400 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m20:19:50.556400 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 9 at position 15
  invalid identifier 'CUSTOMER_NAME'
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql.
[0m20:19:50.556400 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m20:19:50.561621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m20:19:50.564099 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m20:19:50.564321 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m20:19:50.564321 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m20:19:50.564321 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m20:19:50.564321 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m20:19:50.581115 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_name)) AS product_name_clean,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m20:19:50.930887 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0119-0004-bb9d-0000-0005db4bdaf9
[0m20:19:50.930887 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 15
invalid identifier 'PRODUCT_NAME'
[0m20:19:50.946448 [debug] [Thread-1 (]: Database Error in model stg_products (models\staging\stg_products.sql)
  000904 (42000): SQL compilation error: error line 9 at position 15
  invalid identifier 'PRODUCT_NAME'
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql
[0m20:19:50.946448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea3f2704-7668-430d-8693-91b3e8c91b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBCE40F90>]}
[0m20:19:50.948306 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model PUBLIC.stg_products ....................... [[31mERROR[0m in 0.38s]
[0m20:19:50.948306 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m20:19:50.948306 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m20:19:50.948306 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_products (models\staging\stg_products.sql)
  000904 (42000): SQL compilation error: error line 9 at position 15
  invalid identifier 'PRODUCT_NAME'
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql.
[0m20:19:50.948306 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m20:19:50.956350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m20:19:50.957696 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m20:19:50.964803 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m20:19:50.967207 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m20:19:50.967207 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m20:19:50.967207 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m20:19:50.967207 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.transactions
)
SELECT 
    transaction_id,
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TRY_CAST(payment_date AS DATE) AS payment_date
FROM raw
  );
[0m20:19:51.430504 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0119-0004-bde4-0000-0005db4bf1d9
[0m20:19:51.430504 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 4
invalid identifier 'TRANSACTION_ID'
[0m20:19:51.430504 [debug] [Thread-1 (]: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'TRANSACTION_ID'
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql
[0m20:19:51.430504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea3f2704-7668-430d-8693-91b3e8c91b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBCEC8F90>]}
[0m20:19:51.430504 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model PUBLIC.stg_transactions ................... [[31mERROR[0m in 0.48s]
[0m20:19:51.430504 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m20:19:51.430504 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_transactions' to be skipped because of status 'error'.  Reason: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'TRANSACTION_ID'
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql.
[0m20:19:51.446149 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m20:19:51.446881 [info ] [Thread-1 (]: 4 of 4 SKIP relation PUBLIC.customer_revenue_bridge ............................ [[33mSKIP[0m]
[0m20:19:51.446881 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m20:19:51.452488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:19:51.452488 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m20:19:51.452488 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m20:19:52.122997 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m20:19:52.122997 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m20:19:52.795609 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m20:19:52.795609 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m20:19:53.485380 [info ] [MainThread]: 
[0m20:19:53.485380 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 9.37 seconds (9.37s).
[0m20:19:53.500954 [debug] [MainThread]: Command end result
[0m20:19:53.533168 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m20:19:53.548101 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m20:19:53.551172 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m20:19:53.551172 [info ] [MainThread]: 
[0m20:19:53.565686 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m20:19:53.566902 [info ] [MainThread]: 
[0m20:19:53.566902 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 9 at position 15
  invalid identifier 'CUSTOMER_NAME'
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql
[0m20:19:53.566902 [info ] [MainThread]: 
[0m20:19:53.574502 [error] [MainThread]:   Database Error in model stg_products (models\staging\stg_products.sql)
  000904 (42000): SQL compilation error: error line 9 at position 15
  invalid identifier 'PRODUCT_NAME'
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql
[0m20:19:53.574502 [info ] [MainThread]: 
[0m20:19:53.574502 [error] [MainThread]:   Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'TRANSACTION_ID'
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql
[0m20:19:53.582280 [info ] [MainThread]: 
[0m20:19:53.585373 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m20:19:53.585373 [debug] [MainThread]: Command `dbt run` failed at 20:19:53.585373 after 11.75 seconds
[0m20:19:53.585373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB5C12D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB5C12050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBAD77B50>]}
[0m20:19:53.585373 [debug] [MainThread]: Flushing usage events
[0m20:19:55.087804 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:20:23.717811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C399F8FC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C399FE2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C399FE3990>]}


============================== 20:20:23.717811 | ce7579ca-cfea-414d-8ad8-31965d2d6c23 ==============================
[0m20:20:23.717811 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:20:23.729823 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:20:24.355624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce7579ca-cfea-414d-8ad8-31965d2d6c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C39AB5F2D0>]}
[0m20:20:24.457677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce7579ca-cfea-414d-8ad8-31965d2d6c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C39AB5DA50>]}
[0m20:20:24.459680 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:20:25.092991 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:20:25.343160 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:20:25.343160 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_customers.sql
[0m20:20:25.673598 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m20:20:25.692565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce7579ca-cfea-414d-8ad8-31965d2d6c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C39AE3E490>]}
[0m20:20:25.799628 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m20:20:25.799628 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m20:20:25.839992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce7579ca-cfea-414d-8ad8-31965d2d6c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C39B877210>]}
[0m20:20:25.839992 [info ] [MainThread]: Found 4 models, 3 seeds, 474 macros
[0m20:20:25.839992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce7579ca-cfea-414d-8ad8-31965d2d6c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C39ABCAB50>]}
[0m20:20:25.847018 [info ] [MainThread]: 
[0m20:20:25.847018 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:20:25.853373 [info ] [MainThread]: 
[0m20:20:25.853494 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:20:25.853494 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m20:20:26.049642 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m20:20:26.049642 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m20:20:26.049642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:28.433742 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.377 seconds
[0m20:20:28.433742 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m20:20:28.464973 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m20:20:28.464973 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m20:20:28.464973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:30.630178 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.166 seconds
[0m20:20:30.630178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce7579ca-cfea-414d-8ad8-31965d2d6c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C39AE99C10>]}
[0m20:20:30.645679 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m20:20:30.645679 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m20:20:30.645679 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.stg_customers'
[0m20:20:30.645679 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m20:20:30.668884 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m20:20:30.668884 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m20:20:30.737637 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m20:20:30.740012 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m20:20:30.741028 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean,
    region
FROM raw
  );
[0m20:20:30.742024 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:20:32.580404 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb011a-0004-bb9d-0000-0005db4bdafd
[0m20:20:32.580404 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 4
invalid identifier 'REGION'
[0m20:20:32.580404 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'REGION'
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql
[0m20:20:32.591968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce7579ca-cfea-414d-8ad8-31965d2d6c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C39B338B90>]}
[0m20:20:32.591968 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model PUBLIC.stg_customers ...................... [[31mERROR[0m in 1.94s]
[0m20:20:32.591968 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m20:20:32.591968 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m20:20:32.591968 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'REGION'
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql.
[0m20:20:32.591968 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m20:20:32.604205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m20:20:32.605035 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m20:20:32.605035 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m20:20:32.605035 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m20:20:32.620897 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m20:20:32.620897 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m20:20:32.620897 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_name)) AS product_name_clean,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m20:20:33.169487 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb011a-0004-bde4-0000-0005db4bf1e1
[0m20:20:33.169487 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 15
invalid identifier 'PRODUCT_NAME'
[0m20:20:33.169487 [debug] [Thread-1 (]: Database Error in model stg_products (models\staging\stg_products.sql)
  000904 (42000): SQL compilation error: error line 9 at position 15
  invalid identifier 'PRODUCT_NAME'
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql
[0m20:20:33.185066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce7579ca-cfea-414d-8ad8-31965d2d6c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C39B772A50>]}
[0m20:20:33.185066 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model PUBLIC.stg_products ....................... [[31mERROR[0m in 0.58s]
[0m20:20:33.189219 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m20:20:33.189219 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m20:20:33.189219 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_products (models\staging\stg_products.sql)
  000904 (42000): SQL compilation error: error line 9 at position 15
  invalid identifier 'PRODUCT_NAME'
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql.
[0m20:20:33.189219 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m20:20:33.195867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m20:20:33.197281 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m20:20:33.202888 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m20:20:33.202888 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m20:20:33.210372 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m20:20:33.219948 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m20:20:33.222540 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.transactions
)
SELECT 
    transaction_id,
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TRY_CAST(payment_date AS DATE) AS payment_date
FROM raw
  );
[0m20:20:33.608197 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb011a-0004-bb9f-0000-0005db4bbecd
[0m20:20:33.608197 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 4
invalid identifier 'TRANSACTION_ID'
[0m20:20:33.623771 [debug] [Thread-1 (]: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'TRANSACTION_ID'
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql
[0m20:20:33.623771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce7579ca-cfea-414d-8ad8-31965d2d6c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C39C378790>]}
[0m20:20:33.623771 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model PUBLIC.stg_transactions ................... [[31mERROR[0m in 0.43s]
[0m20:20:33.623771 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m20:20:33.623771 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_transactions' to be skipped because of status 'error'.  Reason: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'TRANSACTION_ID'
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql.
[0m20:20:33.623771 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m20:20:33.623771 [info ] [Thread-1 (]: 4 of 4 SKIP relation PUBLIC.customer_revenue_bridge ............................ [[33mSKIP[0m]
[0m20:20:33.623771 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m20:20:33.637794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:20:33.637794 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m20:20:33.637794 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m20:20:34.283975 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m20:20:34.283975 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m20:20:35.124832 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m20:20:35.130880 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m20:20:35.756853 [info ] [MainThread]: 
[0m20:20:35.772479 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 9.90 seconds (9.90s).
[0m20:20:35.773482 [debug] [MainThread]: Command end result
[0m20:20:35.819692 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m20:20:35.820936 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m20:20:35.835913 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m20:20:35.835913 [info ] [MainThread]: 
[0m20:20:35.835913 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m20:20:35.835913 [info ] [MainThread]: 
[0m20:20:35.835913 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'REGION'
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql
[0m20:20:35.835913 [info ] [MainThread]: 
[0m20:20:35.851334 [error] [MainThread]:   Database Error in model stg_products (models\staging\stg_products.sql)
  000904 (42000): SQL compilation error: error line 9 at position 15
  invalid identifier 'PRODUCT_NAME'
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql
[0m20:20:35.854158 [info ] [MainThread]: 
[0m20:20:35.854158 [error] [MainThread]:   Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'TRANSACTION_ID'
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql
[0m20:20:35.854158 [info ] [MainThread]: 
[0m20:20:35.854158 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m20:20:35.854158 [debug] [MainThread]: Command `dbt run` failed at 20:20:35.854158 after 12.26 seconds
[0m20:20:35.868073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C394A62C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C399FC83D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C394AE2E90>]}
[0m20:20:35.870069 [debug] [MainThread]: Flushing usage events
[0m20:20:36.964394 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:24:11.645857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC228CF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC22C9090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC22E3750>]}


============================== 20:24:11.645857 | 7c4c7de5-6966-47f4-8f50-3561f51a5654 ==============================
[0m20:24:11.645857 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:24:11.645857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:24:12.236986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c4c7de5-6966-47f4-8f50-3561f51a5654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC0D17E90>]}
[0m20:24:12.330748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c4c7de5-6966-47f4-8f50-3561f51a5654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC23B7FD0>]}
[0m20:24:12.330748 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:24:12.949180 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:24:13.230951 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:24:13.230951 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_transactions.sql
[0m20:24:13.230951 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_products.sql
[0m20:24:13.592068 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m20:24:13.611787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c4c7de5-6966-47f4-8f50-3561f51a5654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC380C090>]}
[0m20:24:13.717699 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m20:24:13.717699 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m20:24:13.749148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c4c7de5-6966-47f4-8f50-3561f51a5654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC3794ED0>]}
[0m20:24:13.749148 [info ] [MainThread]: Found 4 models, 3 seeds, 474 macros
[0m20:24:13.749148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c4c7de5-6966-47f4-8f50-3561f51a5654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC37E2550>]}
[0m20:24:13.766006 [info ] [MainThread]: 
[0m20:24:13.768396 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:24:13.770865 [info ] [MainThread]: 
[0m20:24:13.772826 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:24:13.782172 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m20:24:13.945205 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m20:24:13.945205 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m20:24:13.945205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:24:16.149386 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.196 seconds
[0m20:24:16.149386 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m20:24:16.164417 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m20:24:16.164417 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m20:24:16.164417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:24:18.549825 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.378 seconds
[0m20:24:18.549825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c4c7de5-6966-47f4-8f50-3561f51a5654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC2F9E890>]}
[0m20:24:18.568665 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m20:24:18.568665 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m20:24:18.568665 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.stg_customers'
[0m20:24:18.574833 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m20:24:18.583069 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m20:24:18.597884 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m20:24:18.658783 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m20:24:18.662470 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m20:24:18.662470 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean,
    region
FROM raw
  );
[0m20:24:18.662470 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:24:20.805036 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb011e-0004-bde4-0000-0005db4bf1e5
[0m20:24:20.807062 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 4
invalid identifier 'REGION'
[0m20:24:20.807062 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'REGION'
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql
[0m20:24:20.807062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c4c7de5-6966-47f4-8f50-3561f51a5654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC3FA0850>]}
[0m20:24:20.807062 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model PUBLIC.stg_customers ...................... [[31mERROR[0m in 2.24s]
[0m20:24:20.822710 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m20:24:20.822710 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m20:24:20.822710 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'REGION'
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql.
[0m20:24:20.822710 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m20:24:20.832096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m20:24:20.833268 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m20:24:20.836745 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m20:24:20.836745 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m20:24:20.845668 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m20:24:20.848084 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m20:24:20.848084 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.products
)
SELECT 
    product_id,
    
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m20:24:21.399084 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.550 seconds
[0m20:24:21.430354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c4c7de5-6966-47f4-8f50-3561f51a5654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC3639910>]}
[0m20:24:21.430354 [info ] [Thread-1 (]: 2 of 4 OK created sql view model PUBLIC.stg_products ........................... [[32mSUCCESS 1[0m in 0.60s]
[0m20:24:21.430354 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m20:24:21.430354 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m20:24:21.430354 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m20:24:21.446017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m20:24:21.446017 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m20:24:21.446017 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m20:24:21.446017 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m20:24:21.446017 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m20:24:21.461739 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m20:24:21.463186 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.transactions
)
SELECT 
    
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TRY_CAST(payment_date AS DATE) AS payment_date
FROM raw
  );
[0m20:24:21.826582 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb011e-0004-c144-0005-db4b0001805a
[0m20:24:21.826582 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 13
invalid identifier 'PAYMENT_DATE'
[0m20:24:21.841117 [debug] [Thread-1 (]: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  000904 (42000): SQL compilation error: error line 12 at position 13
  invalid identifier 'PAYMENT_DATE'
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql
[0m20:24:21.841117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c4c7de5-6966-47f4-8f50-3561f51a5654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC4394150>]}
[0m20:24:21.841117 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model PUBLIC.stg_transactions ................... [[31mERROR[0m in 0.40s]
[0m20:24:21.853484 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m20:24:21.854673 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_transactions' to be skipped because of status 'error'.  Reason: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  000904 (42000): SQL compilation error: error line 12 at position 13
  invalid identifier 'PAYMENT_DATE'
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql.
[0m20:24:21.857194 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m20:24:21.857194 [info ] [Thread-1 (]: 4 of 4 SKIP relation PUBLIC.customer_revenue_bridge ............................ [[33mSKIP[0m]
[0m20:24:21.857194 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m20:24:21.869812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:24:21.869812 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m20:24:21.869812 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m20:24:22.638451 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m20:24:22.654026 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m20:24:23.336527 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m20:24:23.336527 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m20:24:24.287701 [info ] [MainThread]: 
[0m20:24:24.287701 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 10.51 seconds (10.51s).
[0m20:24:24.287701 [debug] [MainThread]: Command end result
[0m20:24:24.330269 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m20:24:24.330269 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m20:24:24.351321 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m20:24:24.351321 [info ] [MainThread]: 
[0m20:24:24.351321 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m20:24:24.351321 [info ] [MainThread]: 
[0m20:24:24.351321 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'REGION'
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql
[0m20:24:24.359817 [info ] [MainThread]: 
[0m20:24:24.359817 [error] [MainThread]:   Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  000904 (42000): SQL compilation error: error line 12 at position 13
  invalid identifier 'PAYMENT_DATE'
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql
[0m20:24:24.359817 [info ] [MainThread]: 
[0m20:24:24.366498 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=1 TOTAL=4
[0m20:24:24.366498 [debug] [MainThread]: Command `dbt run` failed at 20:24:24.366498 after 12.87 seconds
[0m20:24:24.366498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC22C9090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC22C86D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC08F0490>]}
[0m20:24:24.375526 [debug] [MainThread]: Flushing usage events
[0m20:24:26.278693 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:52:51.774701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA918CD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA91C8890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA91C8090>]}


============================== 20:52:51.778477 | da6e482d-33b6-4cfe-9c25-85a62d80bf45 ==============================
[0m20:52:51.778477 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:52:51.778477 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:52:52.560117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da6e482d-33b6-4cfe-9c25-85a62d80bf45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BAA19B950>]}
[0m20:52:52.638246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da6e482d-33b6-4cfe-9c25-85a62d80bf45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BAA05D8D0>]}
[0m20:52:52.640842 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:52:53.291186 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:52:53.573296 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:52:53.573296 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_transactions.sql
[0m20:52:53.911534 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m20:52:53.920054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da6e482d-33b6-4cfe-9c25-85a62d80bf45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BAA179450>]}
[0m20:52:54.016499 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m20:52:54.024080 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m20:52:54.055501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da6e482d-33b6-4cfe-9c25-85a62d80bf45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BAAB6D850>]}
[0m20:52:54.055501 [info ] [MainThread]: Found 4 models, 3 seeds, 474 macros
[0m20:52:54.071697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da6e482d-33b6-4cfe-9c25-85a62d80bf45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BAA5F2410>]}
[0m20:52:54.071697 [info ] [MainThread]: 
[0m20:52:54.077454 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:52:54.079507 [info ] [MainThread]: 
[0m20:52:54.082613 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:52:54.089203 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m20:52:54.348748 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m20:52:54.348748 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m20:52:54.348748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:57.437808 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.076 seconds
[0m20:52:57.437808 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m20:52:57.454429 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m20:52:57.454429 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m20:52:57.454429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:59.665683 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.206 seconds
[0m20:52:59.665683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da6e482d-33b6-4cfe-9c25-85a62d80bf45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA8ADA350>]}
[0m20:52:59.689778 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m20:52:59.689778 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m20:52:59.694121 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.stg_customers'
[0m20:52:59.696077 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m20:52:59.708777 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m20:52:59.711400 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m20:52:59.754290 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m20:52:59.754290 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m20:52:59.761905 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean,
    region
FROM raw
  );
[0m20:52:59.761905 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:53:02.372610 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb013b-0004-bb9d-0000-0005db4bdb01
[0m20:53:02.372610 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 4
invalid identifier 'REGION'
[0m20:53:02.380129 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'REGION'
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql
[0m20:53:02.380129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da6e482d-33b6-4cfe-9c25-85a62d80bf45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BAB024590>]}
[0m20:53:02.388147 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model PUBLIC.stg_customers ...................... [[31mERROR[0m in 2.69s]
[0m20:53:02.390054 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m20:53:02.390054 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m20:53:02.390054 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'REGION'
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql.
[0m20:53:02.390054 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m20:53:02.397694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m20:53:02.397694 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m20:53:02.404775 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m20:53:02.405788 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m20:53:02.405788 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m20:53:02.413804 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m20:53:02.413804 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.products
)
SELECT 
    product_id,
    
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m20:53:03.257632 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.844 seconds
[0m20:53:03.287926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da6e482d-33b6-4cfe-9c25-85a62d80bf45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BAA8FC590>]}
[0m20:53:03.287926 [info ] [Thread-1 (]: 2 of 4 OK created sql view model PUBLIC.stg_products ........................... [[32mSUCCESS 1[0m in 0.89s]
[0m20:53:03.303445 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m20:53:03.303445 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m20:53:03.303445 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m20:53:03.303445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m20:53:03.303445 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m20:53:03.303445 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m20:53:03.303445 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m20:53:03.303445 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m20:53:03.319889 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m20:53:03.319889 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.transactions
)
SELECT 
    
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    
FROM raw
  );
[0m20:53:04.088972 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.766 seconds
[0m20:53:04.088972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da6e482d-33b6-4cfe-9c25-85a62d80bf45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA8B1B950>]}
[0m20:53:04.088972 [info ] [Thread-1 (]: 3 of 4 OK created sql view model PUBLIC.stg_transactions ....................... [[32mSUCCESS 1[0m in 0.79s]
[0m20:53:04.088972 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m20:53:04.088972 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m20:53:04.088972 [info ] [Thread-1 (]: 4 of 4 SKIP relation PUBLIC.customer_revenue_bridge ............................ [[33mSKIP[0m]
[0m20:53:04.088972 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m20:53:04.105132 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:53:04.105132 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m20:53:04.105132 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m20:53:04.903309 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m20:53:04.903309 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m20:53:06.237111 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m20:53:06.237111 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m20:53:07.052401 [info ] [MainThread]: 
[0m20:53:07.052401 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 12.97 seconds (12.97s).
[0m20:53:07.067423 [debug] [MainThread]: Command end result
[0m20:53:07.114871 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m20:53:07.125734 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m20:53:07.140595 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m20:53:07.140595 [info ] [MainThread]: 
[0m20:53:07.140595 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:53:07.140595 [info ] [MainThread]: 
[0m20:53:07.140595 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'REGION'
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql
[0m20:53:07.140595 [info ] [MainThread]: 
[0m20:53:07.140595 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m20:53:07.155559 [debug] [MainThread]: Command `dbt run` failed at 20:53:07.140595 after 15.55 seconds
[0m20:53:07.158696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA4012C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA91EE8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA4092E90>]}
[0m20:53:07.158696 [debug] [MainThread]: Flushing usage events
[0m20:53:08.698260 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:53:28.527830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001938998CF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193899E3750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193899E3590>]}


============================== 20:53:28.543464 | 7a743f82-722e-4209-bec2-b50b69a4bdfd ==============================
[0m20:53:28.543464 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:53:28.543464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:53:29.164437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a743f82-722e-4209-bec2-b50b69a4bdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001938A5CBF90>]}
[0m20:53:29.243647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a743f82-722e-4209-bec2-b50b69a4bdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001938A55DB90>]}
[0m20:53:29.243647 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:53:29.877738 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:53:30.112111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:53:30.112111 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_customers.sql
[0m20:53:30.441390 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m20:53:30.460437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a743f82-722e-4209-bec2-b50b69a4bdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001938AC6E2D0>]}
[0m20:53:30.553612 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m20:53:30.561740 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m20:53:30.577376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a743f82-722e-4209-bec2-b50b69a4bdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001938B1515D0>]}
[0m20:53:30.593006 [info ] [MainThread]: Found 4 models, 3 seeds, 474 macros
[0m20:53:30.593006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a743f82-722e-4209-bec2-b50b69a4bdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001938B0A0590>]}
[0m20:53:30.593006 [info ] [MainThread]: 
[0m20:53:30.605598 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:53:30.606938 [info ] [MainThread]: 
[0m20:53:30.606938 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:53:30.606938 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m20:53:30.867099 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m20:53:30.867099 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m20:53:30.867099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:33.673804 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.812 seconds
[0m20:53:33.689464 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m20:53:33.705083 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m20:53:33.705083 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m20:53:33.705083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:36.040071 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.325 seconds
[0m20:53:36.040071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a743f82-722e-4209-bec2-b50b69a4bdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001938A4DC350>]}
[0m20:53:36.056297 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m20:53:36.056297 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m20:53:36.056297 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.stg_customers'
[0m20:53:36.056297 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m20:53:36.075990 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m20:53:36.075990 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m20:53:36.127817 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m20:53:36.127817 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m20:53:36.133062 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean,
   
FROM raw
  );
[0m20:53:36.133062 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:53:38.801999 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.669 seconds
[0m20:53:38.832676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a743f82-722e-4209-bec2-b50b69a4bdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001938B89F050>]}
[0m20:53:38.832676 [info ] [Thread-1 (]: 1 of 4 OK created sql view model PUBLIC.stg_customers .......................... [[32mSUCCESS 1[0m in 2.78s]
[0m20:53:38.832676 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m20:53:38.832676 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m20:53:38.832676 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m20:53:38.848295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m20:53:38.848295 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m20:53:38.848295 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m20:53:38.848295 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m20:53:38.848295 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m20:53:38.848295 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m20:53:38.848295 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.products
)
SELECT 
    product_id,
    
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m20:53:39.446521 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.596 seconds
[0m20:53:39.461538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a743f82-722e-4209-bec2-b50b69a4bdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001938B8B8110>]}
[0m20:53:39.461538 [info ] [Thread-1 (]: 2 of 4 OK created sql view model PUBLIC.stg_products ........................... [[32mSUCCESS 1[0m in 0.61s]
[0m20:53:39.469121 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m20:53:39.469121 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m20:53:39.470553 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m20:53:39.470553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m20:53:39.472311 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m20:53:39.473070 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m20:53:39.477585 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m20:53:39.483412 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m20:53:39.485436 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m20:53:39.485436 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.transactions
)
SELECT 
    
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    
FROM raw
  );
[0m20:53:40.432242 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.954 seconds
[0m20:53:40.432242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a743f82-722e-4209-bec2-b50b69a4bdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001938B289D10>]}
[0m20:53:40.447817 [info ] [Thread-1 (]: 3 of 4 OK created sql view model PUBLIC.stg_transactions ....................... [[32mSUCCESS 1[0m in 0.96s]
[0m20:53:40.447817 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m20:53:40.447817 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m20:53:40.447817 [info ] [Thread-1 (]: 4 of 4 START sql view model PUBLIC.customer_revenue_bridge ..................... [RUN]
[0m20:53:40.447817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_transactions, now model.crb_kpi.customer_revenue_bridge)
[0m20:53:40.447817 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.customer_revenue_bridge
[0m20:53:40.447817 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.customer_revenue_bridge"
[0m20:53:40.463431 [debug] [Thread-1 (]: Began executing node model.crb_kpi.customer_revenue_bridge
[0m20:53:40.470593 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.customer_revenue_bridge"
[0m20:53:40.481400 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.customer_revenue_bridge"
[0m20:53:40.488927 [debug] [Thread-1 (]: On model.crb_kpi.customer_revenue_bridge: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.customer_revenue_bridge"} */
create or replace   view CRBFITNESS.PUBLIC.customer_revenue_bridge
  
   as (
    WITH transaction_summary AS (
    SELECT 
        t.customer_id,
        c.customer_name_clean,
        p.product_family_clean,
        SUM(t.revenue) AS total_revenue,
        COUNT(DISTINCT t.payment_date) AS active_months,
        MIN(t.payment_date) AS first_transaction_date,
        MAX(t.payment_date) AS last_transaction_date
    FROM CRBFITNESS.PUBLIC.stg_transactions t
    LEFT JOIN CRBFITNESS.PUBLIC.stg_customers c ON t.customer_id = c.customer_id
    LEFT JOIN CRBFITNESS.PUBLIC.stg_products p ON t.product_id = p.product_id
    GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
),

new_customers AS (
    -- Identifies new customers by checking if their first transaction happened in the current fiscal year
    SELECT 
        customer_id,
        customer_name_clean,
        first_transaction_date,
        EXTRACT(YEAR FROM first_transaction_date) AS first_year
    FROM transaction_summary
),

churned_customers AS (
    -- Customers who haven't transacted in the last N months
    SELECT 
        customer_id, 
        customer_name_clean,
        last_transaction_date
    FROM transaction_summary
    WHERE last_transaction_date < DATEADD(MONTH, -6, CURRENT_DATE) -- Example: Last transaction was 6 months ago
),

cross_sell_customers AS (
    -- Customers who have purchased multiple product families
    SELECT 
        customer_id, 
        customer_name_clean,
        COUNT(DISTINCT product_family_clean) AS unique_product_families
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
    HAVING COUNT(DISTINCT product_family_clean) > 1
),

product_churn AS (
    -- Products that have seen a decline in purchases
    SELECT 
        product_family_clean,
        COUNT(DISTINCT customer_id) AS customer_count,
        LAG(customer_count) OVER (PARTITION BY product_family_clean ORDER BY last_transaction_date) AS prev_customer_count,
        customer_count - LAG(customer_count) OVER (PARTITION BY product_family_clean ORDER BY last_transaction_date) AS customer_loss
    FROM transaction_summary
),

revenue_metrics AS (
    -- Net Revenue Retention (NRR) and Gross Revenue Retention (GRR)
    SELECT 
        SUM(CASE WHEN last_transaction_date >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS current_revenue,
        SUM(CASE WHEN first_transaction_date < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS previous_revenue,
        (SUM(CASE WHEN last_transaction_date >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         SUM(CASE WHEN first_transaction_date < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END)) AS NRR,
        (SUM(CASE WHEN last_transaction_date >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         SUM(CASE WHEN last_transaction_date >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END)) AS GRR
    FROM transaction_summary
),

lost_revenue AS (
    -- Revenue lost due to customer churn
    SELECT 
        SUM(total_revenue) AS lost_revenue
    FROM transaction_summary
    WHERE customer_id IN (SELECT customer_id FROM churned_customers)
),

ranked_products AS (
    -- Rank products based on total revenue
    SELECT 
        product_family_clean,
        SUM(total_revenue) AS product_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY product_family_clean
),

ranked_customers AS (
    -- Rank customers based on total revenue
    SELECT 
        customer_id,
        customer_name_clean,
        SUM(total_revenue) AS customer_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
)

-- Final Result
SELECT * FROM new_customers
UNION ALL
SELECT * FROM churned_customers
UNION ALL
SELECT * FROM cross_sell_customers
UNION ALL
SELECT * FROM product_churn
UNION ALL
SELECT * FROM revenue_metrics
UNION ALL
SELECT * FROM lost_revenue
UNION ALL
SELECT * FROM ranked_products
UNION ALL
SELECT * FROM ranked_customers;
[0m20:53:41.065172 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb013b-0004-bde4-0000-0005db4bf1f5
[0m20:53:41.065172 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 116 at position 30 unexpected ';'.
[0m20:53:41.065172 [debug] [Thread-1 (]: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  001003 (42000): SQL compilation error:
  syntax error line 116 at position 30 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m20:53:41.074692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a743f82-722e-4209-bec2-b50b69a4bdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001938B99D8D0>]}
[0m20:53:41.074692 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model PUBLIC.customer_revenue_bridge ............ [[31mERROR[0m in 0.62s]
[0m20:53:41.074692 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m20:53:41.074692 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.customer_revenue_bridge' to be skipped because of status 'error'.  Reason: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  001003 (42000): SQL compilation error:
  syntax error line 116 at position 30 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql.
[0m20:53:41.074692 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:53:41.074692 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m20:53:41.074692 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m20:53:42.003803 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m20:53:42.019458 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m20:53:42.690110 [debug] [MainThread]: Connection 'model.crb_kpi.customer_revenue_bridge' was left open.
[0m20:53:42.690110 [debug] [MainThread]: On model.crb_kpi.customer_revenue_bridge: Close
[0m20:53:43.369310 [info ] [MainThread]: 
[0m20:53:43.369310 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 12.76 seconds (12.76s).
[0m20:53:43.369310 [debug] [MainThread]: Command end result
[0m20:53:43.423391 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m20:53:43.426020 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m20:53:43.426020 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m20:53:43.426020 [info ] [MainThread]: 
[0m20:53:43.439374 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:53:43.441840 [info ] [MainThread]: 
[0m20:53:43.441840 [error] [MainThread]:   Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  001003 (42000): SQL compilation error:
  syntax error line 116 at position 30 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m20:53:43.441840 [info ] [MainThread]: 
[0m20:53:43.441840 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m20:53:43.441840 [debug] [MainThread]: Command `dbt run` failed at 20:53:43.441840 after 15.02 seconds
[0m20:53:43.441840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001938979B850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001938B607CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019384462BD0>]}
[0m20:53:43.441840 [debug] [MainThread]: Flushing usage events
[0m20:53:44.964464 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:54:03.323411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3D7D8C490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3D7D8DB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3D7D8C610>]}


============================== 20:54:03.323411 | 0a05fc0b-10b0-4390-a23d-6217d792c9c0 ==============================
[0m20:54:03.323411 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:54:03.323411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:54:03.913286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a05fc0b-10b0-4390-a23d-6217d792c9c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3D7DB1DD0>]}
[0m20:54:03.991460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a05fc0b-10b0-4390-a23d-6217d792c9c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3D895DDD0>]}
[0m20:54:03.991460 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:54:04.606948 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:54:04.873655 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:54:04.873655 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\customer_revenue_bridge.sql
[0m20:54:05.202825 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m20:54:05.218456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a05fc0b-10b0-4390-a23d-6217d792c9c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3D94FE2D0>]}
[0m20:54:05.314743 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m20:54:05.324646 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m20:54:05.354357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a05fc0b-10b0-4390-a23d-6217d792c9c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3D8CA15D0>]}
[0m20:54:05.354357 [info ] [MainThread]: Found 3 seeds, 4 models, 474 macros
[0m20:54:05.354357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a05fc0b-10b0-4390-a23d-6217d792c9c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3D8C83790>]}
[0m20:54:05.354357 [info ] [MainThread]: 
[0m20:54:05.367085 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:54:05.368819 [info ] [MainThread]: 
[0m20:54:05.368819 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:54:05.375792 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m20:54:05.636728 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m20:54:05.636728 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m20:54:05.636728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:08.389887 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.755 seconds
[0m20:54:08.405536 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m20:54:08.422043 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m20:54:08.422043 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m20:54:08.422043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:10.523158 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.099 seconds
[0m20:54:10.529495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a05fc0b-10b0-4390-a23d-6217d792c9c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3D951CB50>]}
[0m20:54:10.542712 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m20:54:10.542712 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m20:54:10.546944 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.stg_customers'
[0m20:54:10.548871 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m20:54:10.560075 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m20:54:10.560075 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m20:54:10.609895 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m20:54:10.609895 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m20:54:10.609895 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean,
   
FROM raw
  );
[0m20:54:10.617950 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:54:12.821685 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.202 seconds
[0m20:54:12.852360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a05fc0b-10b0-4390-a23d-6217d792c9c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3D9C4CA50>]}
[0m20:54:12.852360 [info ] [Thread-1 (]: 1 of 4 OK created sql view model PUBLIC.stg_customers .......................... [[32mSUCCESS 1[0m in 2.31s]
[0m20:54:12.867979 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m20:54:12.867979 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m20:54:12.867979 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m20:54:12.867979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m20:54:12.867979 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m20:54:12.867979 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m20:54:12.867979 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m20:54:12.885260 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m20:54:12.887403 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m20:54:12.895162 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.products
)
SELECT 
    product_id,
    
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m20:54:13.517136 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.620 seconds
[0m20:54:13.517879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a05fc0b-10b0-4390-a23d-6217d792c9c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3DA0A3F50>]}
[0m20:54:13.517879 [info ] [Thread-1 (]: 2 of 4 OK created sql view model PUBLIC.stg_products ........................... [[32mSUCCESS 1[0m in 0.65s]
[0m20:54:13.517879 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m20:54:13.517879 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m20:54:13.517879 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m20:54:13.517879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m20:54:13.533660 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m20:54:13.537977 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m20:54:13.544019 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m20:54:13.549668 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m20:54:13.549668 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m20:54:13.560276 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.transactions
)
SELECT 
    
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    
FROM raw
  );
[0m20:54:14.223632 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.673 seconds
[0m20:54:14.239247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a05fc0b-10b0-4390-a23d-6217d792c9c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3D9C36C10>]}
[0m20:54:14.239247 [info ] [Thread-1 (]: 3 of 4 OK created sql view model PUBLIC.stg_transactions ....................... [[32mSUCCESS 1[0m in 0.72s]
[0m20:54:14.239247 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m20:54:14.239247 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m20:54:14.239247 [info ] [Thread-1 (]: 4 of 4 START sql view model PUBLIC.customer_revenue_bridge ..................... [RUN]
[0m20:54:14.239247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_transactions, now model.crb_kpi.customer_revenue_bridge)
[0m20:54:14.251293 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.customer_revenue_bridge
[0m20:54:14.261759 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.customer_revenue_bridge"
[0m20:54:14.261759 [debug] [Thread-1 (]: Began executing node model.crb_kpi.customer_revenue_bridge
[0m20:54:14.261759 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.customer_revenue_bridge"
[0m20:54:14.280631 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.customer_revenue_bridge"
[0m20:54:14.280631 [debug] [Thread-1 (]: On model.crb_kpi.customer_revenue_bridge: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.customer_revenue_bridge"} */
create or replace   view CRBFITNESS.PUBLIC.customer_revenue_bridge
  
   as (
    WITH transaction_summary AS (
    SELECT 
        t.customer_id,
        c.customer_name_clean,
        p.product_family_clean,
        SUM(t.revenue) AS total_revenue,
        COUNT(DISTINCT t.payment_date) AS active_months,
        MIN(t.payment_date) AS first_transaction_date,
        MAX(t.payment_date) AS last_transaction_date
    FROM CRBFITNESS.PUBLIC.stg_transactions t
    LEFT JOIN CRBFITNESS.PUBLIC.stg_customers c ON t.customer_id = c.customer_id
    LEFT JOIN CRBFITNESS.PUBLIC.stg_products p ON t.product_id = p.product_id
    GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
),

new_customers AS (
    -- Identifies new customers by checking if their first transaction happened in the current fiscal year
    SELECT 
        customer_id,
        customer_name_clean,
        first_transaction_date,
        EXTRACT(YEAR FROM first_transaction_date) AS first_year
    FROM transaction_summary
),

churned_customers AS (
    -- Customers who haven't transacted in the last N months
    SELECT 
        customer_id, 
        customer_name_clean,
        last_transaction_date
    FROM transaction_summary
    WHERE last_transaction_date < DATEADD(MONTH, -6, CURRENT_DATE) -- Example: Last transaction was 6 months ago
),

cross_sell_customers AS (
    -- Customers who have purchased multiple product families
    SELECT 
        customer_id, 
        customer_name_clean,
        COUNT(DISTINCT product_family_clean) AS unique_product_families
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
    HAVING COUNT(DISTINCT product_family_clean) > 1
),

product_churn AS (
    -- Products that have seen a decline in purchases
    SELECT 
        product_family_clean,
        COUNT(DISTINCT customer_id) AS customer_count,
        LAG(customer_count) OVER (PARTITION BY product_family_clean ORDER BY last_transaction_date) AS prev_customer_count,
        customer_count - LAG(customer_count) OVER (PARTITION BY product_family_clean ORDER BY last_transaction_date) AS customer_loss
    FROM transaction_summary
),

revenue_metrics AS (
    -- Net Revenue Retention (NRR) and Gross Revenue Retention (GRR)
    SELECT 
        SUM(CASE WHEN last_transaction_date >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS current_revenue,
        SUM(CASE WHEN first_transaction_date < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS previous_revenue,
        (SUM(CASE WHEN last_transaction_date >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         SUM(CASE WHEN first_transaction_date < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END)) AS NRR,
        (SUM(CASE WHEN last_transaction_date >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         SUM(CASE WHEN last_transaction_date >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END)) AS GRR
    FROM transaction_summary
),

lost_revenue AS (
    -- Revenue lost due to customer churn
    SELECT 
        SUM(total_revenue) AS lost_revenue
    FROM transaction_summary
    WHERE customer_id IN (SELECT customer_id FROM churned_customers)
),

ranked_products AS (
    -- Rank products based on total revenue
    SELECT 
        product_family_clean,
        SUM(total_revenue) AS product_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY product_family_clean
),

ranked_customers AS (
    -- Rank customers based on total revenue
    SELECT 
        customer_id,
        customer_name_clean,
        SUM(total_revenue) AS customer_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
)

-- Final Result
SELECT * FROM new_customers
UNION ALL
SELECT * FROM churned_customers
UNION ALL
SELECT * FROM cross_sell_customers
UNION ALL
SELECT * FROM product_churn
UNION ALL
SELECT * FROM revenue_metrics
UNION ALL
SELECT * FROM lost_revenue
UNION ALL
SELECT * FROM ranked_products
UNION ALL
SELECT * FROM ranked_customers
  );
[0m20:54:14.960537 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb013c-0004-bb9d-0000-0005db4bdb09
[0m20:54:14.960537 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 23
invalid identifier 'T.PAYMENT_DATE'
[0m20:54:14.960537 [debug] [Thread-1 (]: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  000904 (42000): SQL compilation error: error line 10 at position 23
  invalid identifier 'T.PAYMENT_DATE'
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m20:54:14.960537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a05fc0b-10b0-4390-a23d-6217d792c9c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3D9CFA690>]}
[0m20:54:14.960537 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model PUBLIC.customer_revenue_bridge ............ [[31mERROR[0m in 0.72s]
[0m20:54:14.960537 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m20:54:14.976187 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.customer_revenue_bridge' to be skipped because of status 'error'.  Reason: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  000904 (42000): SQL compilation error: error line 10 at position 23
  invalid identifier 'T.PAYMENT_DATE'
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql.
[0m20:54:14.976947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:54:14.976947 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m20:54:14.976947 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m20:54:15.978323 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m20:54:15.978323 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m20:54:16.889539 [debug] [MainThread]: Connection 'model.crb_kpi.customer_revenue_bridge' was left open.
[0m20:54:16.889539 [debug] [MainThread]: On model.crb_kpi.customer_revenue_bridge: Close
[0m20:54:17.610917 [info ] [MainThread]: 
[0m20:54:17.610917 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 12.24 seconds (12.24s).
[0m20:54:17.610917 [debug] [MainThread]: Command end result
[0m20:54:17.665883 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m20:54:17.665883 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m20:54:17.682040 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m20:54:17.682040 [info ] [MainThread]: 
[0m20:54:17.682040 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:54:17.682040 [info ] [MainThread]: 
[0m20:54:17.682040 [error] [MainThread]:   Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  000904 (42000): SQL compilation error: error line 10 at position 23
  invalid identifier 'T.PAYMENT_DATE'
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m20:54:17.690509 [info ] [MainThread]: 
[0m20:54:17.692027 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m20:54:17.694066 [debug] [MainThread]: Command `dbt run` failed at 20:54:17.694066 after 14.49 seconds
[0m20:54:17.694066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3D2862D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3D2862D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3D2862010>]}
[0m20:54:17.694066 [debug] [MainThread]: Flushing usage events
[0m20:54:19.448360 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:55:13.823850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532BC8C0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532BCE22D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532BCE1F50>]}


============================== 20:55:13.823850 | 26f55038-7662-4476-a937-0088e37251b9 ==============================
[0m20:55:13.823850 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:55:13.823850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:55:14.433725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26f55038-7662-4476-a937-0088e37251b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532C9476D0>]}
[0m20:55:14.512672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26f55038-7662-4476-a937-0088e37251b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532A66D310>]}
[0m20:55:14.512672 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:55:15.153971 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:55:15.405592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:55:15.405592 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\customer_revenue_bridge.sql
[0m20:55:15.719519 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m20:55:15.735477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26f55038-7662-4476-a937-0088e37251b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532D2F84D0>]}
[0m20:55:15.841809 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m20:55:15.844990 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m20:55:15.873146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26f55038-7662-4476-a937-0088e37251b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532D192E50>]}
[0m20:55:15.873146 [info ] [MainThread]: Found 3 seeds, 4 models, 474 macros
[0m20:55:15.884216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26f55038-7662-4476-a937-0088e37251b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025328CF7790>]}
[0m20:55:15.889249 [info ] [MainThread]: 
[0m20:55:15.891320 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:55:15.891320 [info ] [MainThread]: 
[0m20:55:15.896700 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:55:15.896700 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m20:55:16.143962 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m20:55:16.143962 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m20:55:16.143962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:18.638730 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.494 seconds
[0m20:55:18.638730 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m20:55:18.669906 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m20:55:18.669906 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m20:55:18.669906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:21.805453 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 3.142 seconds
[0m20:55:21.820474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26f55038-7662-4476-a937-0088e37251b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532C9D85D0>]}
[0m20:55:21.820474 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m20:55:21.820474 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m20:55:21.820474 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.stg_customers'
[0m20:55:21.836129 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m20:55:21.836129 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m20:55:21.836129 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m20:55:21.911966 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m20:55:21.911966 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m20:55:21.911966 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean,
   
FROM raw
  );
[0m20:55:21.919512 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:55:24.675682 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.765 seconds
[0m20:55:24.722584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26f55038-7662-4476-a937-0088e37251b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532D004DD0>]}
[0m20:55:24.722584 [info ] [Thread-1 (]: 1 of 4 OK created sql view model PUBLIC.stg_customers .......................... [[32mSUCCESS 1[0m in 2.90s]
[0m20:55:24.722584 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m20:55:24.722584 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m20:55:24.722584 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m20:55:24.722584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m20:55:24.722584 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m20:55:24.722584 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m20:55:24.738208 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m20:55:24.740681 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m20:55:24.747698 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m20:55:24.749213 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.products
)
SELECT 
    product_id,
    
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m20:55:25.484023 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.740 seconds
[0m20:55:25.484023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26f55038-7662-4476-a937-0088e37251b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532D996850>]}
[0m20:55:25.484023 [info ] [Thread-1 (]: 2 of 4 OK created sql view model PUBLIC.stg_products ........................... [[32mSUCCESS 1[0m in 0.76s]
[0m20:55:25.499600 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m20:55:25.499600 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m20:55:25.499600 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m20:55:25.499600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m20:55:25.505572 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m20:55:25.512560 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m20:55:25.517537 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m20:55:25.517537 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m20:55:25.517537 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m20:55:25.530979 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.transactions
)
SELECT 
    
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    
FROM raw
  );
[0m20:55:26.320434 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.789 seconds
[0m20:55:26.320434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26f55038-7662-4476-a937-0088e37251b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532D9958D0>]}
[0m20:55:26.320434 [info ] [Thread-1 (]: 3 of 4 OK created sql view model PUBLIC.stg_transactions ....................... [[32mSUCCESS 1[0m in 0.82s]
[0m20:55:26.320434 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m20:55:26.335989 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m20:55:26.335989 [info ] [Thread-1 (]: 4 of 4 START sql view model PUBLIC.customer_revenue_bridge ..................... [RUN]
[0m20:55:26.335989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_transactions, now model.crb_kpi.customer_revenue_bridge)
[0m20:55:26.335989 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.customer_revenue_bridge
[0m20:55:26.350289 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.customer_revenue_bridge"
[0m20:55:26.350289 [debug] [Thread-1 (]: Began executing node model.crb_kpi.customer_revenue_bridge
[0m20:55:26.350289 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.customer_revenue_bridge"
[0m20:55:26.361805 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.customer_revenue_bridge"
[0m20:55:26.361805 [debug] [Thread-1 (]: On model.crb_kpi.customer_revenue_bridge: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.customer_revenue_bridge"} */
create or replace   view CRBFITNESS.PUBLIC.customer_revenue_bridge
  
   as (
    WITH transaction_summary AS (
    SELECT 
        t.customer_id,
        c.customer_name_clean,
        p.product_family_clean,
        SUM(t.revenue) AS total_revenue,
        COUNT(DISTINCT t.payment_date) AS active_months,
       
    FROM CRBFITNESS.PUBLIC.stg_transactions t
    LEFT JOIN CRBFITNESS.PUBLIC.stg_customers c ON t.customer_id = c.customer_id
    LEFT JOIN CRBFITNESS.PUBLIC.stg_products p ON t.product_id = p.product_id
    GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
),

new_customers AS (
    -- Identifies new customers by checking if their first transaction happened in the current fiscal year
    SELECT 
        customer_id,
        customer_name_clean,
        first_transaction_date,
        EXTRACT(YEAR FROM first_transaction_date) AS first_year
    FROM transaction_summary
),

churned_customers AS (
    -- Customers who haven't transacted in the last N months
    SELECT 
        customer_id, 
        customer_name_clean,
        last_transaction_date
    FROM transaction_summary
    WHERE last_transaction_date < DATEADD(MONTH, -6, CURRENT_DATE) -- Example: Last transaction was 6 months ago
),

cross_sell_customers AS (
    -- Customers who have purchased multiple product families
    SELECT 
        customer_id, 
        customer_name_clean,
        COUNT(DISTINCT product_family_clean) AS unique_product_families
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
    HAVING COUNT(DISTINCT product_family_clean) > 1
),

product_churn AS (
    -- Products that have seen a decline in purchases
    SELECT 
        product_family_clean,
        COUNT(DISTINCT customer_id) AS customer_count,
        LAG(customer_count) OVER (PARTITION BY product_family_clean ORDER BY last_transaction_date) AS prev_customer_count,
        customer_count - LAG(customer_count) OVER (PARTITION BY product_family_clean ORDER BY last_transaction_date) AS customer_loss
    FROM transaction_summary
),

revenue_metrics AS (
    -- Net Revenue Retention (NRR) and Gross Revenue Retention (GRR)
    SELECT 
        SUM(CASE WHEN last_transaction_date >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS current_revenue,
        SUM(CASE WHEN first_transaction_date < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS previous_revenue,
        (SUM(CASE WHEN last_transaction_date >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         SUM(CASE WHEN first_transaction_date < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END)) AS NRR,
        (SUM(CASE WHEN last_transaction_date >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         SUM(CASE WHEN last_transaction_date >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END)) AS GRR
    FROM transaction_summary
),

lost_revenue AS (
    -- Revenue lost due to customer churn
    SELECT 
        SUM(total_revenue) AS lost_revenue
    FROM transaction_summary
    WHERE customer_id IN (SELECT customer_id FROM churned_customers)
),

ranked_products AS (
    -- Rank products based on total revenue
    SELECT 
        product_family_clean,
        SUM(total_revenue) AS product_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY product_family_clean
),

ranked_customers AS (
    -- Rank customers based on total revenue
    SELECT 
        customer_id,
        customer_name_clean,
        SUM(total_revenue) AS customer_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
)

-- Final Result
SELECT * FROM new_customers
UNION ALL
SELECT * FROM churned_customers
UNION ALL
SELECT * FROM cross_sell_customers
UNION ALL
SELECT * FROM product_churn
UNION ALL
SELECT * FROM revenue_metrics
UNION ALL
SELECT * FROM lost_revenue
UNION ALL
SELECT * FROM ranked_products
UNION ALL
SELECT * FROM ranked_customers
  );
[0m20:55:26.962523 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb013d-0004-c0bd-0005-db4b000170f6
[0m20:55:26.962523 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 23
invalid identifier 'T.PAYMENT_DATE'
[0m20:55:26.970542 [debug] [Thread-1 (]: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  000904 (42000): SQL compilation error: error line 10 at position 23
  invalid identifier 'T.PAYMENT_DATE'
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m20:55:26.970542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26f55038-7662-4476-a937-0088e37251b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532DCEF050>]}
[0m20:55:26.970542 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model PUBLIC.customer_revenue_bridge ............ [[31mERROR[0m in 0.63s]
[0m20:55:26.978962 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m20:55:26.978962 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.customer_revenue_bridge' to be skipped because of status 'error'.  Reason: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  000904 (42000): SQL compilation error: error line 10 at position 23
  invalid identifier 'T.PAYMENT_DATE'
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql.
[0m20:55:26.978962 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:55:26.978962 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m20:55:26.978962 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m20:55:28.359041 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m20:55:28.359041 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m20:55:29.018674 [debug] [MainThread]: Connection 'model.crb_kpi.customer_revenue_bridge' was left open.
[0m20:55:29.018674 [debug] [MainThread]: On model.crb_kpi.customer_revenue_bridge: Close
[0m20:55:29.913791 [info ] [MainThread]: 
[0m20:55:29.913791 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 14.02 seconds (14.02s).
[0m20:55:29.913791 [debug] [MainThread]: Command end result
[0m20:55:29.968868 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m20:55:29.979473 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m20:55:29.985055 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m20:55:29.985055 [info ] [MainThread]: 
[0m20:55:29.985055 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:55:29.993071 [info ] [MainThread]: 
[0m20:55:29.993071 [error] [MainThread]:   Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  000904 (42000): SQL compilation error: error line 10 at position 23
  invalid identifier 'T.PAYMENT_DATE'
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m20:55:29.993071 [info ] [MainThread]: 
[0m20:55:30.000507 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m20:55:30.000507 [debug] [MainThread]: Command `dbt run` failed at 20:55:30.000507 after 16.29 seconds
[0m20:55:30.000507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025326812C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532BCE22D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532BCE3BD0>]}
[0m20:55:30.000507 [debug] [MainThread]: Flushing usage events
[0m20:55:31.183254 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:06:45.157027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E200F8D590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E200F8DA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E200F8FA50>]}


============================== 21:06:45.157027 | 8f353029-4005-4463-bf3f-a5b04095cf37 ==============================
[0m21:06:45.157027 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:06:45.169656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:06:45.757229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f353029-4005-4463-bf3f-a5b04095cf37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E201E9FD50>]}
[0m21:06:45.835471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f353029-4005-4463-bf3f-a5b04095cf37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E27F96D2D0>]}
[0m21:06:45.835471 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m21:06:46.457485 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m21:06:46.707977 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:06:46.707977 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\customer_revenue_bridge.sql
[0m21:06:47.053835 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m21:06:47.053835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f353029-4005-4463-bf3f-a5b04095cf37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E201E95B50>]}
[0m21:06:47.162453 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m21:06:47.171741 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m21:06:47.202407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f353029-4005-4463-bf3f-a5b04095cf37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E202877010>]}
[0m21:06:47.206221 [info ] [MainThread]: Found 3 seeds, 4 models, 474 macros
[0m21:06:47.206221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f353029-4005-4463-bf3f-a5b04095cf37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E202698A10>]}
[0m21:06:47.206221 [info ] [MainThread]: 
[0m21:06:47.206221 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:06:47.216481 [info ] [MainThread]: 
[0m21:06:47.216481 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:06:47.223002 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m21:06:47.465431 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m21:06:47.465431 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m21:06:47.465431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:06:49.658262 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.191 seconds
[0m21:06:49.658262 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m21:06:49.673742 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m21:06:49.689362 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m21:06:49.689362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:06:51.560713 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.872 seconds
[0m21:06:51.560713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f353029-4005-4463-bf3f-a5b04095cf37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2008DA1D0>]}
[0m21:06:51.576913 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m21:06:51.576913 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m21:06:51.576913 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.stg_customers'
[0m21:06:51.576913 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m21:06:51.600641 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m21:06:51.602449 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m21:06:51.656684 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m21:06:51.656684 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m21:06:51.656684 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean,
   
FROM raw
  );
[0m21:06:51.656684 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:06:54.140084 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.479 seconds
[0m21:06:54.177927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f353029-4005-4463-bf3f-a5b04095cf37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E202ED6E50>]}
[0m21:06:54.177927 [info ] [Thread-1 (]: 1 of 4 OK created sql view model PUBLIC.stg_customers .......................... [[32mSUCCESS 1[0m in 2.60s]
[0m21:06:54.177927 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m21:06:54.177927 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m21:06:54.177927 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m21:06:54.177927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m21:06:54.177927 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m21:06:54.177927 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m21:06:54.193521 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m21:06:54.199973 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m21:06:54.199973 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m21:06:54.199973 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.products
)
SELECT 
    product_id,
    
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m21:06:54.823782 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.628 seconds
[0m21:06:54.837322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f353029-4005-4463-bf3f-a5b04095cf37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E202F19DD0>]}
[0m21:06:54.837322 [info ] [Thread-1 (]: 2 of 4 OK created sql view model PUBLIC.stg_products ........................... [[32mSUCCESS 1[0m in 0.66s]
[0m21:06:54.837322 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m21:06:54.837322 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m21:06:54.837322 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m21:06:54.837322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m21:06:54.837322 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m21:06:54.856609 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m21:06:54.856609 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m21:06:54.860385 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m21:06:54.860385 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m21:06:54.865799 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.transactions
)
SELECT 
    
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    
FROM raw
  );
[0m21:06:55.448844 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.589 seconds
[0m21:06:55.448844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f353029-4005-4463-bf3f-a5b04095cf37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E202EAE590>]}
[0m21:06:55.448844 [info ] [Thread-1 (]: 3 of 4 OK created sql view model PUBLIC.stg_transactions ....................... [[32mSUCCESS 1[0m in 0.61s]
[0m21:06:55.464500 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m21:06:55.464500 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m21:06:55.464500 [info ] [Thread-1 (]: 4 of 4 START sql view model PUBLIC.customer_revenue_bridge ..................... [RUN]
[0m21:06:55.464500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_transactions, now model.crb_kpi.customer_revenue_bridge)
[0m21:06:55.464500 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.customer_revenue_bridge
[0m21:06:55.479722 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.customer_revenue_bridge"
[0m21:06:55.482570 [debug] [Thread-1 (]: Began executing node model.crb_kpi.customer_revenue_bridge
[0m21:06:55.485480 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.customer_revenue_bridge"
[0m21:06:55.502142 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.customer_revenue_bridge"
[0m21:06:55.502142 [debug] [Thread-1 (]: On model.crb_kpi.customer_revenue_bridge: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.customer_revenue_bridge"} */
create or replace   view CRBFITNESS.PUBLIC.customer_revenue_bridge
  
   as (
    WITH transaction_summary AS (
    SELECT 
        t.customer_id,
        c.customer_name_clean,
        p.product_family_clean,
        SUM(t.revenue) AS total_revenue,
        COUNT(DISTINCT t.payment_month) AS active_months, -- Use payment_month instead of payment_date
        MIN(t.payment_month) AS first_transaction_month,  -- First transaction month
        MAX(t.payment_month) AS last_transaction_month  -- Last transaction month
    FROM CRBFITNESS.PUBLIC.stg_transactions t
    LEFT JOIN CRBFITNESS.PUBLIC.stg_customers c ON t.customer_id = c.customer_id
    LEFT JOIN CRBFITNESS.PUBLIC.stg_products p ON t.product_id = p.product_id
    GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
),

new_customers AS (
    SELECT 
        customer_id,
        customer_name_clean,
        first_transaction_month,
        EXTRACT(YEAR FROM first_transaction_month) AS first_year
    FROM transaction_summary
),


churned_customers AS (
    SELECT 
        customer_id, 
        customer_name_clean,
        last_transaction_month
    FROM transaction_summary
    WHERE last_transaction_month < DATEADD(MONTH, -6, CURRENT_DATE) -- Using months instead of dates
),

cross_sell_customers AS (
    -- Customers who have purchased multiple product families
    SELECT 
        customer_id, 
        customer_name_clean,
        COUNT(DISTINCT product_family_clean) AS unique_product_families
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
    HAVING COUNT(DISTINCT product_family_clean) > 1
),

product_churn AS (
    -- Products that have seen a decline in purchases
    SELECT 
        product_family_clean,
        COUNT(DISTINCT customer_id) AS customer_count,
        LAG(customer_count) OVER (PARTITION BY product_family_clean ORDER BY last_transaction_date) AS prev_customer_count,
        customer_count - LAG(customer_count) OVER (PARTITION BY product_family_clean ORDER BY last_transaction_date) AS customer_loss
    FROM transaction_summary
),

revenue_metrics AS (
    SELECT 
        SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS current_revenue,
        SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS previous_revenue,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END)) AS NRR,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END)) AS GRR
    FROM transaction_summary
),

lost_revenue AS (
    -- Revenue lost due to customer churn
    SELECT 
        SUM(total_revenue) AS lost_revenue
    FROM transaction_summary
    WHERE customer_id IN (SELECT customer_id FROM churned_customers)
),

ranked_products AS (
    -- Rank products based on total revenue
    SELECT 
        product_family_clean,
        SUM(total_revenue) AS product_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY product_family_clean
),

ranked_customers AS (
    -- Rank customers based on total revenue
    SELECT 
        customer_id,
        customer_name_clean,
        SUM(total_revenue) AS customer_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
)

-- Final Result
SELECT * FROM new_customers
UNION ALL
SELECT * FROM churned_customers
UNION ALL
SELECT * FROM cross_sell_customers
UNION ALL
SELECT * FROM product_churn
UNION ALL
SELECT * FROM revenue_metrics
UNION ALL
SELECT * FROM lost_revenue
UNION ALL
SELECT * FROM ranked_products
UNION ALL
SELECT * FROM ranked_customers
  );
[0m21:06:56.091018 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0148-0004-bb9d-0000-0005db4bdb0d
[0m21:06:56.091018 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 23
invalid identifier 'T.PAYMENT_MONTH'
[0m21:06:56.091018 [debug] [Thread-1 (]: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  000904 (42000): SQL compilation error: error line 10 at position 23
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m21:06:56.091018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f353029-4005-4463-bf3f-a5b04095cf37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E202FBA850>]}
[0m21:06:56.091018 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model PUBLIC.customer_revenue_bridge ............ [[31mERROR[0m in 0.63s]
[0m21:06:56.106645 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m21:06:56.106645 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.customer_revenue_bridge' to be skipped because of status 'error'.  Reason: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  000904 (42000): SQL compilation error: error line 10 at position 23
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql.
[0m21:06:56.106645 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:06:56.106645 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m21:06:56.106645 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m21:06:56.822755 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m21:06:56.822755 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m21:06:57.488006 [debug] [MainThread]: Connection 'model.crb_kpi.customer_revenue_bridge' was left open.
[0m21:06:57.488006 [debug] [MainThread]: On model.crb_kpi.customer_revenue_bridge: Close
[0m21:06:58.459843 [info ] [MainThread]: 
[0m21:06:58.459843 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 11.24 seconds (11.24s).
[0m21:06:58.459843 [debug] [MainThread]: Command end result
[0m21:06:58.525452 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m21:06:58.532771 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m21:06:58.548206 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m21:06:58.549319 [info ] [MainThread]: 
[0m21:06:58.550871 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:06:58.550871 [info ] [MainThread]: 
[0m21:06:58.550871 [error] [MainThread]:   Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  000904 (42000): SQL compilation error: error line 10 at position 23
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m21:06:58.550871 [info ] [MainThread]: 
[0m21:06:58.550871 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m21:06:58.564035 [debug] [MainThread]: Command `dbt run` failed at 21:06:58.550871 after 13.53 seconds
[0m21:06:58.566038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E200FC8290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E200DAF010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E27BA62BD0>]}
[0m21:06:58.568937 [debug] [MainThread]: Flushing usage events
[0m21:06:59.869632 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:09:36.087223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AC38CA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AC3E22D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AC38D990>]}


============================== 21:09:36.087223 | ca4c2e34-f34a-460a-90bc-09579cb07d26 ==============================
[0m21:09:36.087223 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:09:36.087223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:09:36.683561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca4c2e34-f34a-460a-90bc-09579cb07d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AD230E50>]}
[0m21:09:36.761639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca4c2e34-f34a-460a-90bc-09579cb07d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8ACF5D810>]}
[0m21:09:36.761639 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m21:09:37.367938 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m21:09:37.621340 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:09:37.621340 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:09:37.621340 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m21:09:37.684911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca4c2e34-f34a-460a-90bc-09579cb07d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AD763C10>]}
[0m21:09:37.782873 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m21:09:37.788887 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m21:09:37.820278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca4c2e34-f34a-460a-90bc-09579cb07d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8ADAA5750>]}
[0m21:09:37.820278 [info ] [MainThread]: Found 3 seeds, 4 models, 474 macros
[0m21:09:37.820278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca4c2e34-f34a-460a-90bc-09579cb07d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AD2DE250>]}
[0m21:09:37.820278 [info ] [MainThread]: 
[0m21:09:37.820278 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:09:37.834211 [info ] [MainThread]: 
[0m21:09:37.834211 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:09:37.842740 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m21:09:38.008285 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m21:09:38.008285 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m21:09:38.008285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:09:40.274302 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.263 seconds
[0m21:09:40.288744 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m21:09:40.305914 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m21:09:40.305914 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m21:09:40.305914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:09:42.235311 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.933 seconds
[0m21:09:42.235311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca4c2e34-f34a-460a-90bc-09579cb07d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A849D190>]}
[0m21:09:42.255936 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m21:09:42.255936 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m21:09:42.255936 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.stg_customers'
[0m21:09:42.255936 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m21:09:42.279023 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m21:09:42.279023 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m21:09:42.331980 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m21:09:42.331980 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m21:09:42.331980 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean,
   
FROM raw
  );
[0m21:09:42.331980 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:09:44.934200 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.602 seconds
[0m21:09:44.965391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca4c2e34-f34a-460a-90bc-09579cb07d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AD6D6E50>]}
[0m21:09:44.981018 [info ] [Thread-1 (]: 1 of 4 OK created sql view model PUBLIC.stg_customers .......................... [[32mSUCCESS 1[0m in 2.71s]
[0m21:09:44.981018 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m21:09:44.981018 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m21:09:44.981018 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m21:09:44.981018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m21:09:44.989247 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m21:09:44.993163 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m21:09:44.993163 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m21:09:44.993163 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m21:09:45.005199 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m21:09:45.005199 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.products
)
SELECT 
    product_id,
    
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m21:09:45.590673 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.588 seconds
[0m21:09:45.590673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca4c2e34-f34a-460a-90bc-09579cb07d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AE0A9E90>]}
[0m21:09:45.590673 [info ] [Thread-1 (]: 2 of 4 OK created sql view model PUBLIC.stg_products ........................... [[32mSUCCESS 1[0m in 0.61s]
[0m21:09:45.606326 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m21:09:45.606326 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m21:09:45.609913 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m21:09:45.611660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m21:09:45.611660 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m21:09:45.620253 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m21:09:45.624020 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m21:09:45.630154 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m21:09:45.630154 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m21:09:45.630154 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.transactions
)
SELECT 
    
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    
FROM raw
  );
[0m21:09:46.407314 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.774 seconds
[0m21:09:46.407314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca4c2e34-f34a-460a-90bc-09579cb07d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8ADB29F50>]}
[0m21:09:46.407314 [info ] [Thread-1 (]: 3 of 4 OK created sql view model PUBLIC.stg_transactions ....................... [[32mSUCCESS 1[0m in 0.80s]
[0m21:09:46.407314 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m21:09:46.407314 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m21:09:46.407314 [info ] [Thread-1 (]: 4 of 4 START sql view model PUBLIC.customer_revenue_bridge ..................... [RUN]
[0m21:09:46.407314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_transactions, now model.crb_kpi.customer_revenue_bridge)
[0m21:09:46.421683 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.customer_revenue_bridge
[0m21:09:46.433174 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.customer_revenue_bridge"
[0m21:09:46.433174 [debug] [Thread-1 (]: Began executing node model.crb_kpi.customer_revenue_bridge
[0m21:09:46.441762 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.customer_revenue_bridge"
[0m21:09:46.442781 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.customer_revenue_bridge"
[0m21:09:46.453429 [debug] [Thread-1 (]: On model.crb_kpi.customer_revenue_bridge: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.customer_revenue_bridge"} */
create or replace   view CRBFITNESS.PUBLIC.customer_revenue_bridge
  
   as (
    WITH transaction_summary AS (
    SELECT 
        t.customer_id,
        c.customer_name_clean,
        p.product_family_clean,
        SUM(t.revenue) AS total_revenue,
        COUNT(DISTINCT t.payment_month) AS active_months, -- Use payment_month instead of payment_date
        MIN(t.payment_month) AS first_transaction_month,  -- First transaction month
        MAX(t.payment_month) AS last_transaction_month  -- Last transaction month
    FROM CRBFITNESS.PUBLIC.stg_transactions t
    LEFT JOIN CRBFITNESS.PUBLIC.stg_customers c ON t.customer_id = c.customer_id
    LEFT JOIN CRBFITNESS.PUBLIC.stg_products p ON t.product_id = p.product_id
    GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
),

new_customers AS (
    SELECT 
        customer_id,
        customer_name_clean,
        first_transaction_month,
        EXTRACT(YEAR FROM first_transaction_month) AS first_year
    FROM transaction_summary
),


churned_customers AS (
    SELECT 
        customer_id, 
        customer_name_clean,
        last_transaction_month
    FROM transaction_summary
    WHERE last_transaction_month < DATEADD(MONTH, -6, CURRENT_DATE) -- Using months instead of dates
),

cross_sell_customers AS (
    -- Customers who have purchased multiple product families
    SELECT 
        customer_id, 
        customer_name_clean,
        COUNT(DISTINCT product_family_clean) AS unique_product_families
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
    HAVING COUNT(DISTINCT product_family_clean) > 1
),

product_churn AS (
    -- Products that have seen a decline in purchases
    SELECT 
        product_family_clean,
        COUNT(DISTINCT customer_id) AS customer_count,
        LAG(customer_count) OVER (PARTITION BY product_family_clean ORDER BY last_transaction_date) AS prev_customer_count,
        customer_count - LAG(customer_count) OVER (PARTITION BY product_family_clean ORDER BY last_transaction_date) AS customer_loss
    FROM transaction_summary
),

revenue_metrics AS (
    SELECT 
        SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS current_revenue,
        SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS previous_revenue,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END)) AS NRR,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END)) AS GRR
    FROM transaction_summary
),

lost_revenue AS (
    -- Revenue lost due to customer churn
    SELECT 
        SUM(total_revenue) AS lost_revenue
    FROM transaction_summary
    WHERE customer_id IN (SELECT customer_id FROM churned_customers)
),

ranked_products AS (
    -- Rank products based on total revenue
    SELECT 
        product_family_clean,
        SUM(total_revenue) AS product_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY product_family_clean
),

ranked_customers AS (
    -- Rank customers based on total revenue
    SELECT 
        customer_id,
        customer_name_clean,
        SUM(total_revenue) AS customer_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
)

-- Final Result
SELECT * FROM new_customers
UNION ALL
SELECT * FROM churned_customers
UNION ALL
SELECT * FROM cross_sell_customers
UNION ALL
SELECT * FROM product_churn
UNION ALL
SELECT * FROM revenue_metrics
UNION ALL
SELECT * FROM lost_revenue
UNION ALL
SELECT * FROM ranked_products
UNION ALL
SELECT * FROM ranked_customers
  );
[0m21:09:46.999826 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb014b-0004-bb9d-0000-0005db4bdb15
[0m21:09:47.003016 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 23
invalid identifier 'T.PAYMENT_MONTH'
[0m21:09:47.005998 [debug] [Thread-1 (]: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  000904 (42000): SQL compilation error: error line 10 at position 23
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m21:09:47.005998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca4c2e34-f34a-460a-90bc-09579cb07d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AE086C10>]}
[0m21:09:47.005998 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model PUBLIC.customer_revenue_bridge ............ [[31mERROR[0m in 0.60s]
[0m21:09:47.018016 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m21:09:47.020607 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.customer_revenue_bridge' to be skipped because of status 'error'.  Reason: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  000904 (42000): SQL compilation error: error line 10 at position 23
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql.
[0m21:09:47.022057 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:09:47.022057 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m21:09:47.022057 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m21:09:47.708126 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m21:09:47.708126 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m21:09:48.341695 [debug] [MainThread]: Connection 'model.crb_kpi.customer_revenue_bridge' was left open.
[0m21:09:48.341695 [debug] [MainThread]: On model.crb_kpi.customer_revenue_bridge: Close
[0m21:09:48.964192 [info ] [MainThread]: 
[0m21:09:48.964192 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 11.13 seconds (11.13s).
[0m21:09:48.979695 [debug] [MainThread]: Command end result
[0m21:09:49.028012 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m21:09:49.031234 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m21:09:49.043499 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m21:09:49.043499 [info ] [MainThread]: 
[0m21:09:49.043499 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:09:49.043499 [info ] [MainThread]: 
[0m21:09:49.043499 [error] [MainThread]:   Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  000904 (42000): SQL compilation error: error line 10 at position 23
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m21:09:49.043499 [info ] [MainThread]: 
[0m21:09:49.043499 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m21:09:49.043499 [debug] [MainThread]: Command `dbt run` failed at 21:09:49.043499 after 13.09 seconds
[0m21:09:49.043499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A7212C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AC3E22D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AC3E0FD0>]}
[0m21:09:49.043499 [debug] [MainThread]: Flushing usage events
[0m21:09:50.450489 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:10:40.880177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B482F8C350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B482DAE850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B482F8DB50>]}


============================== 21:10:40.880177 | 49f2a101-8b25-46d1-ba97-1c4491586948 ==============================
[0m21:10:40.880177 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:10:40.880177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:10:41.504395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49f2a101-8b25-46d1-ba97-1c4491586948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B483E457D0>]}
[0m21:10:41.598755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49f2a101-8b25-46d1-ba97-1c4491586948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B483B5D990>]}
[0m21:10:41.598755 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m21:10:42.212783 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m21:10:42.434064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:10:42.434064 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_transactions.sql
[0m21:10:42.792513 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m21:10:42.801167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49f2a101-8b25-46d1-ba97-1c4491586948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B483EA27D0>]}
[0m21:10:42.896709 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m21:10:42.907469 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m21:10:42.928578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49f2a101-8b25-46d1-ba97-1c4491586948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B48484EC50>]}
[0m21:10:42.941530 [info ] [MainThread]: Found 3 seeds, 4 models, 474 macros
[0m21:10:42.943345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49f2a101-8b25-46d1-ba97-1c4491586948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B48429D4D0>]}
[0m21:10:42.946844 [info ] [MainThread]: 
[0m21:10:42.950219 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:10:42.953808 [info ] [MainThread]: 
[0m21:10:42.953808 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:10:42.963144 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m21:10:43.210960 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m21:10:43.212906 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m21:10:43.212906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:10:45.434120 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.222 seconds
[0m21:10:45.434120 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m21:10:45.459361 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m21:10:45.459361 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m21:10:45.459361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:10:47.451002 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.001 seconds
[0m21:10:47.467342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49f2a101-8b25-46d1-ba97-1c4491586948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B483EDCB10>]}
[0m21:10:47.475437 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m21:10:47.475437 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m21:10:47.475437 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.stg_customers'
[0m21:10:47.475437 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m21:10:47.491356 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m21:10:47.491356 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m21:10:47.554222 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m21:10:47.554222 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m21:10:47.554222 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean,
   
FROM raw
  );
[0m21:10:47.554222 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:10:49.537019 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.977 seconds
[0m21:10:49.568272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49f2a101-8b25-46d1-ba97-1c4491586948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B483E98990>]}
[0m21:10:49.568272 [info ] [Thread-1 (]: 1 of 4 OK created sql view model PUBLIC.stg_customers .......................... [[32mSUCCESS 1[0m in 2.09s]
[0m21:10:49.583893 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m21:10:49.583893 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m21:10:49.583893 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m21:10:49.583893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m21:10:49.583893 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m21:10:49.583893 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m21:10:49.583893 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m21:10:49.603099 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m21:10:49.606401 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m21:10:49.606401 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.products
)
SELECT 
    product_id,
    
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m21:10:50.170470 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.564 seconds
[0m21:10:50.170470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49f2a101-8b25-46d1-ba97-1c4491586948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B48484FAD0>]}
[0m21:10:50.178469 [info ] [Thread-1 (]: 2 of 4 OK created sql view model PUBLIC.stg_products ........................... [[32mSUCCESS 1[0m in 0.59s]
[0m21:10:50.178469 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m21:10:50.178469 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m21:10:50.178469 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m21:10:50.178469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m21:10:50.178469 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m21:10:50.194151 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m21:10:50.197575 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m21:10:50.201371 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m21:10:50.201371 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m21:10:50.208036 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.transactions
)
SELECT 
    
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    payment_month
FROM raw
  );
[0m21:10:50.785087 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.575 seconds
[0m21:10:50.785087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49f2a101-8b25-46d1-ba97-1c4491586948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B484FA4050>]}
[0m21:10:50.785087 [info ] [Thread-1 (]: 3 of 4 OK created sql view model PUBLIC.stg_transactions ....................... [[32mSUCCESS 1[0m in 0.61s]
[0m21:10:50.785087 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m21:10:50.785087 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m21:10:50.785087 [info ] [Thread-1 (]: 4 of 4 START sql view model PUBLIC.customer_revenue_bridge ..................... [RUN]
[0m21:10:50.785087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_transactions, now model.crb_kpi.customer_revenue_bridge)
[0m21:10:50.799477 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.customer_revenue_bridge
[0m21:10:50.803248 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.customer_revenue_bridge"
[0m21:10:50.803248 [debug] [Thread-1 (]: Began executing node model.crb_kpi.customer_revenue_bridge
[0m21:10:50.815568 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.customer_revenue_bridge"
[0m21:10:50.829594 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.customer_revenue_bridge"
[0m21:10:50.829594 [debug] [Thread-1 (]: On model.crb_kpi.customer_revenue_bridge: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.customer_revenue_bridge"} */
create or replace   view CRBFITNESS.PUBLIC.customer_revenue_bridge
  
   as (
    WITH transaction_summary AS (
    SELECT 
        t.customer_id,
        c.customer_name_clean,
        p.product_family_clean,
        SUM(t.revenue) AS total_revenue,
        COUNT(DISTINCT t.payment_month) AS active_months, -- Use payment_month instead of payment_date
        MIN(t.payment_month) AS first_transaction_month,  -- First transaction month
        MAX(t.payment_month) AS last_transaction_month  -- Last transaction month
    FROM CRBFITNESS.PUBLIC.stg_transactions t
    LEFT JOIN CRBFITNESS.PUBLIC.stg_customers c ON t.customer_id = c.customer_id
    LEFT JOIN CRBFITNESS.PUBLIC.stg_products p ON t.product_id = p.product_id
    GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
),

new_customers AS (
    SELECT 
        customer_id,
        customer_name_clean,
        first_transaction_month,
        EXTRACT(YEAR FROM first_transaction_month) AS first_year
    FROM transaction_summary
),


churned_customers AS (
    SELECT 
        customer_id, 
        customer_name_clean,
        last_transaction_month
    FROM transaction_summary
    WHERE last_transaction_month < DATEADD(MONTH, -6, CURRENT_DATE) -- Using months instead of dates
),

cross_sell_customers AS (
    -- Customers who have purchased multiple product families
    SELECT 
        customer_id, 
        customer_name_clean,
        COUNT(DISTINCT product_family_clean) AS unique_product_families
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
    HAVING COUNT(DISTINCT product_family_clean) > 1
),

product_churn AS (
    -- Products that have seen a decline in purchases
    SELECT 
        product_family_clean,
        COUNT(DISTINCT customer_id) AS customer_count,
        LAG(customer_count) OVER (PARTITION BY product_family_clean ORDER BY last_transaction_date) AS prev_customer_count,
        customer_count - LAG(customer_count) OVER (PARTITION BY product_family_clean ORDER BY last_transaction_date) AS customer_loss
    FROM transaction_summary
),

revenue_metrics AS (
    SELECT 
        SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS current_revenue,
        SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS previous_revenue,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END)) AS NRR,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END)) AS GRR
    FROM transaction_summary
),

lost_revenue AS (
    -- Revenue lost due to customer churn
    SELECT 
        SUM(total_revenue) AS lost_revenue
    FROM transaction_summary
    WHERE customer_id IN (SELECT customer_id FROM churned_customers)
),

ranked_products AS (
    -- Rank products based on total revenue
    SELECT 
        product_family_clean,
        SUM(total_revenue) AS product_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY product_family_clean
),

ranked_customers AS (
    -- Rank customers based on total revenue
    SELECT 
        customer_id,
        customer_name_clean,
        SUM(total_revenue) AS customer_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
)

-- Final Result
SELECT * FROM new_customers
UNION ALL
SELECT * FROM churned_customers
UNION ALL
SELECT * FROM cross_sell_customers
UNION ALL
SELECT * FROM product_churn
UNION ALL
SELECT * FROM revenue_metrics
UNION ALL
SELECT * FROM lost_revenue
UNION ALL
SELECT * FROM ranked_products
UNION ALL
SELECT * FROM ranked_customers
  );
[0m21:10:51.396583 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb014c-0004-bb9f-0000-0005db4bbef1
[0m21:10:51.396583 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002016 (22000): SQL compilation error:
Function EXTRACT does not support VARCHAR(16777216) argument type
[0m21:10:51.404097 [debug] [Thread-1 (]: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  002016 (22000): SQL compilation error:
  Function EXTRACT does not support VARCHAR(16777216) argument type
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m21:10:51.404097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49f2a101-8b25-46d1-ba97-1c4491586948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4852F8050>]}
[0m21:10:51.404097 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model PUBLIC.customer_revenue_bridge ............ [[31mERROR[0m in 0.62s]
[0m21:10:51.404097 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m21:10:51.404097 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.customer_revenue_bridge' to be skipped because of status 'error'.  Reason: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  002016 (22000): SQL compilation error:
  Function EXTRACT does not support VARCHAR(16777216) argument type
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql.
[0m21:10:51.404097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:10:51.404097 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m21:10:51.404097 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m21:10:52.417669 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m21:10:52.417669 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m21:10:53.206024 [debug] [MainThread]: Connection 'model.crb_kpi.customer_revenue_bridge' was left open.
[0m21:10:53.206024 [debug] [MainThread]: On model.crb_kpi.customer_revenue_bridge: Close
[0m21:10:53.958323 [info ] [MainThread]: 
[0m21:10:53.958323 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 11.00 seconds (11.00s).
[0m21:10:53.958323 [debug] [MainThread]: Command end result
[0m21:10:54.014003 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m21:10:54.022023 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m21:10:54.030384 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m21:10:54.030384 [info ] [MainThread]: 
[0m21:10:54.035290 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:10:54.036769 [info ] [MainThread]: 
[0m21:10:54.036769 [error] [MainThread]:   Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  002016 (22000): SQL compilation error:
  Function EXTRACT does not support VARCHAR(16777216) argument type
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m21:10:54.041173 [info ] [MainThread]: 
[0m21:10:54.041173 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m21:10:54.041173 [debug] [MainThread]: Command `dbt run` failed at 21:10:54.041173 after 13.27 seconds
[0m21:10:54.045399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B47DE12C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B482FE2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B482C534D0>]}
[0m21:10:54.048640 [debug] [MainThread]: Flushing usage events
[0m21:10:55.276956 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:12:45.294534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F6D8C5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F6DE2210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F6DE26D0>]}


============================== 21:12:45.294534 | cf1d9295-0579-41b7-ba09-82ff8acff278 ==============================
[0m21:12:45.294534 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:12:45.310080 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:12:45.925264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf1d9295-0579-41b7-ba09-82ff8acff278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F578D010>]}
[0m21:12:45.999115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf1d9295-0579-41b7-ba09-82ff8acff278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F795D790>]}
[0m21:12:45.999115 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m21:12:46.642501 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m21:12:46.879123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:12:46.879123 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_transactions.sql
[0m21:12:47.220575 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m21:12:47.226015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf1d9295-0579-41b7-ba09-82ff8acff278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F7CE3F10>]}
[0m21:12:47.307760 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m21:12:47.323725 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m21:12:47.359419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf1d9295-0579-41b7-ba09-82ff8acff278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F8588810>]}
[0m21:12:47.360169 [info ] [MainThread]: Found 3 seeds, 4 models, 474 macros
[0m21:12:47.362679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf1d9295-0579-41b7-ba09-82ff8acff278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F8506FD0>]}
[0m21:12:47.367277 [info ] [MainThread]: 
[0m21:12:47.370674 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:12:47.373733 [info ] [MainThread]: 
[0m21:12:47.374901 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:12:47.384619 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m21:12:47.628302 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m21:12:47.628302 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m21:12:47.628302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:49.855019 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.221 seconds
[0m21:12:49.855764 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m21:12:49.871728 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m21:12:49.871728 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m21:12:49.871728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:52.059984 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.179 seconds
[0m21:12:52.068013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf1d9295-0579-41b7-ba09-82ff8acff278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F79EB050>]}
[0m21:12:52.074290 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m21:12:52.074290 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m21:12:52.081365 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.stg_customers'
[0m21:12:52.083892 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m21:12:52.100094 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m21:12:52.103178 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m21:12:52.156319 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m21:12:52.156319 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m21:12:52.156319 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean,
   
FROM raw
  );
[0m21:12:52.161201 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:12:55.297395 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.141 seconds
[0m21:12:55.351032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf1d9295-0579-41b7-ba09-82ff8acff278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F8107AD0>]}
[0m21:12:55.351032 [info ] [Thread-1 (]: 1 of 4 OK created sql view model PUBLIC.stg_customers .......................... [[32mSUCCESS 1[0m in 3.27s]
[0m21:12:55.351032 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m21:12:55.360049 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m21:12:55.360049 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m21:12:55.360049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m21:12:55.364749 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m21:12:55.368628 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m21:12:55.368628 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m21:12:55.376654 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m21:12:55.378196 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m21:12:55.381749 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.products
)
SELECT 
    product_id,
    
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m21:12:55.910907 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.534 seconds
[0m21:12:55.922903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf1d9295-0579-41b7-ba09-82ff8acff278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F8CBACD0>]}
[0m21:12:55.922903 [info ] [Thread-1 (]: 2 of 4 OK created sql view model PUBLIC.stg_products ........................... [[32mSUCCESS 1[0m in 0.56s]
[0m21:12:55.922903 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m21:12:55.922903 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m21:12:55.932622 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m21:12:55.935645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m21:12:55.935645 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m21:12:55.944328 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m21:12:55.944328 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m21:12:55.952010 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m21:12:55.960578 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m21:12:55.963590 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m21:12:56.942497 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.978 seconds
[0m21:12:56.947171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf1d9295-0579-41b7-ba09-82ff8acff278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F814AC50>]}
[0m21:12:56.947171 [info ] [Thread-1 (]: 3 of 4 OK created sql view model PUBLIC.stg_transactions ....................... [[32mSUCCESS 1[0m in 1.01s]
[0m21:12:56.947171 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m21:12:56.954733 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m21:12:56.954733 [info ] [Thread-1 (]: 4 of 4 START sql view model PUBLIC.customer_revenue_bridge ..................... [RUN]
[0m21:12:56.954733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_transactions, now model.crb_kpi.customer_revenue_bridge)
[0m21:12:56.959913 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.customer_revenue_bridge
[0m21:12:56.962931 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.customer_revenue_bridge"
[0m21:12:56.970184 [debug] [Thread-1 (]: Began executing node model.crb_kpi.customer_revenue_bridge
[0m21:12:56.972444 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.customer_revenue_bridge"
[0m21:12:56.988197 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.customer_revenue_bridge"
[0m21:12:56.988197 [debug] [Thread-1 (]: On model.crb_kpi.customer_revenue_bridge: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.customer_revenue_bridge"} */
create or replace   view CRBFITNESS.PUBLIC.customer_revenue_bridge
  
   as (
    WITH transaction_summary AS (
    SELECT 
        t.customer_id,
        c.customer_name_clean,
        p.product_family_clean,
        SUM(t.revenue) AS total_revenue,
        COUNT(DISTINCT t.payment_month) AS active_months, -- Use payment_month instead of payment_date
        MIN(t.payment_month) AS first_transaction_month,  -- First transaction month
        MAX(t.payment_month) AS last_transaction_month  -- Last transaction month
    FROM CRBFITNESS.PUBLIC.stg_transactions t
    LEFT JOIN CRBFITNESS.PUBLIC.stg_customers c ON t.customer_id = c.customer_id
    LEFT JOIN CRBFITNESS.PUBLIC.stg_products p ON t.product_id = p.product_id
    GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
),

new_customers AS (
    SELECT 
        customer_id,
        customer_name_clean,
        first_transaction_month,
        EXTRACT(YEAR FROM first_transaction_month) AS first_year
    FROM transaction_summary
),


churned_customers AS (
    SELECT 
        customer_id, 
        customer_name_clean,
        last_transaction_month
    FROM transaction_summary
    WHERE last_transaction_month < DATEADD(MONTH, -6, CURRENT_DATE) -- Using months instead of dates
),

cross_sell_customers AS (
    -- Customers who have purchased multiple product families
    SELECT 
        customer_id, 
        customer_name_clean,
        COUNT(DISTINCT product_family_clean) AS unique_product_families
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
    HAVING COUNT(DISTINCT product_family_clean) > 1
),

product_churn AS (
    -- Products that have seen a decline in purchases
    SELECT 
        product_family_clean,
        COUNT(DISTINCT customer_id) AS customer_count,
        LAG(customer_count) OVER (PARTITION BY product_family_clean ORDER BY last_transaction_date) AS prev_customer_count,
        customer_count - LAG(customer_count) OVER (PARTITION BY product_family_clean ORDER BY last_transaction_date) AS customer_loss
    FROM transaction_summary
),

revenue_metrics AS (
    SELECT 
        SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS current_revenue,
        SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS previous_revenue,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END)) AS NRR,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END)) AS GRR
    FROM transaction_summary
),

lost_revenue AS (
    -- Revenue lost due to customer churn
    SELECT 
        SUM(total_revenue) AS lost_revenue
    FROM transaction_summary
    WHERE customer_id IN (SELECT customer_id FROM churned_customers)
),

ranked_products AS (
    -- Rank products based on total revenue
    SELECT 
        product_family_clean,
        SUM(total_revenue) AS product_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY product_family_clean
),

ranked_customers AS (
    -- Rank customers based on total revenue
    SELECT 
        customer_id,
        customer_name_clean,
        SUM(total_revenue) AS customer_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
)

-- Final Result
SELECT * FROM new_customers
UNION ALL
SELECT * FROM churned_customers
UNION ALL
SELECT * FROM cross_sell_customers
UNION ALL
SELECT * FROM product_churn
UNION ALL
SELECT * FROM revenue_metrics
UNION ALL
SELECT * FROM lost_revenue
UNION ALL
SELECT * FROM ranked_products
UNION ALL
SELECT * FROM ranked_customers
  );
[0m21:12:57.577288 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb014e-0004-bb9f-0000-0005db4bbef9
[0m21:12:57.578819 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 54 at position 77
invalid identifier 'LAST_TRANSACTION_DATE'
[0m21:12:57.588297 [debug] [Thread-1 (]: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  000904 (42000): SQL compilation error: error line 54 at position 77
  invalid identifier 'LAST_TRANSACTION_DATE'
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m21:12:57.588297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf1d9295-0579-41b7-ba09-82ff8acff278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F8DEF890>]}
[0m21:12:57.588297 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model PUBLIC.customer_revenue_bridge ............ [[31mERROR[0m in 0.63s]
[0m21:12:57.588297 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m21:12:57.588297 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.customer_revenue_bridge' to be skipped because of status 'error'.  Reason: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  000904 (42000): SQL compilation error: error line 54 at position 77
  invalid identifier 'LAST_TRANSACTION_DATE'
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql.
[0m21:12:57.588297 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:12:57.588297 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m21:12:57.588297 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m21:12:58.405234 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m21:12:58.405234 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m21:12:59.103387 [debug] [MainThread]: Connection 'model.crb_kpi.customer_revenue_bridge' was left open.
[0m21:12:59.103387 [debug] [MainThread]: On model.crb_kpi.customer_revenue_bridge: Close
[0m21:12:59.832387 [info ] [MainThread]: 
[0m21:12:59.834988 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 12.46 seconds (12.46s).
[0m21:12:59.837467 [debug] [MainThread]: Command end result
[0m21:12:59.868670 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m21:12:59.876692 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m21:12:59.884682 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m21:12:59.885689 [info ] [MainThread]: 
[0m21:12:59.885689 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:12:59.885689 [info ] [MainThread]: 
[0m21:12:59.885689 [error] [MainThread]:   Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  000904 (42000): SQL compilation error: error line 54 at position 77
  invalid identifier 'LAST_TRANSACTION_DATE'
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m21:12:59.885689 [info ] [MainThread]: 
[0m21:12:59.885689 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m21:12:59.892902 [debug] [MainThread]: Command `dbt run` failed at 21:12:59.892902 after 14.70 seconds
[0m21:12:59.892902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F1862C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F6DEE7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F6C78150>]}
[0m21:12:59.892902 [debug] [MainThread]: Flushing usage events
[0m21:13:01.355111 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:14:09.976467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B00118C690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B00118DB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B00118C310>]}


============================== 21:14:09.984493 | d1cd1d90-3df7-4773-a53f-b36b4156a3ea ==============================
[0m21:14:09.984493 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:14:09.989119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:14:10.585546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1cd1d90-3df7-4773-a53f-b36b4156a3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0011B1D10>]}
[0m21:14:10.664484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1cd1d90-3df7-4773-a53f-b36b4156a3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0020E46D0>]}
[0m21:14:10.664484 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m21:14:11.277879 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m21:14:11.528477 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:14:11.528477 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\customer_revenue_bridge.sql
[0m21:14:11.855134 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m21:14:11.862312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1cd1d90-3df7-4773-a53f-b36b4156a3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B00209DB50>]}
[0m21:14:11.958584 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m21:14:11.958584 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m21:14:11.995894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1cd1d90-3df7-4773-a53f-b36b4156a3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0029A0510>]}
[0m21:14:11.997080 [info ] [MainThread]: Found 3 seeds, 4 models, 474 macros
[0m21:14:11.997080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1cd1d90-3df7-4773-a53f-b36b4156a3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B002090C90>]}
[0m21:14:11.997080 [info ] [MainThread]: 
[0m21:14:11.997080 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:14:12.005951 [info ] [MainThread]: 
[0m21:14:12.007581 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:14:12.011245 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m21:14:12.257146 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m21:14:12.257146 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m21:14:12.257146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:14.302481 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.043 seconds
[0m21:14:14.302481 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m21:14:14.334817 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m21:14:14.334817 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m21:14:14.334817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:16.214342 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.891 seconds
[0m21:14:16.229933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1cd1d90-3df7-4773-a53f-b36b4156a3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0024B9F50>]}
[0m21:14:16.243552 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m21:14:16.246068 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m21:14:16.246068 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.stg_customers'
[0m21:14:16.246068 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m21:14:16.265836 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m21:14:16.265836 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m21:14:16.313908 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m21:14:16.313908 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m21:14:16.313908 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean,
   
FROM raw
  );
[0m21:14:16.323439 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:14:18.646627 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.333 seconds
[0m21:14:18.693452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1cd1d90-3df7-4773-a53f-b36b4156a3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B00246C290>]}
[0m21:14:18.693452 [info ] [Thread-1 (]: 1 of 4 OK created sql view model PUBLIC.stg_customers .......................... [[32mSUCCESS 1[0m in 2.45s]
[0m21:14:18.693452 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m21:14:18.693452 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m21:14:18.693452 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m21:14:18.693452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m21:14:18.693452 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m21:14:18.713642 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m21:14:18.714182 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m21:14:18.714182 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m21:14:18.714182 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m21:14:18.714182 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.products
)
SELECT 
    product_id,
    
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m21:14:19.368769 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.649 seconds
[0m21:14:19.368769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1cd1d90-3df7-4773-a53f-b36b4156a3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B003108D50>]}
[0m21:14:19.368769 [info ] [Thread-1 (]: 2 of 4 OK created sql view model PUBLIC.stg_products ........................... [[32mSUCCESS 1[0m in 0.68s]
[0m21:14:19.368769 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m21:14:19.383306 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m21:14:19.383306 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m21:14:19.383306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m21:14:19.383306 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m21:14:19.383306 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m21:14:19.383306 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m21:14:19.403193 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m21:14:19.406258 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m21:14:19.407275 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m21:14:20.088068 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.682 seconds
[0m21:14:20.088068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1cd1d90-3df7-4773-a53f-b36b4156a3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0029A3110>]}
[0m21:14:20.088068 [info ] [Thread-1 (]: 3 of 4 OK created sql view model PUBLIC.stg_transactions ....................... [[32mSUCCESS 1[0m in 0.70s]
[0m21:14:20.088068 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m21:14:20.088068 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m21:14:20.088068 [info ] [Thread-1 (]: 4 of 4 START sql view model PUBLIC.customer_revenue_bridge ..................... [RUN]
[0m21:14:20.103692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_transactions, now model.crb_kpi.customer_revenue_bridge)
[0m21:14:20.105776 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.customer_revenue_bridge
[0m21:14:20.111803 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.customer_revenue_bridge"
[0m21:14:20.111803 [debug] [Thread-1 (]: Began executing node model.crb_kpi.customer_revenue_bridge
[0m21:14:20.122191 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.customer_revenue_bridge"
[0m21:14:20.128165 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.customer_revenue_bridge"
[0m21:14:20.128165 [debug] [Thread-1 (]: On model.crb_kpi.customer_revenue_bridge: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.customer_revenue_bridge"} */
create or replace   view CRBFITNESS.PUBLIC.customer_revenue_bridge
  
   as (
    WITH transaction_summary AS (
    SELECT 
        t.customer_id,
        c.customer_name_clean,
        p.product_family_clean,
        SUM(t.revenue) AS total_revenue,
        COUNT(DISTINCT t.payment_month) AS active_months, -- Use payment_month instead of payment_date
        MIN(t.payment_month) AS first_transaction_month,  -- First transaction month
        MAX(t.payment_month) AS last_transaction_month  -- Last transaction month
    FROM CRBFITNESS.PUBLIC.stg_transactions t
    LEFT JOIN CRBFITNESS.PUBLIC.stg_customers c ON t.customer_id = c.customer_id
    LEFT JOIN CRBFITNESS.PUBLIC.stg_products p ON t.product_id = p.product_id
    GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
),

new_customers AS (
    SELECT 
        customer_id,
        customer_name_clean,
        first_transaction_month,
        EXTRACT(YEAR FROM first_transaction_month) AS first_year
    FROM transaction_summary
),


churned_customers AS (
    SELECT 
        customer_id, 
        customer_name_clean,
        last_transaction_month
    FROM transaction_summary
    WHERE last_transaction_month < DATEADD(MONTH, -6, CURRENT_DATE) -- Using months instead of dates
),

cross_sell_customers AS (
    -- Customers who have purchased multiple product families
    SELECT 
        customer_id, 
        customer_name_clean,
        COUNT(DISTINCT product_family_clean) AS unique_product_families
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
    HAVING COUNT(DISTINCT product_family_clean) > 1
),

product_churn AS (
    -- Products that have seen a decline in purchases
    SELECT 
        product_family_clean,
        COUNT(DISTINCT customer_id) AS customer_count,
        LAG(customer_count) OVER (PARTITION BY product_family_clean ORDER BY last_transaction_date) AS prev_customer_count,
        customer_count - LAG(customer_count) OVER (PARTITION BY product_family_clean ORDER BY last_transaction_month) AS customer_loss
    FROM transaction_summary
),

revenue_metrics AS (
    SELECT 
        SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS current_revenue,
        SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS previous_revenue,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END)) AS NRR,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END)) AS GRR
    FROM transaction_summary
),

lost_revenue AS (
    -- Revenue lost due to customer churn
    SELECT 
        SUM(total_revenue) AS lost_revenue
    FROM transaction_summary
    WHERE customer_id IN (SELECT customer_id FROM churned_customers)
),

ranked_products AS (
    -- Rank products based on total revenue
    SELECT 
        product_family_clean,
        SUM(total_revenue) AS product_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY product_family_clean
),

ranked_customers AS (
    -- Rank customers based on total revenue
    SELECT 
        customer_id,
        customer_name_clean,
        SUM(total_revenue) AS customer_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
)

-- Final Result
SELECT * FROM new_customers
UNION ALL
SELECT * FROM churned_customers
UNION ALL
SELECT * FROM cross_sell_customers
UNION ALL
SELECT * FROM product_churn
UNION ALL
SELECT * FROM revenue_metrics
UNION ALL
SELECT * FROM lost_revenue
UNION ALL
SELECT * FROM ranked_products
UNION ALL
SELECT * FROM ranked_customers
  );
[0m21:14:20.700929 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0150-0004-bde4-0000-0005db4bf215
[0m21:14:20.700929 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 54 at position 77
invalid identifier 'LAST_TRANSACTION_DATE'
[0m21:14:20.717407 [debug] [Thread-1 (]: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  000904 (42000): SQL compilation error: error line 54 at position 77
  invalid identifier 'LAST_TRANSACTION_DATE'
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m21:14:20.717407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1cd1d90-3df7-4773-a53f-b36b4156a3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0031EE850>]}
[0m21:14:20.717407 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model PUBLIC.customer_revenue_bridge ............ [[31mERROR[0m in 0.61s]
[0m21:14:20.717407 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m21:14:20.717407 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.customer_revenue_bridge' to be skipped because of status 'error'.  Reason: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  000904 (42000): SQL compilation error: error line 54 at position 77
  invalid identifier 'LAST_TRANSACTION_DATE'
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql.
[0m21:14:20.735277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:14:20.737135 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m21:14:20.738949 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m21:14:21.430041 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m21:14:21.430041 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m21:14:22.050093 [debug] [MainThread]: Connection 'model.crb_kpi.customer_revenue_bridge' was left open.
[0m21:14:22.050093 [debug] [MainThread]: On model.crb_kpi.customer_revenue_bridge: Close
[0m21:14:22.800938 [info ] [MainThread]: 
[0m21:14:22.800938 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 10.79 seconds (10.79s).
[0m21:14:22.816559 [debug] [MainThread]: Command end result
[0m21:14:22.842884 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m21:14:22.842884 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m21:14:22.863677 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m21:14:22.863677 [info ] [MainThread]: 
[0m21:14:22.863677 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:14:22.863677 [info ] [MainThread]: 
[0m21:14:22.869891 [error] [MainThread]:   Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  000904 (42000): SQL compilation error: error line 54 at position 77
  invalid identifier 'LAST_TRANSACTION_DATE'
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m21:14:22.869891 [info ] [MainThread]: 
[0m21:14:22.873288 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m21:14:22.877606 [debug] [MainThread]: Command `dbt run` failed at 21:14:22.877606 after 13.02 seconds
[0m21:14:22.877606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0011B1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B00104CF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B07BC62D50>]}
[0m21:14:22.877606 [debug] [MainThread]: Flushing usage events
[0m21:14:24.479964 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:15:29.629549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019519C8FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019519C8DB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019519C8C3D0>]}


============================== 21:15:29.629549 | 9572e128-3fe2-4d53-9f04-741b1ef22973 ==============================
[0m21:15:29.629549 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:15:29.629549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:15:30.248518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9572e128-3fe2-4d53-9f04-741b1ef22973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001951A946B50>]}
[0m21:15:30.327640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9572e128-3fe2-4d53-9f04-741b1ef22973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001951A85D950>]}
[0m21:15:30.327640 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m21:15:30.948311 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m21:15:31.198311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:15:31.198311 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\customer_revenue_bridge.sql
[0m21:15:31.535054 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m21:15:31.535054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9572e128-3fe2-4d53-9f04-741b1ef22973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001951B199B50>]}
[0m21:15:31.632501 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m21:15:31.648131 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m21:15:31.679373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9572e128-3fe2-4d53-9f04-741b1ef22973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001951B373E10>]}
[0m21:15:31.679373 [info ] [MainThread]: Found 3 seeds, 4 models, 474 macros
[0m21:15:31.679373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9572e128-3fe2-4d53-9f04-741b1ef22973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001951B28B3D0>]}
[0m21:15:31.679373 [info ] [MainThread]: 
[0m21:15:31.693354 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:15:31.693354 [info ] [MainThread]: 
[0m21:15:31.693354 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:15:31.701379 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m21:15:31.941365 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m21:15:31.943575 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m21:15:31.943575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:34.297727 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.364 seconds
[0m21:15:34.315939 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m21:15:34.327957 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m21:15:34.327957 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m21:15:34.327957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:36.286968 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.950 seconds
[0m21:15:36.286968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9572e128-3fe2-4d53-9f04-741b1ef22973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001951A9021D0>]}
[0m21:15:36.298549 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m21:15:36.298549 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m21:15:36.298549 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.stg_customers'
[0m21:15:36.303098 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m21:15:36.303098 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m21:15:36.303098 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m21:15:36.369394 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m21:15:36.369394 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m21:15:36.369394 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean,
   
FROM raw
  );
[0m21:15:36.369394 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:15:38.213558 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.844 seconds
[0m21:15:38.260374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9572e128-3fe2-4d53-9f04-741b1ef22973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001951A9A1110>]}
[0m21:15:38.260374 [info ] [Thread-1 (]: 1 of 4 OK created sql view model PUBLIC.stg_customers .......................... [[32mSUCCESS 1[0m in 1.96s]
[0m21:15:38.260374 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m21:15:38.260374 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m21:15:38.260374 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m21:15:38.276290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m21:15:38.277474 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m21:15:38.277474 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m21:15:38.277474 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m21:15:38.277474 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m21:15:38.293388 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m21:15:38.293975 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.products
)
SELECT 
    product_id,
    
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m21:15:38.827913 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.539 seconds
[0m21:15:38.827913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9572e128-3fe2-4d53-9f04-741b1ef22973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019518660B50>]}
[0m21:15:38.827913 [info ] [Thread-1 (]: 2 of 4 OK created sql view model PUBLIC.stg_products ........................... [[32mSUCCESS 1[0m in 0.57s]
[0m21:15:38.843429 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m21:15:38.845260 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m21:15:38.845260 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m21:15:38.845260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m21:15:38.850118 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m21:15:38.854474 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m21:15:38.860787 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m21:15:38.865466 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m21:15:38.865466 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m21:15:38.865466 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m21:15:39.640885 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.776 seconds
[0m21:15:39.659909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9572e128-3fe2-4d53-9f04-741b1ef22973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001951B1AF0D0>]}
[0m21:15:39.661566 [info ] [Thread-1 (]: 3 of 4 OK created sql view model PUBLIC.stg_transactions ....................... [[32mSUCCESS 1[0m in 0.81s]
[0m21:15:39.662852 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m21:15:39.662852 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m21:15:39.662852 [info ] [Thread-1 (]: 4 of 4 START sql view model PUBLIC.customer_revenue_bridge ..................... [RUN]
[0m21:15:39.662852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_transactions, now model.crb_kpi.customer_revenue_bridge)
[0m21:15:39.672376 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.customer_revenue_bridge
[0m21:15:39.680348 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.customer_revenue_bridge"
[0m21:15:39.683809 [debug] [Thread-1 (]: Began executing node model.crb_kpi.customer_revenue_bridge
[0m21:15:39.686890 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.customer_revenue_bridge"
[0m21:15:39.698666 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.customer_revenue_bridge"
[0m21:15:39.698666 [debug] [Thread-1 (]: On model.crb_kpi.customer_revenue_bridge: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.customer_revenue_bridge"} */
create or replace   view CRBFITNESS.PUBLIC.customer_revenue_bridge
  
   as (
    WITH transaction_summary AS (
    SELECT 
        t.customer_id,
        c.customer_name_clean,
        p.product_family_clean,
        SUM(t.revenue) AS total_revenue,
        COUNT(DISTINCT t.payment_month) AS active_months, -- Use payment_month instead of payment_date
        MIN(t.payment_month) AS first_transaction_month,  -- First transaction month
        MAX(t.payment_month) AS last_transaction_month  -- Last transaction month
    FROM CRBFITNESS.PUBLIC.stg_transactions t
    LEFT JOIN CRBFITNESS.PUBLIC.stg_customers c ON t.customer_id = c.customer_id
    LEFT JOIN CRBFITNESS.PUBLIC.stg_products p ON t.product_id = p.product_id
    GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
),

new_customers AS (
    SELECT 
        customer_id,
        customer_name_clean,
        first_transaction_month,
        EXTRACT(YEAR FROM first_transaction_month) AS first_year
    FROM transaction_summary
),


churned_customers AS (
    SELECT 
        customer_id, 
        customer_name_clean,
        last_transaction_month
    FROM transaction_summary
    WHERE last_transaction_month < DATEADD(MONTH, -6, CURRENT_DATE) -- Using months instead of dates
),

cross_sell_customers AS (
    -- Customers who have purchased multiple product families
    SELECT 
        customer_id, 
        customer_name_clean,
        COUNT(DISTINCT product_family_clean) AS unique_product_families
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
    HAVING COUNT(DISTINCT product_family_clean) > 1
),

product_churn AS (
    -- Products that have seen a decline in purchases
    SELECT 
        product_family_clean,
        COUNT(DISTINCT customer_id) AS customer_count,
        LAG(customer_count) OVER (
            PARTITION BY product_family_clean 
            ORDER BY TO_DATE(payment_month, 'YYYY-MM')  -- Ensure proper ordering
        ) AS prev_customer_count,
        customer_count - LAG(customer_count) OVER (
            PARTITION BY product_family_clean 
            ORDER BY TO_DATE(payment_month, 'YYYY-MM')
        ) AS customer_loss
    FROM transaction_summary
),

revenue_metrics AS (
    SELECT 
        SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS current_revenue,
        SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS previous_revenue,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END)) AS NRR,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END)) AS GRR
    FROM transaction_summary
),

lost_revenue AS (
    -- Revenue lost due to customer churn
    SELECT 
        SUM(total_revenue) AS lost_revenue
    FROM transaction_summary
    WHERE customer_id IN (SELECT customer_id FROM churned_customers)
),

ranked_products AS (
    -- Rank products based on total revenue
    SELECT 
        product_family_clean,
        SUM(total_revenue) AS product_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY product_family_clean
),

ranked_customers AS (
    -- Rank customers based on total revenue
    SELECT 
        customer_id,
        customer_name_clean,
        SUM(total_revenue) AS customer_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
)

-- Final Result
SELECT * FROM new_customers
UNION ALL
SELECT * FROM churned_customers
UNION ALL
SELECT * FROM cross_sell_customers
UNION ALL
SELECT * FROM product_churn
UNION ALL
SELECT * FROM revenue_metrics
UNION ALL
SELECT * FROM lost_revenue
UNION ALL
SELECT * FROM ranked_products
UNION ALL
SELECT * FROM ranked_customers
  );
[0m21:15:40.200471 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0151-0004-bb9d-0000-0005db4bdb25
[0m21:15:40.200471 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 56 at position 29
invalid identifier 'PAYMENT_MONTH'
[0m21:15:40.208134 [debug] [Thread-1 (]: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  000904 (42000): SQL compilation error: error line 56 at position 29
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m21:15:40.208134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9572e128-3fe2-4d53-9f04-741b1ef22973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001951BB39590>]}
[0m21:15:40.208134 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model PUBLIC.customer_revenue_bridge ............ [[31mERROR[0m in 0.55s]
[0m21:15:40.208134 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m21:15:40.208134 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.customer_revenue_bridge' to be skipped because of status 'error'.  Reason: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  000904 (42000): SQL compilation error: error line 56 at position 29
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql.
[0m21:15:40.208134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:15:40.208134 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m21:15:40.208134 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m21:15:40.881115 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m21:15:40.881115 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m21:15:41.720257 [debug] [MainThread]: Connection 'model.crb_kpi.customer_revenue_bridge' was left open.
[0m21:15:41.720257 [debug] [MainThread]: On model.crb_kpi.customer_revenue_bridge: Close
[0m21:15:42.607276 [info ] [MainThread]: 
[0m21:15:42.607276 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 10.91 seconds (10.91s).
[0m21:15:42.622857 [debug] [MainThread]: Command end result
[0m21:15:42.670659 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m21:15:42.677429 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m21:15:42.679936 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m21:15:42.679936 [info ] [MainThread]: 
[0m21:15:42.679936 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:15:42.679936 [info ] [MainThread]: 
[0m21:15:42.679936 [error] [MainThread]:   Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  000904 (42000): SQL compilation error: error line 56 at position 29
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m21:15:42.696554 [info ] [MainThread]: 
[0m21:15:42.696554 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m21:15:42.696554 [debug] [MainThread]: Command `dbt run` failed at 21:15:42.696554 after 13.17 seconds
[0m21:15:42.696554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019519CE2E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019519CE2650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019519792C50>]}
[0m21:15:42.696554 [debug] [MainThread]: Flushing usage events
[0m21:15:43.974363 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:18:13.913239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477918D410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477918D990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477918D650>]}


============================== 21:18:13.913239 | b08d656f-00d0-45bf-9651-f0a42a61d977 ==============================
[0m21:18:13.913239 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:18:13.928886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:18:14.556962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b08d656f-00d0-45bf-9651-f0a42a61d977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024778028F10>]}
[0m21:18:14.635089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b08d656f-00d0-45bf-9651-f0a42a61d977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024779D5D3D0>]}
[0m21:18:14.635089 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m21:18:15.234422 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m21:18:15.502334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:18:15.502334 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\customer_revenue_bridge.sql
[0m21:18:15.845017 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m21:18:15.845017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b08d656f-00d0-45bf-9651-f0a42a61d977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477A899410>]}
[0m21:18:15.956815 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m21:18:15.956815 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m21:18:15.988080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b08d656f-00d0-45bf-9651-f0a42a61d977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477AA75B10>]}
[0m21:18:15.988080 [info ] [MainThread]: Found 3 seeds, 4 models, 474 macros
[0m21:18:16.004728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b08d656f-00d0-45bf-9651-f0a42a61d977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477A8BA610>]}
[0m21:18:16.004728 [info ] [MainThread]: 
[0m21:18:16.004728 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:18:16.004728 [info ] [MainThread]: 
[0m21:18:16.004728 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:18:16.020782 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m21:18:16.248034 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m21:18:16.248034 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m21:18:16.248034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:18.403659 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.149 seconds
[0m21:18:18.403659 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m21:18:18.419285 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m21:18:18.419285 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m21:18:18.419285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:20.757516 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.330 seconds
[0m21:18:20.757516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b08d656f-00d0-45bf-9651-f0a42a61d977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477A974B50>]}
[0m21:18:20.774624 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m21:18:20.774624 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m21:18:20.774624 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.stg_customers'
[0m21:18:20.774624 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m21:18:20.788219 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m21:18:20.788219 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m21:18:20.837854 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m21:18:20.849378 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m21:18:20.852546 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean,
   
FROM raw
  );
[0m21:18:20.852546 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:18:22.865059 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.023 seconds
[0m21:18:22.913203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b08d656f-00d0-45bf-9651-f0a42a61d977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477AA77CD0>]}
[0m21:18:22.914482 [info ] [Thread-1 (]: 1 of 4 OK created sql view model PUBLIC.stg_customers .......................... [[32mSUCCESS 1[0m in 2.13s]
[0m21:18:22.916132 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m21:18:22.916877 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m21:18:22.918121 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m21:18:22.919287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m21:18:22.920206 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m21:18:22.922541 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m21:18:22.925195 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m21:18:22.930208 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m21:18:22.930208 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m21:18:22.930208 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.products
)
SELECT 
    product_id,
    
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m21:18:23.514666 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.581 seconds
[0m21:18:23.514666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b08d656f-00d0-45bf-9651-f0a42a61d977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477B058A90>]}
[0m21:18:23.514666 [info ] [Thread-1 (]: 2 of 4 OK created sql view model PUBLIC.stg_products ........................... [[32mSUCCESS 1[0m in 0.60s]
[0m21:18:23.514666 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m21:18:23.514666 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m21:18:23.514666 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m21:18:23.514666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m21:18:23.531225 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m21:18:23.538660 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m21:18:23.538660 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m21:18:23.543081 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m21:18:23.543081 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m21:18:23.554839 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m21:18:24.236147 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.681 seconds
[0m21:18:24.236147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b08d656f-00d0-45bf-9651-f0a42a61d977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477A46EA90>]}
[0m21:18:24.236147 [info ] [Thread-1 (]: 3 of 4 OK created sql view model PUBLIC.stg_transactions ....................... [[32mSUCCESS 1[0m in 0.72s]
[0m21:18:24.236147 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m21:18:24.236147 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m21:18:24.236147 [info ] [Thread-1 (]: 4 of 4 START sql view model PUBLIC.customer_revenue_bridge ..................... [RUN]
[0m21:18:24.251777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_transactions, now model.crb_kpi.customer_revenue_bridge)
[0m21:18:24.253678 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.customer_revenue_bridge
[0m21:18:24.256621 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.customer_revenue_bridge"
[0m21:18:24.256621 [debug] [Thread-1 (]: Began executing node model.crb_kpi.customer_revenue_bridge
[0m21:18:24.271348 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.customer_revenue_bridge"
[0m21:18:24.286132 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.customer_revenue_bridge"
[0m21:18:24.289002 [debug] [Thread-1 (]: On model.crb_kpi.customer_revenue_bridge: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.customer_revenue_bridge"} */
create or replace   view CRBFITNESS.PUBLIC.customer_revenue_bridge
  
   as (
    WITH transaction_summary AS (
    SELECT 
        t.customer_id,
        c.customer_name_clean,
        p.product_family_clean,
        SUM(t.revenue) AS total_revenue,
        COUNT(DISTINCT t.payment_month) AS active_months,  -- Using payment_month
        MIN(t.payment_month) AS first_transaction_month,   -- Replacing date with month
        MAX(t.payment_month) AS last_transaction_month    -- Replacing date with month
    FROM CRBFITNESS.PUBLIC.stg_transactions t
    LEFT JOIN CRBFITNESS.PUBLIC.stg_customers c ON t.customer_id = c.customer_id
    LEFT JOIN CRBFITNESS.PUBLIC.stg_products p ON t.product_id = p.product_id
    GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
)


new_customers AS (
    SELECT 
        customer_id,
        customer_name_clean,
        first_transaction_month,
        EXTRACT(YEAR FROM first_transaction_month) AS first_year
    FROM transaction_summary
),


churned_customers AS (
    SELECT 
        customer_id, 
        customer_name_clean,
        last_transaction_month
    FROM transaction_summary
    WHERE last_transaction_month < DATEADD(MONTH, -6, CURRENT_DATE) -- Using months instead of dates
),

cross_sell_customers AS (
    -- Customers who have purchased multiple product families
    SELECT 
        customer_id, 
        customer_name_clean,
        COUNT(DISTINCT product_family_clean) AS unique_product_families
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
    HAVING COUNT(DISTINCT product_family_clean) > 1
),

product_churn AS (
    -- Products that have seen a decline in purchases
    SELECT 
        product_family_clean,
        COUNT(DISTINCT customer_id) AS customer_count,
        LAG(customer_count) OVER (
            PARTITION BY product_family_clean 
            ORDER BY TO_DATE(payment_month, 'YYYY-MM')  -- Ensure proper ordering
        ) AS prev_customer_count,
        customer_count - LAG(customer_count) OVER (
            PARTITION BY product_family_clean 
            ORDER BY TO_DATE(payment_month, 'YYYY-MM')
        ) AS customer_loss
    FROM transaction_summary
),

revenue_metrics AS (
    SELECT 
        SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS current_revenue,
        SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS previous_revenue,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END)) AS NRR,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END)) AS GRR
    FROM transaction_summary
),

lost_revenue AS (
    -- Revenue lost due to customer churn
    SELECT 
        SUM(total_revenue) AS lost_revenue
    FROM transaction_summary
    WHERE customer_id IN (SELECT customer_id FROM churned_customers)
),

ranked_products AS (
    -- Rank products based on total revenue
    SELECT 
        product_family_clean,
        SUM(total_revenue) AS product_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY product_family_clean
),

ranked_customers AS (
    -- Rank customers based on total revenue
    SELECT 
        customer_id,
        customer_name_clean,
        SUM(total_revenue) AS customer_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
)

-- Final Result
SELECT * FROM new_customers
UNION ALL
SELECT * FROM churned_customers
UNION ALL
SELECT * FROM cross_sell_customers
UNION ALL
SELECT * FROM product_churn
UNION ALL
SELECT * FROM revenue_metrics
UNION ALL
SELECT * FROM lost_revenue
UNION ALL
SELECT * FROM ranked_products
UNION ALL
SELECT * FROM ranked_customers
  );
[0m21:18:24.644492 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0154-0004-bb9d-0000-0005db4bdb29
[0m21:18:24.660032 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 0 unexpected 'new_customers'.
syntax error line 25 at position 51 unexpected 'AS'.
[0m21:18:24.660032 [debug] [Thread-1 (]: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 0 unexpected 'new_customers'.
  syntax error line 25 at position 51 unexpected 'AS'.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m21:18:24.660032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b08d656f-00d0-45bf-9651-f0a42a61d977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477A955490>]}
[0m21:18:24.660032 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model PUBLIC.customer_revenue_bridge ............ [[31mERROR[0m in 0.41s]
[0m21:18:24.673399 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m21:18:24.676982 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.customer_revenue_bridge' to be skipped because of status 'error'.  Reason: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 0 unexpected 'new_customers'.
  syntax error line 25 at position 51 unexpected 'AS'.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql.
[0m21:18:24.681592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:18:24.681592 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m21:18:24.681592 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m21:18:25.317813 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m21:18:25.333400 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m21:18:25.947898 [debug] [MainThread]: Connection 'model.crb_kpi.customer_revenue_bridge' was left open.
[0m21:18:25.963474 [debug] [MainThread]: On model.crb_kpi.customer_revenue_bridge: Close
[0m21:18:26.668116 [info ] [MainThread]: 
[0m21:18:26.668116 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 10.66 seconds (10.66s).
[0m21:18:26.668116 [debug] [MainThread]: Command end result
[0m21:18:26.721824 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m21:18:26.721824 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m21:18:26.736213 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m21:18:26.736213 [info ] [MainThread]: 
[0m21:18:26.739807 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:18:26.739807 [info ] [MainThread]: 
[0m21:18:26.739807 [error] [MainThread]:   Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 0 unexpected 'new_customers'.
  syntax error line 25 at position 51 unexpected 'AS'.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m21:18:26.739807 [info ] [MainThread]: 
[0m21:18:26.739807 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m21:18:26.747610 [debug] [MainThread]: Command `dbt run` failed at 21:18:26.747610 after 12.95 seconds
[0m21:18:26.747610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024773C62C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024773CE2E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024773CE2E90>]}
[0m21:18:26.747610 [debug] [MainThread]: Flushing usage events
[0m21:18:28.086823 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:21:02.825824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E01AB88450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E01ABE2390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E01ABE2190>]}


============================== 21:21:02.825824 | 3c526b98-9437-4918-904a-6d149505729c ==============================
[0m21:21:02.825824 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:21:02.825824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:21:03.449930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c526b98-9437-4918-904a-6d149505729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E01BA1E650>]}
[0m21:21:03.543826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c526b98-9437-4918-904a-6d149505729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E01B75D950>]}
[0m21:21:03.543826 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m21:21:04.159664 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m21:21:04.394677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:21:04.394677 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\customer_revenue_bridge.sql
[0m21:21:04.740686 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m21:21:04.756198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c526b98-9437-4918-904a-6d149505729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E01ABEC2D0>]}
[0m21:21:04.859923 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m21:21:04.867981 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m21:21:04.900152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c526b98-9437-4918-904a-6d149505729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E01C477CD0>]}
[0m21:21:04.900152 [info ] [MainThread]: Found 3 seeds, 4 models, 474 macros
[0m21:21:04.900152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c526b98-9437-4918-904a-6d149505729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E01C3A1850>]}
[0m21:21:04.900152 [info ] [MainThread]: 
[0m21:21:04.900152 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:21:04.911624 [info ] [MainThread]: 
[0m21:21:04.913400 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:21:04.913400 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m21:21:05.142768 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m21:21:05.142768 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m21:21:05.142768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:21:07.376405 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.232 seconds
[0m21:21:07.387885 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m21:21:07.392430 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m21:21:07.408074 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m21:21:07.408074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:21:09.224367 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.828 seconds
[0m21:21:09.239909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c526b98-9437-4918-904a-6d149505729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E01C3C0B90>]}
[0m21:21:09.249501 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m21:21:09.249501 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m21:21:09.249501 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.stg_customers'
[0m21:21:09.256027 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m21:21:09.256027 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m21:21:09.256027 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m21:21:09.320042 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m21:21:09.320042 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m21:21:09.320042 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean,
   
FROM raw
  );
[0m21:21:09.320042 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:21:11.420112 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.102 seconds
[0m21:21:11.466916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c526b98-9437-4918-904a-6d149505729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E01B7EB850>]}
[0m21:21:11.466916 [info ] [Thread-1 (]: 1 of 4 OK created sql view model PUBLIC.stg_customers .......................... [[32mSUCCESS 1[0m in 2.22s]
[0m21:21:11.466916 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m21:21:11.466916 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m21:21:11.466916 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m21:21:11.466916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m21:21:11.466916 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m21:21:11.466916 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m21:21:11.466916 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m21:21:11.486822 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m21:21:11.486822 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m21:21:11.486822 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.products
)
SELECT 
    product_id,
    
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m21:21:12.235819 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.756 seconds
[0m21:21:12.251394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c526b98-9437-4918-904a-6d149505729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E01C92BED0>]}
[0m21:21:12.251394 [info ] [Thread-1 (]: 2 of 4 OK created sql view model PUBLIC.stg_products ........................... [[32mSUCCESS 1[0m in 0.78s]
[0m21:21:12.251394 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m21:21:12.251394 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m21:21:12.251394 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m21:21:12.251394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m21:21:12.264710 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m21:21:12.269074 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m21:21:12.269074 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m21:21:12.281534 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m21:21:12.281534 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m21:21:12.281534 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM CRBFITNESS.PUBLIC.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m21:21:13.058152 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.779 seconds
[0m21:21:13.058152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c526b98-9437-4918-904a-6d149505729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E01BAE5ED0>]}
[0m21:21:13.073668 [info ] [Thread-1 (]: 3 of 4 OK created sql view model PUBLIC.stg_transactions ....................... [[32mSUCCESS 1[0m in 0.81s]
[0m21:21:13.074550 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m21:21:13.074550 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m21:21:13.074550 [info ] [Thread-1 (]: 4 of 4 START sql view model PUBLIC.customer_revenue_bridge ..................... [RUN]
[0m21:21:13.074550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_transactions, now model.crb_kpi.customer_revenue_bridge)
[0m21:21:13.082771 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.customer_revenue_bridge
[0m21:21:13.087230 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.customer_revenue_bridge"
[0m21:21:13.095223 [debug] [Thread-1 (]: Began executing node model.crb_kpi.customer_revenue_bridge
[0m21:21:13.100477 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.customer_revenue_bridge"
[0m21:21:13.112203 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.customer_revenue_bridge"
[0m21:21:13.119217 [debug] [Thread-1 (]: On model.crb_kpi.customer_revenue_bridge: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.customer_revenue_bridge"} */
create or replace   view CRBFITNESS.PUBLIC.customer_revenue_bridge
  
   as (
    WITH transaction_summary AS (
    SELECT 
        t.customer_id,
        c.customer_name_clean,
        p.product_family_clean,
        SUM(t.revenue) AS total_revenue,
        COUNT(DISTINCT t.payment_month) AS active_months,  -- Using payment_month
        MIN(t.payment_month) AS first_transaction_month,   -- Replacing date with month
        MAX(t.payment_month) AS last_transaction_month    -- Replacing date with month
    FROM CRBFITNESS.PUBLIC.stg_transactions t
    LEFT JOIN CRBFITNESS.PUBLIC.stg_customers c ON t.customer_id = c.customer_id
    LEFT JOIN CRBFITNESS.PUBLIC.stg_products p ON t.product_id = p.product_id
    GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
),


 new_customers AS (
    SELECT 
        customer_id, 
        MIN(payment_month) AS first_payment_month  -- Ensure correct aliasing
    FROM transaction_summary
    GROUP BY customer_id
),



churned_customers AS (
    SELECT 
        customer_id, 
        customer_name_clean,
        last_transaction_month
    FROM transaction_summary
    WHERE last_transaction_month < DATEADD(MONTH, -6, CURRENT_DATE) -- Using months instead of dates
),

cross_sell_customers AS (
    -- Customers who have purchased multiple product families
    SELECT 
        customer_id, 
        customer_name_clean,
        COUNT(DISTINCT product_family_clean) AS unique_product_families
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
    HAVING COUNT(DISTINCT product_family_clean) > 1
),

product_churn AS (
    -- Products that have seen a decline in purchases
    SELECT 
        product_family_clean,
        COUNT(DISTINCT customer_id) AS customer_count,
        LAG(customer_count) OVER (
            PARTITION BY product_family_clean 
            ORDER BY TO_DATE(payment_month, 'YYYY-MM')  -- Ensure proper ordering
        ) AS prev_customer_count,
        customer_count - LAG(customer_count) OVER (
            PARTITION BY product_family_clean 
            ORDER BY TO_DATE(payment_month, 'YYYY-MM')
        ) AS customer_loss
    FROM transaction_summary
),

revenue_metrics AS (
    SELECT 
        SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS current_revenue,
        SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS previous_revenue,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END)) AS NRR,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END)) AS GRR
    FROM transaction_summary
),

lost_revenue AS (
    -- Revenue lost due to customer churn
    SELECT 
        SUM(total_revenue) AS lost_revenue
    FROM transaction_summary
    WHERE customer_id IN (SELECT customer_id FROM churned_customers)
),

ranked_products AS (
    -- Rank products based on total revenue
    SELECT 
        product_family_clean,
        SUM(total_revenue) AS product_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY product_family_clean
),

ranked_customers AS (
    -- Rank customers based on total revenue
    SELECT 
        customer_id,
        customer_name_clean,
        SUM(total_revenue) AS customer_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
)

-- Final Result
SELECT * FROM new_customers
UNION ALL
SELECT * FROM churned_customers
UNION ALL
SELECT * FROM cross_sell_customers
UNION ALL
SELECT * FROM product_churn
UNION ALL
SELECT * FROM revenue_metrics
UNION ALL
SELECT * FROM lost_revenue
UNION ALL
SELECT * FROM ranked_products
UNION ALL
SELECT * FROM ranked_customers
  );
[0m21:21:13.653190 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0157-0004-bb9d-0000-0005db4bdb2d
[0m21:21:13.653190 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 23 at position 12
invalid identifier 'PAYMENT_MONTH'
[0m21:21:13.653190 [debug] [Thread-1 (]: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  000904 (42000): SQL compilation error: error line 23 at position 12
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m21:21:13.653190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c526b98-9437-4918-904a-6d149505729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E01CBD08D0>]}
[0m21:21:13.653190 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model PUBLIC.customer_revenue_bridge ............ [[31mERROR[0m in 0.58s]
[0m21:21:13.669806 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m21:21:13.669806 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.customer_revenue_bridge' to be skipped because of status 'error'.  Reason: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  000904 (42000): SQL compilation error: error line 23 at position 12
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql.
[0m21:21:13.669806 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:21:13.669806 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m21:21:13.669806 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m21:21:14.321373 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m21:21:14.321373 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m21:21:15.031366 [debug] [MainThread]: Connection 'model.crb_kpi.customer_revenue_bridge' was left open.
[0m21:21:15.031366 [debug] [MainThread]: On model.crb_kpi.customer_revenue_bridge: Close
[0m21:21:15.746875 [info ] [MainThread]: 
[0m21:21:15.762444 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 10.83 seconds (10.83s).
[0m21:21:15.762444 [debug] [MainThread]: Command end result
[0m21:21:15.817787 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m21:21:15.817787 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m21:21:15.834031 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m21:21:15.834031 [info ] [MainThread]: 
[0m21:21:15.834031 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:21:15.834031 [info ] [MainThread]: 
[0m21:21:15.834031 [error] [MainThread]:   Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  000904 (42000): SQL compilation error: error line 23 at position 12
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m21:21:15.843266 [info ] [MainThread]: 
[0m21:21:15.845835 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m21:21:15.848419 [debug] [MainThread]: Command `dbt run` failed at 21:21:15.848419 after 13.13 seconds
[0m21:21:15.848419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E01ABE2190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E01ABE1D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E015662D50>]}
[0m21:21:15.848419 [debug] [MainThread]: Flushing usage events
[0m21:21:17.102421 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:29:36.724028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002333F58EFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002333F5E5990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002333F5E7490>]}


============================== 21:29:36.735270 | 5894abb0-2c42-42eb-98ac-24cb72e72d33 ==============================
[0m21:29:36.735270 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:29:36.735270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m21:29:37.327815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5894abb0-2c42-42eb-98ac-24cb72e72d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002333F5B1D50>]}
[0m21:29:37.422193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5894abb0-2c42-42eb-98ac-24cb72e72d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233401846D0>]}
[0m21:29:37.422193 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m21:29:38.054624 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m21:29:38.304365 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:29:38.304365 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\customer_revenue_bridge.sql
[0m21:29:38.634957 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m21:29:38.642888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5894abb0-2c42-42eb-98ac-24cb72e72d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023340CA1010>]}
[0m21:29:38.739081 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m21:29:38.754704 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m21:29:38.787518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5894abb0-2c42-42eb-98ac-24cb72e72d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023340D57C90>]}
[0m21:29:38.788895 [info ] [MainThread]: Found 3 seeds, 4 models, 474 macros
[0m21:29:38.790331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5894abb0-2c42-42eb-98ac-24cb72e72d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023340CBA950>]}
[0m21:29:38.794345 [info ] [MainThread]: 
[0m21:29:38.796132 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:29:38.798714 [info ] [MainThread]: 
[0m21:29:38.801070 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:29:38.807330 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m21:29:39.034058 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m21:29:39.034058 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m21:29:39.034058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:41.403555 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.363 seconds
[0m21:29:41.413759 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m21:29:41.426153 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m21:29:41.426153 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m21:29:41.426153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:44.015706 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.589 seconds
[0m21:29:44.030230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5894abb0-2c42-42eb-98ac-24cb72e72d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023340434810>]}
[0m21:29:44.036787 [debug] [Thread-1 (]: Began running node seed.crb_kpi.customers
[0m21:29:44.036787 [info ] [Thread-1 (]: 1 of 3 START seed file PUBLIC.customers ........................................ [RUN]
[0m21:29:44.036787 [debug] [Thread-1 (]: Acquiring new snowflake connection 'seed.crb_kpi.customers'
[0m21:29:44.036787 [debug] [Thread-1 (]: Began compiling node seed.crb_kpi.customers
[0m21:29:44.036787 [debug] [Thread-1 (]: Began executing node seed.crb_kpi.customers
[0m21:29:44.137377 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.customers"
[0m21:29:44.145501 [debug] [Thread-1 (]: On seed.crb_kpi.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.customers"} */
BEGIN
[0m21:29:44.146711 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:29:46.034808 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.888 seconds
[0m21:29:46.034808 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.customers"
[0m21:29:46.034808 [debug] [Thread-1 (]: On seed.crb_kpi.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.customers"} */
truncate table "CRBFITNESS"."PUBLIC"."CUSTOMERS"
  ;
[0m21:29:46.618727 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.588 seconds
[0m21:29:46.618727 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.customers"
[0m21:29:46.618727 [debug] [Thread-1 (]: On seed.crb_kpi.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.customers"} */
COMMIT
[0m21:29:47.305714 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.681 seconds
[0m21:29:47.372211 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.customers"
[0m21:29:47.372211 [debug] [Thread-1 (]: On seed.crb_kpi.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.customers"} */
BEGIN
[0m21:29:47.932425 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.555 seconds
[0m21:29:48.010804 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.customers"
[0m21:29:48.010804 [debug] [Thread-1 (]: On seed.crb_kpi.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.customers"} */
insert into CRBFITNESS.PUBLIC.customers (company, customer_id, customer_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
[0m21:29:48.473482 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb015f-0004-bb9d-0000-0005db4bdb6d
[0m21:29:48.473482 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 1 at position 63
invalid identifier 'CUSTOMER_NAME'
[0m21:29:48.481500 [debug] [Thread-1 (]: Database Error in seed customers (seeds\customers.csv)
  000904 (42000): SQL compilation error: error line 1 at position 63
  invalid identifier 'CUSTOMER_NAME'
[0m21:29:48.481500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5894abb0-2c42-42eb-98ac-24cb72e72d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002334180FD90>]}
[0m21:29:48.481500 [error] [Thread-1 (]: 1 of 3 ERROR loading seed file PUBLIC.customers ................................ [[31mERROR[0m in 4.44s]
[0m21:29:48.481500 [debug] [Thread-1 (]: Finished running node seed.crb_kpi.customers
[0m21:29:48.481500 [debug] [Thread-1 (]: Began running node seed.crb_kpi.products
[0m21:29:48.481500 [debug] [Thread-4 (]: Marking all children of 'seed.crb_kpi.customers' to be skipped because of status 'error'.  Reason: Database Error in seed customers (seeds\customers.csv)
  000904 (42000): SQL compilation error: error line 1 at position 63
  invalid identifier 'CUSTOMER_NAME'.
[0m21:29:48.497148 [info ] [Thread-1 (]: 2 of 3 START seed file PUBLIC.products ......................................... [RUN]
[0m21:29:48.502371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.crb_kpi.customers, now seed.crb_kpi.products)
[0m21:29:48.502371 [debug] [Thread-1 (]: Began compiling node seed.crb_kpi.products
[0m21:29:48.509162 [debug] [Thread-1 (]: Began executing node seed.crb_kpi.products
[0m21:29:48.526463 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.products"
[0m21:29:48.526463 [debug] [Thread-1 (]: On seed.crb_kpi.products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.products"} */
BEGIN
[0m21:29:48.953580 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.418 seconds
[0m21:29:48.953580 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.products"
[0m21:29:48.953580 [debug] [Thread-1 (]: On seed.crb_kpi.products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.products"} */
truncate table "CRBFITNESS"."PUBLIC"."PRODUCTS"
  ;
[0m21:29:49.762251 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.804 seconds
[0m21:29:49.762251 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.products"
[0m21:29:49.762251 [debug] [Thread-1 (]: On seed.crb_kpi.products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.products"} */
COMMIT
[0m21:29:50.584026 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.820 seconds
[0m21:29:50.584026 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.products"
[0m21:29:50.584026 [debug] [Thread-1 (]: On seed.crb_kpi.products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.products"} */
BEGIN
[0m21:29:50.978612 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.386 seconds
[0m21:29:50.989898 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.products"
[0m21:29:50.989898 [debug] [Thread-1 (]: On seed.crb_kpi.products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.products"} */
insert into CRBFITNESS.PUBLIC.products (product_id, PRODUCT_Family, product_sub_family) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),...
[0m21:29:52.152179 [debug] [Thread-1 (]: SQL status: SUCCESS 119 in 1.171 seconds
[0m21:29:52.152179 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.products"
[0m21:29:52.152179 [debug] [Thread-1 (]: On seed.crb_kpi.products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.products"} */
COMMIT
[0m21:29:52.732112 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.575 seconds
[0m21:29:52.747131 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.crb_kpi.products"
[0m21:29:52.779937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5894abb0-2c42-42eb-98ac-24cb72e72d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002334180E490>]}
[0m21:29:52.779937 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file PUBLIC.products ..................................... [[32mINSERT 119[0m in 4.28s]
[0m21:29:52.785082 [debug] [Thread-1 (]: Finished running node seed.crb_kpi.products
[0m21:29:52.785082 [debug] [Thread-1 (]: Began running node seed.crb_kpi.transactions
[0m21:29:52.785082 [info ] [Thread-1 (]: 3 of 3 START seed file PUBLIC.transactions ..................................... [RUN]
[0m21:29:52.790347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.crb_kpi.products, now seed.crb_kpi.transactions)
[0m21:29:52.791827 [debug] [Thread-1 (]: Began compiling node seed.crb_kpi.transactions
[0m21:29:52.792705 [debug] [Thread-1 (]: Began executing node seed.crb_kpi.transactions
[0m21:29:56.698511 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:29:56.698511 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:29:57.139356 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.439 seconds
[0m21:29:57.139356 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:29:57.139356 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
truncate table "CRBFITNESS"."PUBLIC"."TRANSACTIONS"
  ;
[0m21:29:57.779899 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.630 seconds
[0m21:29:57.779899 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:29:57.779899 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:29:58.487584 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.705 seconds
[0m21:29:59.019222 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:29:59.019222 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:29:59.600432 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.575 seconds
[0m21:30:22.134581 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:30:22.134581 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:30:28.015058 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.877 seconds
[0m21:30:28.015058 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:30:28.015058 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:30:28.846205 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.835 seconds
[0m21:30:29.364202 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:30:29.364202 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:30:29.911597 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.549 seconds
[0m21:30:52.665034 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:30:52.665034 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:30:57.810149 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.143 seconds
[0m21:30:57.810149 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:30:57.810149 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:30:58.686234 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.873 seconds
[0m21:30:59.206324 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:30:59.209842 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:30:59.706306 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.504 seconds
[0m21:31:22.365192 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:31:22.365192 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:31:27.368777 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.001 seconds
[0m21:31:27.368777 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:31:27.368777 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:31:28.089479 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.717 seconds
[0m21:31:28.606195 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:31:28.606195 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:31:29.016660 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.405 seconds
[0m21:31:52.096035 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:31:52.096035 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:31:57.481976 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.380 seconds
[0m21:31:57.481976 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:31:57.488010 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:31:58.550761 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.067 seconds
[0m21:31:59.085890 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:31:59.085890 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:31:59.585759 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.494 seconds
[0m21:32:24.639518 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:32:24.639518 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:32:30.049674 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.409 seconds
[0m21:32:30.049674 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:32:30.049674 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:32:31.052436 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.000 seconds
[0m21:32:31.898977 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:32:31.906511 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:32:32.359638 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.460 seconds
[0m21:33:10.906868 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:33:10.906868 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:33:16.365646 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.453 seconds
[0m21:33:16.369691 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:33:16.373735 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:33:17.108468 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.734 seconds
[0m21:33:17.974878 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:33:17.974878 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:33:18.467511 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.484 seconds
[0m21:33:52.944352 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:33:52.944352 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:33:58.327301 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.385 seconds
[0m21:33:58.335643 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:33:58.338607 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:33:59.053443 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.713 seconds
[0m21:33:59.886377 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:33:59.887983 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:34:00.346772 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.457 seconds
[0m21:34:40.239442 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:34:40.239442 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:34:45.718790 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.474 seconds
[0m21:34:45.725279 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:34:45.725279 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:34:46.758418 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.033 seconds
[0m21:34:47.561125 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:34:47.561125 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:34:47.959883 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.395 seconds
[0m21:35:30.538984 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:35:30.542221 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:35:35.592524 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.052 seconds
[0m21:35:35.598611 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:35:35.598611 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:35:36.860041 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.262 seconds
[0m21:35:37.397126 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:35:37.397126 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:35:37.792995 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.398 seconds
[0m21:36:16.778360 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:36:16.778360 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:36:21.680713 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 4.899 seconds
[0m21:36:21.683739 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:36:21.683739 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:36:22.351772 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.664 seconds
[0m21:36:23.184403 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:36:23.184403 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:36:23.612150 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.425 seconds
[0m21:37:06.013671 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:37:06.019286 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:37:11.441856 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.420 seconds
[0m21:37:11.441856 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:37:11.445882 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:37:12.243028 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.796 seconds
[0m21:37:13.143796 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:37:13.143796 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:37:13.679027 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.530 seconds
[0m21:37:52.983880 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:37:52.983880 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:37:58.732074 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.748 seconds
[0m21:37:58.732074 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:37:58.740076 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:37:59.549950 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.810 seconds
[0m21:38:00.343746 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:38:00.343746 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:38:00.787704 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.437 seconds
[0m21:38:41.452419 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:38:41.452419 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:38:47.292033 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.838 seconds
[0m21:38:47.292033 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:38:47.298550 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:38:48.428569 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.133 seconds
[0m21:38:49.278905 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:38:49.282054 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:38:50.138540 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.855 seconds
[0m21:39:29.947178 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:39:29.954530 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:39:35.206928 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.254 seconds
[0m21:39:35.211420 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:39:35.211420 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:39:35.908489 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.694 seconds
[0m21:39:36.724127 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:39:36.724127 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:39:37.122120 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.396 seconds
[0m21:40:16.842630 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:40:16.842630 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:40:21.762834 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 4.920 seconds
[0m21:40:21.767910 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:40:21.769435 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:40:22.393248 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m21:40:23.236607 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:40:23.236607 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:40:23.862747 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.623 seconds
[0m21:41:03.328552 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:41:03.328552 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:41:08.385996 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.060 seconds
[0m21:41:08.385996 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:41:08.385996 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:41:09.391417 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.002 seconds
[0m21:41:09.941861 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:41:09.941861 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:41:10.364179 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.427 seconds
[0m21:41:48.087724 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:41:48.087724 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:41:53.240066 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.154 seconds
[0m21:41:53.240066 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:41:53.248658 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:41:54.252261 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.003 seconds
[0m21:41:55.068559 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:41:55.068559 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:41:55.682394 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.610 seconds
[0m21:42:26.150583 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:42:26.150583 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:42:31.607385 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.443 seconds
[0m21:42:31.607385 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:42:31.607385 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:42:32.344417 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.731 seconds
[0m21:42:32.531914 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:42:32.531914 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:42:32.987072 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.454 seconds
[0m21:42:35.840648 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:42:35.840648 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:42:37.864205 [debug] [Thread-1 (]: SQL status: SUCCESS 3290 in 2.023 seconds
[0m21:42:37.864205 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:42:37.864205 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:42:38.897240 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.021 seconds
[0m21:42:38.899948 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.crb_kpi.transactions"
[0m21:42:38.908760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5894abb0-2c42-42eb-98ac-24cb72e72d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023342F5CED0>]}
[0m21:42:38.908760 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file PUBLIC.transactions ................................. [[32mINSERT 183290[0m in 766.12s]
[0m21:42:38.915704 [debug] [Thread-1 (]: Finished running node seed.crb_kpi.transactions
[0m21:42:38.926914 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m21:42:38.931278 [debug] [MainThread]: Snowflake adapter: Cancelling query 'list_CRBFITNESS' (1648490052682058)
[0m21:42:38.933888 [debug] [MainThread]: Using snowflake connection "master"
[0m21:42:38.933888 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "master"} */
select system$cancel_all_queries(1648490052682058)
[0m21:42:38.936598 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:42:41.031522 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.102 seconds
[0m21:42:41.043617 [debug] [MainThread]: Snowflake adapter: Cancel query 'list_CRBFITNESS': ('0 cancelled.',)
[0m21:42:41.043617 [debug] [MainThread]: Snowflake adapter: Cancelling query 'list_CRBFITNESS_PUBLIC' (1648490052722790)
[0m21:42:41.047637 [debug] [MainThread]: Using snowflake connection "master"
[0m21:42:41.047637 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "master"} */
select system$cancel_all_queries(1648490052722790)
[0m21:42:41.408774 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.360 seconds
[0m21:42:41.408774 [debug] [MainThread]: Snowflake adapter: Cancel query 'list_CRBFITNESS_PUBLIC': ('0 cancelled.',)
[0m21:42:41.408774 [debug] [MainThread]: Snowflake adapter: Cancelling query 'seed.crb_kpi.transactions' (1648490052682062)
[0m21:42:41.413427 [debug] [MainThread]: Using snowflake connection "master"
[0m21:42:41.413427 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "master"} */
select system$cancel_all_queries(1648490052682062)
[0m21:42:41.805608 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.395 seconds
[0m21:42:41.805608 [debug] [MainThread]: Snowflake adapter: Cancel query 'seed.crb_kpi.transactions': ('0 cancelled.',)
[0m21:42:41.805608 [error] [MainThread]: CANCEL query list_CRBFITNESS ................................................... [[31mCANCEL[0m]
[0m21:42:41.814497 [error] [MainThread]: CANCEL query list_CRBFITNESS_PUBLIC ............................................ [[31mCANCEL[0m]
[0m21:42:41.814497 [error] [MainThread]: CANCEL query seed.crb_kpi.transactions ......................................... [[31mCANCEL[0m]
[0m21:42:41.817484 [info ] [MainThread]: 
[0m21:42:41.846621 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m21:42:41.851458 [info ] [MainThread]: 
[0m21:42:41.853219 [error] [MainThread]:   Database Error in seed customers (seeds\customers.csv)
  000904 (42000): SQL compilation error: error line 1 at position 63
  invalid identifier 'CUSTOMER_NAME'
[0m21:42:41.854785 [info ] [MainThread]: 
[0m21:42:41.857607 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:42:41.858800 [debug] [MainThread]: Connection 'master' was left open.
[0m21:42:41.858800 [debug] [MainThread]: On master: Close
[0m21:42:42.696497 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m21:42:42.696497 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m21:42:44.779374 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m21:42:44.779374 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m21:42:47.290464 [debug] [MainThread]: Connection 'seed.crb_kpi.transactions' was left open.
[0m21:42:47.290464 [debug] [MainThread]: On seed.crb_kpi.transactions: Close
[0m21:42:47.914598 [info ] [MainThread]: 
[0m21:42:47.914598 [info ] [MainThread]: Finished running 3 seeds in 0 hours 13 minutes and 9.11 seconds (789.11s).
[0m21:42:47.914598 [error] [MainThread]: Encountered an error:

[0m21:42:47.937396 [error] [MainThread]: Traceback (most recent call last):
  File "C:\users\admin\crb_project\venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\users\admin\crb_project\venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\users\admin\crb_project\venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\users\admin\crb_project\venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\users\admin\crb_project\venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\users\admin\crb_project\venv\Lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\users\admin\crb_project\venv\Lib\site-packages\dbt\cli\main.py", line 710, in seed
    results = task.run()
              ^^^^^^^^^^
  File "C:\users\admin\crb_project\venv\Lib\site-packages\dbt\task\runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\users\admin\crb_project\venv\Lib\site-packages\dbt\task\runnable.py", line 532, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "C:\users\admin\crb_project\venv\Lib\site-packages\dbt\task\runnable.py", line 413, in execute_nodes
    self.run_queue(pool)
  File "C:\users\admin\crb_project\venv\Lib\site-packages\dbt\task\runnable.py", line 340, in run_queue
    self.job_queue.join()
  File "C:\users\admin\crb_project\venv\Lib\site-packages\dbt\graph\queue.py", line 206, in join
    self.inner.join()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

[0m21:42:47.944921 [debug] [MainThread]: Command `dbt seed` failed at 21:42:47.944921 after 791.34 seconds
[0m21:42:47.944921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002333F58DB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002333F5CC550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002333A062C10>]}
[0m21:42:47.944921 [debug] [MainThread]: Flushing usage events
[0m21:42:49.546400 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:50:02.793152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD050B7A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD0538D910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD0538C390>]}


============================== 21:50:02.793152 | 4215188c-e476-4173-a6e4-ee090ac7a4ee ==============================
[0m21:50:02.793152 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:50:02.793152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:50:03.459724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4215188c-e476-4173-a6e4-ee090ac7a4ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD05611850>]}
[0m21:50:03.535901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4215188c-e476-4173-a6e4-ee090ac7a4ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD05F5DDD0>]}
[0m21:50:03.535901 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m21:50:04.147726 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m21:50:04.415404 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:50:04.415404 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:50:04.421349 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m21:50:04.472436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4215188c-e476-4173-a6e4-ee090ac7a4ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD066F04D0>]}
[0m21:50:04.570210 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m21:50:04.577642 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m21:50:04.617991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4215188c-e476-4173-a6e4-ee090ac7a4ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD066E7710>]}
[0m21:50:04.617991 [info ] [MainThread]: Found 3 seeds, 4 models, 474 macros
[0m21:50:04.633859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4215188c-e476-4173-a6e4-ee090ac7a4ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD067AB8D0>]}
[0m21:50:04.633859 [info ] [MainThread]: 
[0m21:50:04.633859 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:50:04.640027 [info ] [MainThread]: 
[0m21:50:04.641708 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:50:04.641708 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m21:50:04.852897 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m21:50:04.852897 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m21:50:04.852897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:50:07.298603 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.447 seconds
[0m21:50:07.314210 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m21:50:07.330317 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m21:50:07.330317 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m21:50:07.335520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:50:09.213071 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.892 seconds
[0m21:50:09.228661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4215188c-e476-4173-a6e4-ee090ac7a4ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD06D4E190>]}
[0m21:50:09.245553 [debug] [Thread-1 (]: Began running node seed.crb_kpi.customers
[0m21:50:09.245553 [info ] [Thread-1 (]: 1 of 3 START seed file PUBLIC.customers ........................................ [RUN]
[0m21:50:09.250560 [debug] [Thread-1 (]: Acquiring new snowflake connection 'seed.crb_kpi.customers'
[0m21:50:09.250560 [debug] [Thread-1 (]: Began compiling node seed.crb_kpi.customers
[0m21:50:09.253172 [debug] [Thread-1 (]: Began executing node seed.crb_kpi.customers
[0m21:50:09.351556 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.customers"
[0m21:50:09.351556 [debug] [Thread-1 (]: On seed.crb_kpi.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.customers"} */
BEGIN
[0m21:50:09.351556 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:50:11.399638 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.044 seconds
[0m21:50:11.399638 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.customers"
[0m21:50:11.399638 [debug] [Thread-1 (]: On seed.crb_kpi.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.customers"} */
truncate table "CRBFITNESS"."PUBLIC"."CUSTOMERS"
  ;
[0m21:50:12.013863 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.611 seconds
[0m21:50:12.013863 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.customers"
[0m21:50:12.020384 [debug] [Thread-1 (]: On seed.crb_kpi.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.customers"} */
COMMIT
[0m21:50:12.631119 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.615 seconds
[0m21:50:12.693736 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.customers"
[0m21:50:12.693736 [debug] [Thread-1 (]: On seed.crb_kpi.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.customers"} */
BEGIN
[0m21:50:13.109403 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.425 seconds
[0m21:50:13.204521 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.customers"
[0m21:50:13.204521 [debug] [Thread-1 (]: On seed.crb_kpi.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.customers"} */
insert into CRBFITNESS.PUBLIC.customers (company, customer_id, customer_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
[0m21:50:13.637246 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0174-0004-c144-0005-db4b00018186
[0m21:50:13.637246 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 1 at position 63
invalid identifier 'CUSTOMER_NAME'
[0m21:50:13.651762 [debug] [Thread-1 (]: Database Error in seed customers (seeds\customers.csv)
  000904 (42000): SQL compilation error: error line 1 at position 63
  invalid identifier 'CUSTOMER_NAME'
[0m21:50:13.651762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4215188c-e476-4173-a6e4-ee090ac7a4ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD062067D0>]}
[0m21:50:13.651762 [error] [Thread-1 (]: 1 of 3 ERROR loading seed file PUBLIC.customers ................................ [[31mERROR[0m in 4.40s]
[0m21:50:13.664783 [debug] [Thread-1 (]: Finished running node seed.crb_kpi.customers
[0m21:50:13.664783 [debug] [Thread-1 (]: Began running node seed.crb_kpi.products
[0m21:50:13.667828 [debug] [Thread-4 (]: Marking all children of 'seed.crb_kpi.customers' to be skipped because of status 'error'.  Reason: Database Error in seed customers (seeds\customers.csv)
  000904 (42000): SQL compilation error: error line 1 at position 63
  invalid identifier 'CUSTOMER_NAME'.
[0m21:50:13.667828 [info ] [Thread-1 (]: 2 of 3 START seed file PUBLIC.products ......................................... [RUN]
[0m21:50:13.672652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.crb_kpi.customers, now seed.crb_kpi.products)
[0m21:50:13.672652 [debug] [Thread-1 (]: Began compiling node seed.crb_kpi.products
[0m21:50:13.672652 [debug] [Thread-1 (]: Began executing node seed.crb_kpi.products
[0m21:50:13.683879 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.products"
[0m21:50:13.683879 [debug] [Thread-1 (]: On seed.crb_kpi.products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.products"} */
BEGIN
[0m21:50:14.119921 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.425 seconds
[0m21:50:14.121937 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.products"
[0m21:50:14.122611 [debug] [Thread-1 (]: On seed.crb_kpi.products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.products"} */
truncate table "CRBFITNESS"."PUBLIC"."PRODUCTS"
  ;
[0m21:50:14.779485 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.658 seconds
[0m21:50:14.779485 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.products"
[0m21:50:14.784559 [debug] [Thread-1 (]: On seed.crb_kpi.products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.products"} */
COMMIT
[0m21:50:15.486859 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.712 seconds
[0m21:50:15.502431 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.products"
[0m21:50:15.502431 [debug] [Thread-1 (]: On seed.crb_kpi.products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.products"} */
BEGIN
[0m21:50:16.004408 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.502 seconds
[0m21:50:16.004408 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.products"
[0m21:50:16.004408 [debug] [Thread-1 (]: On seed.crb_kpi.products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.products"} */
insert into CRBFITNESS.PUBLIC.products (product_id, PRODUCT_Family, product_sub_family) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),...
[0m21:50:16.818426 [debug] [Thread-1 (]: SQL status: SUCCESS 119 in 0.812 seconds
[0m21:50:16.818426 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.products"
[0m21:50:16.818426 [debug] [Thread-1 (]: On seed.crb_kpi.products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.products"} */
COMMIT
[0m21:50:17.544735 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.712 seconds
[0m21:50:17.553271 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.crb_kpi.products"
[0m21:50:17.573891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4215188c-e476-4173-a6e4-ee090ac7a4ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD0743CC90>]}
[0m21:50:17.573891 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file PUBLIC.products ..................................... [[32mINSERT 119[0m in 3.90s]
[0m21:50:17.573891 [debug] [Thread-1 (]: Finished running node seed.crb_kpi.products
[0m21:50:17.586353 [debug] [Thread-1 (]: Began running node seed.crb_kpi.transactions
[0m21:50:17.588164 [info ] [Thread-1 (]: 3 of 3 START seed file PUBLIC.transactions ..................................... [RUN]
[0m21:50:17.589188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.crb_kpi.products, now seed.crb_kpi.transactions)
[0m21:50:17.589188 [debug] [Thread-1 (]: Began compiling node seed.crb_kpi.transactions
[0m21:50:17.589188 [debug] [Thread-1 (]: Began executing node seed.crb_kpi.transactions
[0m21:50:21.569865 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:50:21.584890 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:50:22.049016 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.465 seconds
[0m21:50:22.049016 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:50:22.049016 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
truncate table "CRBFITNESS"."PUBLIC"."TRANSACTIONS"
  ;
[0m21:50:22.975325 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.919 seconds
[0m21:50:22.976896 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:50:22.978461 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:50:23.883313 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.915 seconds
[0m21:50:24.400483 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:50:24.400483 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:50:24.909041 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.513 seconds
[0m21:50:47.430444 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:50:47.430444 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:50:52.074598 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 4.642 seconds
[0m21:50:52.078858 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:50:52.078858 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:50:52.869392 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.797 seconds
[0m21:50:53.386441 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:50:53.386441 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:50:53.794022 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.406 seconds
[0m21:51:36.265577 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:51:36.265577 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:51:40.745297 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 4.476 seconds
[0m21:51:40.745297 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:51:40.748981 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:51:41.314201 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.564 seconds
[0m21:51:42.207235 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:51:42.208256 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:51:42.656848 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.446 seconds
[0m21:52:22.589341 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:52:22.589341 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:52:27.098012 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 4.504 seconds
[0m21:52:27.098012 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:52:27.098012 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:52:27.797772 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.695 seconds
[0m21:52:28.613784 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:52:28.613784 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:52:29.012397 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.399 seconds
[0m21:52:58.669825 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:52:58.674845 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:53:03.240507 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 4.566 seconds
[0m21:53:03.245020 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:53:03.245020 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:53:03.930100 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.685 seconds
[0m21:53:04.771532 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:53:04.771532 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:53:05.171348 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.401 seconds
[0m21:53:44.143495 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:53:44.143495 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:53:49.019085 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 4.869 seconds
[0m21:53:49.019085 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:53:49.019085 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:53:49.739897 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.718 seconds
[0m21:53:50.589403 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:53:50.589403 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:53:51.149102 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.556 seconds
[0m21:54:29.870133 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:54:29.876149 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:54:35.091018 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.221 seconds
[0m21:54:35.101250 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:54:35.105710 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:54:36.103893 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.996 seconds
[0m21:54:36.970475 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:54:36.972626 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:54:37.741236 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.770 seconds
[0m21:55:17.639000 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:55:17.639000 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:55:22.919318 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.274 seconds
[0m21:55:22.921930 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:55:22.923731 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:55:23.993735 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.071 seconds
[0m21:55:24.909181 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:55:24.909181 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:55:25.454496 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.548 seconds
[0m21:56:05.039636 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:56:05.055381 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:56:10.534048 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.479 seconds
[0m21:56:10.538766 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:56:10.538766 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:56:11.262023 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.720 seconds
[0m21:56:12.082182 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:56:12.082182 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:56:12.542745 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.456 seconds
[0m21:56:50.160735 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:56:50.160735 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:56:55.319456 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.148 seconds
[0m21:56:55.319456 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:56:55.319456 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:56:56.186886 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.861 seconds
[0m21:56:56.859999 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:56:56.861671 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:56:57.252180 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.397 seconds
[0m21:57:35.276818 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:57:35.290830 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:57:40.684200 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.403 seconds
[0m21:57:40.684200 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:57:40.684200 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:57:41.424484 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.729 seconds
[0m21:57:42.151985 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:57:42.151985 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:57:42.560394 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.401 seconds
[0m21:58:21.021605 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:58:21.021605 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:58:26.096930 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.075 seconds
[0m21:58:26.115021 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:58:26.115021 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:58:27.038953 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.927 seconds
[0m21:58:27.856700 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:58:27.856700 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:58:28.286087 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.429 seconds
[0m21:59:10.725508 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:59:10.727053 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m21:59:16.492640 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.764 seconds
[0m21:59:16.495704 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:59:16.495704 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m21:59:17.394018 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.895 seconds
[0m21:59:18.214699 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:59:18.215220 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m21:59:18.645519 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.428 seconds
[0m21:59:58.225318 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m21:59:58.225318 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m22:00:03.861867 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.636 seconds
[0m22:00:03.861867 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m22:00:03.861867 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m22:00:04.706867 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.836 seconds
[0m22:00:05.555988 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m22:00:05.555988 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m22:00:06.020422 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.461 seconds
[0m22:00:47.410094 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m22:00:47.419021 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m22:00:52.848652 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.429 seconds
[0m22:00:52.851797 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m22:00:52.853977 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m22:00:53.495910 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.641 seconds
[0m22:00:54.302460 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m22:00:54.309144 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m22:00:54.818595 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.508 seconds
[0m22:01:35.292851 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m22:01:35.292851 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m22:01:40.668440 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.372 seconds
[0m22:01:40.668440 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m22:01:40.675335 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m22:01:41.368109 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.694 seconds
[0m22:01:42.227913 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m22:01:42.227913 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m22:01:42.668208 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.432 seconds
[0m22:02:23.276855 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m22:02:23.280359 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m22:02:28.380654 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.101 seconds
[0m22:02:28.380654 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m22:02:28.380654 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m22:02:29.446758 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.058 seconds
[0m22:02:30.280463 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m22:02:30.280463 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m22:02:30.685144 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.399 seconds
[0m22:03:09.814331 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m22:03:09.814331 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m22:03:14.872356 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.060 seconds
[0m22:03:14.880930 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m22:03:14.880930 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m22:03:15.633938 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.755 seconds
[0m22:03:16.264180 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m22:03:16.264180 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m22:03:16.804421 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.532 seconds
[0m22:03:59.785497 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m22:03:59.785497 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m22:04:05.050437 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 5.259 seconds
[0m22:04:05.051718 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m22:04:05.055234 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m22:04:06.256502 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.208 seconds
[0m22:04:06.550346 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m22:04:06.557005 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
BEGIN
[0m22:04:07.025162 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.466 seconds
[0m22:04:11.969777 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m22:04:11.969777 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
insert into CRBFITNESS.PUBLIC.transactions (customer_id, product_id, payment_month, revenue_type, revenue, quantity, dimension_1, dimension_2, dimension_3, dimension_4, dimension_5, dimension_6, dimension_7, dimension_8, dimension_9, dimension_10, companies) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m22:04:14.667369 [debug] [Thread-1 (]: SQL status: SUCCESS 3290 in 2.691 seconds
[0m22:04:14.667369 [debug] [Thread-1 (]: Using snowflake connection "seed.crb_kpi.transactions"
[0m22:04:14.667369 [debug] [Thread-1 (]: On seed.crb_kpi.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "seed.crb_kpi.transactions"} */
COMMIT
[0m22:04:15.760408 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.089 seconds
[0m22:04:15.767412 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.crb_kpi.transactions"
[0m22:04:15.775871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4215188c-e476-4173-a6e4-ee090ac7a4ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD08C66B10>]}
[0m22:04:15.777063 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file PUBLIC.transactions ................................. [[32mINSERT 183290[0m in 838.19s]
[0m22:04:15.781992 [debug] [Thread-1 (]: Finished running node seed.crb_kpi.transactions
[0m22:04:15.807380 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m22:04:15.817253 [debug] [MainThread]: Snowflake adapter: Cancelling query 'list_CRBFITNESS' (1648490052726926)
[0m22:04:15.819179 [debug] [MainThread]: Using snowflake connection "master"
[0m22:04:15.819179 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "master"} */
select system$cancel_all_queries(1648490052726926)
[0m22:04:15.820357 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:04:18.212090 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.397 seconds
[0m22:04:18.220040 [debug] [MainThread]: Snowflake adapter: Cancel query 'list_CRBFITNESS': ('0 cancelled.',)
[0m22:04:18.220040 [debug] [MainThread]: Snowflake adapter: Cancelling query 'list_CRBFITNESS_PUBLIC' (1648490052682066)
[0m22:04:18.220040 [debug] [MainThread]: Using snowflake connection "master"
[0m22:04:18.228044 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "master"} */
select system$cancel_all_queries(1648490052682066)
[0m22:04:18.754090 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.528 seconds
[0m22:04:18.760282 [debug] [MainThread]: Snowflake adapter: Cancel query 'list_CRBFITNESS_PUBLIC': ('0 cancelled.',)
[0m22:04:18.760282 [debug] [MainThread]: Snowflake adapter: Cancelling query 'seed.crb_kpi.transactions' (1648490052726930)
[0m22:04:18.763321 [debug] [MainThread]: Using snowflake connection "master"
[0m22:04:18.763956 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "master"} */
select system$cancel_all_queries(1648490052726930)
[0m22:04:19.237120 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.471 seconds
[0m22:04:19.237120 [debug] [MainThread]: Snowflake adapter: Cancel query 'seed.crb_kpi.transactions': ('0 cancelled.',)
[0m22:04:19.237120 [error] [MainThread]: CANCEL query list_CRBFITNESS ................................................... [[31mCANCEL[0m]
[0m22:04:19.252319 [error] [MainThread]: CANCEL query list_CRBFITNESS_PUBLIC ............................................ [[31mCANCEL[0m]
[0m22:04:19.264033 [error] [MainThread]: CANCEL query seed.crb_kpi.transactions ......................................... [[31mCANCEL[0m]
[0m22:04:19.275127 [info ] [MainThread]: 
[0m22:04:19.278811 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m22:04:19.280136 [info ] [MainThread]: 
[0m22:04:19.280136 [error] [MainThread]:   Database Error in seed customers (seeds\customers.csv)
  000904 (42000): SQL compilation error: error line 1 at position 63
  invalid identifier 'CUSTOMER_NAME'
[0m22:04:19.280136 [info ] [MainThread]: 
[0m22:04:19.288148 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:04:19.289266 [debug] [MainThread]: Connection 'master' was left open.
[0m22:04:19.289266 [debug] [MainThread]: On master: Close
[0m22:04:19.933909 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m22:04:19.941950 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m22:04:22.442407 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m22:04:22.442407 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m22:04:24.490403 [debug] [MainThread]: Connection 'seed.crb_kpi.transactions' was left open.
[0m22:04:24.495501 [debug] [MainThread]: On seed.crb_kpi.transactions: Close
[0m22:04:25.208148 [info ] [MainThread]: 
[0m22:04:25.208148 [info ] [MainThread]: Finished running 3 seeds in 0 hours 14 minutes and 20.57 seconds (860.57s).
[0m22:04:25.208148 [error] [MainThread]: Encountered an error:

[0m22:04:25.222978 [error] [MainThread]: Traceback (most recent call last):
  File "C:\users\admin\crb_project\venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\users\admin\crb_project\venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\users\admin\crb_project\venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\users\admin\crb_project\venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\users\admin\crb_project\venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\users\admin\crb_project\venv\Lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\users\admin\crb_project\venv\Lib\site-packages\dbt\cli\main.py", line 710, in seed
    results = task.run()
              ^^^^^^^^^^
  File "C:\users\admin\crb_project\venv\Lib\site-packages\dbt\task\runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\users\admin\crb_project\venv\Lib\site-packages\dbt\task\runnable.py", line 532, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "C:\users\admin\crb_project\venv\Lib\site-packages\dbt\task\runnable.py", line 413, in execute_nodes
    self.run_queue(pool)
  File "C:\users\admin\crb_project\venv\Lib\site-packages\dbt\task\runnable.py", line 340, in run_queue
    self.job_queue.join()
  File "C:\users\admin\crb_project\venv\Lib\site-packages\dbt\graph\queue.py", line 206, in join
    self.inner.join()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

[0m22:04:25.232515 [debug] [MainThread]: Command `dbt seed` failed at 22:04:25.224490 after 862.58 seconds
[0m22:04:25.236562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD0538C390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCFFE62BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCFFE62D10>]}
[0m22:04:25.236562 [debug] [MainThread]: Flushing usage events
[0m22:04:26.751914 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:55:00.132499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238CD08FBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238CCCAE850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238CD0E2E90>]}


============================== 00:55:00.172499 | a1630de1-d306-466c-9b18-8a0997153e4f ==============================
[0m00:55:00.172499 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:55:00.177657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:55:07.698981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1630de1-d306-466c-9b18-8a0997153e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238CD0B20D0>]}
[0m00:55:07.807639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1630de1-d306-466c-9b18-8a0997153e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238CDC5DB90>]}
[0m00:55:07.823033 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m00:55:09.637928 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:55:13.558072 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 4 files changed.
[0m00:55:13.563591 [debug] [MainThread]: Partial parsing: deleted file: crb_kpi://seeds\products.csv
[0m00:55:13.563591 [debug] [MainThread]: Partial parsing: deleted file: crb_kpi://seeds\customers.csv
[0m00:55:13.570168 [debug] [MainThread]: Partial parsing: deleted file: crb_kpi://seeds\transactions.csv
[0m00:55:13.572088 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_products.sql
[0m00:55:13.572088 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\customer_revenue_bridge.sql
[0m00:55:13.572088 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_transactions.sql
[0m00:55:13.572088 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_customers.sql
[0m00:55:14.107771 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m00:55:14.115117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1630de1-d306-466c-9b18-8a0997153e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238CE5C1010>]}
[0m00:55:14.207842 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m00:55:14.257691 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m00:55:14.820217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1630de1-d306-466c-9b18-8a0997153e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238CE740590>]}
[0m00:55:14.823242 [info ] [MainThread]: Found 4 models, 474 macros
[0m00:55:14.823242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1630de1-d306-466c-9b18-8a0997153e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238CE62C090>]}
[0m00:55:14.837347 [info ] [MainThread]: 
[0m00:55:14.841824 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:55:14.841824 [info ] [MainThread]: 
[0m00:55:14.851559 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:55:14.876303 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m00:55:20.892105 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m00:55:20.892105 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m00:55:20.892105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:23.878042 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.982 seconds
[0m00:55:23.884801 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m00:55:23.902561 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m00:55:23.902561 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m00:55:23.907772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:25.767942 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.862 seconds
[0m00:55:25.778119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1630de1-d306-466c-9b18-8a0997153e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238CE406790>]}
[0m00:55:25.802912 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m00:55:25.802912 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.customer_revenue_bridge ..................... [RUN]
[0m00:55:25.807935 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.customer_revenue_bridge'
[0m00:55:25.807935 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.customer_revenue_bridge
[0m00:55:25.828620 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.customer_revenue_bridge"
[0m00:55:25.838539 [debug] [Thread-1 (]: Began executing node model.crb_kpi.customer_revenue_bridge
[0m00:55:25.937708 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.customer_revenue_bridge"
[0m00:55:25.956384 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.customer_revenue_bridge"
[0m00:55:25.957971 [debug] [Thread-1 (]: On model.crb_kpi.customer_revenue_bridge: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.customer_revenue_bridge"} */
create or replace   view CRBFITNESS.PUBLIC.customer_revenue_bridge
  
   as (
    WITH transaction_summary AS (
    SELECT 
        t.customer_id,
        c.customer_name_clean,
        p.product_family_clean,
        SUM(t.revenue) AS total_revenue,
        COUNT(DISTINCT t.payment_month) AS active_months,
        MIN(t.payment_month) AS first_transaction_month,
        MAX(t.payment_month) AS last_transaction_month
    FROM staging.stg_transactions t
    LEFT JOIN staging.stg_customers c ON t.customer_id = c.customer_id
    LEFT JOIN staging.stg_products p ON t.product_id = p.product_id
    GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
),

new_customers AS (
    SELECT 
        customer_id, 
        MIN(first_transaction_month) AS first_payment_month  
    FROM transaction_summary
    GROUP BY customer_id
),

churned_customers AS (
    SELECT 
        customer_id, 
        customer_name_clean,
        last_transaction_month
    FROM transaction_summary
    WHERE last_transaction_month < DATEADD(MONTH, -6, CURRENT_DATE)
),

cross_sell_customers AS (
    SELECT 
        customer_id, 
        customer_name_clean,
        COUNT(DISTINCT product_family_clean) AS unique_product_families
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
    HAVING COUNT(DISTINCT product_family_clean) > 1
),

product_churn AS (
    SELECT 
        product_family_clean,
        COUNT(DISTINCT customer_id) AS customer_count,
        LAG(customer_count) OVER (
            PARTITION BY product_family_clean 
            ORDER BY first_transaction_month
        ) AS prev_customer_count,
        customer_count - LAG(customer_count) OVER (
            PARTITION BY product_family_clean 
            ORDER BY first_transaction_month
        ) AS customer_loss
    FROM transaction_summary
),

revenue_metrics AS (
    SELECT 
        SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS current_revenue,
        SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS previous_revenue,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         NULLIF(SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END), 0)) AS NRR,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         NULLIF(SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END), 0)) AS GRR
    FROM transaction_summary
),

lost_revenue AS (
    SELECT 
        SUM(total_revenue) AS lost_revenue
    FROM transaction_summary
    WHERE customer_id IN (SELECT customer_id FROM churned_customers)
),

ranked_products AS (
    SELECT 
        product_family_clean,
        SUM(total_revenue) AS product_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY product_family_clean
),

ranked_customers AS (
    SELECT 
        customer_id,
        customer_name_clean,
        SUM(total_revenue) AS customer_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
)

SELECT * FROM new_customers
UNION ALL
SELECT * FROM churned_customers
UNION ALL
SELECT * FROM cross_sell_customers
UNION ALL
SELECT * FROM product_churn
UNION ALL
SELECT * FROM revenue_metrics
UNION ALL
SELECT * FROM lost_revenue
UNION ALL
SELECT * FROM ranked_products
UNION ALL
SELECT * FROM ranked_customers;
[0m00:55:25.957971 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:55:28.138007 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb022d-0004-c0bd-0005-db4b0001733a
[0m00:55:28.139028 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 112 at position 30 unexpected ';'.
[0m00:55:28.152669 [debug] [Thread-1 (]: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  001003 (42000): SQL compilation error:
  syntax error line 112 at position 30 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m00:55:28.174680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1630de1-d306-466c-9b18-8a0997153e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238CEDE73D0>]}
[0m00:55:28.177977 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model PUBLIC.customer_revenue_bridge ............ [[31mERROR[0m in 2.35s]
[0m00:55:28.182590 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m00:55:28.185591 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m00:55:28.189456 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.customer_revenue_bridge' to be skipped because of status 'error'.  Reason: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  001003 (42000): SQL compilation error:
  syntax error line 112 at position 30 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql.
[0m00:55:28.190771 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m00:55:28.195296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.customer_revenue_bridge, now model.crb_kpi.stg_customers)
[0m00:55:28.195296 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m00:55:28.197914 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m00:55:28.203579 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m00:55:28.207979 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m00:55:28.207979 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m00:55:28.218133 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM staging.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean
FROM raw;
[0m00:55:28.589538 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb022d-0004-bde4-0000-0005db4bf40d
[0m00:55:28.590091 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 8 unexpected ';'.
[0m00:55:28.596179 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql
[0m00:55:28.597697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1630de1-d306-466c-9b18-8a0997153e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238CEDD80D0>]}
[0m00:55:28.598787 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model PUBLIC.stg_customers ...................... [[31mERROR[0m in 0.41s]
[0m00:55:28.602086 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m00:55:28.603282 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m00:55:28.604303 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql.
[0m00:55:28.604303 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m00:55:28.609801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m00:55:28.611551 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m00:55:28.614287 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m00:55:28.617916 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m00:55:28.620720 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m00:55:28.627970 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m00:55:28.629386 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM staging.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw;
[0m00:55:28.978145 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb022d-0004-bb9d-0000-0005db4bdd2d
[0m00:55:28.979669 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 8 unexpected ';'.
[0m00:55:28.995669 [debug] [Thread-1 (]: Database Error in model stg_products (models\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql
[0m00:55:28.999095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1630de1-d306-466c-9b18-8a0997153e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238CEDC6750>]}
[0m00:55:29.000025 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model PUBLIC.stg_products ....................... [[31mERROR[0m in 0.39s]
[0m00:55:29.005493 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m00:55:29.005493 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m00:55:29.008137 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_products (models\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql.
[0m00:55:29.008137 [info ] [Thread-1 (]: 4 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m00:55:29.012174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m00:55:29.012174 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m00:55:29.019782 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m00:55:29.019782 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m00:55:29.048058 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m00:55:29.064144 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m00:55:29.064144 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM staging.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw;
[0m00:55:29.621945 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb022d-0004-c144-0005-db4b000182c6
[0m00:55:29.627966 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 8 unexpected ';'.
[0m00:55:29.638741 [debug] [Thread-1 (]: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql
[0m00:55:29.641353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1630de1-d306-466c-9b18-8a0997153e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238CF18BDD0>]}
[0m00:55:29.641353 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model PUBLIC.stg_transactions ................... [[31mERROR[0m in 0.63s]
[0m00:55:29.648863 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m00:55:29.653935 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_transactions' to be skipped because of status 'error'.  Reason: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql.
[0m00:55:29.663065 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:55:29.664719 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m00:55:29.667028 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m00:55:30.328020 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m00:55:30.328020 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m00:55:30.961333 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m00:55:30.967851 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m00:55:31.615936 [info ] [MainThread]: 
[0m00:55:31.617947 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 16.76 seconds (16.76s).
[0m00:55:31.620769 [debug] [MainThread]: Command end result
[0m00:55:31.684364 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m00:55:31.691486 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m00:55:31.701823 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m00:55:31.707998 [info ] [MainThread]: 
[0m00:55:31.710129 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m00:55:31.710129 [info ] [MainThread]: 
[0m00:55:31.710129 [error] [MainThread]:   Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  001003 (42000): SQL compilation error:
  syntax error line 112 at position 30 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m00:55:31.717731 [info ] [MainThread]: 
[0m00:55:31.719530 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql
[0m00:55:31.724565 [info ] [MainThread]: 
[0m00:55:31.727927 [error] [MainThread]:   Database Error in model stg_products (models\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql
[0m00:55:31.735130 [info ] [MainThread]: 
[0m00:55:31.738509 [error] [MainThread]:   Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql
[0m00:55:31.741971 [info ] [MainThread]: 
[0m00:55:31.743799 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:55:31.747112 [debug] [MainThread]: Command `dbt run` failed at 00:55:31.747112 after 31.85 seconds
[0m00:55:31.748128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238C7C12C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238CCCAF310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238C7C92E90>]}
[0m00:55:31.748128 [debug] [MainThread]: Flushing usage events
[0m00:55:33.018134 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:56:06.158024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201BB18C490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201BB1E1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201BB1E26D0>]}


============================== 00:56:06.167803 | 0859bee0-8652-4dca-bc13-a46e52896c13 ==============================
[0m00:56:06.167803 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:56:06.169542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:56:06.977498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0859bee0-8652-4dca-bc13-a46e52896c13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201BC0A3910>]}
[0m00:56:07.057560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0859bee0-8652-4dca-bc13-a46e52896c13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201BBD5DA90>]}
[0m00:56:07.069345 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m00:56:07.880877 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:56:08.148625 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m00:56:08.148625 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_transactions.sql
[0m00:56:08.157641 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_customers.sql
[0m00:56:08.157641 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_products.sql
[0m00:56:08.557756 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m00:56:08.557756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0859bee0-8652-4dca-bc13-a46e52896c13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201BC901250>]}
[0m00:56:08.709237 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m00:56:08.717760 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m00:56:08.757602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0859bee0-8652-4dca-bc13-a46e52896c13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201BCA2F390>]}
[0m00:56:08.767646 [info ] [MainThread]: Found 4 models, 474 macros
[0m00:56:08.769647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0859bee0-8652-4dca-bc13-a46e52896c13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201BC9BEA90>]}
[0m00:56:08.772688 [info ] [MainThread]: 
[0m00:56:08.772688 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:56:08.780123 [info ] [MainThread]: 
[0m00:56:08.782888 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:56:08.787984 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m00:56:09.049590 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m00:56:09.057646 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m00:56:09.057701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:56:11.071996 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.013 seconds
[0m00:56:11.072047 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m00:56:11.097694 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m00:56:11.097694 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m00:56:11.097694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:56:12.877578 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.777 seconds
[0m00:56:12.882635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0859bee0-8652-4dca-bc13-a46e52896c13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201BC0B27D0>]}
[0m00:56:12.895664 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m00:56:12.897693 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.customer_revenue_bridge ..................... [RUN]
[0m00:56:12.899331 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.customer_revenue_bridge'
[0m00:56:12.899331 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.customer_revenue_bridge
[0m00:56:12.919908 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.customer_revenue_bridge"
[0m00:56:12.926502 [debug] [Thread-1 (]: Began executing node model.crb_kpi.customer_revenue_bridge
[0m00:56:12.987960 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.customer_revenue_bridge"
[0m00:56:12.992544 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.customer_revenue_bridge"
[0m00:56:12.997601 [debug] [Thread-1 (]: On model.crb_kpi.customer_revenue_bridge: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.customer_revenue_bridge"} */
create or replace   view CRBFITNESS.PUBLIC.customer_revenue_bridge
  
   as (
    WITH transaction_summary AS (
    SELECT 
        t.customer_id,
        c.customer_name_clean,
        p.product_family_clean,
        SUM(t.revenue) AS total_revenue,
        COUNT(DISTINCT t.payment_month) AS active_months,
        MIN(t.payment_month) AS first_transaction_month,
        MAX(t.payment_month) AS last_transaction_month
    FROM staging.stg_transactions t
    LEFT JOIN staging.stg_customers c ON t.customer_id = c.customer_id
    LEFT JOIN staging.stg_products p ON t.product_id = p.product_id
    GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
),

new_customers AS (
    SELECT 
        customer_id, 
        MIN(first_transaction_month) AS first_payment_month  
    FROM transaction_summary
    GROUP BY customer_id
),

churned_customers AS (
    SELECT 
        customer_id, 
        customer_name_clean,
        last_transaction_month
    FROM transaction_summary
    WHERE last_transaction_month < DATEADD(MONTH, -6, CURRENT_DATE)
),

cross_sell_customers AS (
    SELECT 
        customer_id, 
        customer_name_clean,
        COUNT(DISTINCT product_family_clean) AS unique_product_families
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
    HAVING COUNT(DISTINCT product_family_clean) > 1
),

product_churn AS (
    SELECT 
        product_family_clean,
        COUNT(DISTINCT customer_id) AS customer_count,
        LAG(customer_count) OVER (
            PARTITION BY product_family_clean 
            ORDER BY first_transaction_month
        ) AS prev_customer_count,
        customer_count - LAG(customer_count) OVER (
            PARTITION BY product_family_clean 
            ORDER BY first_transaction_month
        ) AS customer_loss
    FROM transaction_summary
),

revenue_metrics AS (
    SELECT 
        SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS current_revenue,
        SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS previous_revenue,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         NULLIF(SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END), 0)) AS NRR,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         NULLIF(SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END), 0)) AS GRR
    FROM transaction_summary
),

lost_revenue AS (
    SELECT 
        SUM(total_revenue) AS lost_revenue
    FROM transaction_summary
    WHERE customer_id IN (SELECT customer_id FROM churned_customers)
),

ranked_products AS (
    SELECT 
        product_family_clean,
        SUM(total_revenue) AS product_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY product_family_clean
),

ranked_customers AS (
    SELECT 
        customer_id,
        customer_name_clean,
        SUM(total_revenue) AS customer_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
)

SELECT * FROM new_customers
UNION ALL
SELECT * FROM churned_customers
UNION ALL
SELECT * FROM cross_sell_customers
UNION ALL
SELECT * FROM product_churn
UNION ALL
SELECT * FROM revenue_metrics
UNION ALL
SELECT * FROM lost_revenue
UNION ALL
SELECT * FROM ranked_products
UNION ALL
SELECT * FROM ranked_customers;
[0m00:56:12.997601 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:56:14.772520 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb022e-0004-c144-0005-db4b000182ca
[0m00:56:14.772520 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 112 at position 30 unexpected ';'.
[0m00:56:14.781119 [debug] [Thread-1 (]: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  001003 (42000): SQL compilation error:
  syntax error line 112 at position 30 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m00:56:14.787802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0859bee0-8652-4dca-bc13-a46e52896c13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201BD0486D0>]}
[0m00:56:14.787802 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model PUBLIC.customer_revenue_bridge ............ [[31mERROR[0m in 1.88s]
[0m00:56:14.787802 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m00:56:14.793366 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m00:56:14.797461 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.customer_revenue_bridge' to be skipped because of status 'error'.  Reason: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  001003 (42000): SQL compilation error:
  syntax error line 112 at position 30 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql.
[0m00:56:14.795517 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m00:56:14.801655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.customer_revenue_bridge, now model.crb_kpi.stg_customers)
[0m00:56:14.803373 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m00:56:14.812875 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m00:56:14.815046 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m00:56:14.824600 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m00:56:14.827620 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m00:56:14.827620 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM staging.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean
FROM raw
  );
[0m00:56:15.197865 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb022e-0004-bde4-0000-0005db4bf415
[0m00:56:15.197865 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'CRBFITNESS.STAGING' does not exist or not authorized.
[0m00:56:15.197865 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (02000): SQL compilation error:
  Schema 'CRBFITNESS.STAGING' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql
[0m00:56:15.207816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0859bee0-8652-4dca-bc13-a46e52896c13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201BD0CAB10>]}
[0m00:56:15.207816 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model PUBLIC.stg_customers ...................... [[31mERROR[0m in 0.41s]
[0m00:56:15.210505 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m00:56:15.212017 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m00:56:15.212017 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (02000): SQL compilation error:
  Schema 'CRBFITNESS.STAGING' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql.
[0m00:56:15.214275 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m00:56:15.215598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m00:56:15.216919 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m00:56:15.219863 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m00:56:15.222130 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m00:56:15.228499 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m00:56:15.229269 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m00:56:15.229269 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM staging.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m00:56:15.580659 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb022e-0004-c144-0005-db4b000182ce
[0m00:56:15.580659 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'CRBFITNESS.STAGING' does not exist or not authorized.
[0m00:56:15.595591 [debug] [Thread-1 (]: Database Error in model stg_products (models\staging\stg_products.sql)
  002003 (02000): SQL compilation error:
  Schema 'CRBFITNESS.STAGING' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql
[0m00:56:15.595591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0859bee0-8652-4dca-bc13-a46e52896c13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201BD0F1110>]}
[0m00:56:15.599574 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model PUBLIC.stg_products ....................... [[31mERROR[0m in 0.38s]
[0m00:56:15.599574 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m00:56:15.599574 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m00:56:15.599574 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_products (models\staging\stg_products.sql)
  002003 (02000): SQL compilation error:
  Schema 'CRBFITNESS.STAGING' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql.
[0m00:56:15.605558 [info ] [Thread-1 (]: 4 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m00:56:15.609708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m00:56:15.612644 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m00:56:15.617939 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m00:56:15.620180 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m00:56:15.628127 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m00:56:15.629931 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m00:56:15.629931 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM staging.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m00:56:15.997763 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb022e-0004-c178-0005-db4b0001918e
[0m00:56:15.997763 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'CRBFITNESS.STAGING' does not exist or not authorized.
[0m00:56:16.007915 [debug] [Thread-1 (]: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  002003 (02000): SQL compilation error:
  Schema 'CRBFITNESS.STAGING' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql
[0m00:56:16.007915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0859bee0-8652-4dca-bc13-a46e52896c13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201BD0ECF50>]}
[0m00:56:16.007915 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model PUBLIC.stg_transactions ................... [[31mERROR[0m in 0.40s]
[0m00:56:16.007915 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m00:56:16.007915 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_transactions' to be skipped because of status 'error'.  Reason: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  002003 (02000): SQL compilation error:
  Schema 'CRBFITNESS.STAGING' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql.
[0m00:56:16.019511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:56:16.020064 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m00:56:16.022252 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m00:56:16.643861 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m00:56:16.643861 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m00:56:17.318376 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m00:56:17.323418 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m00:56:17.997980 [info ] [MainThread]: 
[0m00:56:18.001627 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 9.22 seconds (9.22s).
[0m00:56:18.007593 [debug] [MainThread]: Command end result
[0m00:56:18.062477 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m00:56:18.078834 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m00:56:18.092392 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m00:56:18.092392 [info ] [MainThread]: 
[0m00:56:18.094862 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m00:56:18.094862 [info ] [MainThread]: 
[0m00:56:18.099072 [error] [MainThread]:   Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  001003 (42000): SQL compilation error:
  syntax error line 112 at position 30 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m00:56:18.108345 [info ] [MainThread]: 
[0m00:56:18.111581 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (02000): SQL compilation error:
  Schema 'CRBFITNESS.STAGING' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql
[0m00:56:18.114555 [info ] [MainThread]: 
[0m00:56:18.117666 [error] [MainThread]:   Database Error in model stg_products (models\staging\stg_products.sql)
  002003 (02000): SQL compilation error:
  Schema 'CRBFITNESS.STAGING' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql
[0m00:56:18.123819 [info ] [MainThread]: 
[0m00:56:18.124835 [error] [MainThread]:   Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  002003 (02000): SQL compilation error:
  Schema 'CRBFITNESS.STAGING' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql
[0m00:56:18.128340 [info ] [MainThread]: 
[0m00:56:18.131913 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:56:18.131913 [debug] [MainThread]: Command `dbt run` failed at 00:56:18.131913 after 12.16 seconds
[0m00:56:18.131913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201BB1C8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B5C62C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201BB1EE9D0>]}
[0m00:56:18.137853 [debug] [MainThread]: Flushing usage events
[0m00:56:19.355885 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:57:26.001341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D4D8FC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D4D8D010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D4D8D490>]}


============================== 00:57:26.009410 | 56ca6f91-f0ae-44bf-a7a3-5a3546e0f6ed ==============================
[0m00:57:26.009410 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:57:26.017628 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:57:26.929259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56ca6f91-f0ae-44bf-a7a3-5a3546e0f6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D4DE3490>]}
[0m00:57:27.045739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56ca6f91-f0ae-44bf-a7a3-5a3546e0f6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D595DB50>]}
[0m00:57:27.047261 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m00:57:28.137629 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:57:28.430334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:57:28.430334 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:57:28.447328 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m00:57:28.503923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56ca6f91-f0ae-44bf-a7a3-5a3546e0f6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D5CDF690>]}
[0m00:57:28.628415 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m00:57:28.637317 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m00:57:28.692718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56ca6f91-f0ae-44bf-a7a3-5a3546e0f6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D602FF10>]}
[0m00:57:28.697236 [info ] [MainThread]: Found 4 models, 474 macros
[0m00:57:28.700947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56ca6f91-f0ae-44bf-a7a3-5a3546e0f6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D5C1F410>]}
[0m00:57:28.703219 [info ] [MainThread]: 
[0m00:57:28.707660 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:57:28.709223 [info ] [MainThread]: 
[0m00:57:28.709223 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:57:28.727546 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m00:57:28.932139 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m00:57:28.932139 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m00:57:28.937398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:57:31.128973 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.195 seconds
[0m00:57:31.147680 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m00:57:31.182366 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m00:57:31.182366 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m00:57:31.187390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:57:33.489568 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.301 seconds
[0m00:57:33.502389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56ca6f91-f0ae-44bf-a7a3-5a3546e0f6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D46DA310>]}
[0m00:57:33.510463 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m00:57:33.510463 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.customer_revenue_bridge ..................... [RUN]
[0m00:57:33.518919 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.customer_revenue_bridge'
[0m00:57:33.522441 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.customer_revenue_bridge
[0m00:57:33.547577 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.customer_revenue_bridge"
[0m00:57:33.552632 [debug] [Thread-1 (]: Began executing node model.crb_kpi.customer_revenue_bridge
[0m00:57:33.610975 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.customer_revenue_bridge"
[0m00:57:33.626839 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.customer_revenue_bridge"
[0m00:57:33.627418 [debug] [Thread-1 (]: On model.crb_kpi.customer_revenue_bridge: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.customer_revenue_bridge"} */
create or replace   view CRBFITNESS.PUBLIC.customer_revenue_bridge
  
   as (
    WITH transaction_summary AS (
    SELECT 
        t.customer_id,
        c.customer_name_clean,
        p.product_family_clean,
        SUM(t.revenue) AS total_revenue,
        COUNT(DISTINCT t.payment_month) AS active_months,
        MIN(t.payment_month) AS first_transaction_month,
        MAX(t.payment_month) AS last_transaction_month
    FROM staging.stg_transactions t
    LEFT JOIN staging.stg_customers c ON t.customer_id = c.customer_id
    LEFT JOIN staging.stg_products p ON t.product_id = p.product_id
    GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
),

new_customers AS (
    SELECT 
        customer_id, 
        MIN(first_transaction_month) AS first_payment_month  
    FROM transaction_summary
    GROUP BY customer_id
),

churned_customers AS (
    SELECT 
        customer_id, 
        customer_name_clean,
        last_transaction_month
    FROM transaction_summary
    WHERE last_transaction_month < DATEADD(MONTH, -6, CURRENT_DATE)
),

cross_sell_customers AS (
    SELECT 
        customer_id, 
        customer_name_clean,
        COUNT(DISTINCT product_family_clean) AS unique_product_families
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
    HAVING COUNT(DISTINCT product_family_clean) > 1
),

product_churn AS (
    SELECT 
        product_family_clean,
        COUNT(DISTINCT customer_id) AS customer_count,
        LAG(customer_count) OVER (
            PARTITION BY product_family_clean 
            ORDER BY first_transaction_month
        ) AS prev_customer_count,
        customer_count - LAG(customer_count) OVER (
            PARTITION BY product_family_clean 
            ORDER BY first_transaction_month
        ) AS customer_loss
    FROM transaction_summary
),

revenue_metrics AS (
    SELECT 
        SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS current_revenue,
        SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS previous_revenue,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         NULLIF(SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END), 0)) AS NRR,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         NULLIF(SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END), 0)) AS GRR
    FROM transaction_summary
),

lost_revenue AS (
    SELECT 
        SUM(total_revenue) AS lost_revenue
    FROM transaction_summary
    WHERE customer_id IN (SELECT customer_id FROM churned_customers)
),

ranked_products AS (
    SELECT 
        product_family_clean,
        SUM(total_revenue) AS product_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY product_family_clean
),

ranked_customers AS (
    SELECT 
        customer_id,
        customer_name_clean,
        SUM(total_revenue) AS customer_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
)

SELECT * FROM new_customers
UNION ALL
SELECT * FROM churned_customers
UNION ALL
SELECT * FROM cross_sell_customers
UNION ALL
SELECT * FROM product_churn
UNION ALL
SELECT * FROM revenue_metrics
UNION ALL
SELECT * FROM lost_revenue
UNION ALL
SELECT * FROM ranked_products
UNION ALL
SELECT * FROM ranked_customers;
[0m00:57:33.627418 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:57:35.377617 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb022f-0004-c178-0005-db4b000191d2
[0m00:57:35.381448 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 112 at position 30 unexpected ';'.
[0m00:57:35.387430 [debug] [Thread-1 (]: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  001003 (42000): SQL compilation error:
  syntax error line 112 at position 30 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m00:57:35.393764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56ca6f91-f0ae-44bf-a7a3-5a3546e0f6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D64D3810>]}
[0m00:57:35.397353 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model PUBLIC.customer_revenue_bridge ............ [[31mERROR[0m in 1.87s]
[0m00:57:35.401631 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m00:57:35.401631 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m00:57:35.401631 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.customer_revenue_bridge' to be skipped because of status 'error'.  Reason: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  001003 (42000): SQL compilation error:
  syntax error line 112 at position 30 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql.
[0m00:57:35.409272 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m00:57:35.409272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.customer_revenue_bridge, now model.crb_kpi.stg_customers)
[0m00:57:35.417468 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m00:57:35.417468 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m00:57:35.417468 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m00:57:35.427632 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m00:57:35.434204 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m00:57:35.437718 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM staging.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean
FROM raw
  );
[0m00:57:35.797399 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb022f-0004-c0bd-0005-db4b0001734e
[0m00:57:35.804265 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CRBFITNESS.STAGING.CUSTOMERS' does not exist or not authorized.
[0m00:57:35.811405 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.STAGING.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql
[0m00:57:35.811405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56ca6f91-f0ae-44bf-a7a3-5a3546e0f6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D6C1F2D0>]}
[0m00:57:35.817428 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model PUBLIC.stg_customers ...................... [[31mERROR[0m in 0.40s]
[0m00:57:35.819519 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m00:57:35.819519 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m00:57:35.826052 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.STAGING.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql.
[0m00:57:35.828293 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m00:57:35.829973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m00:57:35.829973 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m00:57:35.837672 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m00:57:35.848357 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m00:57:35.852981 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m00:57:35.863727 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m00:57:35.863727 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM staging.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m00:57:36.230853 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb022f-0004-bde4-0000-0005db4bf441
[0m00:57:36.230853 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CRBFITNESS.STAGING.PRODUCTS' does not exist or not authorized.
[0m00:57:36.238936 [debug] [Thread-1 (]: Database Error in model stg_products (models\staging\stg_products.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.STAGING.PRODUCTS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql
[0m00:57:36.248746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56ca6f91-f0ae-44bf-a7a3-5a3546e0f6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D6C451D0>]}
[0m00:57:36.248746 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model PUBLIC.stg_products ....................... [[31mERROR[0m in 0.42s]
[0m00:57:36.248746 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m00:57:36.248746 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m00:57:36.255891 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_products (models\staging\stg_products.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.STAGING.PRODUCTS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql.
[0m00:57:36.257712 [info ] [Thread-1 (]: 4 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m00:57:36.260291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m00:57:36.260291 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m00:57:36.267407 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m00:57:36.273362 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m00:57:36.280749 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m00:57:36.288957 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m00:57:36.288957 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM staging.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m00:57:36.693206 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb022f-0004-bb9d-0000-0005db4bdd61
[0m00:57:36.697014 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CRBFITNESS.STAGING.TRANSACTIONS' does not exist or not authorized.
[0m00:57:36.701471 [debug] [Thread-1 (]: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.STAGING.TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql
[0m00:57:36.707739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56ca6f91-f0ae-44bf-a7a3-5a3546e0f6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D6DBA0D0>]}
[0m00:57:36.710662 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model PUBLIC.stg_transactions ................... [[31mERROR[0m in 0.45s]
[0m00:57:36.712004 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m00:57:36.712004 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_transactions' to be skipped because of status 'error'.  Reason: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.STAGING.TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql.
[0m00:57:36.717581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:57:36.717581 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m00:57:36.717581 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m00:57:37.363394 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m00:57:37.363394 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m00:57:37.997740 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m00:57:38.002790 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m00:57:38.639448 [info ] [MainThread]: 
[0m00:57:38.662617 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 9.93 seconds (9.93s).
[0m00:57:38.664632 [debug] [MainThread]: Command end result
[0m00:57:38.705840 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m00:57:38.707432 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m00:57:38.732129 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m00:57:38.732129 [info ] [MainThread]: 
[0m00:57:38.737698 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m00:57:38.739212 [info ] [MainThread]: 
[0m00:57:38.739212 [error] [MainThread]:   Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  001003 (42000): SQL compilation error:
  syntax error line 112 at position 30 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m00:57:38.747359 [info ] [MainThread]: 
[0m00:57:38.751520 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.STAGING.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql
[0m00:57:38.751520 [info ] [MainThread]: 
[0m00:57:38.751520 [error] [MainThread]:   Database Error in model stg_products (models\staging\stg_products.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.STAGING.PRODUCTS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql
[0m00:57:38.755764 [info ] [MainThread]: 
[0m00:57:38.757277 [error] [MainThread]:   Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.STAGING.TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql
[0m00:57:38.758662 [info ] [MainThread]: 
[0m00:57:38.758662 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:57:38.763687 [debug] [MainThread]: Command `dbt run` failed at 00:57:38.763687 after 12.92 seconds
[0m00:57:38.767255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D4DE2390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D4DEE990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D4A4F6D0>]}
[0m00:57:38.767255 [debug] [MainThread]: Flushing usage events
[0m00:57:40.057752 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:58:23.010111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A312588690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3125E23D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3125C8410>]}


============================== 00:58:23.018210 | 3f004d88-8f8a-4c13-9ab1-998b6d46c49a ==============================
[0m00:58:23.018210 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:58:23.018210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:58:23.799248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f004d88-8f8a-4c13-9ab1-998b6d46c49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A31280DC50>]}
[0m00:58:23.922110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f004d88-8f8a-4c13-9ab1-998b6d46c49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3114AF0D0>]}
[0m00:58:23.925547 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m00:58:24.697345 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:58:24.917452 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:58:24.920412 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\customer_revenue_bridge.sql
[0m00:58:25.297038 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m00:58:25.307213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f004d88-8f8a-4c13-9ab1-998b6d46c49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A313D58BD0>]}
[0m00:58:25.457420 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m00:58:25.467367 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m00:58:25.509899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f004d88-8f8a-4c13-9ab1-998b6d46c49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A313C716D0>]}
[0m00:58:25.509899 [info ] [MainThread]: Found 4 models, 474 macros
[0m00:58:25.509899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f004d88-8f8a-4c13-9ab1-998b6d46c49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A313D39F50>]}
[0m00:58:25.517340 [info ] [MainThread]: 
[0m00:58:25.518381 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:58:25.518381 [info ] [MainThread]: 
[0m00:58:25.522402 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:58:25.532630 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m00:58:25.757437 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m00:58:25.757437 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m00:58:25.757437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:58:27.900313 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.138 seconds
[0m00:58:27.907124 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m00:58:27.917328 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m00:58:27.926046 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m00:58:27.927035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:58:29.721088 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.795 seconds
[0m00:58:29.727523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f004d88-8f8a-4c13-9ab1-998b6d46c49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A313965E10>]}
[0m00:58:29.737704 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m00:58:29.737704 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.customer_revenue_bridge ..................... [RUN]
[0m00:58:29.737704 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.customer_revenue_bridge'
[0m00:58:29.737704 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.customer_revenue_bridge
[0m00:58:29.749062 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.customer_revenue_bridge"
[0m00:58:29.749062 [debug] [Thread-1 (]: Began executing node model.crb_kpi.customer_revenue_bridge
[0m00:58:29.803068 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.customer_revenue_bridge"
[0m00:58:29.812613 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.customer_revenue_bridge"
[0m00:58:29.812613 [debug] [Thread-1 (]: On model.crb_kpi.customer_revenue_bridge: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.customer_revenue_bridge"} */
create or replace   view CRBFITNESS.PUBLIC.customer_revenue_bridge
  
   as (
    WITH transaction_summary AS (
    SELECT 
        t.customer_id,
        c.customer_name_clean,
        p.product_family_clean,
        SUM(t.revenue) AS total_revenue,
        COUNT(DISTINCT t.payment_month) AS active_months,
        MIN(t.payment_month) AS first_transaction_month,
        MAX(t.payment_month) AS last_transaction_month
    FROM staging.stg_transactions t
    LEFT JOIN staging.stg_customers c ON t.customer_id = c.customer_id
    LEFT JOIN staging.stg_products p ON t.product_id = p.product_id
    GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
),

new_customers AS (
    SELECT 
        customer_id, 
        MIN(first_transaction_month) AS first_payment_month  
    FROM transaction_summary
    GROUP BY customer_id
),

churned_customers AS (
    SELECT 
        customer_id, 
        customer_name_clean,
        last_transaction_month
    FROM transaction_summary
    WHERE last_transaction_month < DATEADD(MONTH, -6, CURRENT_DATE)
),

cross_sell_customers AS (
    SELECT 
        customer_id, 
        customer_name_clean,
        COUNT(DISTINCT product_family_clean) AS unique_product_families
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
    HAVING COUNT(DISTINCT product_family_clean) > 1
),

product_churn AS (
    SELECT 
        product_family_clean,
        COUNT(DISTINCT customer_id) AS customer_count,
        LAG(customer_count) OVER (
            PARTITION BY product_family_clean 
            ORDER BY first_transaction_month
        ) AS prev_customer_count,
        customer_count - LAG(customer_count) OVER (
            PARTITION BY product_family_clean 
            ORDER BY first_transaction_month
        ) AS customer_loss
    FROM transaction_summary
),

revenue_metrics AS (
    SELECT 
        SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS current_revenue,
        SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS previous_revenue,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         NULLIF(SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END), 0)) AS NRR,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         NULLIF(SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END), 0)) AS GRR
    FROM transaction_summary
),

lost_revenue AS (
    SELECT 
        SUM(total_revenue) AS lost_revenue
    FROM transaction_summary
    WHERE customer_id IN (SELECT customer_id FROM churned_customers)
),

ranked_products AS (
    SELECT 
        product_family_clean,
        SUM(total_revenue) AS product_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY product_family_clean
),

ranked_customers AS (
    SELECT 
        customer_id,
        customer_name_clean,
        SUM(total_revenue) AS customer_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
)

SELECT * FROM new_customers
UNION ALL
SELECT * FROM churned_customers
UNION ALL
SELECT * FROM cross_sell_customers
UNION ALL
SELECT * FROM product_churn
UNION ALL
SELECT * FROM revenue_metrics
UNION ALL
SELECT * FROM lost_revenue
UNION ALL
SELECT * FROM ranked_products
UNION ALL
SELECT * FROM ranked_customers
  );
[0m00:58:29.812613 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:58:31.687705 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0230-0004-bb9d-0000-0005db4bdd69
[0m00:58:31.687705 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CRBFITNESS.STAGING.STG_TRANSACTIONS' does not exist or not authorized.
[0m00:58:31.696228 [debug] [Thread-1 (]: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.STAGING.STG_TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m00:58:31.697310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f004d88-8f8a-4c13-9ab1-998b6d46c49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A313CC2690>]}
[0m00:58:31.697310 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model PUBLIC.customer_revenue_bridge ............ [[31mERROR[0m in 1.96s]
[0m00:58:31.704473 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m00:58:31.704473 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m00:58:31.704473 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.customer_revenue_bridge' to be skipped because of status 'error'.  Reason: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.STAGING.STG_TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql.
[0m00:58:31.707558 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m00:58:31.710232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.customer_revenue_bridge, now model.crb_kpi.stg_customers)
[0m00:58:31.712616 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m00:58:31.717224 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m00:58:31.717312 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m00:58:31.722265 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m00:58:31.727369 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m00:58:31.732389 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM staging.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean
FROM raw
  );
[0m00:58:32.095024 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0230-0004-c144-0005-db4b000182fe
[0m00:58:32.097594 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CRBFITNESS.STAGING.CUSTOMERS' does not exist or not authorized.
[0m00:58:32.102660 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.STAGING.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql
[0m00:58:32.107173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f004d88-8f8a-4c13-9ab1-998b6d46c49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3145B1790>]}
[0m00:58:32.107173 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model PUBLIC.stg_customers ...................... [[31mERROR[0m in 0.40s]
[0m00:58:32.110738 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m00:58:32.110738 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m00:58:32.110738 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.STAGING.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql.
[0m00:58:32.114806 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m00:58:32.118932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m00:58:32.118932 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m00:58:32.122654 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m00:58:32.127171 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m00:58:32.132228 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m00:58:32.137517 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m00:58:32.141498 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM staging.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m00:58:32.522471 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0230-0004-c178-0005-db4b000191d6
[0m00:58:32.522471 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CRBFITNESS.STAGING.PRODUCTS' does not exist or not authorized.
[0m00:58:32.532180 [debug] [Thread-1 (]: Database Error in model stg_products (models\staging\stg_products.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.STAGING.PRODUCTS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql
[0m00:58:32.532180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f004d88-8f8a-4c13-9ab1-998b6d46c49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A31496AFD0>]}
[0m00:58:32.532180 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model PUBLIC.stg_products ....................... [[31mERROR[0m in 0.41s]
[0m00:58:32.532180 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m00:58:32.537196 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m00:58:32.539231 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_products (models\staging\stg_products.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.STAGING.PRODUCTS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql.
[0m00:58:32.537196 [info ] [Thread-1 (]: 4 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m00:58:32.539741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m00:58:32.539741 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m00:58:32.543522 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m00:58:32.545764 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m00:58:32.551793 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m00:58:32.551793 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m00:58:32.555774 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM staging.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m00:58:33.007569 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0230-0004-c0bd-0005-db4b00017352
[0m00:58:33.010080 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CRBFITNESS.STAGING.TRANSACTIONS' does not exist or not authorized.
[0m00:58:33.018387 [debug] [Thread-1 (]: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.STAGING.TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql
[0m00:58:33.018387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f004d88-8f8a-4c13-9ab1-998b6d46c49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A31496CD10>]}
[0m00:58:33.022403 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model PUBLIC.stg_transactions ................... [[31mERROR[0m in 0.48s]
[0m00:58:33.024579 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m00:58:33.027108 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_transactions' to be skipped because of status 'error'.  Reason: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.STAGING.TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql.
[0m00:58:33.028088 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:58:33.028088 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m00:58:33.032609 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m00:58:33.668464 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m00:58:33.668464 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m00:58:34.281263 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m00:58:34.281263 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m00:58:34.902061 [info ] [MainThread]: 
[0m00:58:34.902061 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 9.38 seconds (9.38s).
[0m00:58:34.907579 [debug] [MainThread]: Command end result
[0m00:58:34.959051 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m00:58:34.963638 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m00:58:34.976393 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m00:58:34.977407 [info ] [MainThread]: 
[0m00:58:34.982465 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m00:58:34.983120 [info ] [MainThread]: 
[0m00:58:34.983120 [error] [MainThread]:   Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.STAGING.STG_TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m00:58:34.987400 [info ] [MainThread]: 
[0m00:58:34.987400 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.STAGING.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql
[0m00:58:34.991354 [info ] [MainThread]: 
[0m00:58:34.991354 [error] [MainThread]:   Database Error in model stg_products (models\staging\stg_products.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.STAGING.PRODUCTS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql
[0m00:58:34.997371 [info ] [MainThread]: 
[0m00:58:34.999449 [error] [MainThread]:   Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.STAGING.TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql
[0m00:58:34.999960 [info ] [MainThread]: 
[0m00:58:35.004853 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:58:35.007500 [debug] [MainThread]: Command `dbt run` failed at 00:58:35.007500 after 12.15 seconds
[0m00:58:35.007500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3125E3A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A30D412C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A30D492E10>]}
[0m00:58:35.007500 [debug] [MainThread]: Flushing usage events
[0m00:58:36.137068 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:00:09.675101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022083C8C450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220838AE850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022083C8DAD0>]}


============================== 01:00:09.684921 | ff29acc0-bc5e-4330-ba75-0f85586620c3 ==============================
[0m01:00:09.684921 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:00:09.686944 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:00:10.468925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff29acc0-bc5e-4330-ba75-0f85586620c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220848FA150>]}
[0m01:00:10.563902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff29acc0-bc5e-4330-ba75-0f85586620c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002208485DA50>]}
[0m01:00:10.563902 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:00:11.376766 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:00:11.681918 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m01:00:11.681918 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_transactions.sql
[0m01:00:11.685979 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_products.sql
[0m01:00:11.687026 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_customers.sql
[0m01:00:12.078571 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m01:00:12.087011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff29acc0-bc5e-4330-ba75-0f85586620c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022084835890>]}
[0m01:00:12.180743 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:00:12.188942 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:00:12.240661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff29acc0-bc5e-4330-ba75-0f85586620c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022085337B90>]}
[0m01:00:12.240661 [info ] [MainThread]: Found 4 models, 474 macros
[0m01:00:12.240661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff29acc0-bc5e-4330-ba75-0f85586620c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022085258A50>]}
[0m01:00:12.240661 [info ] [MainThread]: 
[0m01:00:12.246929 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:00:12.257969 [info ] [MainThread]: 
[0m01:00:12.260862 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:00:12.271716 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m01:00:12.477060 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m01:00:12.477060 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m01:00:12.485880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:14.609522 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.126 seconds
[0m01:00:14.619891 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m01:00:14.641915 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m01:00:14.641915 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m01:00:14.641915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:16.330980 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.685 seconds
[0m01:00:16.337997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff29acc0-bc5e-4330-ba75-0f85586620c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220FFB9D8D0>]}
[0m01:00:16.349773 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m01:00:16.351495 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.customer_revenue_bridge ..................... [RUN]
[0m01:00:16.353650 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.customer_revenue_bridge'
[0m01:00:16.354482 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.customer_revenue_bridge
[0m01:00:16.363717 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.customer_revenue_bridge"
[0m01:00:16.368878 [debug] [Thread-1 (]: Began executing node model.crb_kpi.customer_revenue_bridge
[0m01:00:16.421338 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.customer_revenue_bridge"
[0m01:00:16.437115 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.customer_revenue_bridge"
[0m01:00:16.438128 [debug] [Thread-1 (]: On model.crb_kpi.customer_revenue_bridge: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.customer_revenue_bridge"} */
create or replace   view CRBFITNESS.PUBLIC.customer_revenue_bridge
  
   as (
    WITH transaction_summary AS (
    SELECT 
        t.customer_id,
        c.customer_name_clean,
        p.product_family_clean,
        SUM(t.revenue) AS total_revenue,
        COUNT(DISTINCT t.payment_month) AS active_months,
        MIN(t.payment_month) AS first_transaction_month,
        MAX(t.payment_month) AS last_transaction_month
    FROM staging.stg_transactions t
    LEFT JOIN staging.stg_customers c ON t.customer_id = c.customer_id
    LEFT JOIN staging.stg_products p ON t.product_id = p.product_id
    GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
),

new_customers AS (
    SELECT 
        customer_id, 
        MIN(first_transaction_month) AS first_payment_month  
    FROM transaction_summary
    GROUP BY customer_id
),

churned_customers AS (
    SELECT 
        customer_id, 
        customer_name_clean,
        last_transaction_month
    FROM transaction_summary
    WHERE last_transaction_month < DATEADD(MONTH, -6, CURRENT_DATE)
),

cross_sell_customers AS (
    SELECT 
        customer_id, 
        customer_name_clean,
        COUNT(DISTINCT product_family_clean) AS unique_product_families
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
    HAVING COUNT(DISTINCT product_family_clean) > 1
),

product_churn AS (
    SELECT 
        product_family_clean,
        COUNT(DISTINCT customer_id) AS customer_count,
        LAG(customer_count) OVER (
            PARTITION BY product_family_clean 
            ORDER BY first_transaction_month
        ) AS prev_customer_count,
        customer_count - LAG(customer_count) OVER (
            PARTITION BY product_family_clean 
            ORDER BY first_transaction_month
        ) AS customer_loss
    FROM transaction_summary
),

revenue_metrics AS (
    SELECT 
        SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS current_revenue,
        SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS previous_revenue,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         NULLIF(SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END), 0)) AS NRR,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         NULLIF(SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END), 0)) AS GRR
    FROM transaction_summary
),

lost_revenue AS (
    SELECT 
        SUM(total_revenue) AS lost_revenue
    FROM transaction_summary
    WHERE customer_id IN (SELECT customer_id FROM churned_customers)
),

ranked_products AS (
    SELECT 
        product_family_clean,
        SUM(total_revenue) AS product_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY product_family_clean
),

ranked_customers AS (
    SELECT 
        customer_id,
        customer_name_clean,
        SUM(total_revenue) AS customer_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
)

SELECT * FROM new_customers
UNION ALL
SELECT * FROM churned_customers
UNION ALL
SELECT * FROM cross_sell_customers
UNION ALL
SELECT * FROM product_churn
UNION ALL
SELECT * FROM revenue_metrics
UNION ALL
SELECT * FROM lost_revenue
UNION ALL
SELECT * FROM ranked_products
UNION ALL
SELECT * FROM ranked_customers
  );
[0m01:00:16.438128 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:00:18.222271 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0232-0004-c144-0005-db4b00018306
[0m01:00:18.222271 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CRBFITNESS.STAGING.STG_TRANSACTIONS' does not exist or not authorized.
[0m01:00:18.228345 [debug] [Thread-1 (]: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.STAGING.STG_TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m01:00:18.239093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff29acc0-bc5e-4330-ba75-0f85586620c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022085962010>]}
[0m01:00:18.241822 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model PUBLIC.customer_revenue_bridge ............ [[31mERROR[0m in 1.88s]
[0m01:00:18.243354 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m01:00:18.243354 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m01:00:18.245363 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.customer_revenue_bridge' to be skipped because of status 'error'.  Reason: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.STAGING.STG_TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql.
[0m01:00:18.245363 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m01:00:18.248032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.customer_revenue_bridge, now model.crb_kpi.stg_customers)
[0m01:00:18.250048 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m01:00:18.250048 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m01:00:18.253565 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m01:00:18.257146 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m01:00:18.261808 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m01:00:18.261808 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean
FROM raw
  );
[0m01:00:18.887456 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.628 seconds
[0m01:00:18.942150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff29acc0-bc5e-4330-ba75-0f85586620c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220848A0650>]}
[0m01:00:18.946566 [info ] [Thread-1 (]: 2 of 4 OK created sql view model PUBLIC.stg_customers .......................... [[32mSUCCESS 1[0m in 0.69s]
[0m01:00:18.947077 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m01:00:18.949157 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m01:00:18.949157 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m01:00:18.953173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m01:00:18.953173 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m01:00:18.957189 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m01:00:18.961259 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m01:00:18.967144 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m01:00:18.972258 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m01:00:18.972258 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM public.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m01:00:19.587198 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.619 seconds
[0m01:00:19.597309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff29acc0-bc5e-4330-ba75-0f85586620c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220FFB9DED0>]}
[0m01:00:19.597309 [info ] [Thread-1 (]: 3 of 4 OK created sql view model PUBLIC.stg_products ........................... [[32mSUCCESS 1[0m in 0.64s]
[0m01:00:19.602323 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m01:00:19.602323 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m01:00:19.602323 [info ] [Thread-1 (]: 4 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m01:00:19.606841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m01:00:19.610394 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m01:00:19.610394 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m01:00:19.618498 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m01:00:19.628404 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m01:00:19.629472 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m01:00:19.632767 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m01:00:20.177160 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.542 seconds
[0m01:00:20.178867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff29acc0-bc5e-4330-ba75-0f85586620c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220860B21D0>]}
[0m01:00:20.178867 [info ] [Thread-1 (]: 4 of 4 OK created sql view model PUBLIC.stg_transactions ....................... [[32mSUCCESS 1[0m in 0.57s]
[0m01:00:20.183417 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m01:00:20.186158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:20.187171 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m01:00:20.187171 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m01:00:20.811911 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m01:00:20.811911 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m01:00:21.465117 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m01:00:21.465117 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m01:00:22.120193 [info ] [MainThread]: 
[0m01:00:22.122913 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 9.86 seconds (9.86s).
[0m01:00:22.127236 [debug] [MainThread]: Command end result
[0m01:00:22.177219 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:00:22.177219 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:00:22.191314 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m01:00:22.192440 [info ] [MainThread]: 
[0m01:00:22.193776 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:00:22.195627 [info ] [MainThread]: 
[0m01:00:22.197295 [error] [MainThread]:   Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.STAGING.STG_TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m01:00:22.199375 [info ] [MainThread]: 
[0m01:00:22.199983 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m01:00:22.203184 [debug] [MainThread]: Command `dbt run` failed at 01:00:22.203184 after 12.66 seconds
[0m01:00:22.203184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022083CC81D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220FE662C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220827AF5D0>]}
[0m01:00:22.203184 [debug] [MainThread]: Flushing usage events
[0m01:00:23.497220 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:01:38.038801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC3018C0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC301E3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC301E3710>]}


============================== 01:01:38.046879 | af072453-5561-4564-a32b-2cb06124b4f7 ==============================
[0m01:01:38.046879 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:01:38.046879 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:01:38.866654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af072453-5561-4564-a32b-2cb06124b4f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC310A3D10>]}
[0m01:01:38.976635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af072453-5561-4564-a32b-2cb06124b4f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC2EB6D310>]}
[0m01:01:38.980155 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:01:39.766835 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:01:40.027817 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:01:40.027817 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\customer_revenue_bridge.sql
[0m01:01:40.432902 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m01:01:40.445753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af072453-5561-4564-a32b-2cb06124b4f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC318C8290>]}
[0m01:01:40.592785 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:01:40.600965 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:01:40.644860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af072453-5561-4564-a32b-2cb06124b4f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC31A26F50>]}
[0m01:01:40.646879 [info ] [MainThread]: Found 4 models, 474 macros
[0m01:01:40.646879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af072453-5561-4564-a32b-2cb06124b4f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC319C2C90>]}
[0m01:01:40.649684 [info ] [MainThread]: 
[0m01:01:40.649684 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:01:40.649684 [info ] [MainThread]: 
[0m01:01:40.649684 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:01:40.657990 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m01:01:40.926547 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m01:01:40.926547 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m01:01:40.926547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:01:43.156830 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.229 seconds
[0m01:01:43.165825 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m01:01:43.186802 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m01:01:43.189339 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m01:01:43.189339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:01:44.943765 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.752 seconds
[0m01:01:44.948248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af072453-5561-4564-a32b-2cb06124b4f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC310331D0>]}
[0m01:01:44.956645 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m01:01:44.956645 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.customer_revenue_bridge ..................... [RUN]
[0m01:01:44.956645 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.customer_revenue_bridge'
[0m01:01:44.964778 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.customer_revenue_bridge
[0m01:01:44.976599 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.customer_revenue_bridge"
[0m01:01:44.981614 [debug] [Thread-1 (]: Began executing node model.crb_kpi.customer_revenue_bridge
[0m01:01:45.036568 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.customer_revenue_bridge"
[0m01:01:45.041306 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.customer_revenue_bridge"
[0m01:01:45.046816 [debug] [Thread-1 (]: On model.crb_kpi.customer_revenue_bridge: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.customer_revenue_bridge"} */
create or replace   view CRBFITNESS.PUBLIC.customer_revenue_bridge
  
   as (
    WITH transaction_summary AS (
    SELECT 
        t.customer_id,
        c.customer_name_clean,
        p.product_family_clean,
        SUM(t.revenue) AS total_revenue,
        COUNT(DISTINCT t.payment_month) AS active_months,
        MIN(t.payment_month) AS first_transaction_month,
        MAX(t.payment_month) AS last_transaction_month
    FROM public.stg_transactions t
    LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
    LEFT JOIN public.stg_products p ON t.product_id = p.product_id
    GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
),

new_customers AS (
    SELECT 
        customer_id, 
        MIN(first_transaction_month) AS first_payment_month  
    FROM transaction_summary
    GROUP BY customer_id
),

churned_customers AS (
    SELECT 
        customer_id, 
        customer_name_clean,
        last_transaction_month
    FROM transaction_summary
    WHERE last_transaction_month < DATEADD(MONTH, -6, CURRENT_DATE)
),

cross_sell_customers AS (
    SELECT 
        customer_id, 
        customer_name_clean,
        COUNT(DISTINCT product_family_clean) AS unique_product_families
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
    HAVING COUNT(DISTINCT product_family_clean) > 1
),

product_churn AS (
    SELECT 
        product_family_clean,
        COUNT(DISTINCT customer_id) AS customer_count,
        LAG(customer_count) OVER (
            PARTITION BY product_family_clean 
            ORDER BY first_transaction_month
        ) AS prev_customer_count,
        customer_count - LAG(customer_count) OVER (
            PARTITION BY product_family_clean 
            ORDER BY first_transaction_month
        ) AS customer_loss
    FROM transaction_summary
),

revenue_metrics AS (
    SELECT 
        SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS current_revenue,
        SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS previous_revenue,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         NULLIF(SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END), 0)) AS NRR,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         NULLIF(SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END), 0)) AS GRR
    FROM transaction_summary
),

lost_revenue AS (
    SELECT 
        SUM(total_revenue) AS lost_revenue
    FROM transaction_summary
    WHERE customer_id IN (SELECT customer_id FROM churned_customers)
),

ranked_products AS (
    SELECT 
        product_family_clean,
        SUM(total_revenue) AS product_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY product_family_clean
),

ranked_customers AS (
    SELECT 
        customer_id,
        customer_name_clean,
        SUM(total_revenue) AS customer_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
)

SELECT * FROM new_customers
UNION ALL
SELECT * FROM churned_customers
UNION ALL
SELECT * FROM cross_sell_customers
UNION ALL
SELECT * FROM product_churn
UNION ALL
SELECT * FROM revenue_metrics
UNION ALL
SELECT * FROM lost_revenue
UNION ALL
SELECT * FROM ranked_products
UNION ALL
SELECT * FROM ranked_customers
  );
[0m01:01:45.046816 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:01:46.856996 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0233-0004-c178-0005-db4b000191de
[0m01:01:46.856996 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001789 (42601): SQL compilation error:
invalid number of result columns for set operator input branches, expected 2, got 3 in branch 2
[0m01:01:46.866584 [debug] [Thread-1 (]: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  001789 (42601): SQL compilation error:
  invalid number of result columns for set operator input branches, expected 2, got 3 in branch 2
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m01:01:46.873141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af072453-5561-4564-a32b-2cb06124b4f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC320262D0>]}
[0m01:01:46.873141 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model PUBLIC.customer_revenue_bridge ............ [[31mERROR[0m in 1.91s]
[0m01:01:46.874905 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m01:01:46.876918 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m01:01:46.877360 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m01:01:46.877360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.customer_revenue_bridge, now model.crb_kpi.stg_customers)
[0m01:01:46.877360 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m01:01:46.884452 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m01:01:46.886970 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.customer_revenue_bridge' to be skipped because of status 'error'.  Reason: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  001789 (42601): SQL compilation error:
  invalid number of result columns for set operator input branches, expected 2, got 3 in branch 2
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql.
[0m01:01:46.889694 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m01:01:46.897391 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m01:01:46.897391 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m01:01:46.901995 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean
FROM raw
  );
[0m01:01:47.457027 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.556 seconds
[0m01:01:47.506666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af072453-5561-4564-a32b-2cb06124b4f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC31A56090>]}
[0m01:01:47.506666 [info ] [Thread-1 (]: 2 of 4 OK created sql view model PUBLIC.stg_customers .......................... [[32mSUCCESS 1[0m in 0.63s]
[0m01:01:47.511180 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m01:01:47.511180 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m01:01:47.513704 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m01:01:47.515641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m01:01:47.515641 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m01:01:47.519363 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m01:01:47.519363 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m01:01:47.526875 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m01:01:47.526875 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m01:01:47.526875 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM public.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m01:01:48.059130 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.527 seconds
[0m01:01:48.067147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af072453-5561-4564-a32b-2cb06124b4f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC31A63610>]}
[0m01:01:48.067147 [info ] [Thread-1 (]: 3 of 4 OK created sql view model PUBLIC.stg_products ........................... [[32mSUCCESS 1[0m in 0.55s]
[0m01:01:48.067147 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m01:01:48.067147 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m01:01:48.075231 [info ] [Thread-1 (]: 4 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m01:01:48.076749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m01:01:48.076749 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m01:01:48.083330 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m01:01:48.086898 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m01:01:48.091952 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m01:01:48.096974 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m01:01:48.099244 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m01:01:48.645078 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.545 seconds
[0m01:01:48.651678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af072453-5561-4564-a32b-2cb06124b4f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC320F7AD0>]}
[0m01:01:48.654702 [info ] [Thread-1 (]: 4 of 4 OK created sql view model PUBLIC.stg_transactions ....................... [[32mSUCCESS 1[0m in 0.57s]
[0m01:01:48.656737 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m01:01:48.663220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:01:48.663578 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m01:01:48.666602 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m01:01:49.343167 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m01:01:49.343167 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m01:01:49.972989 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m01:01:49.972989 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m01:01:50.589356 [info ] [MainThread]: 
[0m01:01:50.589356 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 9.94 seconds (9.94s).
[0m01:01:50.594900 [debug] [MainThread]: Command end result
[0m01:01:50.639781 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:01:50.639781 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:01:50.656810 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m01:01:50.658691 [info ] [MainThread]: 
[0m01:01:50.660186 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:01:50.660186 [info ] [MainThread]: 
[0m01:01:50.660186 [error] [MainThread]:   Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  001789 (42601): SQL compilation error:
  invalid number of result columns for set operator input branches, expected 2, got 3 in branch 2
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m01:01:50.664333 [info ] [MainThread]: 
[0m01:01:50.666919 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m01:01:50.666919 [debug] [MainThread]: Command `dbt run` failed at 01:01:50.666919 after 12.78 seconds
[0m01:01:50.666919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC2FFAF350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC2FFAF490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC2FFAEB50>]}
[0m01:01:50.672478 [debug] [MainThread]: Flushing usage events
[0m01:01:51.896975 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:04:00.516304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB63A8E890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB636AE850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB63A8D410>]}


============================== 01:04:00.521794 | c572df53-30e4-47b7-929d-0195264c85bb ==============================
[0m01:04:00.521794 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:04:00.526359 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:04:01.266232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c572df53-30e4-47b7-929d-0195264c85bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB63AE2A90>]}
[0m01:04:01.368460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c572df53-30e4-47b7-929d-0195264c85bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB6465DB50>]}
[0m01:04:01.368460 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:04:02.176485 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:04:02.472365 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:04:02.473219 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\customer_revenue_bridge.sql
[0m01:04:02.872323 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m01:04:02.876426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c572df53-30e4-47b7-929d-0195264c85bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB647D22D0>]}
[0m01:04:03.008539 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:04:03.016037 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:04:03.057368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c572df53-30e4-47b7-929d-0195264c85bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB6512B390>]}
[0m01:04:03.057368 [info ] [MainThread]: Found 4 models, 474 macros
[0m01:04:03.058877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c572df53-30e4-47b7-929d-0195264c85bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB6500F090>]}
[0m01:04:03.058877 [info ] [MainThread]: 
[0m01:04:03.058877 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:04:03.058877 [info ] [MainThread]: 
[0m01:04:03.067840 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:04:03.071343 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m01:04:03.298249 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m01:04:03.298249 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m01:04:03.298249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:05.321246 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.021 seconds
[0m01:04:05.330387 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m01:04:05.357881 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m01:04:05.357881 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m01:04:05.360415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:07.416197 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.058 seconds
[0m01:04:07.425466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c572df53-30e4-47b7-929d-0195264c85bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB6503A850>]}
[0m01:04:07.437570 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m01:04:07.437570 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.customer_revenue_bridge ..................... [RUN]
[0m01:04:07.441592 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.customer_revenue_bridge'
[0m01:04:07.449398 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.customer_revenue_bridge
[0m01:04:07.468305 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.customer_revenue_bridge"
[0m01:04:07.476326 [debug] [Thread-1 (]: Began executing node model.crb_kpi.customer_revenue_bridge
[0m01:04:07.586325 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.customer_revenue_bridge"
[0m01:04:07.596159 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.customer_revenue_bridge"
[0m01:04:07.606104 [debug] [Thread-1 (]: On model.crb_kpi.customer_revenue_bridge: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.customer_revenue_bridge"} */
create or replace   view CRBFITNESS.PUBLIC.customer_revenue_bridge
  
   as (
    SELECT customer_id, CAST(first_payment_month AS DATE) AS metric_value, NULL AS extra_info 
FROM new_customers

UNION ALL

SELECT customer_id, CAST(last_transaction_month AS DATE) AS metric_value, customer_name_clean 
FROM churned_customers

UNION ALL

SELECT customer_id, CAST(unique_product_families AS STRING) AS metric_value, customer_name_clean
FROM cross_sell_customers

UNION ALL

SELECT NULL AS customer_id, CAST(customer_count AS STRING) AS metric_value, product_family_clean 
FROM product_churn

UNION ALL

SELECT NULL AS customer_id, CAST(current_revenue AS STRING) AS metric_value, 'revenue_metrics' 
FROM revenue_metrics

UNION ALL

SELECT NULL AS customer_id, CAST(lost_revenue AS STRING) AS metric_value, 'lost_revenue' 
FROM lost_revenue

UNION ALL

SELECT NULL AS customer_id, CAST(product_revenue AS STRING) AS metric_value, product_family_clean 
FROM ranked_products

UNION ALL

SELECT customer_id, CAST(customer_revenue AS STRING) AS metric_value, customer_name_clean 
FROM ranked_customers;
[0m01:04:07.612915 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:04:09.263800 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0236-0004-c178-0005-db4b000191ea
[0m01:04:09.265323 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 40 at position 21 unexpected ';'.
[0m01:04:09.271425 [debug] [Thread-1 (]: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  001003 (42000): SQL compilation error:
  syntax error line 40 at position 21 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m01:04:09.276438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c572df53-30e4-47b7-929d-0195264c85bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB64B79A50>]}
[0m01:04:09.276438 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model PUBLIC.customer_revenue_bridge ............ [[31mERROR[0m in 1.83s]
[0m01:04:09.280644 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m01:04:09.281926 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m01:04:09.281926 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.customer_revenue_bridge' to be skipped because of status 'error'.  Reason: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  001003 (42000): SQL compilation error:
  syntax error line 40 at position 21 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql.
[0m01:04:09.281926 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m01:04:09.286622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.customer_revenue_bridge, now model.crb_kpi.stg_customers)
[0m01:04:09.287868 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m01:04:09.288924 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m01:04:09.294367 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m01:04:09.299225 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m01:04:09.299225 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m01:04:09.306302 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean
FROM raw
  );
[0m01:04:10.906287 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.599 seconds
[0m01:04:10.970721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c572df53-30e4-47b7-929d-0195264c85bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB6570F3D0>]}
[0m01:04:10.976313 [info ] [Thread-1 (]: 2 of 4 OK created sql view model PUBLIC.stg_customers .......................... [[32mSUCCESS 1[0m in 1.68s]
[0m01:04:10.979061 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m01:04:10.979061 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m01:04:10.979061 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m01:04:10.986136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m01:04:10.988149 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m01:04:10.996404 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m01:04:11.004013 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m01:04:11.016423 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m01:04:11.026637 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m01:04:11.031292 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM public.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m01:04:11.956079 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.922 seconds
[0m01:04:11.958293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c572df53-30e4-47b7-929d-0195264c85bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB657E0A90>]}
[0m01:04:11.962314 [info ] [Thread-1 (]: 3 of 4 OK created sql view model PUBLIC.stg_products ........................... [[32mSUCCESS 1[0m in 0.98s]
[0m01:04:11.966242 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m01:04:11.966242 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m01:04:11.966242 [info ] [Thread-1 (]: 4 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m01:04:11.966242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m01:04:11.966242 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m01:04:11.976514 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m01:04:11.980321 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m01:04:11.990409 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m01:04:11.996169 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m01:04:12.001881 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m01:04:13.314193 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.310 seconds
[0m01:04:13.323810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c572df53-30e4-47b7-929d-0195264c85bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB64F968D0>]}
[0m01:04:13.326408 [info ] [Thread-1 (]: 4 of 4 OK created sql view model PUBLIC.stg_transactions ....................... [[32mSUCCESS 1[0m in 1.36s]
[0m01:04:13.339343 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m01:04:13.344303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:04:13.348569 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m01:04:13.350513 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m01:04:13.979417 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m01:04:13.981609 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m01:04:14.632862 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m01:04:14.636532 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m01:04:15.656449 [info ] [MainThread]: 
[0m01:04:15.656449 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 12.59 seconds (12.59s).
[0m01:04:15.669734 [debug] [MainThread]: Command end result
[0m01:04:15.716143 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:04:15.720259 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:04:15.736115 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m01:04:15.736115 [info ] [MainThread]: 
[0m01:04:15.736115 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:04:15.736115 [info ] [MainThread]: 
[0m01:04:15.736115 [error] [MainThread]:   Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  001003 (42000): SQL compilation error:
  syntax error line 40 at position 21 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m01:04:15.743576 [info ] [MainThread]: 
[0m01:04:15.745857 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m01:04:15.751627 [debug] [MainThread]: Command `dbt run` failed at 01:04:15.751627 after 15.38 seconds
[0m01:04:15.755724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB63AE3BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB5E612C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB63AC8710>]}
[0m01:04:15.756351 [debug] [MainThread]: Flushing usage events
[0m01:04:16.990298 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:04:29.151274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002514BA88650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002514BA89410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002514BA88A90>]}


============================== 01:04:29.156988 | 014bedab-8241-4103-9115-9134c8a0d4cf ==============================
[0m01:04:29.156988 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:04:29.165799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:04:30.018460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '014bedab-8241-4103-9115-9134c8a0d4cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002514C7A2050>]}
[0m01:04:30.136131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '014bedab-8241-4103-9115-9134c8a0d4cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002514C65D7D0>]}
[0m01:04:30.136131 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:04:31.003928 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:04:31.286245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:04:31.286245 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\customer_revenue_bridge.sql
[0m01:04:31.738671 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m01:04:31.749440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '014bedab-8241-4103-9115-9134c8a0d4cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002514CB72050>]}
[0m01:04:31.875519 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:04:31.898471 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:04:31.952231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '014bedab-8241-4103-9115-9134c8a0d4cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002514D133710>]}
[0m01:04:31.952231 [info ] [MainThread]: Found 4 models, 474 macros
[0m01:04:31.956252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '014bedab-8241-4103-9115-9134c8a0d4cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002514D0C3350>]}
[0m01:04:31.963591 [info ] [MainThread]: 
[0m01:04:31.966348 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:04:31.968371 [info ] [MainThread]: 
[0m01:04:31.968371 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:04:31.982708 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m01:04:32.286413 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m01:04:32.287511 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m01:04:32.287511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:34.303817 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.011 seconds
[0m01:04:34.310504 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m01:04:34.337880 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m01:04:34.340855 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m01:04:34.340855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:36.086091 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.745 seconds
[0m01:04:36.098172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '014bedab-8241-4103-9115-9134c8a0d4cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002514D01C9D0>]}
[0m01:04:36.112626 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m01:04:36.114138 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.customer_revenue_bridge ..................... [RUN]
[0m01:04:36.116282 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.customer_revenue_bridge'
[0m01:04:36.116282 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.customer_revenue_bridge
[0m01:04:36.135082 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.customer_revenue_bridge"
[0m01:04:36.138567 [debug] [Thread-1 (]: Began executing node model.crb_kpi.customer_revenue_bridge
[0m01:04:36.195953 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.customer_revenue_bridge"
[0m01:04:36.203832 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.customer_revenue_bridge"
[0m01:04:36.206433 [debug] [Thread-1 (]: On model.crb_kpi.customer_revenue_bridge: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.customer_revenue_bridge"} */
create or replace   view CRBFITNESS.PUBLIC.customer_revenue_bridge
  
   as (
    SELECT customer_id, CAST(first_payment_month AS DATE) AS metric_value, NULL AS extra_info 
FROM new_customers

UNION ALL

SELECT customer_id, CAST(last_transaction_month AS DATE) AS metric_value, customer_name_clean 
FROM churned_customers

UNION ALL

SELECT customer_id, CAST(unique_product_families AS STRING) AS metric_value, customer_name_clean
FROM cross_sell_customers

UNION ALL

SELECT NULL AS customer_id, CAST(customer_count AS STRING) AS metric_value, product_family_clean 
FROM product_churn

UNION ALL

SELECT NULL AS customer_id, CAST(current_revenue AS STRING) AS metric_value, 'revenue_metrics' 
FROM revenue_metrics

UNION ALL

SELECT NULL AS customer_id, CAST(lost_revenue AS STRING) AS metric_value, 'lost_revenue' 
FROM lost_revenue

UNION ALL

SELECT NULL AS customer_id, CAST(product_revenue AS STRING) AS metric_value, product_family_clean 
FROM ranked_products

UNION ALL

SELECT customer_id, CAST(customer_revenue AS STRING) AS metric_value, customer_name_clean 
FROM ranked_customers
  );
[0m01:04:36.206433 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:04:38.056467 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0236-0004-c178-0005-db4b000191f2
[0m01:04:38.056467 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CRBFITNESS.PUBLIC.NEW_CUSTOMERS' does not exist or not authorized.
[0m01:04:38.066413 [debug] [Thread-1 (]: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.PUBLIC.NEW_CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m01:04:38.066413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '014bedab-8241-4103-9115-9134c8a0d4cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002514CF773D0>]}
[0m01:04:38.066413 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model PUBLIC.customer_revenue_bridge ............ [[31mERROR[0m in 1.95s]
[0m01:04:38.074808 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m01:04:38.076411 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m01:04:38.076411 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.customer_revenue_bridge' to be skipped because of status 'error'.  Reason: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.PUBLIC.NEW_CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql.
[0m01:04:38.076411 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m01:04:38.084323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.customer_revenue_bridge, now model.crb_kpi.stg_customers)
[0m01:04:38.086233 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m01:04:38.091886 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m01:04:38.091886 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m01:04:38.104906 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m01:04:38.106428 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m01:04:38.107935 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean
FROM raw
  );
[0m01:04:38.866484 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.765 seconds
[0m01:04:38.926225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '014bedab-8241-4103-9115-9134c8a0d4cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002514D104350>]}
[0m01:04:38.926225 [info ] [Thread-1 (]: 2 of 4 OK created sql view model PUBLIC.stg_customers .......................... [[32mSUCCESS 1[0m in 0.84s]
[0m01:04:38.930346 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m01:04:38.930346 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m01:04:38.930346 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m01:04:38.930346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m01:04:38.930346 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m01:04:38.936443 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m01:04:38.941018 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m01:04:38.947259 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m01:04:38.951654 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m01:04:38.951654 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM public.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m01:04:39.551882 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.600 seconds
[0m01:04:39.561524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '014bedab-8241-4103-9115-9134c8a0d4cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002514DE4D590>]}
[0m01:04:39.562886 [info ] [Thread-1 (]: 3 of 4 OK created sql view model PUBLIC.stg_products ........................... [[32mSUCCESS 1[0m in 0.63s]
[0m01:04:39.566147 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m01:04:39.568387 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m01:04:39.570836 [info ] [Thread-1 (]: 4 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m01:04:39.572639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m01:04:39.574066 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m01:04:39.580325 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m01:04:39.583846 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m01:04:39.587344 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m01:04:39.590282 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m01:04:39.593178 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m01:04:40.286052 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.691 seconds
[0m01:04:40.291243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '014bedab-8241-4103-9115-9134c8a0d4cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002514DEA8D90>]}
[0m01:04:40.294270 [info ] [Thread-1 (]: 4 of 4 OK created sql view model PUBLIC.stg_transactions ....................... [[32mSUCCESS 1[0m in 0.72s]
[0m01:04:40.296302 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m01:04:40.301388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:04:40.301388 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m01:04:40.301388 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m01:04:40.935997 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m01:04:40.935997 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m01:04:41.556812 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m01:04:41.556812 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m01:04:42.204320 [info ] [MainThread]: 
[0m01:04:42.206341 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 10.24 seconds (10.24s).
[0m01:04:42.211235 [debug] [MainThread]: Command end result
[0m01:04:42.256103 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:04:42.269256 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:04:42.281579 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m01:04:42.284082 [info ] [MainThread]: 
[0m01:04:42.287777 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:04:42.288426 [info ] [MainThread]: 
[0m01:04:42.288426 [error] [MainThread]:   Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.PUBLIC.NEW_CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m01:04:42.291351 [info ] [MainThread]: 
[0m01:04:42.293361 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m01:04:42.295052 [debug] [MainThread]: Command `dbt run` failed at 01:04:42.295052 after 13.32 seconds
[0m01:04:42.296123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025146612C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025146612D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025146612050>]}
[0m01:04:42.297179 [debug] [MainThread]: Flushing usage events
[0m01:04:43.426973 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:06:15.441095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F050A8C610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F050AE23D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F050AE22D0>]}


============================== 01:06:15.448001 | c0501d39-871f-47f4-959a-f5c9210f8fd0 ==============================
[0m01:06:15.448001 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:06:15.448001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:06:16.326061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0501d39-871f-47f4-959a-f5c9210f8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F050AE23D0>]}
[0m01:06:16.470186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0501d39-871f-47f4-959a-f5c9210f8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F04F46D1D0>]}
[0m01:06:16.475703 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:06:17.365630 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:06:17.706107 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:06:17.706107 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\customer_revenue_bridge.sql
[0m01:06:18.127730 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m01:06:18.144717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0501d39-871f-47f4-959a-f5c9210f8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F051FCDDD0>]}
[0m01:06:18.277550 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:06:18.286452 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:06:18.323787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0501d39-871f-47f4-959a-f5c9210f8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F052129150>]}
[0m01:06:18.323787 [info ] [MainThread]: Found 4 models, 474 macros
[0m01:06:18.325740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0501d39-871f-47f4-959a-f5c9210f8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F052039F50>]}
[0m01:06:18.329559 [info ] [MainThread]: 
[0m01:06:18.329559 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:06:18.332926 [info ] [MainThread]: 
[0m01:06:18.337048 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:06:18.345569 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m01:06:18.565897 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m01:06:18.565897 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m01:06:18.570503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:06:20.685999 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.119 seconds
[0m01:06:20.692410 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m01:06:20.708140 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m01:06:20.708140 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m01:06:20.708140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:06:22.565850 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.857 seconds
[0m01:06:22.576087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0501d39-871f-47f4-959a-f5c9210f8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F051BCF8D0>]}
[0m01:06:22.588126 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m01:06:22.588126 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.customer_revenue_bridge ..................... [RUN]
[0m01:06:22.588126 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.customer_revenue_bridge'
[0m01:06:22.594172 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.customer_revenue_bridge
[0m01:06:22.605989 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.customer_revenue_bridge"
[0m01:06:22.605989 [debug] [Thread-1 (]: Began executing node model.crb_kpi.customer_revenue_bridge
[0m01:06:22.670974 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.customer_revenue_bridge"
[0m01:06:22.677509 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.customer_revenue_bridge"
[0m01:06:22.677509 [debug] [Thread-1 (]: On model.crb_kpi.customer_revenue_bridge: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.customer_revenue_bridge"} */
create or replace   view CRBFITNESS.PUBLIC.customer_revenue_bridge
  
   as (
    SELECT customer_id, CAST(first_payment_month AS DATE) AS metric_value, NULL AS extra_info 
FROM customers

UNION ALL

SELECT customer_id, CAST(last_transaction_month AS DATE) AS metric_value, customer_name_clean 
FROM churned_customers

UNION ALL

SELECT customer_id, CAST(unique_product_families AS STRING) AS metric_value, customer_name_clean
FROM cross_sell_customers

UNION ALL

SELECT NULL AS customer_id, CAST(customer_count AS STRING) AS metric_value, product_family_clean 
FROM product_churn

UNION ALL

SELECT NULL AS customer_id, CAST(current_revenue AS STRING) AS metric_value, 'revenue_metrics' 
FROM revenue_metrics

UNION ALL

SELECT NULL AS customer_id, CAST(lost_revenue AS STRING) AS metric_value, 'lost_revenue' 
FROM lost_revenue

UNION ALL

SELECT NULL AS customer_id, CAST(product_revenue AS STRING) AS metric_value, product_family_clean 
FROM ranked_products

UNION ALL

SELECT customer_id, CAST(customer_revenue AS STRING) AS metric_value, customer_name_clean 
FROM ranked_customers
  );
[0m01:06:22.677509 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:06:24.474527 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0238-0004-bb9d-0000-0005db4bdd89
[0m01:06:24.476046 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CRBFITNESS.PUBLIC.CHURNED_CUSTOMERS' does not exist or not authorized.
[0m01:06:24.485815 [debug] [Thread-1 (]: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.PUBLIC.CHURNED_CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m01:06:24.490031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0501d39-871f-47f4-959a-f5c9210f8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F051FA2410>]}
[0m01:06:24.490031 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model PUBLIC.customer_revenue_bridge ............ [[31mERROR[0m in 1.90s]
[0m01:06:24.490031 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m01:06:24.496045 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m01:06:24.496045 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.customer_revenue_bridge' to be skipped because of status 'error'.  Reason: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.PUBLIC.CHURNED_CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql.
[0m01:06:24.496045 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m01:06:24.500466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.customer_revenue_bridge, now model.crb_kpi.stg_customers)
[0m01:06:24.500466 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m01:06:24.503960 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m01:06:24.507632 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m01:06:24.513989 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m01:06:24.516622 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m01:06:24.516622 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean
FROM raw
  );
[0m01:06:24.972624 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.455 seconds
[0m01:06:25.021564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0501d39-871f-47f4-959a-f5c9210f8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0527CA0D0>]}
[0m01:06:25.026883 [info ] [Thread-1 (]: 2 of 4 OK created sql view model PUBLIC.stg_customers .......................... [[32mSUCCESS 1[0m in 0.52s]
[0m01:06:25.026883 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m01:06:25.026883 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m01:06:25.026883 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m01:06:25.039882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m01:06:25.042119 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m01:06:25.046028 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m01:06:25.046028 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m01:06:25.056039 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m01:06:25.061051 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m01:06:25.062563 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM public.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m01:06:25.676198 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.613 seconds
[0m01:06:25.682066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0501d39-871f-47f4-959a-f5c9210f8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0521685D0>]}
[0m01:06:25.682066 [info ] [Thread-1 (]: 3 of 4 OK created sql view model PUBLIC.stg_products ........................... [[32mSUCCESS 1[0m in 0.64s]
[0m01:06:25.689178 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m01:06:25.689178 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m01:06:25.695774 [info ] [Thread-1 (]: 4 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m01:06:25.697791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m01:06:25.698582 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m01:06:25.703637 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m01:06:25.705650 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m01:06:25.710267 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m01:06:25.710267 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m01:06:25.710267 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m01:06:26.371366 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.658 seconds
[0m01:06:26.375754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0501d39-871f-47f4-959a-f5c9210f8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0527940D0>]}
[0m01:06:26.377396 [info ] [Thread-1 (]: 4 of 4 OK created sql view model PUBLIC.stg_transactions ....................... [[32mSUCCESS 1[0m in 0.68s]
[0m01:06:26.379202 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m01:06:26.381335 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:06:26.381335 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m01:06:26.384427 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m01:06:27.001283 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m01:06:27.003554 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m01:06:27.606139 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m01:06:27.606139 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m01:06:28.252397 [info ] [MainThread]: 
[0m01:06:28.254991 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 9.92 seconds (9.92s).
[0m01:06:28.260097 [debug] [MainThread]: Command end result
[0m01:06:28.305653 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:06:28.312521 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:06:28.320131 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m01:06:28.320131 [info ] [MainThread]: 
[0m01:06:28.326037 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:06:28.326037 [info ] [MainThread]: 
[0m01:06:28.326037 [error] [MainThread]:   Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  002003 (42S02): SQL compilation error:
  Object 'CRBFITNESS.PUBLIC.CHURNED_CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m01:06:28.326037 [info ] [MainThread]: 
[0m01:06:28.326037 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m01:06:28.334773 [debug] [MainThread]: Command `dbt run` failed at 01:06:28.326037 after 13.05 seconds
[0m01:06:28.335788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F04B612C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F050AE22D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F050AE3BD0>]}
[0m01:06:28.335788 [debug] [MainThread]: Flushing usage events
[0m01:06:29.605971 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:06:42.658757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A1D98C5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A1D9E2010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A1D9E2190>]}


============================== 01:06:42.667862 | f519c05e-1857-4e22-9a9c-50758de84e63 ==============================
[0m01:06:42.667862 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:06:42.668531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:06:43.435752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f519c05e-1857-4e22-9a9c-50758de84e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A1D9B1C50>]}
[0m01:06:43.541891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f519c05e-1857-4e22-9a9c-50758de84e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A1C36D350>]}
[0m01:06:43.543971 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:06:44.402481 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:06:44.657403 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:06:44.658953 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\customer_revenue_bridge.sql
[0m01:06:45.070208 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m01:06:45.075569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f519c05e-1857-4e22-9a9c-50758de84e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A1F1224D0>]}
[0m01:06:45.185653 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:06:45.214553 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:06:45.258884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f519c05e-1857-4e22-9a9c-50758de84e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A1F1596D0>]}
[0m01:06:45.262433 [info ] [MainThread]: Found 4 models, 474 macros
[0m01:06:45.266538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f519c05e-1857-4e22-9a9c-50758de84e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A1F1B6C90>]}
[0m01:06:45.270570 [info ] [MainThread]: 
[0m01:06:45.276781 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:06:45.280490 [info ] [MainThread]: 
[0m01:06:45.280490 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:06:45.289710 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m01:06:45.537464 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m01:06:45.537464 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m01:06:45.545974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:06:47.755941 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.212 seconds
[0m01:06:47.762718 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m01:06:47.785792 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m01:06:47.785792 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m01:06:47.787955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:06:49.521028 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.734 seconds
[0m01:06:49.531095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f519c05e-1857-4e22-9a9c-50758de84e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A1E800D10>]}
[0m01:06:49.543695 [debug] [Thread-1 (]: Began running node model.crb_kpi.customer_revenue_bridge
[0m01:06:49.545714 [info ] [Thread-1 (]: 1 of 4 START sql view model PUBLIC.customer_revenue_bridge ..................... [RUN]
[0m01:06:49.546503 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.customer_revenue_bridge'
[0m01:06:49.546503 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.customer_revenue_bridge
[0m01:06:49.562545 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.customer_revenue_bridge"
[0m01:06:49.566692 [debug] [Thread-1 (]: Began executing node model.crb_kpi.customer_revenue_bridge
[0m01:06:49.615765 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.customer_revenue_bridge"
[0m01:06:49.626006 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.customer_revenue_bridge"
[0m01:06:49.626006 [debug] [Thread-1 (]: On model.crb_kpi.customer_revenue_bridge: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.customer_revenue_bridge"} */
create or replace   view CRBFITNESS.PUBLIC.customer_revenue_bridge
  
   as (
    WITH transaction_summary AS (
    SELECT 
        t.customer_id,
        c.customer_name_clean,
        p.product_family_clean,
        SUM(t.revenue) AS total_revenue,
        COUNT(DISTINCT t.payment_month) AS active_months,
        MIN(t.payment_month) AS first_transaction_month,
        MAX(t.payment_month) AS last_transaction_month
    FROM public.stg_transactions t
    LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
    LEFT JOIN public.stg_products p ON t.product_id = p.product_id
    GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
),

new_customers AS (
    SELECT 
        customer_id, 
        MIN(first_transaction_month) AS first_payment_month  
    FROM transaction_summary
    GROUP BY customer_id
),

churned_customers AS (
    SELECT 
        customer_id, 
        customer_name_clean,
        last_transaction_month
    FROM transaction_summary
    WHERE last_transaction_month < DATEADD(MONTH, -6, CURRENT_DATE)
),

cross_sell_customers AS (
    SELECT 
        customer_id, 
        customer_name_clean,
        COUNT(DISTINCT product_family_clean) AS unique_product_families
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
    HAVING COUNT(DISTINCT product_family_clean) > 1
),

product_churn AS (
    SELECT 
        product_family_clean,
        COUNT(DISTINCT customer_id) AS customer_count,
        LAG(customer_count) OVER (
            PARTITION BY product_family_clean 
            ORDER BY first_transaction_month
        ) AS prev_customer_count,
        customer_count - LAG(customer_count) OVER (
            PARTITION BY product_family_clean 
            ORDER BY first_transaction_month
        ) AS customer_loss
    FROM transaction_summary
),

revenue_metrics AS (
    SELECT 
        SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS current_revenue,
        SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) AS previous_revenue,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         NULLIF(SUM(CASE WHEN first_transaction_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END), 0)) AS NRR,
        (SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END) * 1.0 /
         NULLIF(SUM(CASE WHEN last_transaction_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN total_revenue ELSE 0 END), 0)) AS GRR
    FROM transaction_summary
),

lost_revenue AS (
    SELECT 
        SUM(total_revenue) AS lost_revenue
    FROM transaction_summary
    WHERE customer_id IN (SELECT customer_id FROM churned_customers)
),

ranked_products AS (
    SELECT 
        product_family_clean,
        SUM(total_revenue) AS product_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY product_family_clean
),

ranked_customers AS (
    SELECT 
        customer_id,
        customer_name_clean,
        SUM(total_revenue) AS customer_revenue,
        RANK() OVER (ORDER BY SUM(total_revenue) DESC) AS revenue_rank
    FROM transaction_summary
    GROUP BY customer_id, customer_name_clean
)

SELECT * FROM new_customers
UNION ALL
SELECT * FROM churned_customers
UNION ALL
SELECT * FROM cross_sell_customers
UNION ALL
SELECT * FROM product_churn
UNION ALL
SELECT * FROM revenue_metrics
UNION ALL
SELECT * FROM lost_revenue
UNION ALL
SELECT * FROM ranked_products
UNION ALL
SELECT * FROM ranked_customers
  );
[0m01:06:49.628053 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:06:51.581074 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0238-0004-bb9d-0000-0005db4bdd95
[0m01:06:51.582178 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001789 (42601): SQL compilation error:
invalid number of result columns for set operator input branches, expected 2, got 3 in branch 2
[0m01:06:51.590825 [debug] [Thread-1 (]: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  001789 (42601): SQL compilation error:
  invalid number of result columns for set operator input branches, expected 2, got 3 in branch 2
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m01:06:51.597632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f519c05e-1857-4e22-9a9c-50758de84e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A1F8D6FD0>]}
[0m01:06:51.598529 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model PUBLIC.customer_revenue_bridge ............ [[31mERROR[0m in 2.04s]
[0m01:06:51.598529 [debug] [Thread-1 (]: Finished running node model.crb_kpi.customer_revenue_bridge
[0m01:06:51.598529 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m01:06:51.604177 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.customer_revenue_bridge' to be skipped because of status 'error'.  Reason: Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  001789 (42601): SQL compilation error:
  invalid number of result columns for set operator input branches, expected 2, got 3 in branch 2
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql.
[0m01:06:51.605699 [info ] [Thread-1 (]: 2 of 4 START sql view model PUBLIC.stg_customers ............................... [RUN]
[0m01:06:51.610257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.customer_revenue_bridge, now model.crb_kpi.stg_customers)
[0m01:06:51.612350 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m01:06:51.616158 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m01:06:51.616158 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m01:06:51.622405 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m01:06:51.625976 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m01:06:51.625976 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean
FROM raw
  );
[0m01:06:52.185617 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.559 seconds
[0m01:06:52.235766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f519c05e-1857-4e22-9a9c-50758de84e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A1C360AD0>]}
[0m01:06:52.235766 [info ] [Thread-1 (]: 2 of 4 OK created sql view model PUBLIC.stg_customers .......................... [[32mSUCCESS 1[0m in 0.63s]
[0m01:06:52.240795 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m01:06:52.240795 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m01:06:52.240795 [info ] [Thread-1 (]: 3 of 4 START sql view model PUBLIC.stg_products ................................ [RUN]
[0m01:06:52.240795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m01:06:52.240795 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m01:06:52.245877 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m01:06:52.245877 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m01:06:52.245877 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m01:06:52.255624 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m01:06:52.258157 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM public.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m01:06:52.835776 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.577 seconds
[0m01:06:52.841750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f519c05e-1857-4e22-9a9c-50758de84e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A1F704950>]}
[0m01:06:52.841750 [info ] [Thread-1 (]: 3 of 4 OK created sql view model PUBLIC.stg_products ........................... [[32mSUCCESS 1[0m in 0.60s]
[0m01:06:52.845832 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m01:06:52.845832 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m01:06:52.849986 [info ] [Thread-1 (]: 4 of 4 START sql view model PUBLIC.stg_transactions ............................ [RUN]
[0m01:06:52.849986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m01:06:52.854689 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m01:06:52.860295 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m01:06:52.863387 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m01:06:52.869990 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m01:06:52.873853 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m01:06:52.874974 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m01:06:53.511540 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.636 seconds
[0m01:06:53.515654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f519c05e-1857-4e22-9a9c-50758de84e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A1F8F8B90>]}
[0m01:06:53.519889 [info ] [Thread-1 (]: 4 of 4 OK created sql view model PUBLIC.stg_transactions ....................... [[32mSUCCESS 1[0m in 0.67s]
[0m01:06:53.522133 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m01:06:53.525650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:06:53.525650 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m01:06:53.525650 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m01:06:54.190598 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m01:06:54.190598 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m01:06:54.815814 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m01:06:54.815814 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m01:06:55.537994 [info ] [MainThread]: 
[0m01:06:55.537994 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 10.26 seconds (10.26s).
[0m01:06:55.548388 [debug] [MainThread]: Command end result
[0m01:06:55.601510 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:06:55.606344 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:06:55.617495 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m01:06:55.621398 [info ] [MainThread]: 
[0m01:06:55.624145 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:06:55.625666 [info ] [MainThread]: 
[0m01:06:55.625666 [error] [MainThread]:   Database Error in model customer_revenue_bridge (models\marts\customer_revenue_bridge.sql)
  001789 (42601): SQL compilation error:
  invalid number of result columns for set operator input branches, expected 2, got 3 in branch 2
  compiled code at target\run\crb_kpi\models\marts\customer_revenue_bridge.sql
[0m01:06:55.631648 [info ] [MainThread]: 
[0m01:06:55.633757 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m01:06:55.635777 [debug] [MainThread]: Command `dbt run` failed at 01:06:55.635777 after 13.13 seconds
[0m01:06:55.637667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A18812D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A18812BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A18812050>]}
[0m01:06:55.638588 [debug] [MainThread]: Flushing usage events
[0m01:06:56.726037 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:17:51.878589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD3B5884D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD3B589CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD3B5893D0>]}


============================== 01:17:51.895317 | 53b415f4-d7a1-4edf-80e4-07a5f8add791 ==============================
[0m01:17:51.895317 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:17:51.895317 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:17:53.063800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53b415f4-d7a1-4edf-80e4-07a5f8add791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD3B5C4850>]}
[0m01:17:53.163736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53b415f4-d7a1-4edf-80e4-07a5f8add791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD39F6D290>]}
[0m01:17:53.168784 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:17:54.019948 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:17:54.437928 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 7 files added, 0 files changed.
[0m01:17:54.437928 [debug] [MainThread]: Partial parsing: added file: crb_kpi://models\marts\new_logos.sql
[0m01:17:54.437928 [debug] [MainThread]: Partial parsing: added file: crb_kpi://models\marts\cross_sell_product_churn.sql
[0m01:17:54.437928 [debug] [MainThread]: Partial parsing: added file: crb_kpi://models\marts\ranked_products.sql
[0m01:17:54.441004 [debug] [MainThread]: Partial parsing: added file: crb_kpi://models\marts\net_nrr_grr.sql
[0m01:17:54.441004 [debug] [MainThread]: Partial parsing: added file: crb_kpi://models\marts\ranked_customers.sql
[0m01:17:54.441004 [debug] [MainThread]: Partial parsing: added file: crb_kpi://models\marts\churned_new_customers.sql
[0m01:17:54.443400 [debug] [MainThread]: Partial parsing: added file: crb_kpi://models\marts\revenue_lost.sql
[0m01:17:54.444028 [debug] [MainThread]: Partial parsing: deleted file: crb_kpi://models\marts\customer_revenue_bridge.sql
[0m01:17:54.923529 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m01:17:54.936204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53b415f4-d7a1-4edf-80e4-07a5f8add791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD3CD1F5D0>]}
[0m01:17:55.057786 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:17:55.065834 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:17:55.191263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53b415f4-d7a1-4edf-80e4-07a5f8add791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD376232D0>]}
[0m01:17:55.193821 [info ] [MainThread]: Found 10 models, 474 macros
[0m01:17:55.193821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53b415f4-d7a1-4edf-80e4-07a5f8add791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD3CCB2B50>]}
[0m01:17:55.198607 [info ] [MainThread]: 
[0m01:17:55.198607 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:17:55.198607 [info ] [MainThread]: 
[0m01:17:55.198607 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:17:55.204710 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m01:17:55.345589 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m01:17:55.345589 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m01:17:55.353672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:57.630362 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.280 seconds
[0m01:17:57.638394 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m01:17:57.665614 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m01:17:57.666591 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m01:17:57.668540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:59.540912 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.872 seconds
[0m01:17:59.543426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53b415f4-d7a1-4edf-80e4-07a5f8add791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD3C116A90>]}
[0m01:17:59.557423 [debug] [Thread-1 (]: Began running node model.crb_kpi.churned_new_customers
[0m01:17:59.563442 [info ] [Thread-1 (]: 1 of 10 START sql view model PUBLIC.churned_new_customers ...................... [RUN]
[0m01:17:59.565501 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.churned_new_customers'
[0m01:17:59.566231 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.churned_new_customers
[0m01:17:59.583853 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.churned_new_customers"
[0m01:17:59.588911 [debug] [Thread-1 (]: Began executing node model.crb_kpi.churned_new_customers
[0m01:17:59.639402 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.churned_new_customers"
[0m01:17:59.643413 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.churned_new_customers"
[0m01:17:59.647453 [debug] [Thread-1 (]: On model.crb_kpi.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.churned_new_customers"} */
create or replace   view CRBFITNESS.PUBLIC.churned_new_customers
  
   as (
    SELECT 
    customer_id, 
    'new' AS customer_status, 
    MIN(payment_month) AS first_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MIN(payment_month) IS NOT NULL

UNION ALL

SELECT 
    customer_id, 
    'churned' AS customer_status, 
    MAX(payment_month) AS last_transaction_month
FROM public.stg_transactions
WHERE MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
GROUP BY customer_id;
[0m01:17:59.647453 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:18:01.385344 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0244-0004-bde4-0000-0005db4bf4d9
[0m01:18:01.388192 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 20 unexpected ';'.
[0m01:18:01.397468 [debug] [Thread-1 (]: Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 20 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql
[0m01:18:01.398988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b415f4-d7a1-4edf-80e4-07a5f8add791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD3C930D10>]}
[0m01:18:01.403527 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model PUBLIC.churned_new_customers ............. [[31mERROR[0m in 1.84s]
[0m01:18:01.404571 [debug] [Thread-1 (]: Finished running node model.crb_kpi.churned_new_customers
[0m01:18:01.404571 [debug] [Thread-1 (]: Began running node model.crb_kpi.cross_sell_product_churn
[0m01:18:01.404571 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.churned_new_customers' to be skipped because of status 'error'.  Reason: Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 20 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql.
[0m01:18:01.404571 [info ] [Thread-1 (]: 2 of 10 START sql view model PUBLIC.cross_sell_product_churn ................... [RUN]
[0m01:18:01.413743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.churned_new_customers, now model.crb_kpi.cross_sell_product_churn)
[0m01:18:01.413743 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.cross_sell_product_churn
[0m01:18:01.413743 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.cross_sell_product_churn"
[0m01:18:01.421173 [debug] [Thread-1 (]: Began executing node model.crb_kpi.cross_sell_product_churn
[0m01:18:01.424692 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.cross_sell_product_churn"
[0m01:18:01.432172 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.cross_sell_product_churn"
[0m01:18:01.433815 [debug] [Thread-1 (]: On model.crb_kpi.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.cross_sell_product_churn"} */
create or replace   view CRBFITNESS.PUBLIC.cross_sell_product_churn
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    p.product_family_clean, 
    COUNT(DISTINCT p.product_family_clean) AS cross_sell_count
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
ORDER BY cross_sell_count DESC
LIMIT 10;
[0m01:18:01.814564 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0244-0004-bb9d-0000-0005db4bde09
[0m01:18:01.814564 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 8 unexpected ';'.
[0m01:18:01.823437 [debug] [Thread-1 (]: Database Error in model cross_sell_product_churn (models\marts\cross_sell_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\cross_sell_product_churn.sql
[0m01:18:01.823437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b415f4-d7a1-4edf-80e4-07a5f8add791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD3D4FE8D0>]}
[0m01:18:01.823437 [error] [Thread-1 (]: 2 of 10 ERROR creating sql view model PUBLIC.cross_sell_product_churn .......... [[31mERROR[0m in 0.41s]
[0m01:18:01.830977 [debug] [Thread-1 (]: Finished running node model.crb_kpi.cross_sell_product_churn
[0m01:18:01.833488 [debug] [Thread-1 (]: Began running node model.crb_kpi.net_nrr_grr
[0m01:18:01.833488 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.cross_sell_product_churn' to be skipped because of status 'error'.  Reason: Database Error in model cross_sell_product_churn (models\marts\cross_sell_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\cross_sell_product_churn.sql.
[0m01:18:01.833488 [info ] [Thread-1 (]: 3 of 10 START sql view model PUBLIC.net_nrr_grr ................................ [RUN]
[0m01:18:01.839143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.cross_sell_product_churn, now model.crb_kpi.net_nrr_grr)
[0m01:18:01.839143 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.net_nrr_grr
[0m01:18:01.844220 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.net_nrr_grr"
[0m01:18:01.847240 [debug] [Thread-1 (]: Began executing node model.crb_kpi.net_nrr_grr
[0m01:18:01.855360 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.net_nrr_grr"
[0m01:18:01.855360 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.net_nrr_grr"
[0m01:18:01.855360 [debug] [Thread-1 (]: On model.crb_kpi.net_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.net_nrr_grr"} */
create or replace   view CRBFITNESS.PUBLIC.net_nrr_grr
  
   as (
    SELECT 
    SUM(CASE WHEN t.payment_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN t.revenue ELSE 0 END) AS current_revenue,
    SUM(CASE WHEN t.payment_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN t.revenue ELSE 0 END) AS previous_revenue,
    (SUM(CASE WHEN t.payment_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN t.revenue ELSE 0 END) * 1.0 /
     NULLIF(SUM(CASE WHEN t.payment_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN t.revenue ELSE 0 END), 0)) AS NRR,
    (SUM(CASE WHEN t.payment_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN t.revenue ELSE 0 END) * 1.0 /
     NULLIF(SUM(CASE WHEN t.payment_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN t.revenue ELSE 0 END), 0)) AS GRR
FROM public.stg_transactions t;
[0m01:18:02.227023 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0244-0004-c178-0005-db4b0001926e
[0m01:18:02.227023 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 30 unexpected ';'.
[0m01:18:02.235410 [debug] [Thread-1 (]: Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 30 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql
[0m01:18:02.235410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b415f4-d7a1-4edf-80e4-07a5f8add791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD3D976490>]}
[0m01:18:02.243986 [error] [Thread-1 (]: 3 of 10 ERROR creating sql view model PUBLIC.net_nrr_grr ....................... [[31mERROR[0m in 0.40s]
[0m01:18:02.245239 [debug] [Thread-1 (]: Finished running node model.crb_kpi.net_nrr_grr
[0m01:18:02.249300 [debug] [Thread-1 (]: Began running node model.crb_kpi.new_logos
[0m01:18:02.250189 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.net_nrr_grr' to be skipped because of status 'error'.  Reason: Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 30 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql.
[0m01:18:02.251706 [info ] [Thread-1 (]: 4 of 10 START sql view model PUBLIC.new_logos .................................. [RUN]
[0m01:18:02.253931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.net_nrr_grr, now model.crb_kpi.new_logos)
[0m01:18:02.253931 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.new_logos
[0m01:18:02.259992 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.new_logos"
[0m01:18:02.261494 [debug] [Thread-1 (]: Began executing node model.crb_kpi.new_logos
[0m01:18:02.264959 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.new_logos"
[0m01:18:02.268966 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.new_logos"
[0m01:18:02.270710 [debug] [Thread-1 (]: On model.crb_kpi.new_logos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.new_logos"} */
create or replace   view CRBFITNESS.PUBLIC.new_logos
  
   as (
    SELECT 
    t.customer_id, 
    MIN(EXTRACT(YEAR FROM t.payment_month)) AS first_fiscal_year
FROM public.stg_transactions t
GROUP BY t.customer_id;
[0m01:18:02.673800 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0244-0004-c0bd-0005-db4b000173ce
[0m01:18:02.673800 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 22 unexpected ';'.
[0m01:18:02.683958 [debug] [Thread-1 (]: Database Error in model new_logos (models\marts\new_logos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 22 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\new_logos.sql
[0m01:18:02.683958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b415f4-d7a1-4edf-80e4-07a5f8add791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD3D4D1190>]}
[0m01:18:02.683958 [error] [Thread-1 (]: 4 of 10 ERROR creating sql view model PUBLIC.new_logos ......................... [[31mERROR[0m in 0.43s]
[0m01:18:02.689014 [debug] [Thread-1 (]: Finished running node model.crb_kpi.new_logos
[0m01:18:02.689014 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_customers
[0m01:18:02.689014 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.new_logos' to be skipped because of status 'error'.  Reason: Database Error in model new_logos (models\marts\new_logos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 22 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\new_logos.sql.
[0m01:18:02.693728 [info ] [Thread-1 (]: 5 of 10 START sql view model PUBLIC.ranked_customers ........................... [RUN]
[0m01:18:02.693728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.new_logos, now model.crb_kpi.ranked_customers)
[0m01:18:02.697342 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_customers
[0m01:18:02.703858 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_customers"
[0m01:18:02.705433 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_customers
[0m01:18:02.718802 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_customers"
[0m01:18:02.723902 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_customers"
[0m01:18:02.729496 [debug] [Thread-1 (]: On model.crb_kpi.ranked_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_customers"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_customers
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
GROUP BY t.customer_id, c.customer_name_clean
ORDER BY total_revenue DESC;
[0m01:18:03.108673 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0244-0004-bde4-0000-0005db4bf4dd
[0m01:18:03.108673 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 27 unexpected ';'.
[0m01:18:03.116776 [debug] [Thread-1 (]: Database Error in model ranked_customers (models\marts\ranked_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 27 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\ranked_customers.sql
[0m01:18:03.123798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b415f4-d7a1-4edf-80e4-07a5f8add791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD3D99B950>]}
[0m01:18:03.124859 [error] [Thread-1 (]: 5 of 10 ERROR creating sql view model PUBLIC.ranked_customers .................. [[31mERROR[0m in 0.43s]
[0m01:18:03.129237 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_customers
[0m01:18:03.130861 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_products
[0m01:18:03.130861 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.ranked_customers' to be skipped because of status 'error'.  Reason: Database Error in model ranked_customers (models\marts\ranked_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 27 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\ranked_customers.sql.
[0m01:18:03.133938 [info ] [Thread-1 (]: 6 of 10 START sql view model PUBLIC.ranked_products ............................ [RUN]
[0m01:18:03.133938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_customers, now model.crb_kpi.ranked_products)
[0m01:18:03.133938 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_products
[0m01:18:03.144009 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_products"
[0m01:18:03.148395 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_products
[0m01:18:03.153701 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_products"
[0m01:18:03.153701 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_products"
[0m01:18:03.158728 [debug] [Thread-1 (]: On model.crb_kpi.ranked_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_products"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_products
  
   as (
    SELECT 
    p.product_family_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY p.product_family_clean
ORDER BY total_revenue DESC;
[0m01:18:03.488586 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0244-0004-c178-0005-db4b00019272
[0m01:18:03.493689 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 27 unexpected ';'.
[0m01:18:03.501544 [debug] [Thread-1 (]: Database Error in model ranked_products (models\marts\ranked_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 27 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\ranked_products.sql
[0m01:18:03.503678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b415f4-d7a1-4edf-80e4-07a5f8add791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD3D990E90>]}
[0m01:18:03.505327 [error] [Thread-1 (]: 6 of 10 ERROR creating sql view model PUBLIC.ranked_products ................... [[31mERROR[0m in 0.37s]
[0m01:18:03.509479 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_products
[0m01:18:03.509479 [debug] [Thread-1 (]: Began running node model.crb_kpi.revenue_lost
[0m01:18:03.512362 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.ranked_products' to be skipped because of status 'error'.  Reason: Database Error in model ranked_products (models\marts\ranked_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 27 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\ranked_products.sql.
[0m01:18:03.514626 [info ] [Thread-1 (]: 7 of 10 START sql view model PUBLIC.revenue_lost ............................... [RUN]
[0m01:18:03.514626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_products, now model.crb_kpi.revenue_lost)
[0m01:18:03.514626 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.revenue_lost
[0m01:18:03.526231 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.revenue_lost"
[0m01:18:03.526231 [debug] [Thread-1 (]: Began executing node model.crb_kpi.revenue_lost
[0m01:18:03.533490 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.revenue_lost"
[0m01:18:03.543928 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.revenue_lost"
[0m01:18:03.548306 [debug] [Thread-1 (]: On model.crb_kpi.revenue_lost: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.revenue_lost"} */
create or replace   view CRBFITNESS.PUBLIC.revenue_lost
  
   as (
    SELECT 
    t.payment_month AS period, 
    SUM(t.revenue) AS total_revenue_lost
FROM public.stg_transactions t
WHERE t.customer_id IN (
    SELECT customer_id 
    FROM public.stg_transactions 
    GROUP BY customer_id 
    HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
)
GROUP BY t.payment_month
ORDER BY t.payment_month;
[0m01:18:03.911755 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0244-0004-c0bd-0005-db4b000173d2
[0m01:18:03.913856 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 24 unexpected ';'.
[0m01:18:03.919880 [debug] [Thread-1 (]: Database Error in model revenue_lost (models\marts\revenue_lost.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 24 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\revenue_lost.sql
[0m01:18:03.919880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b415f4-d7a1-4edf-80e4-07a5f8add791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD3D963850>]}
[0m01:18:03.923974 [error] [Thread-1 (]: 7 of 10 ERROR creating sql view model PUBLIC.revenue_lost ...................... [[31mERROR[0m in 0.41s]
[0m01:18:03.923974 [debug] [Thread-1 (]: Finished running node model.crb_kpi.revenue_lost
[0m01:18:03.928729 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m01:18:03.929795 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.revenue_lost' to be skipped because of status 'error'.  Reason: Database Error in model revenue_lost (models\marts\revenue_lost.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 24 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\revenue_lost.sql.
[0m01:18:03.929795 [info ] [Thread-1 (]: 8 of 10 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m01:18:03.933817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.revenue_lost, now model.crb_kpi.stg_customers)
[0m01:18:03.933817 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m01:18:03.936373 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m01:18:03.943893 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m01:18:03.947848 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m01:18:03.952359 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m01:18:03.953877 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean
FROM raw
  );
[0m01:18:04.554742 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.602 seconds
[0m01:18:04.602547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b415f4-d7a1-4edf-80e4-07a5f8add791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD3D4C06D0>]}
[0m01:18:04.603634 [info ] [Thread-1 (]: 8 of 10 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 0.67s]
[0m01:18:04.603634 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m01:18:04.603634 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m01:18:04.608147 [info ] [Thread-1 (]: 9 of 10 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m01:18:04.610812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m01:18:04.610812 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m01:18:04.613829 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m01:18:04.618872 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m01:18:04.623751 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m01:18:04.627264 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m01:18:04.629625 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM public.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m01:18:05.176350 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.547 seconds
[0m01:18:05.183872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b415f4-d7a1-4edf-80e4-07a5f8add791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD3D95ED90>]}
[0m01:18:05.183872 [info ] [Thread-1 (]: 9 of 10 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 0.57s]
[0m01:18:05.188385 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m01:18:05.188952 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m01:18:05.189887 [info ] [Thread-1 (]: 10 of 10 START sql view model PUBLIC.stg_transactions .......................... [RUN]
[0m01:18:05.191318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m01:18:05.192329 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m01:18:05.193846 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m01:18:05.198884 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m01:18:05.205304 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m01:18:05.205304 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m01:18:05.208821 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m01:18:05.888806 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.680 seconds
[0m01:18:05.893820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b415f4-d7a1-4edf-80e4-07a5f8add791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD3D968710>]}
[0m01:18:05.897651 [info ] [Thread-1 (]: 10 of 10 OK created sql view model PUBLIC.stg_transactions ..................... [[32mSUCCESS 1[0m in 0.70s]
[0m01:18:05.899373 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m01:18:05.900922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:05.903500 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m01:18:05.905014 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m01:18:06.531640 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m01:18:06.533746 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m01:18:07.149833 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m01:18:07.149833 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m01:18:07.776325 [info ] [MainThread]: 
[0m01:18:07.778548 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 12.58 seconds (12.58s).
[0m01:18:07.784658 [debug] [MainThread]: Command end result
[0m01:18:07.833976 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:18:07.844248 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:18:07.863620 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m01:18:07.868469 [info ] [MainThread]: 
[0m01:18:07.868469 [info ] [MainThread]: [31mCompleted with 7 errors, 0 partial successes, and 0 warnings:[0m
[0m01:18:07.868469 [info ] [MainThread]: 
[0m01:18:07.874829 [error] [MainThread]:   Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 20 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql
[0m01:18:07.876177 [info ] [MainThread]: 
[0m01:18:07.879209 [error] [MainThread]:   Database Error in model cross_sell_product_churn (models\marts\cross_sell_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\cross_sell_product_churn.sql
[0m01:18:07.880178 [info ] [MainThread]: 
[0m01:18:07.883472 [error] [MainThread]:   Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 30 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql
[0m01:18:07.883472 [info ] [MainThread]: 
[0m01:18:07.887093 [error] [MainThread]:   Database Error in model new_logos (models\marts\new_logos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 22 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\new_logos.sql
[0m01:18:07.887093 [info ] [MainThread]: 
[0m01:18:07.891133 [error] [MainThread]:   Database Error in model ranked_customers (models\marts\ranked_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 27 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\ranked_customers.sql
[0m01:18:07.895186 [info ] [MainThread]: 
[0m01:18:07.906066 [error] [MainThread]:   Database Error in model ranked_products (models\marts\ranked_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 27 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\ranked_products.sql
[0m01:18:07.907587 [info ] [MainThread]: 
[0m01:18:07.913684 [error] [MainThread]:   Database Error in model revenue_lost (models\marts\revenue_lost.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 24 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\revenue_lost.sql
[0m01:18:07.915822 [info ] [MainThread]: 
[0m01:18:07.915822 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=7 SKIP=0 TOTAL=10
[0m01:18:07.915822 [debug] [MainThread]: Command `dbt run` failed at 01:18:07.915822 after 16.28 seconds
[0m01:18:07.923541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD3B5EE9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD36072D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD3B47BF50>]}
[0m01:18:07.924681 [debug] [MainThread]: Flushing usage events
[0m01:18:09.468806 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:18:43.641956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE988C590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE988DAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE988C1D0>]}


============================== 01:18:43.653332 | 0132e298-f458-4e63-8241-89a89c9a5311 ==============================
[0m01:18:43.653332 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:18:43.653332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:18:44.413885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0132e298-f458-4e63-8241-89a89c9a5311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE9896890>]}
[0m01:18:44.516694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0132e298-f458-4e63-8241-89a89c9a5311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE826D210>]}
[0m01:18:44.516694 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:18:45.283479 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:18:45.666113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 7 files changed.
[0m01:18:45.666113 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\churned_new_customers.sql
[0m01:18:45.666113 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\ranked_products.sql
[0m01:18:45.666113 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\net_nrr_grr.sql
[0m01:18:45.666113 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\new_logos.sql
[0m01:18:45.666113 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\cross_sell_product_churn.sql
[0m01:18:45.673619 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\revenue_lost.sql
[0m01:18:45.673619 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\ranked_customers.sql
[0m01:18:46.170795 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m01:18:46.175366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0132e298-f458-4e63-8241-89a89c9a5311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DEAA6DC90>]}
[0m01:18:46.327703 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:18:46.337906 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:18:46.413323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0132e298-f458-4e63-8241-89a89c9a5311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DEB067550>]}
[0m01:18:46.413323 [info ] [MainThread]: Found 10 models, 474 macros
[0m01:18:46.413323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0132e298-f458-4e63-8241-89a89c9a5311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DEAE9FE50>]}
[0m01:18:46.423613 [info ] [MainThread]: 
[0m01:18:46.423747 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:18:46.431702 [info ] [MainThread]: 
[0m01:18:46.436845 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:18:46.444906 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m01:18:46.763233 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m01:18:46.764875 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m01:18:46.764875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:48.847014 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.080 seconds
[0m01:18:48.853494 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m01:18:48.885337 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m01:18:48.885337 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m01:18:48.892922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:50.853603 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.963 seconds
[0m01:18:50.863417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0132e298-f458-4e63-8241-89a89c9a5311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DEA688D90>]}
[0m01:18:50.880758 [debug] [Thread-1 (]: Began running node model.crb_kpi.churned_new_customers
[0m01:18:50.883778 [info ] [Thread-1 (]: 1 of 10 START sql view model PUBLIC.churned_new_customers ...................... [RUN]
[0m01:18:50.883778 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.churned_new_customers'
[0m01:18:50.886833 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.churned_new_customers
[0m01:18:50.903613 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.churned_new_customers"
[0m01:18:50.903613 [debug] [Thread-1 (]: Began executing node model.crb_kpi.churned_new_customers
[0m01:18:50.973623 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.churned_new_customers"
[0m01:18:50.978234 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.churned_new_customers"
[0m01:18:50.978234 [debug] [Thread-1 (]: On model.crb_kpi.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.churned_new_customers"} */
create or replace   view CRBFITNESS.PUBLIC.churned_new_customers
  
   as (
    SELECT 
    customer_id, 
    'new' AS customer_status, 
    MIN(payment_month) AS first_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MIN(payment_month) IS NOT NULL

UNION ALL

SELECT 
    customer_id, 
    'churned' AS customer_status, 
    MAX(payment_month) AS last_transaction_month
FROM public.stg_transactions
WHERE MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
GROUP BY customer_id
  );
[0m01:18:50.978234 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:18:52.776668 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0244-0004-c178-0005-db4b0001927a
[0m01:18:52.776668 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002035 (42601): SQL compilation error:
Invalid aggregate function in where clause [MAX(STG_TRANSACTIONS.PAYMENT_MONTH)]
[0m01:18:52.784928 [debug] [Thread-1 (]: Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  002035 (42601): SQL compilation error:
  Invalid aggregate function in where clause [MAX(STG_TRANSACTIONS.PAYMENT_MONTH)]
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql
[0m01:18:52.784928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0132e298-f458-4e63-8241-89a89c9a5311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DEAACC950>]}
[0m01:18:52.794117 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model PUBLIC.churned_new_customers ............. [[31mERROR[0m in 1.90s]
[0m01:18:52.797125 [debug] [Thread-1 (]: Finished running node model.crb_kpi.churned_new_customers
[0m01:18:52.797125 [debug] [Thread-1 (]: Began running node model.crb_kpi.cross_sell_product_churn
[0m01:18:52.797125 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.churned_new_customers' to be skipped because of status 'error'.  Reason: Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  002035 (42601): SQL compilation error:
  Invalid aggregate function in where clause [MAX(STG_TRANSACTIONS.PAYMENT_MONTH)]
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql.
[0m01:18:52.797125 [info ] [Thread-1 (]: 2 of 10 START sql view model PUBLIC.cross_sell_product_churn ................... [RUN]
[0m01:18:52.803664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.churned_new_customers, now model.crb_kpi.cross_sell_product_churn)
[0m01:18:52.803664 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.cross_sell_product_churn
[0m01:18:52.810037 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.cross_sell_product_churn"
[0m01:18:52.813505 [debug] [Thread-1 (]: Began executing node model.crb_kpi.cross_sell_product_churn
[0m01:18:52.823620 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.cross_sell_product_churn"
[0m01:18:52.829790 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.cross_sell_product_churn"
[0m01:18:52.829790 [debug] [Thread-1 (]: On model.crb_kpi.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.cross_sell_product_churn"} */
create or replace   view CRBFITNESS.PUBLIC.cross_sell_product_churn
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    p.product_family_clean, 
    COUNT(DISTINCT p.product_family_clean) AS cross_sell_count
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
ORDER BY cross_sell_count DESC
LIMIT 10
  );
[0m01:18:53.493364 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.664 seconds
[0m01:18:53.553748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0132e298-f458-4e63-8241-89a89c9a5311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE8260990>]}
[0m01:18:53.553748 [info ] [Thread-1 (]: 2 of 10 OK created sql view model PUBLIC.cross_sell_product_churn .............. [[32mSUCCESS 1[0m in 0.75s]
[0m01:18:53.557980 [debug] [Thread-1 (]: Finished running node model.crb_kpi.cross_sell_product_churn
[0m01:18:53.559992 [debug] [Thread-1 (]: Began running node model.crb_kpi.net_nrr_grr
[0m01:18:53.561426 [info ] [Thread-1 (]: 3 of 10 START sql view model PUBLIC.net_nrr_grr ................................ [RUN]
[0m01:18:53.563392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.cross_sell_product_churn, now model.crb_kpi.net_nrr_grr)
[0m01:18:53.563392 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.net_nrr_grr
[0m01:18:53.568450 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.net_nrr_grr"
[0m01:18:53.576702 [debug] [Thread-1 (]: Began executing node model.crb_kpi.net_nrr_grr
[0m01:18:53.583287 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.net_nrr_grr"
[0m01:18:53.587902 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.net_nrr_grr"
[0m01:18:53.587902 [debug] [Thread-1 (]: On model.crb_kpi.net_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.net_nrr_grr"} */
create or replace   view CRBFITNESS.PUBLIC.net_nrr_grr
  
   as (
    SELECT 
    SUM(CASE WHEN t.payment_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN t.revenue ELSE 0 END) AS current_revenue,
    SUM(CASE WHEN t.payment_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN t.revenue ELSE 0 END) AS previous_revenue,
    (SUM(CASE WHEN t.payment_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN t.revenue ELSE 0 END) * 1.0 /
     NULLIF(SUM(CASE WHEN t.payment_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN t.revenue ELSE 0 END), 0)) AS NRR,
    (SUM(CASE WHEN t.payment_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN t.revenue ELSE 0 END) * 1.0 /
     NULLIF(SUM(CASE WHEN t.payment_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN t.revenue ELSE 0 END), 0)) AS GRR
FROM public.stg_transactions t
  );
[0m01:18:54.253655 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.668 seconds
[0m01:18:54.262015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0132e298-f458-4e63-8241-89a89c9a5311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DEBC57890>]}
[0m01:18:54.263408 [info ] [Thread-1 (]: 3 of 10 OK created sql view model PUBLIC.net_nrr_grr ........................... [[32mSUCCESS 1[0m in 0.70s]
[0m01:18:54.265233 [debug] [Thread-1 (]: Finished running node model.crb_kpi.net_nrr_grr
[0m01:18:54.265233 [debug] [Thread-1 (]: Began running node model.crb_kpi.new_logos
[0m01:18:54.265233 [info ] [Thread-1 (]: 4 of 10 START sql view model PUBLIC.new_logos .................................. [RUN]
[0m01:18:54.269315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.net_nrr_grr, now model.crb_kpi.new_logos)
[0m01:18:54.270328 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.new_logos
[0m01:18:54.271193 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.new_logos"
[0m01:18:54.273703 [debug] [Thread-1 (]: Began executing node model.crb_kpi.new_logos
[0m01:18:54.278416 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.new_logos"
[0m01:18:54.283432 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.new_logos"
[0m01:18:54.284014 [debug] [Thread-1 (]: On model.crb_kpi.new_logos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.new_logos"} */
create or replace   view CRBFITNESS.PUBLIC.new_logos
  
   as (
    SELECT 
    t.customer_id, 
    MIN(EXTRACT(YEAR FROM t.payment_month)) AS first_fiscal_year
FROM public.stg_transactions t
GROUP BY t.customer_id
  );
[0m01:18:54.920201 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.634 seconds
[0m01:18:54.923323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0132e298-f458-4e63-8241-89a89c9a5311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DEBCB4A90>]}
[0m01:18:54.930563 [info ] [Thread-1 (]: 4 of 10 OK created sql view model PUBLIC.new_logos ............................. [[32mSUCCESS 1[0m in 0.66s]
[0m01:18:54.933691 [debug] [Thread-1 (]: Finished running node model.crb_kpi.new_logos
[0m01:18:54.936439 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_customers
[0m01:18:54.936439 [info ] [Thread-1 (]: 5 of 10 START sql view model PUBLIC.ranked_customers ........................... [RUN]
[0m01:18:54.944593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.new_logos, now model.crb_kpi.ranked_customers)
[0m01:18:54.945614 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_customers
[0m01:18:54.952673 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_customers"
[0m01:18:54.958252 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_customers
[0m01:18:54.969573 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_customers"
[0m01:18:54.973749 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_customers"
[0m01:18:54.973749 [debug] [Thread-1 (]: On model.crb_kpi.ranked_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_customers"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_customers
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
GROUP BY t.customer_id, c.customer_name_clean
ORDER BY total_revenue DESC
  );
[0m01:18:55.668503 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.690 seconds
[0m01:18:55.673931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0132e298-f458-4e63-8241-89a89c9a5311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DEBCB5E90>]}
[0m01:18:55.676967 [info ] [Thread-1 (]: 5 of 10 OK created sql view model PUBLIC.ranked_customers ...................... [[32mSUCCESS 1[0m in 0.74s]
[0m01:18:55.682208 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_customers
[0m01:18:55.683721 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_products
[0m01:18:55.685282 [info ] [Thread-1 (]: 6 of 10 START sql view model PUBLIC.ranked_products ............................ [RUN]
[0m01:18:55.685806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_customers, now model.crb_kpi.ranked_products)
[0m01:18:55.685806 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_products
[0m01:18:55.695232 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_products"
[0m01:18:55.695232 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_products
[0m01:18:55.709964 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_products"
[0m01:18:55.718233 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_products"
[0m01:18:55.718233 [debug] [Thread-1 (]: On model.crb_kpi.ranked_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_products"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_products
  
   as (
    SELECT 
    p.product_family_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY p.product_family_clean
ORDER BY total_revenue DESC
  );
[0m01:18:56.273450 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.552 seconds
[0m01:18:56.281270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0132e298-f458-4e63-8241-89a89c9a5311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DEAF67210>]}
[0m01:18:56.283507 [info ] [Thread-1 (]: 6 of 10 OK created sql view model PUBLIC.ranked_products ....................... [[32mSUCCESS 1[0m in 0.60s]
[0m01:18:56.283507 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_products
[0m01:18:56.288540 [debug] [Thread-1 (]: Began running node model.crb_kpi.revenue_lost
[0m01:18:56.288540 [info ] [Thread-1 (]: 7 of 10 START sql view model PUBLIC.revenue_lost ............................... [RUN]
[0m01:18:56.288540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_products, now model.crb_kpi.revenue_lost)
[0m01:18:56.295150 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.revenue_lost
[0m01:18:56.303417 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.revenue_lost"
[0m01:18:56.305072 [debug] [Thread-1 (]: Began executing node model.crb_kpi.revenue_lost
[0m01:18:56.313598 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.revenue_lost"
[0m01:18:56.318621 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.revenue_lost"
[0m01:18:56.321639 [debug] [Thread-1 (]: On model.crb_kpi.revenue_lost: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.revenue_lost"} */
create or replace   view CRBFITNESS.PUBLIC.revenue_lost
  
   as (
    SELECT 
    t.payment_month AS period, 
    SUM(t.revenue) AS total_revenue_lost
FROM public.stg_transactions t
WHERE t.customer_id IN (
    SELECT customer_id 
    FROM public.stg_transactions 
    GROUP BY customer_id 
    HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
)
GROUP BY t.payment_month
ORDER BY t.payment_month
  );
[0m01:18:56.820834 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.499 seconds
[0m01:18:56.823352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0132e298-f458-4e63-8241-89a89c9a5311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DEB6CB290>]}
[0m01:18:56.829315 [info ] [Thread-1 (]: 7 of 10 OK created sql view model PUBLIC.revenue_lost .......................... [[32mSUCCESS 1[0m in 0.53s]
[0m01:18:56.832542 [debug] [Thread-1 (]: Finished running node model.crb_kpi.revenue_lost
[0m01:18:56.833561 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m01:18:56.833561 [info ] [Thread-1 (]: 8 of 10 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m01:18:56.836706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.revenue_lost, now model.crb_kpi.stg_customers)
[0m01:18:56.836706 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m01:18:56.843489 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m01:18:56.845042 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m01:18:56.850934 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m01:18:56.853706 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m01:18:56.855700 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean
FROM raw
  );
[0m01:18:57.373369 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.522 seconds
[0m01:18:57.390068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0132e298-f458-4e63-8241-89a89c9a5311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DEB513B10>]}
[0m01:18:57.393682 [info ] [Thread-1 (]: 8 of 10 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 0.55s]
[0m01:18:57.398190 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m01:18:57.400180 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m01:18:57.400180 [info ] [Thread-1 (]: 9 of 10 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m01:18:57.403850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m01:18:57.407303 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m01:18:57.414500 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m01:18:57.414500 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m01:18:57.433615 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m01:18:57.439818 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m01:18:57.444501 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM public.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m01:18:57.933675 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.483 seconds
[0m01:18:57.943549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0132e298-f458-4e63-8241-89a89c9a5311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DEBCFDBD0>]}
[0m01:18:57.943549 [info ] [Thread-1 (]: 9 of 10 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 0.54s]
[0m01:18:57.950201 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m01:18:57.953721 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m01:18:57.953813 [info ] [Thread-1 (]: 10 of 10 START sql view model PUBLIC.stg_transactions .......................... [RUN]
[0m01:18:57.958265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m01:18:57.960502 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m01:18:57.966635 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m01:18:57.970081 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m01:18:57.983547 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m01:18:57.983547 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m01:18:57.983547 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m01:18:58.586918 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.602 seconds
[0m01:18:58.595097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0132e298-f458-4e63-8241-89a89c9a5311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DEB6BBA50>]}
[0m01:18:58.607277 [info ] [Thread-1 (]: 10 of 10 OK created sql view model PUBLIC.stg_transactions ..................... [[32mSUCCESS 1[0m in 0.64s]
[0m01:18:58.616466 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m01:18:58.621556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:58.621556 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m01:18:58.623574 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m01:18:59.270365 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m01:18:59.271377 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m01:18:59.897741 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m01:18:59.897741 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m01:19:00.517067 [info ] [MainThread]: 
[0m01:19:00.517067 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 14.08 seconds (14.08s).
[0m01:19:00.530116 [debug] [MainThread]: Command end result
[0m01:19:00.603325 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:19:00.610644 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:19:00.623608 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m01:19:00.623608 [info ] [MainThread]: 
[0m01:19:00.623608 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:19:00.627434 [info ] [MainThread]: 
[0m01:19:00.631309 [error] [MainThread]:   Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  002035 (42601): SQL compilation error:
  Invalid aggregate function in where clause [MAX(STG_TRANSACTIONS.PAYMENT_MONTH)]
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql
[0m01:19:00.633396 [info ] [MainThread]: 
[0m01:19:00.639713 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m01:19:00.643765 [debug] [MainThread]: Command `dbt run` failed at 01:19:00.643765 after 17.13 seconds
[0m01:19:00.647806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE94AEE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE94AED10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE4262D10>]}
[0m01:19:00.650326 [debug] [MainThread]: Flushing usage events
[0m01:19:02.116320 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:20:26.623221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D0FC88490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D0F8AE850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D0F8AE910>]}


============================== 01:20:26.633039 | d7c16bcc-1dc3-4820-9b2a-e3c574a0f3cf ==============================
[0m01:20:26.633039 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:20:26.635979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:20:27.414900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7c16bcc-1dc3-4820-9b2a-e3c574a0f3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D0E7AB790>]}
[0m01:20:27.513289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7c16bcc-1dc3-4820-9b2a-e3c574a0f3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D1085D850>]}
[0m01:20:27.513289 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:20:28.263370 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:20:28.573447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:20:28.573447 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\churned_new_customers.sql
[0m01:20:28.928182 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m01:20:28.953227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7c16bcc-1dc3-4820-9b2a-e3c574a0f3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D10906550>]}
[0m01:20:29.073322 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:20:29.078289 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:20:29.121587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7c16bcc-1dc3-4820-9b2a-e3c574a0f3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D11267150>]}
[0m01:20:29.123107 [info ] [MainThread]: Found 10 models, 474 macros
[0m01:20:29.123107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7c16bcc-1dc3-4820-9b2a-e3c574a0f3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D112C2E50>]}
[0m01:20:29.128001 [info ] [MainThread]: 
[0m01:20:29.128001 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:20:29.132324 [info ] [MainThread]: 
[0m01:20:29.137584 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:20:29.143094 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m01:20:29.403038 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m01:20:29.403038 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m01:20:29.403038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:31.539213 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.130 seconds
[0m01:20:31.543462 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m01:20:31.569524 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m01:20:31.569524 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m01:20:31.573044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:33.353253 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.783 seconds
[0m01:20:33.365351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7c16bcc-1dc3-4820-9b2a-e3c574a0f3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D0BB9D0D0>]}
[0m01:20:33.382649 [debug] [Thread-1 (]: Began running node model.crb_kpi.churned_new_customers
[0m01:20:33.383162 [info ] [Thread-1 (]: 1 of 10 START sql view model PUBLIC.churned_new_customers ...................... [RUN]
[0m01:20:33.386087 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.churned_new_customers'
[0m01:20:33.387523 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.churned_new_customers
[0m01:20:33.399740 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.churned_new_customers"
[0m01:20:33.401456 [debug] [Thread-1 (]: Began executing node model.crb_kpi.churned_new_customers
[0m01:20:33.453108 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.churned_new_customers"
[0m01:20:33.456162 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.churned_new_customers"
[0m01:20:33.456162 [debug] [Thread-1 (]: On model.crb_kpi.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.churned_new_customers"} */
create or replace   view CRBFITNESS.PUBLIC.churned_new_customers
  
   as (
    SELECT 
    customer_id, 
    'new' AS customer_status, 
    MIN(payment_month) AS first_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MIN(payment_month) IS NOT NULL

UNION ALL

SELECT 
    customer_id, 
    'churned' AS customer_status, 
    MAX(payment_month) AS last_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE);
[0m01:20:33.456162 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:20:35.899950 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0246-0004-c0bd-0005-db4b000173e2
[0m01:20:35.903116 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 60 unexpected ';'.
[0m01:20:35.913035 [debug] [Thread-1 (]: Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 60 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql
[0m01:20:35.913035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7c16bcc-1dc3-4820-9b2a-e3c574a0f3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D1127D710>]}
[0m01:20:35.918923 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model PUBLIC.churned_new_customers ............. [[31mERROR[0m in 2.53s]
[0m01:20:35.921942 [debug] [Thread-1 (]: Finished running node model.crb_kpi.churned_new_customers
[0m01:20:35.923466 [debug] [Thread-1 (]: Began running node model.crb_kpi.cross_sell_product_churn
[0m01:20:35.923466 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.churned_new_customers' to be skipped because of status 'error'.  Reason: Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 60 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql.
[0m01:20:35.923466 [info ] [Thread-1 (]: 2 of 10 START sql view model PUBLIC.cross_sell_product_churn ................... [RUN]
[0m01:20:35.932737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.churned_new_customers, now model.crb_kpi.cross_sell_product_churn)
[0m01:20:35.935887 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.cross_sell_product_churn
[0m01:20:35.939559 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.cross_sell_product_churn"
[0m01:20:35.943075 [debug] [Thread-1 (]: Began executing node model.crb_kpi.cross_sell_product_churn
[0m01:20:35.949146 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.cross_sell_product_churn"
[0m01:20:35.954756 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.cross_sell_product_churn"
[0m01:20:35.954756 [debug] [Thread-1 (]: On model.crb_kpi.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.cross_sell_product_churn"} */
create or replace   view CRBFITNESS.PUBLIC.cross_sell_product_churn
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    p.product_family_clean, 
    COUNT(DISTINCT p.product_family_clean) AS cross_sell_count
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
ORDER BY cross_sell_count DESC
LIMIT 10
  );
[0m01:20:37.083081 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.133 seconds
[0m01:20:37.145151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7c16bcc-1dc3-4820-9b2a-e3c574a0f3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D0E6609D0>]}
[0m01:20:37.145151 [info ] [Thread-1 (]: 2 of 10 OK created sql view model PUBLIC.cross_sell_product_churn .............. [[32mSUCCESS 1[0m in 1.21s]
[0m01:20:37.149439 [debug] [Thread-1 (]: Finished running node model.crb_kpi.cross_sell_product_churn
[0m01:20:37.149439 [debug] [Thread-1 (]: Began running node model.crb_kpi.net_nrr_grr
[0m01:20:37.149439 [info ] [Thread-1 (]: 3 of 10 START sql view model PUBLIC.net_nrr_grr ................................ [RUN]
[0m01:20:37.152969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.cross_sell_product_churn, now model.crb_kpi.net_nrr_grr)
[0m01:20:37.152969 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.net_nrr_grr
[0m01:20:37.152969 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.net_nrr_grr"
[0m01:20:37.157512 [debug] [Thread-1 (]: Began executing node model.crb_kpi.net_nrr_grr
[0m01:20:37.165069 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.net_nrr_grr"
[0m01:20:37.167626 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.net_nrr_grr"
[0m01:20:37.167626 [debug] [Thread-1 (]: On model.crb_kpi.net_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.net_nrr_grr"} */
create or replace   view CRBFITNESS.PUBLIC.net_nrr_grr
  
   as (
    SELECT 
    SUM(CASE WHEN t.payment_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN t.revenue ELSE 0 END) AS current_revenue,
    SUM(CASE WHEN t.payment_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN t.revenue ELSE 0 END) AS previous_revenue,
    (SUM(CASE WHEN t.payment_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN t.revenue ELSE 0 END) * 1.0 /
     NULLIF(SUM(CASE WHEN t.payment_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN t.revenue ELSE 0 END), 0)) AS NRR,
    (SUM(CASE WHEN t.payment_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN t.revenue ELSE 0 END) * 1.0 /
     NULLIF(SUM(CASE WHEN t.payment_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN t.revenue ELSE 0 END), 0)) AS GRR
FROM public.stg_transactions t
  );
[0m01:20:37.813125 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.649 seconds
[0m01:20:37.824978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7c16bcc-1dc3-4820-9b2a-e3c574a0f3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D119FD910>]}
[0m01:20:37.824978 [info ] [Thread-1 (]: 3 of 10 OK created sql view model PUBLIC.net_nrr_grr ........................... [[32mSUCCESS 1[0m in 0.68s]
[0m01:20:37.828326 [debug] [Thread-1 (]: Finished running node model.crb_kpi.net_nrr_grr
[0m01:20:37.828326 [debug] [Thread-1 (]: Began running node model.crb_kpi.new_logos
[0m01:20:37.828326 [info ] [Thread-1 (]: 4 of 10 START sql view model PUBLIC.new_logos .................................. [RUN]
[0m01:20:37.828326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.net_nrr_grr, now model.crb_kpi.new_logos)
[0m01:20:37.833338 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.new_logos
[0m01:20:37.833338 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.new_logos"
[0m01:20:37.838377 [debug] [Thread-1 (]: Began executing node model.crb_kpi.new_logos
[0m01:20:37.844455 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.new_logos"
[0m01:20:37.847884 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.new_logos"
[0m01:20:37.847884 [debug] [Thread-1 (]: On model.crb_kpi.new_logos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.new_logos"} */
create or replace   view CRBFITNESS.PUBLIC.new_logos
  
   as (
    SELECT 
    t.customer_id, 
    MIN(EXTRACT(YEAR FROM t.payment_month)) AS first_fiscal_year
FROM public.stg_transactions t
GROUP BY t.customer_id
  );
[0m01:20:38.483605 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.636 seconds
[0m01:20:38.491638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7c16bcc-1dc3-4820-9b2a-e3c574a0f3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D118147D0>]}
[0m01:20:38.494707 [info ] [Thread-1 (]: 4 of 10 OK created sql view model PUBLIC.new_logos ............................. [[32mSUCCESS 1[0m in 0.66s]
[0m01:20:38.496456 [debug] [Thread-1 (]: Finished running node model.crb_kpi.new_logos
[0m01:20:38.496456 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_customers
[0m01:20:38.496456 [info ] [Thread-1 (]: 5 of 10 START sql view model PUBLIC.ranked_customers ........................... [RUN]
[0m01:20:38.502144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.new_logos, now model.crb_kpi.ranked_customers)
[0m01:20:38.503843 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_customers
[0m01:20:38.505683 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_customers"
[0m01:20:38.505683 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_customers
[0m01:20:38.516752 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_customers"
[0m01:20:38.518577 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_customers"
[0m01:20:38.520221 [debug] [Thread-1 (]: On model.crb_kpi.ranked_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_customers"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_customers
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
GROUP BY t.customer_id, c.customer_name_clean
ORDER BY total_revenue DESC
  );
[0m01:20:39.139515 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.617 seconds
[0m01:20:39.145170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7c16bcc-1dc3-4820-9b2a-e3c574a0f3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D120B8FD0>]}
[0m01:20:39.145170 [info ] [Thread-1 (]: 5 of 10 OK created sql view model PUBLIC.ranked_customers ...................... [[32mSUCCESS 1[0m in 0.64s]
[0m01:20:39.145170 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_customers
[0m01:20:39.145170 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_products
[0m01:20:39.153264 [info ] [Thread-1 (]: 6 of 10 START sql view model PUBLIC.ranked_products ............................ [RUN]
[0m01:20:39.153264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_customers, now model.crb_kpi.ranked_products)
[0m01:20:39.153264 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_products
[0m01:20:39.163275 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_products"
[0m01:20:39.165432 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_products
[0m01:20:39.173064 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_products"
[0m01:20:39.173064 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_products"
[0m01:20:39.178135 [debug] [Thread-1 (]: On model.crb_kpi.ranked_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_products"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_products
  
   as (
    SELECT 
    p.product_family_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY p.product_family_clean
ORDER BY total_revenue DESC
  );
[0m01:20:39.853301 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.676 seconds
[0m01:20:39.860867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7c16bcc-1dc3-4820-9b2a-e3c574a0f3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D120B82D0>]}
[0m01:20:39.863403 [info ] [Thread-1 (]: 6 of 10 OK created sql view model PUBLIC.ranked_products ....................... [[32mSUCCESS 1[0m in 0.71s]
[0m01:20:39.863403 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_products
[0m01:20:39.863403 [debug] [Thread-1 (]: Began running node model.crb_kpi.revenue_lost
[0m01:20:39.868477 [info ] [Thread-1 (]: 7 of 10 START sql view model PUBLIC.revenue_lost ............................... [RUN]
[0m01:20:39.868477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_products, now model.crb_kpi.revenue_lost)
[0m01:20:39.871431 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.revenue_lost
[0m01:20:39.873571 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.revenue_lost"
[0m01:20:39.873571 [debug] [Thread-1 (]: Began executing node model.crb_kpi.revenue_lost
[0m01:20:39.881888 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.revenue_lost"
[0m01:20:39.883665 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.revenue_lost"
[0m01:20:39.883665 [debug] [Thread-1 (]: On model.crb_kpi.revenue_lost: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.revenue_lost"} */
create or replace   view CRBFITNESS.PUBLIC.revenue_lost
  
   as (
    SELECT 
    t.payment_month AS period, 
    SUM(t.revenue) AS total_revenue_lost
FROM public.stg_transactions t
WHERE t.customer_id IN (
    SELECT customer_id 
    FROM public.stg_transactions 
    GROUP BY customer_id 
    HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
)
GROUP BY t.payment_month
ORDER BY t.payment_month
  );
[0m01:20:40.488429 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.600 seconds
[0m01:20:40.492978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7c16bcc-1dc3-4820-9b2a-e3c574a0f3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D1205AA10>]}
[0m01:20:40.492978 [info ] [Thread-1 (]: 7 of 10 OK created sql view model PUBLIC.revenue_lost .......................... [[32mSUCCESS 1[0m in 0.62s]
[0m01:20:40.498057 [debug] [Thread-1 (]: Finished running node model.crb_kpi.revenue_lost
[0m01:20:40.498057 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m01:20:40.498057 [info ] [Thread-1 (]: 8 of 10 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m01:20:40.503093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.revenue_lost, now model.crb_kpi.stg_customers)
[0m01:20:40.503093 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m01:20:40.510165 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m01:20:40.515285 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m01:20:40.521306 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m01:20:40.523327 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m01:20:40.523327 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean
FROM raw
  );
[0m01:20:41.123237 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m01:20:41.128767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7c16bcc-1dc3-4820-9b2a-e3c574a0f3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D1205E590>]}
[0m01:20:41.128767 [info ] [Thread-1 (]: 8 of 10 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 0.63s]
[0m01:20:41.128767 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m01:20:41.133286 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m01:20:41.133286 [info ] [Thread-1 (]: 9 of 10 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m01:20:41.137441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m01:20:41.137441 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m01:20:41.145095 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m01:20:41.145095 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m01:20:41.153220 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m01:20:41.159488 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m01:20:41.160807 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM public.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m01:20:41.693302 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.536 seconds
[0m01:20:41.703134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7c16bcc-1dc3-4820-9b2a-e3c574a0f3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D1205C990>]}
[0m01:20:41.703134 [info ] [Thread-1 (]: 9 of 10 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 0.57s]
[0m01:20:41.708910 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m01:20:41.708910 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m01:20:41.708910 [info ] [Thread-1 (]: 10 of 10 START sql view model PUBLIC.stg_transactions .......................... [RUN]
[0m01:20:41.713429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m01:20:41.715489 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m01:20:41.715489 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m01:20:41.715489 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m01:20:41.733450 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m01:20:41.740181 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m01:20:41.741252 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m01:20:42.393210 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.652 seconds
[0m01:20:42.395836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7c16bcc-1dc3-4820-9b2a-e3c574a0f3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D120FCE10>]}
[0m01:20:42.399714 [info ] [Thread-1 (]: 10 of 10 OK created sql view model PUBLIC.stg_transactions ..................... [[32mSUCCESS 1[0m in 0.68s]
[0m01:20:42.399714 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m01:20:42.402953 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:20:42.402953 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m01:20:42.402953 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m01:20:43.027635 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m01:20:43.030161 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m01:20:43.663133 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m01:20:43.663133 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m01:20:44.283274 [info ] [MainThread]: 
[0m01:20:44.293211 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 15.15 seconds (15.15s).
[0m01:20:44.299468 [debug] [MainThread]: Command end result
[0m01:20:44.336111 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:20:44.343086 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:20:44.354964 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m01:20:44.357664 [info ] [MainThread]: 
[0m01:20:44.359070 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:20:44.360499 [info ] [MainThread]: 
[0m01:20:44.361922 [error] [MainThread]:   Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 60 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql
[0m01:20:44.363436 [info ] [MainThread]: 
[0m01:20:44.368592 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m01:20:44.373167 [debug] [MainThread]: Command `dbt run` failed at 01:20:44.370946 after 17.91 seconds
[0m01:20:44.374976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D0A662C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D0FCC8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D0A6E2E90>]}
[0m01:20:44.374976 [debug] [MainThread]: Flushing usage events
[0m01:20:45.853250 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:20:55.972844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238870F5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002388B88DE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002388B88C850>]}


============================== 01:20:55.982900 | a8df0197-ffab-48ff-bbf8-a19b41043ef7 ==============================
[0m01:20:55.982900 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:20:55.982900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:20:56.724557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8df0197-ffab-48ff-bbf8-a19b41043ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002388B583290>]}
[0m01:20:56.823214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8df0197-ffab-48ff-bbf8-a19b41043ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002388C45DA10>]}
[0m01:20:56.823214 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:20:57.603173 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:20:57.886760 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:20:57.886760 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\churned_new_customers.sql
[0m01:20:58.273902 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m01:20:58.291345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8df0197-ffab-48ff-bbf8-a19b41043ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002388C995C90>]}
[0m01:20:58.417026 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:20:58.423236 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:20:58.467041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8df0197-ffab-48ff-bbf8-a19b41043ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002388CF62AD0>]}
[0m01:20:58.468179 [info ] [MainThread]: Found 10 models, 474 macros
[0m01:20:58.469189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8df0197-ffab-48ff-bbf8-a19b41043ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002388CEC7350>]}
[0m01:20:58.472889 [info ] [MainThread]: 
[0m01:20:58.472889 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:20:58.477059 [info ] [MainThread]: 
[0m01:20:58.478556 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:20:58.484596 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m01:20:58.726901 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m01:20:58.726901 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m01:20:58.726901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:21:00.741056 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.013 seconds
[0m01:21:00.747542 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m01:21:00.764977 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m01:21:00.764977 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m01:21:00.764977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:21:02.603247 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.839 seconds
[0m01:21:02.618158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8df0197-ffab-48ff-bbf8-a19b41043ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002388C59B350>]}
[0m01:21:02.626196 [debug] [Thread-1 (]: Began running node model.crb_kpi.churned_new_customers
[0m01:21:02.626196 [info ] [Thread-1 (]: 1 of 10 START sql view model PUBLIC.churned_new_customers ...................... [RUN]
[0m01:21:02.626196 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.churned_new_customers'
[0m01:21:02.633625 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.churned_new_customers
[0m01:21:02.646738 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.churned_new_customers"
[0m01:21:02.646738 [debug] [Thread-1 (]: Began executing node model.crb_kpi.churned_new_customers
[0m01:21:02.697526 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.churned_new_customers"
[0m01:21:02.701123 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.churned_new_customers"
[0m01:21:02.701123 [debug] [Thread-1 (]: On model.crb_kpi.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.churned_new_customers"} */
create or replace   view CRBFITNESS.PUBLIC.churned_new_customers
  
   as (
    SELECT 
    customer_id, 
    'new' AS customer_status, 
    MIN(payment_month) AS first_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MIN(payment_month) IS NOT NULL

UNION ALL

SELECT 
    customer_id, 
    'churned' AS customer_status, 
    MAX(payment_month) AS last_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
  );
[0m01:21:02.703265 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:21:04.713721 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.010 seconds
[0m01:21:04.768381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8df0197-ffab-48ff-bbf8-a19b41043ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002388CCFC950>]}
[0m01:21:04.768381 [info ] [Thread-1 (]: 1 of 10 OK created sql view model PUBLIC.churned_new_customers ................. [[32mSUCCESS 1[0m in 2.14s]
[0m01:21:04.773061 [debug] [Thread-1 (]: Finished running node model.crb_kpi.churned_new_customers
[0m01:21:04.773061 [debug] [Thread-1 (]: Began running node model.crb_kpi.cross_sell_product_churn
[0m01:21:04.773061 [info ] [Thread-1 (]: 2 of 10 START sql view model PUBLIC.cross_sell_product_churn ................... [RUN]
[0m01:21:04.773061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.churned_new_customers, now model.crb_kpi.cross_sell_product_churn)
[0m01:21:04.773061 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.cross_sell_product_churn
[0m01:21:04.783032 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.cross_sell_product_churn"
[0m01:21:04.787083 [debug] [Thread-1 (]: Began executing node model.crb_kpi.cross_sell_product_churn
[0m01:21:04.789627 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.cross_sell_product_churn"
[0m01:21:04.794980 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.cross_sell_product_churn"
[0m01:21:04.796945 [debug] [Thread-1 (]: On model.crb_kpi.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.cross_sell_product_churn"} */
create or replace   view CRBFITNESS.PUBLIC.cross_sell_product_churn
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    p.product_family_clean, 
    COUNT(DISTINCT p.product_family_clean) AS cross_sell_count
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
ORDER BY cross_sell_count DESC
LIMIT 10
  );
[0m01:21:05.773352 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.984 seconds
[0m01:21:05.793155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8df0197-ffab-48ff-bbf8-a19b41043ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002388D5C1150>]}
[0m01:21:05.793155 [info ] [Thread-1 (]: 2 of 10 OK created sql view model PUBLIC.cross_sell_product_churn .............. [[32mSUCCESS 1[0m in 1.02s]
[0m01:21:05.793155 [debug] [Thread-1 (]: Finished running node model.crb_kpi.cross_sell_product_churn
[0m01:21:05.798723 [debug] [Thread-1 (]: Began running node model.crb_kpi.net_nrr_grr
[0m01:21:05.799238 [info ] [Thread-1 (]: 3 of 10 START sql view model PUBLIC.net_nrr_grr ................................ [RUN]
[0m01:21:05.802956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.cross_sell_product_churn, now model.crb_kpi.net_nrr_grr)
[0m01:21:05.803525 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.net_nrr_grr
[0m01:21:05.807876 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.net_nrr_grr"
[0m01:21:05.812953 [debug] [Thread-1 (]: Began executing node model.crb_kpi.net_nrr_grr
[0m01:21:05.819675 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.net_nrr_grr"
[0m01:21:05.823325 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.net_nrr_grr"
[0m01:21:05.823325 [debug] [Thread-1 (]: On model.crb_kpi.net_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.net_nrr_grr"} */
create or replace   view CRBFITNESS.PUBLIC.net_nrr_grr
  
   as (
    SELECT 
    SUM(CASE WHEN t.payment_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN t.revenue ELSE 0 END) AS current_revenue,
    SUM(CASE WHEN t.payment_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN t.revenue ELSE 0 END) AS previous_revenue,
    (SUM(CASE WHEN t.payment_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN t.revenue ELSE 0 END) * 1.0 /
     NULLIF(SUM(CASE WHEN t.payment_month < DATEADD(YEAR, -1, CURRENT_DATE) THEN t.revenue ELSE 0 END), 0)) AS NRR,
    (SUM(CASE WHEN t.payment_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN t.revenue ELSE 0 END) * 1.0 /
     NULLIF(SUM(CASE WHEN t.payment_month >= DATEADD(YEAR, -1, CURRENT_DATE) THEN t.revenue ELSE 0 END), 0)) AS GRR
FROM public.stg_transactions t
  );
[0m01:21:06.455928 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.628 seconds
[0m01:21:06.463117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8df0197-ffab-48ff-bbf8-a19b41043ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002388D5FB610>]}
[0m01:21:06.465425 [info ] [Thread-1 (]: 3 of 10 OK created sql view model PUBLIC.net_nrr_grr ........................... [[32mSUCCESS 1[0m in 0.66s]
[0m01:21:06.465425 [debug] [Thread-1 (]: Finished running node model.crb_kpi.net_nrr_grr
[0m01:21:06.468941 [debug] [Thread-1 (]: Began running node model.crb_kpi.new_logos
[0m01:21:06.468941 [info ] [Thread-1 (]: 4 of 10 START sql view model PUBLIC.new_logos .................................. [RUN]
[0m01:21:06.473037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.net_nrr_grr, now model.crb_kpi.new_logos)
[0m01:21:06.475051 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.new_logos
[0m01:21:06.481049 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.new_logos"
[0m01:21:06.483177 [debug] [Thread-1 (]: Began executing node model.crb_kpi.new_logos
[0m01:21:06.495015 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.new_logos"
[0m01:21:06.495999 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.new_logos"
[0m01:21:06.495999 [debug] [Thread-1 (]: On model.crb_kpi.new_logos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.new_logos"} */
create or replace   view CRBFITNESS.PUBLIC.new_logos
  
   as (
    SELECT 
    t.customer_id, 
    MIN(EXTRACT(YEAR FROM t.payment_month)) AS first_fiscal_year
FROM public.stg_transactions t
GROUP BY t.customer_id
  );
[0m01:21:07.093179 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m01:21:07.101552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8df0197-ffab-48ff-bbf8-a19b41043ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002388CF62FD0>]}
[0m01:21:07.103068 [info ] [Thread-1 (]: 4 of 10 OK created sql view model PUBLIC.new_logos ............................. [[32mSUCCESS 1[0m in 0.63s]
[0m01:21:07.104310 [debug] [Thread-1 (]: Finished running node model.crb_kpi.new_logos
[0m01:21:07.104310 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_customers
[0m01:21:07.109795 [info ] [Thread-1 (]: 5 of 10 START sql view model PUBLIC.ranked_customers ........................... [RUN]
[0m01:21:07.109795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.new_logos, now model.crb_kpi.ranked_customers)
[0m01:21:07.114867 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_customers
[0m01:21:07.118879 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_customers"
[0m01:21:07.122959 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_customers
[0m01:21:07.136301 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_customers"
[0m01:21:07.138283 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_customers"
[0m01:21:07.140507 [debug] [Thread-1 (]: On model.crb_kpi.ranked_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_customers"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_customers
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
GROUP BY t.customer_id, c.customer_name_clean
ORDER BY total_revenue DESC
  );
[0m01:21:07.821083 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.681 seconds
[0m01:21:07.826849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8df0197-ffab-48ff-bbf8-a19b41043ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002388D70A090>]}
[0m01:21:07.829526 [info ] [Thread-1 (]: 5 of 10 OK created sql view model PUBLIC.ranked_customers ...................... [[32mSUCCESS 1[0m in 0.72s]
[0m01:21:07.833189 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_customers
[0m01:21:07.833189 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_products
[0m01:21:07.833189 [info ] [Thread-1 (]: 6 of 10 START sql view model PUBLIC.ranked_products ............................ [RUN]
[0m01:21:07.833189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_customers, now model.crb_kpi.ranked_products)
[0m01:21:07.842976 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_products
[0m01:21:07.849671 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_products"
[0m01:21:07.853172 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_products
[0m01:21:07.861210 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_products"
[0m01:21:07.863344 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_products"
[0m01:21:07.864957 [debug] [Thread-1 (]: On model.crb_kpi.ranked_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_products"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_products
  
   as (
    SELECT 
    p.product_family_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY p.product_family_clean
ORDER BY total_revenue DESC
  );
[0m01:21:08.463344 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.603 seconds
[0m01:21:08.473260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8df0197-ffab-48ff-bbf8-a19b41043ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002388D6D31D0>]}
[0m01:21:08.476785 [info ] [Thread-1 (]: 6 of 10 OK created sql view model PUBLIC.ranked_products ....................... [[32mSUCCESS 1[0m in 0.64s]
[0m01:21:08.479154 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_products
[0m01:21:08.482037 [debug] [Thread-1 (]: Began running node model.crb_kpi.revenue_lost
[0m01:21:08.484571 [info ] [Thread-1 (]: 7 of 10 START sql view model PUBLIC.revenue_lost ............................... [RUN]
[0m01:21:08.484571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_products, now model.crb_kpi.revenue_lost)
[0m01:21:08.488398 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.revenue_lost
[0m01:21:08.493274 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.revenue_lost"
[0m01:21:08.498309 [debug] [Thread-1 (]: Began executing node model.crb_kpi.revenue_lost
[0m01:21:08.507901 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.revenue_lost"
[0m01:21:08.507901 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.revenue_lost"
[0m01:21:08.507901 [debug] [Thread-1 (]: On model.crb_kpi.revenue_lost: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.revenue_lost"} */
create or replace   view CRBFITNESS.PUBLIC.revenue_lost
  
   as (
    SELECT 
    t.payment_month AS period, 
    SUM(t.revenue) AS total_revenue_lost
FROM public.stg_transactions t
WHERE t.customer_id IN (
    SELECT customer_id 
    FROM public.stg_transactions 
    GROUP BY customer_id 
    HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
)
GROUP BY t.payment_month
ORDER BY t.payment_month
  );
[0m01:21:09.067845 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.556 seconds
[0m01:21:09.073412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8df0197-ffab-48ff-bbf8-a19b41043ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002388D6D0610>]}
[0m01:21:09.073412 [info ] [Thread-1 (]: 7 of 10 OK created sql view model PUBLIC.revenue_lost .......................... [[32mSUCCESS 1[0m in 0.59s]
[0m01:21:09.078861 [debug] [Thread-1 (]: Finished running node model.crb_kpi.revenue_lost
[0m01:21:09.080138 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m01:21:09.080138 [info ] [Thread-1 (]: 8 of 10 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m01:21:09.084049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.revenue_lost, now model.crb_kpi.stg_customers)
[0m01:21:09.084049 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m01:21:09.093162 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m01:21:09.095091 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m01:21:09.102874 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m01:21:09.105221 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m01:21:09.107487 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean
FROM raw
  );
[0m01:21:09.634897 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.526 seconds
[0m01:21:09.638318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8df0197-ffab-48ff-bbf8-a19b41043ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002388D5F96D0>]}
[0m01:21:09.643375 [info ] [Thread-1 (]: 8 of 10 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 0.55s]
[0m01:21:09.643375 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m01:21:09.647949 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m01:21:09.647949 [info ] [Thread-1 (]: 9 of 10 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m01:21:09.650966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m01:21:09.653677 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m01:21:09.659959 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m01:21:09.663121 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m01:21:09.669890 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m01:21:09.670436 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m01:21:09.673486 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM public.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m01:21:10.273272 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.602 seconds
[0m01:21:10.283538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8df0197-ffab-48ff-bbf8-a19b41043ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002388D6D8710>]}
[0m01:21:10.283538 [info ] [Thread-1 (]: 9 of 10 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 0.63s]
[0m01:21:10.283538 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m01:21:10.288073 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m01:21:10.288073 [info ] [Thread-1 (]: 10 of 10 START sql view model PUBLIC.stg_transactions .......................... [RUN]
[0m01:21:10.288073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m01:21:10.293113 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m01:21:10.298602 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m01:21:10.302306 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m01:21:10.307778 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m01:21:10.314694 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m01:21:10.314694 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m01:21:10.953051 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m01:21:10.962220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8df0197-ffab-48ff-bbf8-a19b41043ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002388DC183D0>]}
[0m01:21:10.963436 [info ] [Thread-1 (]: 10 of 10 OK created sql view model PUBLIC.stg_transactions ..................... [[32mSUCCESS 1[0m in 0.67s]
[0m01:21:10.964966 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m01:21:10.966975 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:21:10.969006 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m01:21:10.969006 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m01:21:11.577987 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m01:21:11.577987 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m01:21:12.218334 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m01:21:12.220867 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m01:21:12.867202 [info ] [MainThread]: 
[0m01:21:12.873233 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 14.39 seconds (14.39s).
[0m01:21:12.873233 [debug] [MainThread]: Command end result
[0m01:21:12.923177 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:21:12.923177 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:21:12.941923 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m01:21:12.943504 [info ] [MainThread]: 
[0m01:21:12.945334 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:21:12.947516 [info ] [MainThread]: 
[0m01:21:12.950153 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m01:21:12.955270 [debug] [MainThread]: Command `dbt run` succeeded at 01:21:12.955270 after 17.10 seconds
[0m01:21:12.955270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002388B8C8890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002388B3BBDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023886492E90>]}
[0m01:21:12.955270 [debug] [MainThread]: Flushing usage events
[0m01:21:14.344953 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:26:40.042616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9B0D8CF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9B0DE2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9B0DE3D50>]}


============================== 01:26:40.052013 | 9889ede9-eb24-4cce-95f6-93368ca3691c ==============================
[0m01:26:40.052013 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:26:40.055466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:26:40.901745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9889ede9-eb24-4cce-95f6-93368ca3691c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9B1C46E10>]}
[0m01:26:41.006680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9889ede9-eb24-4cce-95f6-93368ca3691c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9B19D5810>]}
[0m01:26:41.011781 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:26:41.822338 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:26:42.161895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:26:42.172206 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\new_logos.sql
[0m01:26:42.172751 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\net_nrr_grr.sql
[0m01:26:42.544928 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m01:26:42.552061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9889ede9-eb24-4cce-95f6-93368ca3691c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9B1CB1A90>]}
[0m01:26:42.702412 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:26:42.713559 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:26:42.792198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9889ede9-eb24-4cce-95f6-93368ca3691c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9B2663650>]}
[0m01:26:42.794006 [info ] [MainThread]: Found 10 models, 474 macros
[0m01:26:42.794006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9889ede9-eb24-4cce-95f6-93368ca3691c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9B2610A90>]}
[0m01:26:42.810396 [info ] [MainThread]: 
[0m01:26:42.816116 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:26:42.817965 [info ] [MainThread]: 
[0m01:26:42.823952 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:26:42.847011 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m01:26:43.075896 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m01:26:43.075896 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m01:26:43.075896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:26:45.363431 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.285 seconds
[0m01:26:45.368423 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m01:26:45.387203 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m01:26:45.387203 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m01:26:45.387203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:26:47.166181 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.779 seconds
[0m01:26:47.173865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9889ede9-eb24-4cce-95f6-93368ca3691c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9B1C3EF10>]}
[0m01:26:47.192557 [debug] [Thread-1 (]: Began running node model.crb_kpi.churned_new_customers
[0m01:26:47.196199 [info ] [Thread-1 (]: 1 of 10 START sql view model PUBLIC.churned_new_customers ...................... [RUN]
[0m01:26:47.197718 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.churned_new_customers'
[0m01:26:47.197718 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.churned_new_customers
[0m01:26:47.222006 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.churned_new_customers"
[0m01:26:47.222006 [debug] [Thread-1 (]: Began executing node model.crb_kpi.churned_new_customers
[0m01:26:47.272004 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.churned_new_customers"
[0m01:26:47.277979 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.churned_new_customers"
[0m01:26:47.277979 [debug] [Thread-1 (]: On model.crb_kpi.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.churned_new_customers"} */
create or replace   view CRBFITNESS.PUBLIC.churned_new_customers
  
   as (
    SELECT 
    customer_id, 
    'new' AS customer_status, 
    MIN(payment_month) AS first_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MIN(payment_month) IS NOT NULL

UNION ALL

SELECT 
    customer_id, 
    'churned' AS customer_status, 
    MAX(payment_month) AS last_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
  );
[0m01:26:47.277979 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:26:49.236419 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.957 seconds
[0m01:26:49.292019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9889ede9-eb24-4cce-95f6-93368ca3691c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9B1C0AC10>]}
[0m01:26:49.293471 [info ] [Thread-1 (]: 1 of 10 OK created sql view model PUBLIC.churned_new_customers ................. [[32mSUCCESS 1[0m in 2.09s]
[0m01:26:49.293471 [debug] [Thread-1 (]: Finished running node model.crb_kpi.churned_new_customers
[0m01:26:49.293471 [debug] [Thread-1 (]: Began running node model.crb_kpi.cross_sell_product_churn
[0m01:26:49.293471 [info ] [Thread-1 (]: 2 of 10 START sql view model PUBLIC.cross_sell_product_churn ................... [RUN]
[0m01:26:49.293471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.churned_new_customers, now model.crb_kpi.cross_sell_product_churn)
[0m01:26:49.300787 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.cross_sell_product_churn
[0m01:26:49.305129 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.cross_sell_product_churn"
[0m01:26:49.307214 [debug] [Thread-1 (]: Began executing node model.crb_kpi.cross_sell_product_churn
[0m01:26:49.312202 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.cross_sell_product_churn"
[0m01:26:49.317226 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.cross_sell_product_churn"
[0m01:26:49.318887 [debug] [Thread-1 (]: On model.crb_kpi.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.cross_sell_product_churn"} */
create or replace   view CRBFITNESS.PUBLIC.cross_sell_product_churn
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    p.product_family_clean, 
    COUNT(DISTINCT p.product_family_clean) AS cross_sell_count
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
ORDER BY cross_sell_count DESC
LIMIT 10
  );
[0m01:26:49.972270 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.654 seconds
[0m01:26:49.976285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9889ede9-eb24-4cce-95f6-93368ca3691c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9B24AE190>]}
[0m01:26:49.982362 [info ] [Thread-1 (]: 2 of 10 OK created sql view model PUBLIC.cross_sell_product_churn .............. [[32mSUCCESS 1[0m in 0.68s]
[0m01:26:49.982362 [debug] [Thread-1 (]: Finished running node model.crb_kpi.cross_sell_product_churn
[0m01:26:49.987336 [debug] [Thread-1 (]: Began running node model.crb_kpi.net_nrr_grr
[0m01:26:49.989162 [info ] [Thread-1 (]: 3 of 10 START sql view model PUBLIC.net_nrr_grr ................................ [RUN]
[0m01:26:49.989985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.cross_sell_product_churn, now model.crb_kpi.net_nrr_grr)
[0m01:26:49.992073 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.net_nrr_grr
[0m01:26:49.997762 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.net_nrr_grr"
[0m01:26:49.997762 [debug] [Thread-1 (]: Began executing node model.crb_kpi.net_nrr_grr
[0m01:26:50.007644 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.net_nrr_grr"
[0m01:26:50.009915 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.net_nrr_grr"
[0m01:26:50.011934 [debug] [Thread-1 (]: On model.crb_kpi.net_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.net_nrr_grr"} */
create or replace   view CRBFITNESS.PUBLIC.net_nrr_grr
  
   as (
    SELECT 
    SUM(CASE WHEN TO_DATE(t.payment_month, 'DD-MM-YYYY') >= DATEADD(YEAR, -1, CURRENT_DATE) 
             THEN t.revenue ELSE 0 END) AS current_revenue,

    SUM(CASE WHEN TO_DATE(t.payment_month, 'DD-MM-YYYY') < DATEADD(YEAR, -1, CURRENT_DATE) 
             THEN t.revenue ELSE 0 END) AS previous_revenue,

    (SUM(CASE WHEN TO_DATE(t.payment_month, 'DD-MM-YYYY') >= DATEADD(YEAR, -1, CURRENT_DATE) 
              THEN t.revenue ELSE 0 END) * 1.0 /
     NULLIF(SUM(CASE WHEN TO_DATE(t.payment_month, 'DD-MM-YYYY') < DATEADD(YEAR, -1, CURRENT_DATE) 
                     THEN t.revenue ELSE 0 END), 0)) AS NRR,

    (SUM(CASE WHEN TO_DATE(t.payment_month, 'DD-MM-YYYY') >= DATEADD(YEAR, -1, CURRENT_DATE) 
              THEN t.revenue ELSE 0 END) * 1.0 /
     NULLIF(SUM(CASE WHEN TO_DATE(t.payment_month, 'DD-MM-YYYY') >= DATEADD(YEAR, -1, CURRENT_DATE) 
                     THEN t.revenue ELSE 0 END), 0)) AS GRR

FROM public.stg_transactions t
  );
[0m01:26:50.442129 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb024c-0004-c144-0005-db4b000183d6
[0m01:26:50.442129 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000939 (22023): SQL compilation error: error line 5 at position 18
too many arguments for function [TO_DATE(T.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
[0m01:26:50.452236 [debug] [Thread-1 (]: Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  000939 (22023): SQL compilation error: error line 5 at position 18
  too many arguments for function [TO_DATE(T.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql
[0m01:26:50.457257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9889ede9-eb24-4cce-95f6-93368ca3691c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9B2DB8B10>]}
[0m01:26:50.457257 [error] [Thread-1 (]: 3 of 10 ERROR creating sql view model PUBLIC.net_nrr_grr ....................... [[31mERROR[0m in 0.46s]
[0m01:26:50.457257 [debug] [Thread-1 (]: Finished running node model.crb_kpi.net_nrr_grr
[0m01:26:50.462271 [debug] [Thread-1 (]: Began running node model.crb_kpi.new_logos
[0m01:26:50.462271 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.net_nrr_grr' to be skipped because of status 'error'.  Reason: Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  000939 (22023): SQL compilation error: error line 5 at position 18
  too many arguments for function [TO_DATE(T.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql.
[0m01:26:50.462271 [info ] [Thread-1 (]: 4 of 10 START sql view model PUBLIC.new_logos .................................. [RUN]
[0m01:26:50.467744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.net_nrr_grr, now model.crb_kpi.new_logos)
[0m01:26:50.467744 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.new_logos
[0m01:26:50.476543 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.new_logos"
[0m01:26:50.476543 [debug] [Thread-1 (]: Began executing node model.crb_kpi.new_logos
[0m01:26:50.485913 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.new_logos"
[0m01:26:50.489928 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.new_logos"
[0m01:26:50.491948 [debug] [Thread-1 (]: On model.crb_kpi.new_logos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.new_logos"} */
create or replace   view CRBFITNESS.PUBLIC.new_logos
  
   as (
    SELECT 
    t.customer_id, 
    MIN(EXTRACT(YEAR FROM TO_DATE(t.payment_month, 'DD-MM-YYYY'))) AS first_fiscal_year
FROM public.stg_transactions t
GROUP BY t.customer_id
  );
[0m01:26:50.861857 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb024c-0004-c178-0005-db4b000192e6
[0m01:26:50.868484 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000939 (22023): SQL compilation error: error line 6 at position 26
too many arguments for function [TO_DATE(T.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
[0m01:26:50.874757 [debug] [Thread-1 (]: Database Error in model new_logos (models\marts\new_logos.sql)
  000939 (22023): SQL compilation error: error line 6 at position 26
  too many arguments for function [TO_DATE(T.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
  compiled code at target\run\crb_kpi\models\marts\new_logos.sql
[0m01:26:50.874757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9889ede9-eb24-4cce-95f6-93368ca3691c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9B2DB0810>]}
[0m01:26:50.874757 [error] [Thread-1 (]: 4 of 10 ERROR creating sql view model PUBLIC.new_logos ......................... [[31mERROR[0m in 0.41s]
[0m01:26:50.882331 [debug] [Thread-1 (]: Finished running node model.crb_kpi.new_logos
[0m01:26:50.885140 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_customers
[0m01:26:50.885140 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.new_logos' to be skipped because of status 'error'.  Reason: Database Error in model new_logos (models\marts\new_logos.sql)
  000939 (22023): SQL compilation error: error line 6 at position 26
  too many arguments for function [TO_DATE(T.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
  compiled code at target\run\crb_kpi\models\marts\new_logos.sql.
[0m01:26:50.888626 [info ] [Thread-1 (]: 5 of 10 START sql view model PUBLIC.ranked_customers ........................... [RUN]
[0m01:26:50.888626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.new_logos, now model.crb_kpi.ranked_customers)
[0m01:26:50.892138 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_customers
[0m01:26:50.897046 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_customers"
[0m01:26:50.897571 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_customers
[0m01:26:50.904660 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_customers"
[0m01:26:50.904660 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_customers"
[0m01:26:50.909059 [debug] [Thread-1 (]: On model.crb_kpi.ranked_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_customers"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_customers
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
GROUP BY t.customer_id, c.customer_name_clean
ORDER BY total_revenue DESC
  );
[0m01:26:51.501990 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m01:26:51.501990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9889ede9-eb24-4cce-95f6-93368ca3691c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9B2DB7590>]}
[0m01:26:51.501990 [info ] [Thread-1 (]: 5 of 10 OK created sql view model PUBLIC.ranked_customers ...................... [[32mSUCCESS 1[0m in 0.61s]
[0m01:26:51.509587 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_customers
[0m01:26:51.512167 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_products
[0m01:26:51.512167 [info ] [Thread-1 (]: 6 of 10 START sql view model PUBLIC.ranked_products ............................ [RUN]
[0m01:26:51.512167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_customers, now model.crb_kpi.ranked_products)
[0m01:26:51.516125 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_products
[0m01:26:51.520078 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_products"
[0m01:26:51.520078 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_products
[0m01:26:51.527272 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_products"
[0m01:26:51.529095 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_products"
[0m01:26:51.530890 [debug] [Thread-1 (]: On model.crb_kpi.ranked_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_products"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_products
  
   as (
    SELECT 
    p.product_family_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY p.product_family_clean
ORDER BY total_revenue DESC
  );
[0m01:26:52.122179 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.593 seconds
[0m01:26:52.127440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9889ede9-eb24-4cce-95f6-93368ca3691c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9B2C98110>]}
[0m01:26:52.132598 [info ] [Thread-1 (]: 6 of 10 OK created sql view model PUBLIC.ranked_products ....................... [[32mSUCCESS 1[0m in 0.62s]
[0m01:26:52.132598 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_products
[0m01:26:52.135112 [debug] [Thread-1 (]: Began running node model.crb_kpi.revenue_lost
[0m01:26:52.137320 [info ] [Thread-1 (]: 7 of 10 START sql view model PUBLIC.revenue_lost ............................... [RUN]
[0m01:26:52.141086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_products, now model.crb_kpi.revenue_lost)
[0m01:26:52.143390 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.revenue_lost
[0m01:26:52.146469 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.revenue_lost"
[0m01:26:52.146469 [debug] [Thread-1 (]: Began executing node model.crb_kpi.revenue_lost
[0m01:26:52.154403 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.revenue_lost"
[0m01:26:52.156094 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.revenue_lost"
[0m01:26:52.159190 [debug] [Thread-1 (]: On model.crb_kpi.revenue_lost: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.revenue_lost"} */
create or replace   view CRBFITNESS.PUBLIC.revenue_lost
  
   as (
    SELECT 
    t.payment_month AS period, 
    SUM(t.revenue) AS total_revenue_lost
FROM public.stg_transactions t
WHERE t.customer_id IN (
    SELECT customer_id 
    FROM public.stg_transactions 
    GROUP BY customer_id 
    HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
)
GROUP BY t.payment_month
ORDER BY t.payment_month
  );
[0m01:26:52.757267 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.600 seconds
[0m01:26:52.766958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9889ede9-eb24-4cce-95f6-93368ca3691c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9B2DA8650>]}
[0m01:26:52.770181 [info ] [Thread-1 (]: 7 of 10 OK created sql view model PUBLIC.revenue_lost .......................... [[32mSUCCESS 1[0m in 0.63s]
[0m01:26:52.772310 [debug] [Thread-1 (]: Finished running node model.crb_kpi.revenue_lost
[0m01:26:52.772310 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m01:26:52.777368 [info ] [Thread-1 (]: 8 of 10 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m01:26:52.777368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.revenue_lost, now model.crb_kpi.stg_customers)
[0m01:26:52.780519 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m01:26:52.788924 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m01:26:52.792133 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m01:26:52.797191 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m01:26:52.804374 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m01:26:52.805140 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean
FROM raw
  );
[0m01:26:53.322474 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.519 seconds
[0m01:26:53.327053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9889ede9-eb24-4cce-95f6-93368ca3691c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9B2CF9CD0>]}
[0m01:26:53.332253 [info ] [Thread-1 (]: 8 of 10 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 0.55s]
[0m01:26:53.332253 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m01:26:53.335804 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m01:26:53.335804 [info ] [Thread-1 (]: 9 of 10 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m01:26:53.335804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m01:26:53.341936 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m01:26:53.346961 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m01:26:53.346961 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m01:26:53.362197 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m01:26:53.367248 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m01:26:53.368670 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM public.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m01:26:54.023351 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.654 seconds
[0m01:26:54.031949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9889ede9-eb24-4cce-95f6-93368ca3691c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9B33026D0>]}
[0m01:26:54.031949 [info ] [Thread-1 (]: 9 of 10 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 0.70s]
[0m01:26:54.036536 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m01:26:54.036536 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m01:26:54.036536 [info ] [Thread-1 (]: 10 of 10 START sql view model PUBLIC.stg_transactions .......................... [RUN]
[0m01:26:54.042082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m01:26:54.042082 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m01:26:54.046982 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m01:26:54.050055 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m01:26:54.054672 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m01:26:54.062220 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m01:26:54.062220 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m01:26:54.611985 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.549 seconds
[0m01:26:54.615531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9889ede9-eb24-4cce-95f6-93368ca3691c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9B3302DD0>]}
[0m01:26:54.622054 [info ] [Thread-1 (]: 10 of 10 OK created sql view model PUBLIC.stg_transactions ..................... [[32mSUCCESS 1[0m in 0.57s]
[0m01:26:54.622054 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m01:26:54.628874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:26:54.628874 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m01:26:54.631909 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m01:26:55.322088 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m01:26:55.325167 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m01:26:55.973449 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m01:26:55.973449 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m01:26:56.606409 [info ] [MainThread]: 
[0m01:26:56.612743 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 13.78 seconds (13.78s).
[0m01:26:56.614653 [debug] [MainThread]: Command end result
[0m01:26:56.656906 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:26:56.661987 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:26:56.672074 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m01:26:56.672074 [info ] [MainThread]: 
[0m01:26:56.674161 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m01:26:56.675637 [info ] [MainThread]: 
[0m01:26:56.675637 [error] [MainThread]:   Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  000939 (22023): SQL compilation error: error line 5 at position 18
  too many arguments for function [TO_DATE(T.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql
[0m01:26:56.675637 [info ] [MainThread]: 
[0m01:26:56.675637 [error] [MainThread]:   Database Error in model new_logos (models\marts\new_logos.sql)
  000939 (22023): SQL compilation error: error line 6 at position 26
  too many arguments for function [TO_DATE(T.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
  compiled code at target\run\crb_kpi\models\marts\new_logos.sql
[0m01:26:56.684008 [info ] [MainThread]: 
[0m01:26:56.686277 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
[0m01:26:56.688388 [debug] [MainThread]: Command `dbt run` failed at 01:26:56.688388 after 16.77 seconds
[0m01:26:56.688388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AB862C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AB8E2E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AB8E2E90>]}
[0m01:26:56.688388 [debug] [MainThread]: Flushing usage events
[0m01:26:58.269053 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:28:02.694576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C348ED50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C30AF090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C348FED0>]}


============================== 01:28:02.709580 | 491de22d-50c8-4dff-93f8-8a27caf3c7d7 ==============================
[0m01:28:02.709580 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:28:02.711645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:28:03.556690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '491de22d-50c8-4dff-93f8-8a27caf3c7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C1FAB790>]}
[0m01:28:03.641534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '491de22d-50c8-4dff-93f8-8a27caf3c7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C1E6D2D0>]}
[0m01:28:03.647331 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:28:04.376812 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:28:04.663300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:28:04.667193 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\new_logos.sql
[0m01:28:04.667193 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\net_nrr_grr.sql
[0m01:28:05.041705 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m01:28:05.051883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '491de22d-50c8-4dff-93f8-8a27caf3c7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C49AE750>]}
[0m01:28:05.156098 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:28:05.161919 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:28:05.208070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '491de22d-50c8-4dff-93f8-8a27caf3c7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C4A67190>]}
[0m01:28:05.209244 [info ] [MainThread]: Found 10 models, 474 macros
[0m01:28:05.209244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '491de22d-50c8-4dff-93f8-8a27caf3c7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C4A77D90>]}
[0m01:28:05.211761 [info ] [MainThread]: 
[0m01:28:05.216338 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:28:05.218181 [info ] [MainThread]: 
[0m01:28:05.218181 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:28:05.224532 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m01:28:05.518383 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m01:28:05.518383 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m01:28:05.518383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:07.596456 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.077 seconds
[0m01:28:07.601935 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m01:28:07.622967 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m01:28:07.622967 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m01:28:07.627922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:09.431929 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.808 seconds
[0m01:28:09.443106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '491de22d-50c8-4dff-93f8-8a27caf3c7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C4A6B790>]}
[0m01:28:09.452118 [debug] [Thread-1 (]: Began running node model.crb_kpi.churned_new_customers
[0m01:28:09.452118 [info ] [Thread-1 (]: 1 of 10 START sql view model PUBLIC.churned_new_customers ...................... [RUN]
[0m01:28:09.459188 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.churned_new_customers'
[0m01:28:09.461703 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.churned_new_customers
[0m01:28:09.476240 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.churned_new_customers"
[0m01:28:09.481895 [debug] [Thread-1 (]: Began executing node model.crb_kpi.churned_new_customers
[0m01:28:09.553414 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.churned_new_customers"
[0m01:28:09.562000 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.churned_new_customers"
[0m01:28:09.562000 [debug] [Thread-1 (]: On model.crb_kpi.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.churned_new_customers"} */
create or replace   view CRBFITNESS.PUBLIC.churned_new_customers
  
   as (
    SELECT 
    customer_id, 
    'new' AS customer_status, 
    MIN(payment_month) AS first_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MIN(payment_month) IS NOT NULL

UNION ALL

SELECT 
    customer_id, 
    'churned' AS customer_status, 
    MAX(payment_month) AS last_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
  );
[0m01:28:09.562000 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:28:11.561846 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.995 seconds
[0m01:28:11.613122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '491de22d-50c8-4dff-93f8-8a27caf3c7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C4A75190>]}
[0m01:28:11.615292 [info ] [Thread-1 (]: 1 of 10 OK created sql view model PUBLIC.churned_new_customers ................. [[32mSUCCESS 1[0m in 2.15s]
[0m01:28:11.618616 [debug] [Thread-1 (]: Finished running node model.crb_kpi.churned_new_customers
[0m01:28:11.618616 [debug] [Thread-1 (]: Began running node model.crb_kpi.cross_sell_product_churn
[0m01:28:11.618616 [info ] [Thread-1 (]: 2 of 10 START sql view model PUBLIC.cross_sell_product_churn ................... [RUN]
[0m01:28:11.621736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.churned_new_customers, now model.crb_kpi.cross_sell_product_churn)
[0m01:28:11.624637 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.cross_sell_product_churn
[0m01:28:11.626043 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.cross_sell_product_churn"
[0m01:28:11.631575 [debug] [Thread-1 (]: Began executing node model.crb_kpi.cross_sell_product_churn
[0m01:28:11.638153 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.cross_sell_product_churn"
[0m01:28:11.642176 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.cross_sell_product_churn"
[0m01:28:11.644109 [debug] [Thread-1 (]: On model.crb_kpi.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.cross_sell_product_churn"} */
create or replace   view CRBFITNESS.PUBLIC.cross_sell_product_churn
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    p.product_family_clean, 
    COUNT(DISTINCT p.product_family_clean) AS cross_sell_count
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
ORDER BY cross_sell_count DESC
LIMIT 10
  );
[0m01:28:12.251520 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.611 seconds
[0m01:28:12.261585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '491de22d-50c8-4dff-93f8-8a27caf3c7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C4A6BB50>]}
[0m01:28:12.261585 [info ] [Thread-1 (]: 2 of 10 OK created sql view model PUBLIC.cross_sell_product_churn .............. [[32mSUCCESS 1[0m in 0.64s]
[0m01:28:12.271496 [debug] [Thread-1 (]: Finished running node model.crb_kpi.cross_sell_product_churn
[0m01:28:12.271496 [debug] [Thread-1 (]: Began running node model.crb_kpi.net_nrr_grr
[0m01:28:12.276012 [info ] [Thread-1 (]: 3 of 10 START sql view model PUBLIC.net_nrr_grr ................................ [RUN]
[0m01:28:12.279333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.cross_sell_product_churn, now model.crb_kpi.net_nrr_grr)
[0m01:28:12.281401 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.net_nrr_grr
[0m01:28:12.289833 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.net_nrr_grr"
[0m01:28:12.296913 [debug] [Thread-1 (]: Began executing node model.crb_kpi.net_nrr_grr
[0m01:28:12.311936 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.net_nrr_grr"
[0m01:28:12.316787 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.net_nrr_grr"
[0m01:28:12.323624 [debug] [Thread-1 (]: On model.crb_kpi.net_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.net_nrr_grr"} */
create or replace   view CRBFITNESS.PUBLIC.net_nrr_grr
  
   as (
    SELECT 
    SUM(CASE WHEN TRY_TO_DATE(t.payment_month, 'DD-MM-YYYY') >= DATEADD(YEAR, -1, CURRENT_DATE) 
             THEN t.revenue ELSE 0 END) AS current_revenue,

    SUM(CASE WHEN TRY_TO_DATE(t.payment_month, 'DD-MM-YYYY') < DATEADD(YEAR, -1, CURRENT_DATE) 
             THEN t.revenue ELSE 0 END) AS previous_revenue,

    (SUM(CASE WHEN TRY_TO_DATE(t.payment_month, 'DD-MM-YYYY') >= DATEADD(YEAR, -1, CURRENT_DATE) 
              THEN t.revenue ELSE 0 END) * 1.0 /
     NULLIF(SUM(CASE WHEN TRY_TO_DATE(t.payment_month, 'DD-MM-YYYY') < DATEADD(YEAR, -1, CURRENT_DATE) 
                     THEN t.revenue ELSE 0 END), 0)) AS NRR,

    (SUM(CASE WHEN TRY_TO_DATE(t.payment_month, 'DD-MM-YYYY') >= DATEADD(YEAR, -1, CURRENT_DATE) 
              THEN t.revenue ELSE 0 END) * 1.0 /
     NULLIF(SUM(CASE WHEN TRY_TO_DATE(t.payment_month, 'DD-MM-YYYY') >= DATEADD(YEAR, -1, CURRENT_DATE) 
                     THEN t.revenue ELSE 0 END), 0)) AS GRR

FROM public.stg_transactions t
  );
[0m01:28:12.751387 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb024e-0004-c144-0005-db4b000183de
[0m01:28:12.751387 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000939 (22023): SQL compilation error: error line 5 at position 18
too many arguments for function [TRY_TO_DATE(T.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
[0m01:28:12.761315 [debug] [Thread-1 (]: Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  000939 (22023): SQL compilation error: error line 5 at position 18
  too many arguments for function [TRY_TO_DATE(T.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql
[0m01:28:12.761315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '491de22d-50c8-4dff-93f8-8a27caf3c7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C54B4C10>]}
[0m01:28:12.761315 [error] [Thread-1 (]: 3 of 10 ERROR creating sql view model PUBLIC.net_nrr_grr ....................... [[31mERROR[0m in 0.48s]
[0m01:28:12.769099 [debug] [Thread-1 (]: Finished running node model.crb_kpi.net_nrr_grr
[0m01:28:12.770127 [debug] [Thread-1 (]: Began running node model.crb_kpi.new_logos
[0m01:28:12.770642 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.net_nrr_grr' to be skipped because of status 'error'.  Reason: Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  000939 (22023): SQL compilation error: error line 5 at position 18
  too many arguments for function [TRY_TO_DATE(T.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql.
[0m01:28:12.771705 [info ] [Thread-1 (]: 4 of 10 START sql view model PUBLIC.new_logos .................................. [RUN]
[0m01:28:12.775657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.net_nrr_grr, now model.crb_kpi.new_logos)
[0m01:28:12.776857 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.new_logos
[0m01:28:12.776857 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.new_logos"
[0m01:28:12.781528 [debug] [Thread-1 (]: Began executing node model.crb_kpi.new_logos
[0m01:28:12.783403 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.new_logos"
[0m01:28:12.790001 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.new_logos"
[0m01:28:12.791237 [debug] [Thread-1 (]: On model.crb_kpi.new_logos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.new_logos"} */
create or replace   view CRBFITNESS.PUBLIC.new_logos
  
   as (
    SELECT 
    t.customer_id, 
    MIN(EXTRACT(YEAR FROM TRY_TO_DATE(t.payment_month, 'DD-MM-YYYY'))) AS first_fiscal_year
FROM public.stg_transactions t
GROUP BY t.customer_id
  );
[0m01:28:13.133639 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb024e-0004-c178-0005-db4b000192f2
[0m01:28:13.133639 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000939 (22023): SQL compilation error: error line 6 at position 26
too many arguments for function [TRY_TO_DATE(T.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
[0m01:28:13.146407 [debug] [Thread-1 (]: Database Error in model new_logos (models\marts\new_logos.sql)
  000939 (22023): SQL compilation error: error line 6 at position 26
  too many arguments for function [TRY_TO_DATE(T.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
  compiled code at target\run\crb_kpi\models\marts\new_logos.sql
[0m01:28:13.149422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '491de22d-50c8-4dff-93f8-8a27caf3c7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C51F1F90>]}
[0m01:28:13.151553 [error] [Thread-1 (]: 4 of 10 ERROR creating sql view model PUBLIC.new_logos ......................... [[31mERROR[0m in 0.37s]
[0m01:28:13.154048 [debug] [Thread-1 (]: Finished running node model.crb_kpi.new_logos
[0m01:28:13.154048 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_customers
[0m01:28:13.154048 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.new_logos' to be skipped because of status 'error'.  Reason: Database Error in model new_logos (models\marts\new_logos.sql)
  000939 (22023): SQL compilation error: error line 6 at position 26
  too many arguments for function [TRY_TO_DATE(T.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
  compiled code at target\run\crb_kpi\models\marts\new_logos.sql.
[0m01:28:13.154048 [info ] [Thread-1 (]: 5 of 10 START sql view model PUBLIC.ranked_customers ........................... [RUN]
[0m01:28:13.154048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.new_logos, now model.crb_kpi.ranked_customers)
[0m01:28:13.161605 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_customers
[0m01:28:13.166408 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_customers"
[0m01:28:13.174751 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_customers
[0m01:28:13.189859 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_customers"
[0m01:28:13.202558 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_customers"
[0m01:28:13.202558 [debug] [Thread-1 (]: On model.crb_kpi.ranked_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_customers"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_customers
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
GROUP BY t.customer_id, c.customer_name_clean
ORDER BY total_revenue DESC
  );
[0m01:28:13.771724 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.575 seconds
[0m01:28:13.786575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '491de22d-50c8-4dff-93f8-8a27caf3c7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C5590690>]}
[0m01:28:13.786575 [info ] [Thread-1 (]: 5 of 10 OK created sql view model PUBLIC.ranked_customers ...................... [[32mSUCCESS 1[0m in 0.63s]
[0m01:28:13.793787 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_customers
[0m01:28:13.794802 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_products
[0m01:28:13.794802 [info ] [Thread-1 (]: 6 of 10 START sql view model PUBLIC.ranked_products ............................ [RUN]
[0m01:28:13.802886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_customers, now model.crb_kpi.ranked_products)
[0m01:28:13.806515 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_products
[0m01:28:13.812969 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_products"
[0m01:28:13.819215 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_products
[0m01:28:13.824440 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_products"
[0m01:28:13.831520 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_products"
[0m01:28:13.831520 [debug] [Thread-1 (]: On model.crb_kpi.ranked_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_products"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_products
  
   as (
    SELECT 
    p.product_family_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY p.product_family_clean
ORDER BY total_revenue DESC
  );
[0m01:28:14.506670 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.670 seconds
[0m01:28:14.511893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '491de22d-50c8-4dff-93f8-8a27caf3c7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C5593150>]}
[0m01:28:14.511893 [info ] [Thread-1 (]: 6 of 10 OK created sql view model PUBLIC.ranked_products ....................... [[32mSUCCESS 1[0m in 0.71s]
[0m01:28:14.516973 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_products
[0m01:28:14.516973 [debug] [Thread-1 (]: Began running node model.crb_kpi.revenue_lost
[0m01:28:14.516973 [info ] [Thread-1 (]: 7 of 10 START sql view model PUBLIC.revenue_lost ............................... [RUN]
[0m01:28:14.516973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_products, now model.crb_kpi.revenue_lost)
[0m01:28:14.522081 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.revenue_lost
[0m01:28:14.525674 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.revenue_lost"
[0m01:28:14.527952 [debug] [Thread-1 (]: Began executing node model.crb_kpi.revenue_lost
[0m01:28:14.531950 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.revenue_lost"
[0m01:28:14.531950 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.revenue_lost"
[0m01:28:14.536999 [debug] [Thread-1 (]: On model.crb_kpi.revenue_lost: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.revenue_lost"} */
create or replace   view CRBFITNESS.PUBLIC.revenue_lost
  
   as (
    SELECT 
    t.payment_month AS period, 
    SUM(t.revenue) AS total_revenue_lost
FROM public.stg_transactions t
WHERE t.customer_id IN (
    SELECT customer_id 
    FROM public.stg_transactions 
    GROUP BY customer_id 
    HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
)
GROUP BY t.payment_month
ORDER BY t.payment_month
  );
[0m01:28:15.111615 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.581 seconds
[0m01:28:15.123280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '491de22d-50c8-4dff-93f8-8a27caf3c7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C5132F50>]}
[0m01:28:15.123280 [info ] [Thread-1 (]: 7 of 10 OK created sql view model PUBLIC.revenue_lost .......................... [[32mSUCCESS 1[0m in 0.61s]
[0m01:28:15.126494 [debug] [Thread-1 (]: Finished running node model.crb_kpi.revenue_lost
[0m01:28:15.126494 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m01:28:15.126494 [info ] [Thread-1 (]: 8 of 10 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m01:28:15.126494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.revenue_lost, now model.crb_kpi.stg_customers)
[0m01:28:15.131508 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m01:28:15.131508 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m01:28:15.136550 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m01:28:15.141678 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m01:28:15.143821 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m01:28:15.145596 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean
FROM raw
  );
[0m01:28:15.631581 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.485 seconds
[0m01:28:15.631581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '491de22d-50c8-4dff-93f8-8a27caf3c7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C4A67090>]}
[0m01:28:15.631581 [info ] [Thread-1 (]: 8 of 10 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 0.51s]
[0m01:28:15.631581 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m01:28:15.631581 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m01:28:15.641716 [info ] [Thread-1 (]: 9 of 10 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m01:28:15.641716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m01:28:15.644683 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m01:28:15.647942 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m01:28:15.651538 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m01:28:15.656307 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m01:28:15.658285 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m01:28:15.658285 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM public.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m01:28:16.172023 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.518 seconds
[0m01:28:16.182026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '491de22d-50c8-4dff-93f8-8a27caf3c7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C54987D0>]}
[0m01:28:16.186548 [info ] [Thread-1 (]: 9 of 10 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 0.54s]
[0m01:28:16.186548 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m01:28:16.186548 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m01:28:16.186548 [info ] [Thread-1 (]: 10 of 10 START sql view model PUBLIC.stg_transactions .......................... [RUN]
[0m01:28:16.191564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m01:28:16.194568 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m01:28:16.198072 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m01:28:16.201594 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m01:28:16.211603 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m01:28:16.216329 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m01:28:16.216329 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m01:28:16.674158 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.461 seconds
[0m01:28:16.683886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '491de22d-50c8-4dff-93f8-8a27caf3c7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C5800C50>]}
[0m01:28:16.686228 [info ] [Thread-1 (]: 10 of 10 OK created sql view model PUBLIC.stg_transactions ..................... [[32mSUCCESS 1[0m in 0.49s]
[0m01:28:16.688031 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m01:28:16.689541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:28:16.689541 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m01:28:16.691557 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m01:28:17.312040 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m01:28:17.313329 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m01:28:17.941556 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m01:28:17.941556 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m01:28:18.571702 [info ] [MainThread]: 
[0m01:28:18.571702 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 13.35 seconds (13.35s).
[0m01:28:18.581813 [debug] [MainThread]: Command end result
[0m01:28:18.625893 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:28:18.631912 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:28:18.645713 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m01:28:18.648692 [info ] [MainThread]: 
[0m01:28:18.650132 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m01:28:18.651673 [info ] [MainThread]: 
[0m01:28:18.651673 [error] [MainThread]:   Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  000939 (22023): SQL compilation error: error line 5 at position 18
  too many arguments for function [TRY_TO_DATE(T.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql
[0m01:28:18.653833 [info ] [MainThread]: 
[0m01:28:18.658732 [error] [MainThread]:   Database Error in model new_logos (models\marts\new_logos.sql)
  000939 (22023): SQL compilation error: error line 6 at position 26
  too many arguments for function [TRY_TO_DATE(T.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
  compiled code at target\run\crb_kpi\models\marts\new_logos.sql
[0m01:28:18.658732 [info ] [MainThread]: 
[0m01:28:18.662583 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
[0m01:28:18.662583 [debug] [MainThread]: Command `dbt run` failed at 01:28:18.662583 after 16.12 seconds
[0m01:28:18.662583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261BE012C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C3173CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C2F4F6D0>]}
[0m01:28:18.662583 [debug] [MainThread]: Flushing usage events
[0m01:28:20.131559 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:31:05.091226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1AF8C390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1AFC8790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1AFE1890>]}


============================== 01:31:05.101395 | 33b43872-a27b-4cb2-9e65-c35ae113beff ==============================
[0m01:31:05.101395 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:31:05.101395 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:31:05.851181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33b43872-a27b-4cb2-9e65-c35ae113beff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1AF80910>]}
[0m01:31:05.941472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33b43872-a27b-4cb2-9e65-c35ae113beff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1BB5D850>]}
[0m01:31:05.951008 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:31:06.743219 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:31:07.011220 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:31:07.011220 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\net_nrr_grr.sql
[0m01:31:07.021496 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\new_logos.sql
[0m01:31:07.411236 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m01:31:07.415772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33b43872-a27b-4cb2-9e65-c35ae113beff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1C3B3910>]}
[0m01:31:07.551117 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:31:07.561291 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:31:07.621485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33b43872-a27b-4cb2-9e65-c35ae113beff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1C7B7A10>]}
[0m01:31:07.621485 [info ] [MainThread]: Found 10 models, 474 macros
[0m01:31:07.621485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33b43872-a27b-4cb2-9e65-c35ae113beff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1C698ED0>]}
[0m01:31:07.632674 [info ] [MainThread]: 
[0m01:31:07.635524 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:31:07.635524 [info ] [MainThread]: 
[0m01:31:07.641056 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:31:07.651136 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m01:31:07.914396 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m01:31:07.914396 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m01:31:07.914396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:09.993465 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.076 seconds
[0m01:31:10.003978 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m01:31:10.031360 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m01:31:10.031360 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m01:31:10.035390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:11.861791 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.833 seconds
[0m01:31:11.881093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33b43872-a27b-4cb2-9e65-c35ae113beff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1BB65750>]}
[0m01:31:11.891093 [debug] [Thread-1 (]: Began running node model.crb_kpi.churned_new_customers
[0m01:31:11.896112 [info ] [Thread-1 (]: 1 of 10 START sql view model PUBLIC.churned_new_customers ...................... [RUN]
[0m01:31:11.899335 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.churned_new_customers'
[0m01:31:11.899335 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.churned_new_customers
[0m01:31:11.914397 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.churned_new_customers"
[0m01:31:11.918723 [debug] [Thread-1 (]: Began executing node model.crb_kpi.churned_new_customers
[0m01:31:11.973488 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.churned_new_customers"
[0m01:31:11.977110 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.churned_new_customers"
[0m01:31:11.977110 [debug] [Thread-1 (]: On model.crb_kpi.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.churned_new_customers"} */
create or replace   view CRBFITNESS.PUBLIC.churned_new_customers
  
   as (
    SELECT 
    customer_id, 
    'new' AS customer_status, 
    MIN(payment_month) AS first_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MIN(payment_month) IS NOT NULL

UNION ALL

SELECT 
    customer_id, 
    'churned' AS customer_status, 
    MAX(payment_month) AS last_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
  );
[0m01:31:11.977110 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:31:14.026941 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.052 seconds
[0m01:31:14.081262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33b43872-a27b-4cb2-9e65-c35ae113beff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1BE44750>]}
[0m01:31:14.081262 [info ] [Thread-1 (]: 1 of 10 OK created sql view model PUBLIC.churned_new_customers ................. [[32mSUCCESS 1[0m in 2.18s]
[0m01:31:14.081262 [debug] [Thread-1 (]: Finished running node model.crb_kpi.churned_new_customers
[0m01:31:14.081262 [debug] [Thread-1 (]: Began running node model.crb_kpi.cross_sell_product_churn
[0m01:31:14.081262 [info ] [Thread-1 (]: 2 of 10 START sql view model PUBLIC.cross_sell_product_churn ................... [RUN]
[0m01:31:14.091089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.churned_new_customers, now model.crb_kpi.cross_sell_product_churn)
[0m01:31:14.094547 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.cross_sell_product_churn
[0m01:31:14.098242 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.cross_sell_product_churn"
[0m01:31:14.105365 [debug] [Thread-1 (]: Began executing node model.crb_kpi.cross_sell_product_churn
[0m01:31:14.111442 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.cross_sell_product_churn"
[0m01:31:14.114268 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.cross_sell_product_churn"
[0m01:31:14.115160 [debug] [Thread-1 (]: On model.crb_kpi.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.cross_sell_product_churn"} */
create or replace   view CRBFITNESS.PUBLIC.cross_sell_product_churn
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    p.product_family_clean, 
    COUNT(DISTINCT p.product_family_clean) AS cross_sell_count
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
ORDER BY cross_sell_count DESC
LIMIT 10
  );
[0m01:31:14.876263 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.760 seconds
[0m01:31:14.881281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33b43872-a27b-4cb2-9e65-c35ae113beff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1CEC5C50>]}
[0m01:31:14.885976 [info ] [Thread-1 (]: 2 of 10 OK created sql view model PUBLIC.cross_sell_product_churn .............. [[32mSUCCESS 1[0m in 0.79s]
[0m01:31:14.885976 [debug] [Thread-1 (]: Finished running node model.crb_kpi.cross_sell_product_churn
[0m01:31:14.885976 [debug] [Thread-1 (]: Began running node model.crb_kpi.net_nrr_grr
[0m01:31:14.891560 [info ] [Thread-1 (]: 3 of 10 START sql view model PUBLIC.net_nrr_grr ................................ [RUN]
[0m01:31:14.896078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.cross_sell_product_churn, now model.crb_kpi.net_nrr_grr)
[0m01:31:14.896078 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.net_nrr_grr
[0m01:31:14.903579 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.net_nrr_grr"
[0m01:31:14.905654 [debug] [Thread-1 (]: Began executing node model.crb_kpi.net_nrr_grr
[0m01:31:14.911044 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.net_nrr_grr"
[0m01:31:14.915786 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.net_nrr_grr"
[0m01:31:14.915786 [debug] [Thread-1 (]: On model.crb_kpi.net_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.net_nrr_grr"} */
create or replace   view CRBFITNESS.PUBLIC.net_nrr_grr
  
   as (
    SELECT 
    SUM(CASE 
            WHEN TRY_CAST(t.payment_month AS DATE) >= DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN t.revenue 
            ELSE 0 
        END) AS current_revenue,

    SUM(CASE 
            WHEN TRY_CAST(t.payment_month AS DATE) < DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN t.revenue 
            ELSE 0 
        END) AS previous_revenue,

    (SUM(CASE 
            WHEN TRY_CAST(t.payment_month AS DATE) >= DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN t.revenue 
            ELSE 0 
        END) * 1.0 /
     NULLIF(SUM(CASE 
                    WHEN TRY_CAST(t.payment_month AS DATE) < DATEADD(YEAR, -1, CURRENT_DATE) 
                    THEN t.revenue 
                    ELSE 0 
                END), 0)) AS NRR,

    (SUM(CASE 
            WHEN TRY_CAST(t.payment_month AS DATE) >= DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN t.revenue 
            ELSE 0 
        END) * 1.0 /
     NULLIF(SUM(CASE 
                    WHEN TRY_CAST(t.payment_month AS DATE) >= DATEADD(YEAR, -1, CURRENT_DATE) 
                    THEN t.revenue 
                    ELSE 0 
                END), 0)) AS GRR

FROM public.stg_transactions t
  );
[0m01:31:15.599550 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.680 seconds
[0m01:31:15.603548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33b43872-a27b-4cb2-9e65-c35ae113beff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1CEA3290>]}
[0m01:31:15.603548 [info ] [Thread-1 (]: 3 of 10 OK created sql view model PUBLIC.net_nrr_grr ........................... [[32mSUCCESS 1[0m in 0.71s]
[0m01:31:15.611247 [debug] [Thread-1 (]: Finished running node model.crb_kpi.net_nrr_grr
[0m01:31:15.611247 [debug] [Thread-1 (]: Began running node model.crb_kpi.new_logos
[0m01:31:15.611247 [info ] [Thread-1 (]: 4 of 10 START sql view model PUBLIC.new_logos .................................. [RUN]
[0m01:31:15.611247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.net_nrr_grr, now model.crb_kpi.new_logos)
[0m01:31:15.619313 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.new_logos
[0m01:31:15.623645 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.new_logos"
[0m01:31:15.623645 [debug] [Thread-1 (]: Began executing node model.crb_kpi.new_logos
[0m01:31:15.632704 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.new_logos"
[0m01:31:15.636840 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.new_logos"
[0m01:31:15.636840 [debug] [Thread-1 (]: On model.crb_kpi.new_logos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.new_logos"} */
create or replace   view CRBFITNESS.PUBLIC.new_logos
  
   as (
    SELECT 
    t.customer_id, 
    MIN(EXTRACT(YEAR FROM TRY_CAST(t.payment_month AS DATE))) AS first_fiscal_year
FROM public.stg_transactions t
GROUP BY t.customer_id
  );
[0m01:31:16.191475 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.555 seconds
[0m01:31:16.197169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33b43872-a27b-4cb2-9e65-c35ae113beff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1CFBAD50>]}
[0m01:31:16.201184 [info ] [Thread-1 (]: 4 of 10 OK created sql view model PUBLIC.new_logos ............................. [[32mSUCCESS 1[0m in 0.59s]
[0m01:31:16.204316 [debug] [Thread-1 (]: Finished running node model.crb_kpi.new_logos
[0m01:31:16.204316 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_customers
[0m01:31:16.206869 [info ] [Thread-1 (]: 5 of 10 START sql view model PUBLIC.ranked_customers ........................... [RUN]
[0m01:31:16.206869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.new_logos, now model.crb_kpi.ranked_customers)
[0m01:31:16.211811 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_customers
[0m01:31:16.218561 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_customers"
[0m01:31:16.223768 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_customers
[0m01:31:16.231125 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_customers"
[0m01:31:16.235057 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_customers"
[0m01:31:16.235057 [debug] [Thread-1 (]: On model.crb_kpi.ranked_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_customers"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_customers
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
GROUP BY t.customer_id, c.customer_name_clean
ORDER BY total_revenue DESC
  );
[0m01:31:16.811094 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.574 seconds
[0m01:31:16.811094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33b43872-a27b-4cb2-9e65-c35ae113beff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1BE32210>]}
[0m01:31:16.819206 [info ] [Thread-1 (]: 5 of 10 OK created sql view model PUBLIC.ranked_customers ...................... [[32mSUCCESS 1[0m in 0.60s]
[0m01:31:16.821770 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_customers
[0m01:31:16.821770 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_products
[0m01:31:16.824285 [info ] [Thread-1 (]: 6 of 10 START sql view model PUBLIC.ranked_products ............................ [RUN]
[0m01:31:16.824285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_customers, now model.crb_kpi.ranked_products)
[0m01:31:16.827655 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_products
[0m01:31:16.832809 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_products"
[0m01:31:16.832809 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_products
[0m01:31:16.841251 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_products"
[0m01:31:16.841251 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_products"
[0m01:31:16.841251 [debug] [Thread-1 (]: On model.crb_kpi.ranked_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_products"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_products
  
   as (
    SELECT 
    p.product_family_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY p.product_family_clean
ORDER BY total_revenue DESC
  );
[0m01:31:17.493638 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.647 seconds
[0m01:31:17.493638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33b43872-a27b-4cb2-9e65-c35ae113beff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1CEF4490>]}
[0m01:31:17.502181 [info ] [Thread-1 (]: 6 of 10 OK created sql view model PUBLIC.ranked_products ....................... [[32mSUCCESS 1[0m in 0.67s]
[0m01:31:17.503684 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_products
[0m01:31:17.505819 [debug] [Thread-1 (]: Began running node model.crb_kpi.revenue_lost
[0m01:31:17.505819 [info ] [Thread-1 (]: 7 of 10 START sql view model PUBLIC.revenue_lost ............................... [RUN]
[0m01:31:17.509334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_products, now model.crb_kpi.revenue_lost)
[0m01:31:17.511078 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.revenue_lost
[0m01:31:17.517979 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.revenue_lost"
[0m01:31:17.521066 [debug] [Thread-1 (]: Began executing node model.crb_kpi.revenue_lost
[0m01:31:17.534964 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.revenue_lost"
[0m01:31:17.540954 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.revenue_lost"
[0m01:31:17.540954 [debug] [Thread-1 (]: On model.crb_kpi.revenue_lost: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.revenue_lost"} */
create or replace   view CRBFITNESS.PUBLIC.revenue_lost
  
   as (
    SELECT 
    t.payment_month AS period, 
    SUM(t.revenue) AS total_revenue_lost
FROM public.stg_transactions t
WHERE t.customer_id IN (
    SELECT customer_id 
    FROM public.stg_transactions 
    GROUP BY customer_id 
    HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
)
GROUP BY t.payment_month
ORDER BY t.payment_month
  );
[0m01:31:18.191400 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.652 seconds
[0m01:31:18.201303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33b43872-a27b-4cb2-9e65-c35ae113beff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1CFDD390>]}
[0m01:31:18.201303 [info ] [Thread-1 (]: 7 of 10 OK created sql view model PUBLIC.revenue_lost .......................... [[32mSUCCESS 1[0m in 0.69s]
[0m01:31:18.205489 [debug] [Thread-1 (]: Finished running node model.crb_kpi.revenue_lost
[0m01:31:18.207009 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m01:31:18.207009 [info ] [Thread-1 (]: 8 of 10 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m01:31:18.211062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.revenue_lost, now model.crb_kpi.stg_customers)
[0m01:31:18.213398 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m01:31:18.221254 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m01:31:18.224439 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m01:31:18.229462 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m01:31:18.235419 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m01:31:18.236670 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean
FROM raw
  );
[0m01:31:18.787505 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.550 seconds
[0m01:31:18.795595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33b43872-a27b-4cb2-9e65-c35ae113beff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1CFA3550>]}
[0m01:31:18.795595 [info ] [Thread-1 (]: 8 of 10 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 0.58s]
[0m01:31:18.801282 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m01:31:18.801282 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m01:31:18.801282 [info ] [Thread-1 (]: 9 of 10 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m01:31:18.806339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m01:31:18.807363 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m01:31:18.812490 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m01:31:18.813745 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m01:31:18.821158 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m01:31:18.822800 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m01:31:18.822800 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM public.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m01:31:19.363241 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.539 seconds
[0m01:31:19.367792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33b43872-a27b-4cb2-9e65-c35ae113beff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1D411350>]}
[0m01:31:19.371316 [info ] [Thread-1 (]: 9 of 10 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 0.56s]
[0m01:31:19.371316 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m01:31:19.376369 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m01:31:19.379418 [info ] [Thread-1 (]: 10 of 10 START sql view model PUBLIC.stg_transactions .......................... [RUN]
[0m01:31:19.379418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m01:31:19.382296 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m01:31:19.386309 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m01:31:19.387768 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m01:31:19.391115 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m01:31:19.393858 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m01:31:19.395372 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m01:31:19.960984 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.568 seconds
[0m01:31:19.960984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33b43872-a27b-4cb2-9e65-c35ae113beff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1D403050>]}
[0m01:31:19.971171 [info ] [Thread-1 (]: 10 of 10 OK created sql view model PUBLIC.stg_transactions ..................... [[32mSUCCESS 1[0m in 0.58s]
[0m01:31:19.973229 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m01:31:19.976009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:31:19.976643 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m01:31:19.977892 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m01:31:20.621032 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m01:31:20.631202 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m01:31:21.281478 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m01:31:21.289260 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m01:31:21.931195 [info ] [MainThread]: 
[0m01:31:21.931195 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 14.29 seconds (14.29s).
[0m01:31:21.941075 [debug] [MainThread]: Command end result
[0m01:31:21.999044 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:31:22.009967 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:31:22.023129 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m01:31:22.023683 [info ] [MainThread]: 
[0m01:31:22.026574 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:31:22.028437 [info ] [MainThread]: 
[0m01:31:22.030081 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m01:31:22.031149 [debug] [MainThread]: Command `dbt run` succeeded at 01:31:22.031149 after 17.05 seconds
[0m01:31:22.031149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1AFEEA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1ACBBD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A15AE2E10>]}
[0m01:31:22.034089 [debug] [MainThread]: Flushing usage events
[0m01:31:23.481345 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:35:30.584011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022569C8C450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022569CE23D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022569CE3DD0>]}


============================== 01:35:30.596341 | 4c780399-b849-47ff-b007-0fd1f0008391 ==============================
[0m01:35:30.596341 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:35:30.600352 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:35:31.390430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c780399-b849-47ff-b007-0fd1f0008391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256A9A15D0>]}
[0m01:35:31.480513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c780399-b849-47ff-b007-0fd1f0008391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256A85D910>]}
[0m01:35:31.485134 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:35:32.270248 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:35:32.550311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:35:32.550311 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\new_logos.sql
[0m01:35:32.558339 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\net_nrr_grr.sql
[0m01:35:32.951982 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m01:35:32.960507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c780399-b849-47ff-b007-0fd1f0008391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256A9089D0>]}
[0m01:35:33.072169 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:35:33.080234 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:35:33.124292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c780399-b849-47ff-b007-0fd1f0008391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256B365710>]}
[0m01:35:33.124292 [info ] [MainThread]: Found 10 models, 474 macros
[0m01:35:33.130283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c780399-b849-47ff-b007-0fd1f0008391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256A8CBA90>]}
[0m01:35:33.132788 [info ] [MainThread]: 
[0m01:35:33.136945 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:35:33.139143 [info ] [MainThread]: 
[0m01:35:33.141157 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:35:33.150530 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m01:35:33.405593 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m01:35:33.405593 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m01:35:33.405593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:35:35.714846 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.308 seconds
[0m01:35:35.724882 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m01:35:35.743279 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m01:35:35.743556 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m01:35:35.743556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:35:37.560430 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.816 seconds
[0m01:35:37.570339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c780399-b849-47ff-b007-0fd1f0008391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022565B9D2D0>]}
[0m01:35:37.580647 [debug] [Thread-1 (]: Began running node model.crb_kpi.churned_new_customers
[0m01:35:37.580647 [info ] [Thread-1 (]: 1 of 10 START sql view model PUBLIC.churned_new_customers ...................... [RUN]
[0m01:35:37.590608 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.churned_new_customers'
[0m01:35:37.590608 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.churned_new_customers
[0m01:35:37.614774 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.churned_new_customers"
[0m01:35:37.618330 [debug] [Thread-1 (]: Began executing node model.crb_kpi.churned_new_customers
[0m01:35:37.670388 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.churned_new_customers"
[0m01:35:37.675196 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.churned_new_customers"
[0m01:35:37.675196 [debug] [Thread-1 (]: On model.crb_kpi.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.churned_new_customers"} */
create or replace   view CRBFITNESS.PUBLIC.churned_new_customers
  
   as (
    SELECT 
    customer_id, 
    'new' AS customer_status, 
    MIN(payment_month) AS first_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MIN(payment_month) IS NOT NULL

UNION ALL

SELECT 
    customer_id, 
    'churned' AS customer_status, 
    MAX(payment_month) AS last_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
  );
[0m01:35:37.675196 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:35:39.783541 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.110 seconds
[0m01:35:39.835449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c780399-b849-47ff-b007-0fd1f0008391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256B933950>]}
[0m01:35:39.840542 [info ] [Thread-1 (]: 1 of 10 OK created sql view model PUBLIC.churned_new_customers ................. [[32mSUCCESS 1[0m in 2.24s]
[0m01:35:39.844558 [debug] [Thread-1 (]: Finished running node model.crb_kpi.churned_new_customers
[0m01:35:39.844558 [debug] [Thread-1 (]: Began running node model.crb_kpi.cross_sell_product_churn
[0m01:35:39.846146 [info ] [Thread-1 (]: 2 of 10 START sql view model PUBLIC.cross_sell_product_churn ................... [RUN]
[0m01:35:39.847162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.churned_new_customers, now model.crb_kpi.cross_sell_product_churn)
[0m01:35:39.847162 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.cross_sell_product_churn
[0m01:35:39.850704 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.cross_sell_product_churn"
[0m01:35:39.854398 [debug] [Thread-1 (]: Began executing node model.crb_kpi.cross_sell_product_churn
[0m01:35:39.866731 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.cross_sell_product_churn"
[0m01:35:39.870582 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.cross_sell_product_churn"
[0m01:35:39.872054 [debug] [Thread-1 (]: On model.crb_kpi.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.cross_sell_product_churn"} */
create or replace   view CRBFITNESS.PUBLIC.cross_sell_product_churn
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    p.product_family_clean, 
    COUNT(DISTINCT p.product_family_clean) AS cross_sell_count
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
ORDER BY cross_sell_count DESC
LIMIT 10
  );
[0m01:35:40.694882 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.826 seconds
[0m01:35:40.705471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c780399-b849-47ff-b007-0fd1f0008391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256B1A44D0>]}
[0m01:35:40.707304 [info ] [Thread-1 (]: 2 of 10 OK created sql view model PUBLIC.cross_sell_product_churn .............. [[32mSUCCESS 1[0m in 0.86s]
[0m01:35:40.710388 [debug] [Thread-1 (]: Finished running node model.crb_kpi.cross_sell_product_churn
[0m01:35:40.710388 [debug] [Thread-1 (]: Began running node model.crb_kpi.net_nrr_grr
[0m01:35:40.710388 [info ] [Thread-1 (]: 3 of 10 START sql view model PUBLIC.net_nrr_grr ................................ [RUN]
[0m01:35:40.710388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.cross_sell_product_churn, now model.crb_kpi.net_nrr_grr)
[0m01:35:40.714621 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.net_nrr_grr
[0m01:35:40.714621 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.net_nrr_grr"
[0m01:35:40.722443 [debug] [Thread-1 (]: Began executing node model.crb_kpi.net_nrr_grr
[0m01:35:40.726977 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.net_nrr_grr"
[0m01:35:40.730734 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.net_nrr_grr"
[0m01:35:40.735743 [debug] [Thread-1 (]: On model.crb_kpi.net_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.net_nrr_grr"} */
create or replace   view CRBFITNESS.PUBLIC.net_nrr_grr
  
   as (
    SELECT 
    SUM(CASE 
            WHEN t.payment_month >= TO_CHAR(DATEADD(YEAR, -1, CURRENT_DATE), 'DD-MM-YYYY') 
            THEN t.revenue 
            ELSE 0 
        END) AS current_revenue,

    SUM(CASE 
            WHEN t.payment_month < TO_CHAR(DATEADD(YEAR, -1, CURRENT_DATE), 'DD-MM-YYYY') 
            THEN t.revenue 
            ELSE 0 
        END) AS previous_revenue,

    (SUM(CASE 
            WHEN t.payment_month >= TO_CHAR(DATEADD(YEAR, -1, CURRENT_DATE), 'DD-MM-YYYY') 
            THEN t.revenue 
            ELSE 0 
        END) * 1.0 /
     NULLIF(SUM(CASE 
                    WHEN t.payment_month < TO_CHAR(DATEADD(YEAR, -1, CURRENT_DATE), 'DD-MM-YYYY') 
                    THEN t.revenue 
                    ELSE 0 
                END), 0)) AS NRR,

    (SUM(CASE 
            WHEN t.payment_month >= TO_CHAR(DATEADD(YEAR, -1, CURRENT_DATE), 'DD-MM-YYYY') 
            THEN t.revenue 
            ELSE 0 
        END) * 1.0 /
     NULLIF(SUM(CASE 
                    WHEN t.payment_month >= TO_CHAR(DATEADD(YEAR, -1, CURRENT_DATE), 'DD-MM-YYYY') 
                    THEN t.revenue 
                    ELSE 0 
                END), 0)) AS GRR

FROM public.stg_transactions t
  );
[0m01:35:41.349037 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.612 seconds
[0m01:35:41.355585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c780399-b849-47ff-b007-0fd1f0008391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256B366BD0>]}
[0m01:35:41.357320 [info ] [Thread-1 (]: 3 of 10 OK created sql view model PUBLIC.net_nrr_grr ........................... [[32mSUCCESS 1[0m in 0.64s]
[0m01:35:41.359181 [debug] [Thread-1 (]: Finished running node model.crb_kpi.net_nrr_grr
[0m01:35:41.360700 [debug] [Thread-1 (]: Began running node model.crb_kpi.new_logos
[0m01:35:41.360700 [info ] [Thread-1 (]: 4 of 10 START sql view model PUBLIC.new_logos .................................. [RUN]
[0m01:35:41.366799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.net_nrr_grr, now model.crb_kpi.new_logos)
[0m01:35:41.369324 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.new_logos
[0m01:35:41.371910 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.new_logos"
[0m01:35:41.373947 [debug] [Thread-1 (]: Began executing node model.crb_kpi.new_logos
[0m01:35:41.380236 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.new_logos"
[0m01:35:41.383504 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.new_logos"
[0m01:35:41.383504 [debug] [Thread-1 (]: On model.crb_kpi.new_logos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.new_logos"} */
create or replace   view CRBFITNESS.PUBLIC.new_logos
  
   as (
    SELECT 
    t.customer_id, 
    LEFT(t.payment_month, 4) AS first_fiscal_year
FROM public.stg_transactions t
GROUP BY t.customer_id, LEFT(t.payment_month, 4)
  );
[0m01:35:41.950498 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.564 seconds
[0m01:35:41.954669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c780399-b849-47ff-b007-0fd1f0008391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256BCB6C10>]}
[0m01:35:41.954669 [info ] [Thread-1 (]: 4 of 10 OK created sql view model PUBLIC.new_logos ............................. [[32mSUCCESS 1[0m in 0.59s]
[0m01:35:41.960189 [debug] [Thread-1 (]: Finished running node model.crb_kpi.new_logos
[0m01:35:41.961327 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_customers
[0m01:35:41.961327 [info ] [Thread-1 (]: 5 of 10 START sql view model PUBLIC.ranked_customers ........................... [RUN]
[0m01:35:41.965345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.new_logos, now model.crb_kpi.ranked_customers)
[0m01:35:41.968047 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_customers
[0m01:35:41.975442 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_customers"
[0m01:35:41.975442 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_customers
[0m01:35:41.984921 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_customers"
[0m01:35:41.990675 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_customers"
[0m01:35:41.990675 [debug] [Thread-1 (]: On model.crb_kpi.ranked_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_customers"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_customers
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
GROUP BY t.customer_id, c.customer_name_clean
ORDER BY total_revenue DESC
  );
[0m01:35:42.730285 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.736 seconds
[0m01:35:42.734835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c780399-b849-47ff-b007-0fd1f0008391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256BCB9D10>]}
[0m01:35:42.734835 [info ] [Thread-1 (]: 5 of 10 OK created sql view model PUBLIC.ranked_customers ...................... [[32mSUCCESS 1[0m in 0.77s]
[0m01:35:42.740353 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_customers
[0m01:35:42.740353 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_products
[0m01:35:42.740353 [info ] [Thread-1 (]: 6 of 10 START sql view model PUBLIC.ranked_products ............................ [RUN]
[0m01:35:42.745405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_customers, now model.crb_kpi.ranked_products)
[0m01:35:42.748712 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_products
[0m01:35:42.752816 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_products"
[0m01:35:42.753748 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_products
[0m01:35:42.753748 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_products"
[0m01:35:42.761957 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_products"
[0m01:35:42.763566 [debug] [Thread-1 (]: On model.crb_kpi.ranked_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_products"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_products
  
   as (
    SELECT 
    p.product_family_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY p.product_family_clean
ORDER BY total_revenue DESC
  );
[0m01:35:43.521468 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.757 seconds
[0m01:35:43.523509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c780399-b849-47ff-b007-0fd1f0008391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256BCC6250>]}
[0m01:35:43.523509 [info ] [Thread-1 (]: 6 of 10 OK created sql view model PUBLIC.ranked_products ....................... [[32mSUCCESS 1[0m in 0.78s]
[0m01:35:43.530533 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_products
[0m01:35:43.533266 [debug] [Thread-1 (]: Began running node model.crb_kpi.revenue_lost
[0m01:35:43.533266 [info ] [Thread-1 (]: 7 of 10 START sql view model PUBLIC.revenue_lost ............................... [RUN]
[0m01:35:43.537281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_products, now model.crb_kpi.revenue_lost)
[0m01:35:43.537281 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.revenue_lost
[0m01:35:43.540297 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.revenue_lost"
[0m01:35:43.545345 [debug] [Thread-1 (]: Began executing node model.crb_kpi.revenue_lost
[0m01:35:43.552471 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.revenue_lost"
[0m01:35:43.556509 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.revenue_lost"
[0m01:35:43.558385 [debug] [Thread-1 (]: On model.crb_kpi.revenue_lost: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.revenue_lost"} */
create or replace   view CRBFITNESS.PUBLIC.revenue_lost
  
   as (
    SELECT 
    t.payment_month AS period, 
    SUM(t.revenue) AS total_revenue_lost
FROM public.stg_transactions t
WHERE t.customer_id IN (
    SELECT customer_id 
    FROM public.stg_transactions 
    GROUP BY customer_id 
    HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
)
GROUP BY t.payment_month
ORDER BY t.payment_month
  );
[0m01:35:44.259137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.699 seconds
[0m01:35:44.261350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c780399-b849-47ff-b007-0fd1f0008391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256BCC48D0>]}
[0m01:35:44.261350 [info ] [Thread-1 (]: 7 of 10 OK created sql view model PUBLIC.revenue_lost .......................... [[32mSUCCESS 1[0m in 0.72s]
[0m01:35:44.268487 [debug] [Thread-1 (]: Finished running node model.crb_kpi.revenue_lost
[0m01:35:44.268487 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m01:35:44.270503 [info ] [Thread-1 (]: 8 of 10 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m01:35:44.274459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.revenue_lost, now model.crb_kpi.stg_customers)
[0m01:35:44.275700 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m01:35:44.280765 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m01:35:44.282251 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m01:35:44.286826 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m01:35:44.291148 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m01:35:44.291148 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean
FROM raw
  );
[0m01:35:44.890506 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.596 seconds
[0m01:35:44.898507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c780399-b849-47ff-b007-0fd1f0008391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256BCC5410>]}
[0m01:35:44.902048 [info ] [Thread-1 (]: 8 of 10 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 0.63s]
[0m01:35:44.910206 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m01:35:44.911728 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m01:35:44.914387 [info ] [Thread-1 (]: 9 of 10 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m01:35:44.917792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m01:35:44.917792 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m01:35:44.921751 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m01:35:44.921751 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m01:35:44.930834 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m01:35:44.931897 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m01:35:44.931897 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM public.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m01:35:45.514240 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.578 seconds
[0m01:35:45.520639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c780399-b849-47ff-b007-0fd1f0008391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256C010190>]}
[0m01:35:45.520639 [info ] [Thread-1 (]: 9 of 10 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 0.60s]
[0m01:35:45.525206 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m01:35:45.528052 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m01:35:45.531117 [info ] [Thread-1 (]: 10 of 10 START sql view model PUBLIC.stg_transactions .......................... [RUN]
[0m01:35:45.534571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m01:35:45.537101 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m01:35:45.540207 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m01:35:45.543731 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m01:35:45.555262 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m01:35:45.560127 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m01:35:45.560127 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m01:35:46.274561 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.710 seconds
[0m01:35:46.286912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c780399-b849-47ff-b007-0fd1f0008391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256C010C50>]}
[0m01:35:46.290531 [info ] [Thread-1 (]: 10 of 10 OK created sql view model PUBLIC.stg_transactions ..................... [[32mSUCCESS 1[0m in 0.76s]
[0m01:35:46.294588 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m01:35:46.301849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:35:46.305383 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m01:35:46.308340 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m01:35:46.963511 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m01:35:46.963511 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m01:35:47.633055 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m01:35:47.633055 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m01:35:48.260508 [info ] [MainThread]: 
[0m01:35:48.260508 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 15.12 seconds (15.12s).
[0m01:35:48.276167 [debug] [MainThread]: Command end result
[0m01:35:48.353221 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:35:48.365229 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:35:48.390535 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m01:35:48.390535 [info ] [MainThread]: 
[0m01:35:48.390535 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:35:48.390535 [info ] [MainThread]: 
[0m01:35:48.390535 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m01:35:48.401649 [debug] [MainThread]: Command `dbt run` succeeded at 01:35:48.401527 after 17.97 seconds
[0m01:35:48.404185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022564892E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022564812D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022564811FD0>]}
[0m01:35:48.404830 [debug] [MainThread]: Flushing usage events
[0m01:35:49.940272 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:37:47.429874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002715918AA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271591C88D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271591E2650>]}


============================== 01:37:47.440015 | 63858357-b4fd-49e2-bdc3-19b8652da067 ==============================
[0m01:37:47.440015 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:37:47.440015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:37:48.219928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63858357-b4fd-49e2-bdc3-19b8652da067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027157BFF510>]}
[0m01:37:48.314149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63858357-b4fd-49e2-bdc3-19b8652da067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027157B6D1D0>]}
[0m01:37:48.321057 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:37:49.100812 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:37:49.391677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:37:49.399759 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\net_nrr_grr.sql
[0m01:37:49.399759 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\new_logos.sql
[0m01:37:49.797778 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m01:37:49.801781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63858357-b4fd-49e2-bdc3-19b8652da067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027159DD5810>]}
[0m01:37:49.943222 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:37:49.954842 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:37:49.989994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63858357-b4fd-49e2-bdc3-19b8652da067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002715AA62C90>]}
[0m01:37:49.991014 [info ] [MainThread]: Found 10 models, 474 macros
[0m01:37:49.991014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63858357-b4fd-49e2-bdc3-19b8652da067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002715AA12950>]}
[0m01:37:49.991014 [info ] [MainThread]: 
[0m01:37:49.991014 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:37:49.999259 [info ] [MainThread]: 
[0m01:37:50.000311 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:37:50.009873 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m01:37:50.240237 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m01:37:50.240237 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m01:37:50.240237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:37:52.287284 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.041 seconds
[0m01:37:52.296004 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m01:37:52.320278 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m01:37:52.320278 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m01:37:52.324781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:37:54.093739 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.770 seconds
[0m01:37:54.104810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63858357-b4fd-49e2-bdc3-19b8652da067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002715A50D190>]}
[0m01:37:54.116423 [debug] [Thread-1 (]: Began running node model.crb_kpi.churned_new_customers
[0m01:37:54.116423 [info ] [Thread-1 (]: 1 of 10 START sql view model PUBLIC.churned_new_customers ...................... [RUN]
[0m01:37:54.122504 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.churned_new_customers'
[0m01:37:54.122504 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.churned_new_customers
[0m01:37:54.140045 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.churned_new_customers"
[0m01:37:54.141557 [debug] [Thread-1 (]: Began executing node model.crb_kpi.churned_new_customers
[0m01:37:54.199729 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.churned_new_customers"
[0m01:37:54.205208 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.churned_new_customers"
[0m01:37:54.206758 [debug] [Thread-1 (]: On model.crb_kpi.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.churned_new_customers"} */
create or replace   view CRBFITNESS.PUBLIC.churned_new_customers
  
   as (
    SELECT 
    customer_id, 
    'new' AS customer_status, 
    MIN(payment_month) AS first_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MIN(payment_month) IS NOT NULL

UNION ALL

SELECT 
    customer_id, 
    'churned' AS customer_status, 
    MAX(payment_month) AS last_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
  );
[0m01:37:54.206758 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:37:56.240105 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.035 seconds
[0m01:37:56.289720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63858357-b4fd-49e2-bdc3-19b8652da067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002715A50C810>]}
[0m01:37:56.289720 [info ] [Thread-1 (]: 1 of 10 OK created sql view model PUBLIC.churned_new_customers ................. [[32mSUCCESS 1[0m in 2.16s]
[0m01:37:56.292549 [debug] [Thread-1 (]: Finished running node model.crb_kpi.churned_new_customers
[0m01:37:56.292549 [debug] [Thread-1 (]: Began running node model.crb_kpi.cross_sell_product_churn
[0m01:37:56.295213 [info ] [Thread-1 (]: 2 of 10 START sql view model PUBLIC.cross_sell_product_churn ................... [RUN]
[0m01:37:56.297059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.churned_new_customers, now model.crb_kpi.cross_sell_product_churn)
[0m01:37:56.298533 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.cross_sell_product_churn
[0m01:37:56.301616 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.cross_sell_product_churn"
[0m01:37:56.301616 [debug] [Thread-1 (]: Began executing node model.crb_kpi.cross_sell_product_churn
[0m01:37:56.308303 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.cross_sell_product_churn"
[0m01:37:56.311606 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.cross_sell_product_churn"
[0m01:37:56.313496 [debug] [Thread-1 (]: On model.crb_kpi.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.cross_sell_product_churn"} */
create or replace   view CRBFITNESS.PUBLIC.cross_sell_product_churn
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    p.product_family_clean, 
    COUNT(DISTINCT p.product_family_clean) AS cross_sell_count
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
ORDER BY cross_sell_count DESC
LIMIT 10
  );
[0m01:37:57.020185 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.704 seconds
[0m01:37:57.022620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63858357-b4fd-49e2-bdc3-19b8652da067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002715A857A50>]}
[0m01:37:57.022620 [info ] [Thread-1 (]: 2 of 10 OK created sql view model PUBLIC.cross_sell_product_churn .............. [[32mSUCCESS 1[0m in 0.73s]
[0m01:37:57.030242 [debug] [Thread-1 (]: Finished running node model.crb_kpi.cross_sell_product_churn
[0m01:37:57.031151 [debug] [Thread-1 (]: Began running node model.crb_kpi.net_nrr_grr
[0m01:37:57.031151 [info ] [Thread-1 (]: 3 of 10 START sql view model PUBLIC.net_nrr_grr ................................ [RUN]
[0m01:37:57.031151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.cross_sell_product_churn, now model.crb_kpi.net_nrr_grr)
[0m01:37:57.038268 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.net_nrr_grr
[0m01:37:57.042471 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.net_nrr_grr"
[0m01:37:57.046490 [debug] [Thread-1 (]: Began executing node model.crb_kpi.net_nrr_grr
[0m01:37:57.052025 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.net_nrr_grr"
[0m01:37:57.061833 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.net_nrr_grr"
[0m01:37:57.061833 [debug] [Thread-1 (]: On model.crb_kpi.net_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.net_nrr_grr"} */
create or replace   view CRBFITNESS.PUBLIC.net_nrr_grr
  
   as (
    SELECT 
    SUM(CASE 
            WHEN RIGHT(t.payment_month, 4) || '-' || SUBSTRING(t.payment_month, 4, 2) || '-' || LEFT(t.payment_month, 2) >= 
                 TO_CHAR(DATEADD(YEAR, -1, CURRENT_DATE), 'YYYY-MM-DD') 
            THEN t.revenue 
            ELSE 0 
        END) AS current_revenue,

    SUM(CASE 
            WHEN RIGHT(t.payment_month, 4) || '-' || SUBSTRING(t.payment_month, 4, 2) || '-' || LEFT(t.payment_month, 2) < 
                 TO_CHAR(DATEADD(YEAR, -1, CURRENT_DATE), 'YYYY-MM-DD') 
            THEN t.revenue 
            ELSE 0 
        END) AS previous_revenue,

    (SUM(CASE 
            WHEN RIGHT(t.payment_month, 4) || '-' || SUBSTRING(t.payment_month, 4, 2) || '-' || LEFT(t.payment_month, 2) >= 
                 TO_CHAR(DATEADD(YEAR, -1, CURRENT_DATE), 'YYYY-MM-DD') 
            THEN t.revenue 
            ELSE 0 
        END) * 1.0 /
     NULLIF(SUM(CASE 
                    WHEN RIGHT(t.payment_month, 4) || '-' || SUBSTRING(t.payment_month, 4, 2) || '-' || LEFT(t.payment_month, 2) < 
                         TO_CHAR(DATEADD(YEAR, -1, CURRENT_DATE), 'YYYY-MM-DD') 
                    THEN t.revenue 
                    ELSE 0 
                END), 0)) AS NRR,

    (SUM(CASE 
            WHEN RIGHT(t.payment_month, 4) || '-' || SUBSTRING(t.payment_month, 4, 2) || '-' || LEFT(t.payment_month, 2) >= 
                 TO_CHAR(DATEADD(YEAR, -1, CURRENT_DATE), 'YYYY-MM-DD') 
            THEN t.revenue 
            ELSE 0 
        END) * 1.0 /
     NULLIF(SUM(CASE 
                    WHEN RIGHT(t.payment_month, 4) || '-' || SUBSTRING(t.payment_month, 4, 2) || '-' || LEFT(t.payment_month, 2) >= 
                         TO_CHAR(DATEADD(YEAR, -1, CURRENT_DATE), 'YYYY-MM-DD') 
                    THEN t.revenue 
                    ELSE 0 
                END), 0)) AS GRR

FROM public.stg_transactions t
  );
[0m01:37:57.619994 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.555 seconds
[0m01:37:57.625279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63858357-b4fd-49e2-bdc3-19b8652da067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002715B1AC450>]}
[0m01:37:57.630018 [info ] [Thread-1 (]: 3 of 10 OK created sql view model PUBLIC.net_nrr_grr ........................... [[32mSUCCESS 1[0m in 0.59s]
[0m01:37:57.630018 [debug] [Thread-1 (]: Finished running node model.crb_kpi.net_nrr_grr
[0m01:37:57.635793 [debug] [Thread-1 (]: Began running node model.crb_kpi.new_logos
[0m01:37:57.637435 [info ] [Thread-1 (]: 4 of 10 START sql view model PUBLIC.new_logos .................................. [RUN]
[0m01:37:57.642316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.net_nrr_grr, now model.crb_kpi.new_logos)
[0m01:37:57.645501 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.new_logos
[0m01:37:57.656348 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.new_logos"
[0m01:37:57.659864 [debug] [Thread-1 (]: Began executing node model.crb_kpi.new_logos
[0m01:37:57.661647 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.new_logos"
[0m01:37:57.670795 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.new_logos"
[0m01:37:57.673109 [debug] [Thread-1 (]: On model.crb_kpi.new_logos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.new_logos"} */
create or replace   view CRBFITNESS.PUBLIC.new_logos
  
   as (
    SELECT 
    t.customer_id, 
    RIGHT(t.payment_month, 4) AS first_fiscal_year
FROM public.stg_transactions t
GROUP BY t.customer_id, RIGHT(t.payment_month, 4)
  );
[0m01:37:58.268633 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m01:37:58.271708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63858357-b4fd-49e2-bdc3-19b8652da067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002715B1C8690>]}
[0m01:37:58.277982 [info ] [Thread-1 (]: 4 of 10 OK created sql view model PUBLIC.new_logos ............................. [[32mSUCCESS 1[0m in 0.63s]
[0m01:37:58.280003 [debug] [Thread-1 (]: Finished running node model.crb_kpi.new_logos
[0m01:37:58.280003 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_customers
[0m01:37:58.284562 [info ] [Thread-1 (]: 5 of 10 START sql view model PUBLIC.ranked_customers ........................... [RUN]
[0m01:37:58.287645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.new_logos, now model.crb_kpi.ranked_customers)
[0m01:37:58.288979 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_customers
[0m01:37:58.292890 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_customers"
[0m01:37:58.292890 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_customers
[0m01:37:58.300645 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_customers"
[0m01:37:58.304117 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_customers"
[0m01:37:58.304117 [debug] [Thread-1 (]: On model.crb_kpi.ranked_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_customers"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_customers
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
GROUP BY t.customer_id, c.customer_name_clean
ORDER BY total_revenue DESC
  );
[0m01:37:58.979240 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.673 seconds
[0m01:37:58.982899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63858357-b4fd-49e2-bdc3-19b8652da067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002715B0F9050>]}
[0m01:37:58.982899 [info ] [Thread-1 (]: 5 of 10 OK created sql view model PUBLIC.ranked_customers ...................... [[32mSUCCESS 1[0m in 0.70s]
[0m01:37:58.982899 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_customers
[0m01:37:58.989921 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_products
[0m01:37:58.989921 [info ] [Thread-1 (]: 6 of 10 START sql view model PUBLIC.ranked_products ............................ [RUN]
[0m01:37:58.992477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_customers, now model.crb_kpi.ranked_products)
[0m01:37:58.993912 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_products
[0m01:37:58.993912 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_products"
[0m01:37:59.000213 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_products
[0m01:37:59.000213 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_products"
[0m01:37:59.005269 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_products"
[0m01:37:59.008282 [debug] [Thread-1 (]: On model.crb_kpi.ranked_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_products"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_products
  
   as (
    SELECT 
    p.product_family_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY p.product_family_clean
ORDER BY total_revenue DESC
  );
[0m01:37:59.713149 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.702 seconds
[0m01:37:59.713149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63858357-b4fd-49e2-bdc3-19b8652da067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002715B1A4C10>]}
[0m01:37:59.720166 [info ] [Thread-1 (]: 6 of 10 OK created sql view model PUBLIC.ranked_products ....................... [[32mSUCCESS 1[0m in 0.72s]
[0m01:37:59.720166 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_products
[0m01:37:59.724864 [debug] [Thread-1 (]: Began running node model.crb_kpi.revenue_lost
[0m01:37:59.725752 [info ] [Thread-1 (]: 7 of 10 START sql view model PUBLIC.revenue_lost ............................... [RUN]
[0m01:37:59.725752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_products, now model.crb_kpi.revenue_lost)
[0m01:37:59.730152 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.revenue_lost
[0m01:37:59.735075 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.revenue_lost"
[0m01:37:59.737564 [debug] [Thread-1 (]: Began executing node model.crb_kpi.revenue_lost
[0m01:37:59.742432 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.revenue_lost"
[0m01:37:59.746241 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.revenue_lost"
[0m01:37:59.746241 [debug] [Thread-1 (]: On model.crb_kpi.revenue_lost: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.revenue_lost"} */
create or replace   view CRBFITNESS.PUBLIC.revenue_lost
  
   as (
    SELECT 
    t.payment_month AS period, 
    SUM(t.revenue) AS total_revenue_lost
FROM public.stg_transactions t
WHERE t.customer_id IN (
    SELECT customer_id 
    FROM public.stg_transactions 
    GROUP BY customer_id 
    HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
)
GROUP BY t.payment_month
ORDER BY t.payment_month
  );
[0m01:38:00.331925 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.588 seconds
[0m01:38:00.339947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63858357-b4fd-49e2-bdc3-19b8652da067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002715B1DB410>]}
[0m01:38:00.342463 [info ] [Thread-1 (]: 7 of 10 OK created sql view model PUBLIC.revenue_lost .......................... [[32mSUCCESS 1[0m in 0.61s]
[0m01:38:00.345063 [debug] [Thread-1 (]: Finished running node model.crb_kpi.revenue_lost
[0m01:38:00.345063 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m01:38:00.345063 [info ] [Thread-1 (]: 8 of 10 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m01:38:00.350078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.revenue_lost, now model.crb_kpi.stg_customers)
[0m01:38:00.350078 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m01:38:00.354295 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m01:38:00.356326 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m01:38:00.362022 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m01:38:00.364881 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m01:38:00.364881 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean
FROM raw
  );
[0m01:38:00.868615 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.502 seconds
[0m01:38:00.874522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63858357-b4fd-49e2-bdc3-19b8652da067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002715A5D5050>]}
[0m01:38:00.876448 [info ] [Thread-1 (]: 8 of 10 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 0.52s]
[0m01:38:00.877624 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m01:38:00.879713 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m01:38:00.880288 [info ] [Thread-1 (]: 9 of 10 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m01:38:00.882451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m01:38:00.882451 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m01:38:00.887943 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m01:38:00.890048 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m01:38:00.899768 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m01:38:00.899768 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m01:38:00.899768 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM public.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m01:38:01.392275 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.495 seconds
[0m01:38:01.400092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63858357-b4fd-49e2-bdc3-19b8652da067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002715B615190>]}
[0m01:38:01.408555 [info ] [Thread-1 (]: 9 of 10 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 0.52s]
[0m01:38:01.411737 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m01:38:01.411737 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m01:38:01.411737 [info ] [Thread-1 (]: 10 of 10 START sql view model PUBLIC.stg_transactions .......................... [RUN]
[0m01:38:01.411737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m01:38:01.411737 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m01:38:01.422326 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m01:38:01.423885 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m01:38:01.430034 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m01:38:01.431808 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m01:38:01.432851 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m01:38:02.080230 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.652 seconds
[0m01:38:02.090057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63858357-b4fd-49e2-bdc3-19b8652da067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002715B615190>]}
[0m01:38:02.090057 [info ] [Thread-1 (]: 10 of 10 OK created sql view model PUBLIC.stg_transactions ..................... [[32mSUCCESS 1[0m in 0.68s]
[0m01:38:02.096132 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m01:38:02.099023 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:38:02.099023 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m01:38:02.100699 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m01:38:02.729794 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m01:38:02.729794 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m01:38:03.373518 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m01:38:03.373518 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m01:38:03.995421 [info ] [MainThread]: 
[0m01:38:03.999939 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 14.00 seconds (14.00s).
[0m01:38:04.004991 [debug] [MainThread]: Command end result
[0m01:38:04.051158 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:38:04.055904 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:38:04.064917 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m01:38:04.068876 [info ] [MainThread]: 
[0m01:38:04.069888 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:38:04.071525 [info ] [MainThread]: 
[0m01:38:04.073188 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m01:38:04.073188 [debug] [MainThread]: Command `dbt run` succeeded at 01:38:04.073188 after 16.76 seconds
[0m01:38:04.073188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027153CE2E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027153C62C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027153C61FD0>]}
[0m01:38:04.079511 [debug] [MainThread]: Flushing usage events
[0m01:38:05.590434 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:45:18.741926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B718CF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B718D950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B718D390>]}


============================== 01:45:18.758745 | 9a10f374-1c6c-4cc4-86a7-8b2060dd8a9e ==============================
[0m01:45:18.758745 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:45:18.761804 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:45:19.980682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a10f374-1c6c-4cc4-86a7-8b2060dd8a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B7DA3050>]}
[0m01:45:20.148900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a10f374-1c6c-4cc4-86a7-8b2060dd8a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B5B6D350>]}
[0m01:45:20.152746 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:45:21.138547 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:45:21.610355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:45:21.618993 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\new_logos.sql
[0m01:45:21.618993 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\net_nrr_grr.sql
[0m01:45:22.243303 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m01:45:22.259867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a10f374-1c6c-4cc4-86a7-8b2060dd8a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B84F8CD0>]}
[0m01:45:22.458674 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:45:22.475221 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:45:22.568560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a10f374-1c6c-4cc4-86a7-8b2060dd8a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B89B8090>]}
[0m01:45:22.568560 [info ] [MainThread]: Found 10 models, 474 macros
[0m01:45:22.568560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a10f374-1c6c-4cc4-86a7-8b2060dd8a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B8967850>]}
[0m01:45:22.573534 [info ] [MainThread]: 
[0m01:45:22.573534 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:45:22.581674 [info ] [MainThread]: 
[0m01:45:22.581674 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:45:22.598990 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m01:45:22.916688 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m01:45:22.918842 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m01:45:22.918842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:45:25.695639 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.776 seconds
[0m01:45:25.703903 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m01:45:25.738964 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m01:45:25.738964 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m01:45:25.738964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:45:27.718733 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.976 seconds
[0m01:45:27.731988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a10f374-1c6c-4cc4-86a7-8b2060dd8a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B7DEAC50>]}
[0m01:45:27.740193 [debug] [Thread-1 (]: Began running node model.crb_kpi.churned_new_customers
[0m01:45:27.748863 [info ] [Thread-1 (]: 1 of 10 START sql view model PUBLIC.churned_new_customers ...................... [RUN]
[0m01:45:27.748863 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.churned_new_customers'
[0m01:45:27.748863 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.churned_new_customers
[0m01:45:27.783207 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.churned_new_customers"
[0m01:45:27.788818 [debug] [Thread-1 (]: Began executing node model.crb_kpi.churned_new_customers
[0m01:45:27.871378 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.churned_new_customers"
[0m01:45:27.879585 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.churned_new_customers"
[0m01:45:27.885460 [debug] [Thread-1 (]: On model.crb_kpi.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.churned_new_customers"} */
create or replace   view CRBFITNESS.PUBLIC.churned_new_customers
  
   as (
    SELECT 
    customer_id, 
    'new' AS customer_status, 
    MIN(payment_month) AS first_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MIN(payment_month) IS NOT NULL

UNION ALL

SELECT 
    customer_id, 
    'churned' AS customer_status, 
    MAX(payment_month) AS last_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
  );
[0m01:45:27.888602 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:45:29.971631 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.085 seconds
[0m01:45:30.038724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a10f374-1c6c-4cc4-86a7-8b2060dd8a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B88C7010>]}
[0m01:45:30.038724 [info ] [Thread-1 (]: 1 of 10 OK created sql view model PUBLIC.churned_new_customers ................. [[32mSUCCESS 1[0m in 2.28s]
[0m01:45:30.038724 [debug] [Thread-1 (]: Finished running node model.crb_kpi.churned_new_customers
[0m01:45:30.046437 [debug] [Thread-1 (]: Began running node model.crb_kpi.cross_sell_product_churn
[0m01:45:30.048568 [info ] [Thread-1 (]: 2 of 10 START sql view model PUBLIC.cross_sell_product_churn ................... [RUN]
[0m01:45:30.053326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.churned_new_customers, now model.crb_kpi.cross_sell_product_churn)
[0m01:45:30.054843 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.cross_sell_product_churn
[0m01:45:30.071163 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.cross_sell_product_churn"
[0m01:45:30.071163 [debug] [Thread-1 (]: Began executing node model.crb_kpi.cross_sell_product_churn
[0m01:45:30.079708 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.cross_sell_product_churn"
[0m01:45:30.086987 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.cross_sell_product_churn"
[0m01:45:30.088511 [debug] [Thread-1 (]: On model.crb_kpi.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.cross_sell_product_churn"} */
create or replace   view CRBFITNESS.PUBLIC.cross_sell_product_churn
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    p.product_family_clean, 
    COUNT(DISTINCT p.product_family_clean) AS cross_sell_count
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
ORDER BY cross_sell_count DESC
LIMIT 10
  );
[0m01:45:30.875020 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.786 seconds
[0m01:45:30.884266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a10f374-1c6c-4cc4-86a7-8b2060dd8a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B809DC90>]}
[0m01:45:30.884266 [info ] [Thread-1 (]: 2 of 10 OK created sql view model PUBLIC.cross_sell_product_churn .............. [[32mSUCCESS 1[0m in 0.84s]
[0m01:45:30.891630 [debug] [Thread-1 (]: Finished running node model.crb_kpi.cross_sell_product_churn
[0m01:45:30.891630 [debug] [Thread-1 (]: Began running node model.crb_kpi.net_nrr_grr
[0m01:45:30.891630 [info ] [Thread-1 (]: 3 of 10 START sql view model PUBLIC.net_nrr_grr ................................ [RUN]
[0m01:45:30.900534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.cross_sell_product_churn, now model.crb_kpi.net_nrr_grr)
[0m01:45:30.900534 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.net_nrr_grr
[0m01:45:30.913977 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.net_nrr_grr"
[0m01:45:30.925387 [debug] [Thread-1 (]: Began executing node model.crb_kpi.net_nrr_grr
[0m01:45:30.941108 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.net_nrr_grr"
[0m01:45:30.951126 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.net_nrr_grr"
[0m01:45:30.951126 [debug] [Thread-1 (]: On model.crb_kpi.net_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.net_nrr_grr"} */
create or replace   view CRBFITNESS.PUBLIC.net_nrr_grr
  
   as (
    SELECT 
    SUM(CASE WHEN TRY_TO_DATE(t.payment_month::VARCHAR, 'DD-MM-YYYY') >= DATEADD(YEAR, -1, CURRENT_DATE) 
             THEN t.revenue ELSE 0 END) AS current_revenue,
    
    SUM(CASE WHEN TRY_TO_DATE(t.payment_month::VARCHAR, 'DD-MM-YYYY') < DATEADD(YEAR, -1, CURRENT_DATE) 
             THEN t.revenue ELSE 0 END) AS previous_revenue,

    (SUM(CASE WHEN TRY_TO_DATE(t.payment_month::VARCHAR, 'DD-MM-YYYY') >= DATEADD(YEAR, -1, CURRENT_DATE) 
              THEN t.revenue ELSE 0 END) * 1.0 / 
     NULLIF(SUM(CASE WHEN TRY_TO_DATE(t.payment_month::VARCHAR, 'DD-MM-YYYY') < DATEADD(YEAR, -1, CURRENT_DATE) 
                     THEN t.revenue ELSE 0 END), 0)) AS NRR,

    (SUM(CASE WHEN TRY_TO_DATE(t.payment_month::VARCHAR, 'DD-MM-YYYY') >= DATEADD(YEAR, -1, CURRENT_DATE) 
              THEN t.revenue ELSE 0 END) * 1.0 / 
     NULLIF(SUM(CASE WHEN TRY_TO_DATE(t.payment_month::VARCHAR, 'DD-MM-YYYY') >= DATEADD(YEAR, -1, CURRENT_DATE) 
                     THEN t.revenue ELSE 0 END), 0)) AS GRR
     
FROM public.stg_transactions t;
[0m01:45:31.400945 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb025f-0004-c178-0005-db4b0001940e
[0m01:45:31.400945 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 21 at position 30 unexpected ';'.
[0m01:45:31.419087 [debug] [Thread-1 (]: Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 30 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql
[0m01:45:31.419087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a10f374-1c6c-4cc4-86a7-8b2060dd8a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B90A77D0>]}
[0m01:45:31.419087 [error] [Thread-1 (]: 3 of 10 ERROR creating sql view model PUBLIC.net_nrr_grr ....................... [[31mERROR[0m in 0.52s]
[0m01:45:31.424963 [debug] [Thread-1 (]: Finished running node model.crb_kpi.net_nrr_grr
[0m01:45:31.424963 [debug] [Thread-1 (]: Began running node model.crb_kpi.new_logos
[0m01:45:31.428542 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.net_nrr_grr' to be skipped because of status 'error'.  Reason: Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 30 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql.
[0m01:45:31.433578 [info ] [Thread-1 (]: 4 of 10 START sql view model PUBLIC.new_logos .................................. [RUN]
[0m01:45:31.438608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.net_nrr_grr, now model.crb_kpi.new_logos)
[0m01:45:31.441680 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.new_logos
[0m01:45:31.448779 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.new_logos"
[0m01:45:31.449908 [debug] [Thread-1 (]: Began executing node model.crb_kpi.new_logos
[0m01:45:31.468937 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.new_logos"
[0m01:45:31.475218 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.new_logos"
[0m01:45:31.478811 [debug] [Thread-1 (]: On model.crb_kpi.new_logos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.new_logos"} */
create or replace   view CRBFITNESS.PUBLIC.new_logos
  
   as (
    SELECT 
    t.customer_id, 
    MIN(EXTRACT(YEAR FROM TRY_TO_DATE(t.payment_month::VARCHAR, 'DD-MM-YYYY'))) AS first_fiscal_year
FROM public.stg_transactions t
GROUP BY t.customer_id;
[0m01:45:31.851198 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb025f-0004-c144-0005-db4b000184fa
[0m01:45:31.851198 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 22 unexpected ';'.
[0m01:45:31.862507 [debug] [Thread-1 (]: Database Error in model new_logos (models\marts\new_logos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 22 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\new_logos.sql
[0m01:45:31.862507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a10f374-1c6c-4cc4-86a7-8b2060dd8a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B94AE290>]}
[0m01:45:31.868560 [error] [Thread-1 (]: 4 of 10 ERROR creating sql view model PUBLIC.new_logos ......................... [[31mERROR[0m in 0.42s]
[0m01:45:31.868560 [debug] [Thread-1 (]: Finished running node model.crb_kpi.new_logos
[0m01:45:31.868560 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_customers
[0m01:45:31.876412 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.new_logos' to be skipped because of status 'error'.  Reason: Database Error in model new_logos (models\marts\new_logos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 22 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\new_logos.sql.
[0m01:45:31.878545 [info ] [Thread-1 (]: 5 of 10 START sql view model PUBLIC.ranked_customers ........................... [RUN]
[0m01:45:31.884599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.new_logos, now model.crb_kpi.ranked_customers)
[0m01:45:31.888727 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_customers
[0m01:45:31.892772 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_customers"
[0m01:45:31.898895 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_customers
[0m01:45:31.908882 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_customers"
[0m01:45:31.920205 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_customers"
[0m01:45:31.923839 [debug] [Thread-1 (]: On model.crb_kpi.ranked_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_customers"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_customers
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
GROUP BY t.customer_id, c.customer_name_clean
ORDER BY total_revenue DESC
  );
[0m01:45:32.548667 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.630 seconds
[0m01:45:32.558952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a10f374-1c6c-4cc4-86a7-8b2060dd8a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B9109FD0>]}
[0m01:45:32.564991 [info ] [Thread-1 (]: 5 of 10 OK created sql view model PUBLIC.ranked_customers ...................... [[32mSUCCESS 1[0m in 0.67s]
[0m01:45:32.568711 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_customers
[0m01:45:32.568711 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_products
[0m01:45:32.573247 [info ] [Thread-1 (]: 6 of 10 START sql view model PUBLIC.ranked_products ............................ [RUN]
[0m01:45:32.573247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_customers, now model.crb_kpi.ranked_products)
[0m01:45:32.578769 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_products
[0m01:45:32.581336 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_products"
[0m01:45:32.589528 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_products
[0m01:45:32.599761 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_products"
[0m01:45:32.608741 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_products"
[0m01:45:32.608741 [debug] [Thread-1 (]: On model.crb_kpi.ranked_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_products"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_products
  
   as (
    SELECT 
    p.product_family_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY p.product_family_clean
ORDER BY total_revenue DESC
  );
[0m01:45:33.123968 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.511 seconds
[0m01:45:33.130586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a10f374-1c6c-4cc4-86a7-8b2060dd8a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B9104810>]}
[0m01:45:33.130586 [info ] [Thread-1 (]: 6 of 10 OK created sql view model PUBLIC.ranked_products ....................... [[32mSUCCESS 1[0m in 0.56s]
[0m01:45:33.138691 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_products
[0m01:45:33.138691 [debug] [Thread-1 (]: Began running node model.crb_kpi.revenue_lost
[0m01:45:33.142828 [info ] [Thread-1 (]: 7 of 10 START sql view model PUBLIC.revenue_lost ............................... [RUN]
[0m01:45:33.146858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_products, now model.crb_kpi.revenue_lost)
[0m01:45:33.148884 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.revenue_lost
[0m01:45:33.155071 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.revenue_lost"
[0m01:45:33.163172 [debug] [Thread-1 (]: Began executing node model.crb_kpi.revenue_lost
[0m01:45:33.171305 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.revenue_lost"
[0m01:45:33.171305 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.revenue_lost"
[0m01:45:33.178975 [debug] [Thread-1 (]: On model.crb_kpi.revenue_lost: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.revenue_lost"} */
create or replace   view CRBFITNESS.PUBLIC.revenue_lost
  
   as (
    SELECT 
    t.payment_month AS period, 
    SUM(t.revenue) AS total_revenue_lost
FROM public.stg_transactions t
WHERE t.customer_id IN (
    SELECT customer_id 
    FROM public.stg_transactions 
    GROUP BY customer_id 
    HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
)
GROUP BY t.payment_month
ORDER BY t.payment_month
  );
[0m01:45:33.751483 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.571 seconds
[0m01:45:33.759636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a10f374-1c6c-4cc4-86a7-8b2060dd8a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B95AA4D0>]}
[0m01:45:33.759636 [info ] [Thread-1 (]: 7 of 10 OK created sql view model PUBLIC.revenue_lost .......................... [[32mSUCCESS 1[0m in 0.62s]
[0m01:45:33.766325 [debug] [Thread-1 (]: Finished running node model.crb_kpi.revenue_lost
[0m01:45:33.767873 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m01:45:33.769052 [info ] [Thread-1 (]: 8 of 10 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m01:45:33.772869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.revenue_lost, now model.crb_kpi.stg_customers)
[0m01:45:33.776429 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m01:45:33.784717 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m01:45:33.788736 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m01:45:33.798856 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m01:45:33.801689 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m01:45:33.808888 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean
FROM raw
  );
[0m01:45:34.328667 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.521 seconds
[0m01:45:34.338598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a10f374-1c6c-4cc4-86a7-8b2060dd8a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B95BBFD0>]}
[0m01:45:34.338598 [info ] [Thread-1 (]: 8 of 10 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 0.57s]
[0m01:45:34.338598 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m01:45:34.345315 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m01:45:34.348847 [info ] [Thread-1 (]: 9 of 10 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m01:45:34.348847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m01:45:34.353620 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m01:45:34.361745 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m01:45:34.370008 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m01:45:34.378755 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m01:45:34.388971 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m01:45:34.388971 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM public.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m01:45:34.898592 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.510 seconds
[0m01:45:34.910888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a10f374-1c6c-4cc4-86a7-8b2060dd8a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B95DCDD0>]}
[0m01:45:34.910888 [info ] [Thread-1 (]: 9 of 10 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 0.56s]
[0m01:45:34.910888 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m01:45:34.918588 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m01:45:34.918588 [info ] [Thread-1 (]: 10 of 10 START sql view model PUBLIC.stg_transactions .......................... [RUN]
[0m01:45:34.925017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m01:45:34.926769 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m01:45:34.936421 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m01:45:34.939433 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m01:45:34.948554 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m01:45:34.952511 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m01:45:34.952511 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m01:45:35.568859 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.612 seconds
[0m01:45:35.575007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a10f374-1c6c-4cc4-86a7-8b2060dd8a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B95B3850>]}
[0m01:45:35.578602 [info ] [Thread-1 (]: 10 of 10 OK created sql view model PUBLIC.stg_transactions ..................... [[32mSUCCESS 1[0m in 0.65s]
[0m01:45:35.583336 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m01:45:35.588358 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:45:35.591433 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m01:45:35.595339 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m01:45:36.218670 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m01:45:36.221240 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m01:45:36.871464 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m01:45:36.878641 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m01:45:37.508871 [info ] [MainThread]: 
[0m01:45:37.511883 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 14.93 seconds (14.93s).
[0m01:45:37.519977 [debug] [MainThread]: Command end result
[0m01:45:37.569461 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:45:37.573478 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:45:37.593868 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m01:45:37.598390 [info ] [MainThread]: 
[0m01:45:37.598390 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m01:45:37.601966 [info ] [MainThread]: 
[0m01:45:37.606040 [error] [MainThread]:   Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 30 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql
[0m01:45:37.608669 [info ] [MainThread]: 
[0m01:45:37.610215 [error] [MainThread]:   Database Error in model new_logos (models\marts\new_logos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 22 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\new_logos.sql
[0m01:45:37.619000 [info ] [MainThread]: 
[0m01:45:37.619000 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
[0m01:45:37.628658 [debug] [MainThread]: Command `dbt run` failed at 01:45:37.628658 after 19.11 seconds
[0m01:45:37.628658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B6FAEE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B6FAF010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B1C62D10>]}
[0m01:45:37.635120 [debug] [MainThread]: Flushing usage events
[0m01:45:39.073530 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:45:59.039589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012671A8C990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012671A8DDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012671A8DB90>]}


============================== 01:45:59.058813 | 9c90a485-43c5-493a-b790-23a433a6f098 ==============================
[0m01:45:59.058813 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:45:59.065489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:46:00.284454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c90a485-43c5-493a-b790-23a433a6f098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012671A86F10>]}
[0m01:46:00.489724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c90a485-43c5-493a-b790-23a433a6f098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012670469590>]}
[0m01:46:00.489724 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:46:01.742830 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:46:02.149611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:46:02.149611 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\new_logos.sql
[0m01:46:02.149611 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\net_nrr_grr.sql
[0m01:46:02.845229 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m01:46:02.869950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c90a485-43c5-493a-b790-23a433a6f098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012672E2DC50>]}
[0m01:46:03.048732 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:46:03.058924 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:46:03.118801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c90a485-43c5-493a-b790-23a433a6f098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012673163F90>]}
[0m01:46:03.123822 [info ] [MainThread]: Found 10 models, 474 macros
[0m01:46:03.123822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c90a485-43c5-493a-b790-23a433a6f098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012672674210>]}
[0m01:46:03.132255 [info ] [MainThread]: 
[0m01:46:03.138799 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:46:03.140382 [info ] [MainThread]: 
[0m01:46:03.148468 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:46:03.168426 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m01:46:03.491594 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m01:46:03.491594 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m01:46:03.491594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:46:05.718792 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.221 seconds
[0m01:46:05.728680 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m01:46:05.758394 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m01:46:05.758394 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m01:46:05.758394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:46:07.511649 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.750 seconds
[0m01:46:07.519886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c90a485-43c5-493a-b790-23a433a6f098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012672FB5810>]}
[0m01:46:07.536583 [debug] [Thread-1 (]: Began running node model.crb_kpi.churned_new_customers
[0m01:46:07.538602 [info ] [Thread-1 (]: 1 of 10 START sql view model PUBLIC.churned_new_customers ...................... [RUN]
[0m01:46:07.538602 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.churned_new_customers'
[0m01:46:07.538602 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.churned_new_customers
[0m01:46:07.553383 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.churned_new_customers"
[0m01:46:07.558513 [debug] [Thread-1 (]: Began executing node model.crb_kpi.churned_new_customers
[0m01:46:07.638804 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.churned_new_customers"
[0m01:46:07.643088 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.churned_new_customers"
[0m01:46:07.643088 [debug] [Thread-1 (]: On model.crb_kpi.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.churned_new_customers"} */
create or replace   view CRBFITNESS.PUBLIC.churned_new_customers
  
   as (
    SELECT 
    customer_id, 
    'new' AS customer_status, 
    MIN(payment_month) AS first_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MIN(payment_month) IS NOT NULL

UNION ALL

SELECT 
    customer_id, 
    'churned' AS customer_status, 
    MAX(payment_month) AS last_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
  );
[0m01:46:07.643088 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:46:09.646951 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.999 seconds
[0m01:46:09.736747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c90a485-43c5-493a-b790-23a433a6f098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000126727A0650>]}
[0m01:46:09.738955 [info ] [Thread-1 (]: 1 of 10 OK created sql view model PUBLIC.churned_new_customers ................. [[32mSUCCESS 1[0m in 2.18s]
[0m01:46:09.744997 [debug] [Thread-1 (]: Finished running node model.crb_kpi.churned_new_customers
[0m01:46:09.748585 [debug] [Thread-1 (]: Began running node model.crb_kpi.cross_sell_product_churn
[0m01:46:09.751032 [info ] [Thread-1 (]: 2 of 10 START sql view model PUBLIC.cross_sell_product_churn ................... [RUN]
[0m01:46:09.753058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.churned_new_customers, now model.crb_kpi.cross_sell_product_churn)
[0m01:46:09.758633 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.cross_sell_product_churn
[0m01:46:09.761156 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.cross_sell_product_churn"
[0m01:46:09.768828 [debug] [Thread-1 (]: Began executing node model.crb_kpi.cross_sell_product_churn
[0m01:46:09.790422 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.cross_sell_product_churn"
[0m01:46:09.793463 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.cross_sell_product_churn"
[0m01:46:09.798939 [debug] [Thread-1 (]: On model.crb_kpi.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.cross_sell_product_churn"} */
create or replace   view CRBFITNESS.PUBLIC.cross_sell_product_churn
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    p.product_family_clean, 
    COUNT(DISTINCT p.product_family_clean) AS cross_sell_count
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
ORDER BY cross_sell_count DESC
LIMIT 10
  );
[0m01:46:10.475065 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.673 seconds
[0m01:46:10.478765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c90a485-43c5-493a-b790-23a433a6f098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000126737F1750>]}
[0m01:46:10.483359 [info ] [Thread-1 (]: 2 of 10 OK created sql view model PUBLIC.cross_sell_product_churn .............. [[32mSUCCESS 1[0m in 0.73s]
[0m01:46:10.488472 [debug] [Thread-1 (]: Finished running node model.crb_kpi.cross_sell_product_churn
[0m01:46:10.488472 [debug] [Thread-1 (]: Began running node model.crb_kpi.net_nrr_grr
[0m01:46:10.491489 [info ] [Thread-1 (]: 3 of 10 START sql view model PUBLIC.net_nrr_grr ................................ [RUN]
[0m01:46:10.491489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.cross_sell_product_churn, now model.crb_kpi.net_nrr_grr)
[0m01:46:10.491489 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.net_nrr_grr
[0m01:46:10.499662 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.net_nrr_grr"
[0m01:46:10.508809 [debug] [Thread-1 (]: Began executing node model.crb_kpi.net_nrr_grr
[0m01:46:10.523611 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.net_nrr_grr"
[0m01:46:10.531897 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.net_nrr_grr"
[0m01:46:10.535599 [debug] [Thread-1 (]: On model.crb_kpi.net_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.net_nrr_grr"} */
create or replace   view CRBFITNESS.PUBLIC.net_nrr_grr
  
   as (
    SELECT 
    SUM(CASE WHEN TRY_TO_DATE(t.payment_month::VARCHAR, 'DD-MM-YYYY') >= DATEADD(YEAR, -1, CURRENT_DATE) 
             THEN t.revenue ELSE 0 END) AS current_revenue,
    
    SUM(CASE WHEN TRY_TO_DATE(t.payment_month::VARCHAR, 'DD-MM-YYYY') < DATEADD(YEAR, -1, CURRENT_DATE) 
             THEN t.revenue ELSE 0 END) AS previous_revenue,

    (SUM(CASE WHEN TRY_TO_DATE(t.payment_month::VARCHAR, 'DD-MM-YYYY') >= DATEADD(YEAR, -1, CURRENT_DATE) 
              THEN t.revenue ELSE 0 END) * 1.0 / 
     NULLIF(SUM(CASE WHEN TRY_TO_DATE(t.payment_month::VARCHAR, 'DD-MM-YYYY') < DATEADD(YEAR, -1, CURRENT_DATE) 
                     THEN t.revenue ELSE 0 END), 0)) AS NRR,

    (SUM(CASE WHEN TRY_TO_DATE(t.payment_month::VARCHAR, 'DD-MM-YYYY') >= DATEADD(YEAR, -1, CURRENT_DATE) 
              THEN t.revenue ELSE 0 END) * 1.0 / 
     NULLIF(SUM(CASE WHEN TRY_TO_DATE(t.payment_month::VARCHAR, 'DD-MM-YYYY') >= DATEADD(YEAR, -1, CURRENT_DATE) 
                     THEN t.revenue ELSE 0 END), 0)) AS GRR
     
FROM public.stg_transactions t
  );
[0m01:46:11.198691 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.661 seconds
[0m01:46:11.208532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c90a485-43c5-493a-b790-23a433a6f098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001266D5A0B50>]}
[0m01:46:11.208532 [info ] [Thread-1 (]: 3 of 10 OK created sql view model PUBLIC.net_nrr_grr ........................... [[32mSUCCESS 1[0m in 0.72s]
[0m01:46:11.215826 [debug] [Thread-1 (]: Finished running node model.crb_kpi.net_nrr_grr
[0m01:46:11.218459 [debug] [Thread-1 (]: Began running node model.crb_kpi.new_logos
[0m01:46:11.221486 [info ] [Thread-1 (]: 4 of 10 START sql view model PUBLIC.new_logos .................................. [RUN]
[0m01:46:11.225659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.net_nrr_grr, now model.crb_kpi.new_logos)
[0m01:46:11.226406 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.new_logos
[0m01:46:11.235415 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.new_logos"
[0m01:46:11.238550 [debug] [Thread-1 (]: Began executing node model.crb_kpi.new_logos
[0m01:46:11.253376 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.new_logos"
[0m01:46:11.258586 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.new_logos"
[0m01:46:11.258586 [debug] [Thread-1 (]: On model.crb_kpi.new_logos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.new_logos"} */
create or replace   view CRBFITNESS.PUBLIC.new_logos
  
   as (
    SELECT 
    t.customer_id, 
    MIN(EXTRACT(YEAR FROM TRY_TO_DATE(t.payment_month::VARCHAR, 'DD-MM-YYYY'))) AS first_fiscal_year
FROM public.stg_transactions t
GROUP BY t.customer_id
  );
[0m01:46:11.794862 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.531 seconds
[0m01:46:11.803234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c90a485-43c5-493a-b790-23a433a6f098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012673128390>]}
[0m01:46:11.803234 [info ] [Thread-1 (]: 4 of 10 OK created sql view model PUBLIC.new_logos ............................. [[32mSUCCESS 1[0m in 0.58s]
[0m01:46:11.808760 [debug] [Thread-1 (]: Finished running node model.crb_kpi.new_logos
[0m01:46:11.808760 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_customers
[0m01:46:11.811372 [info ] [Thread-1 (]: 5 of 10 START sql view model PUBLIC.ranked_customers ........................... [RUN]
[0m01:46:11.811372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.new_logos, now model.crb_kpi.ranked_customers)
[0m01:46:11.819491 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_customers
[0m01:46:11.828828 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_customers"
[0m01:46:11.833864 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_customers
[0m01:46:11.843709 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_customers"
[0m01:46:11.853008 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_customers"
[0m01:46:11.853008 [debug] [Thread-1 (]: On model.crb_kpi.ranked_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_customers"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_customers
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
GROUP BY t.customer_id, c.customer_name_clean
ORDER BY total_revenue DESC
  );
[0m01:46:12.458484 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.605 seconds
[0m01:46:12.468580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c90a485-43c5-493a-b790-23a433a6f098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012673AE1C10>]}
[0m01:46:12.471638 [info ] [Thread-1 (]: 5 of 10 OK created sql view model PUBLIC.ranked_customers ...................... [[32mSUCCESS 1[0m in 0.66s]
[0m01:46:12.471638 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_customers
[0m01:46:12.479802 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_products
[0m01:46:12.479802 [info ] [Thread-1 (]: 6 of 10 START sql view model PUBLIC.ranked_products ............................ [RUN]
[0m01:46:12.479802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_customers, now model.crb_kpi.ranked_products)
[0m01:46:12.488563 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_products
[0m01:46:12.488563 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_products"
[0m01:46:12.498768 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_products
[0m01:46:12.513039 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_products"
[0m01:46:12.521192 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_products"
[0m01:46:12.524231 [debug] [Thread-1 (]: On model.crb_kpi.ranked_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_products"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_products
  
   as (
    SELECT 
    p.product_family_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY p.product_family_clean
ORDER BY total_revenue DESC
  );
[0m01:46:13.228583 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.705 seconds
[0m01:46:13.236756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c90a485-43c5-493a-b790-23a433a6f098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012673AE3150>]}
[0m01:46:13.238928 [info ] [Thread-1 (]: 6 of 10 OK created sql view model PUBLIC.ranked_products ....................... [[32mSUCCESS 1[0m in 0.76s]
[0m01:46:13.241460 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_products
[0m01:46:13.241460 [debug] [Thread-1 (]: Began running node model.crb_kpi.revenue_lost
[0m01:46:13.249617 [info ] [Thread-1 (]: 7 of 10 START sql view model PUBLIC.revenue_lost ............................... [RUN]
[0m01:46:13.255081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_products, now model.crb_kpi.revenue_lost)
[0m01:46:13.255081 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.revenue_lost
[0m01:46:13.263731 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.revenue_lost"
[0m01:46:13.269428 [debug] [Thread-1 (]: Began executing node model.crb_kpi.revenue_lost
[0m01:46:13.278768 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.revenue_lost"
[0m01:46:13.283007 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.revenue_lost"
[0m01:46:13.288602 [debug] [Thread-1 (]: On model.crb_kpi.revenue_lost: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.revenue_lost"} */
create or replace   view CRBFITNESS.PUBLIC.revenue_lost
  
   as (
    SELECT 
    t.payment_month AS period, 
    SUM(t.revenue) AS total_revenue_lost
FROM public.stg_transactions t
WHERE t.customer_id IN (
    SELECT customer_id 
    FROM public.stg_transactions 
    GROUP BY customer_id 
    HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
)
GROUP BY t.payment_month
ORDER BY t.payment_month
  );
[0m01:46:13.800662 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.514 seconds
[0m01:46:13.818489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c90a485-43c5-493a-b790-23a433a6f098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012673AE2A10>]}
[0m01:46:13.825036 [info ] [Thread-1 (]: 7 of 10 OK created sql view model PUBLIC.revenue_lost .......................... [[32mSUCCESS 1[0m in 0.56s]
[0m01:46:13.828576 [debug] [Thread-1 (]: Finished running node model.crb_kpi.revenue_lost
[0m01:46:13.828576 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m01:46:13.833097 [info ] [Thread-1 (]: 8 of 10 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m01:46:13.837181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.revenue_lost, now model.crb_kpi.stg_customers)
[0m01:46:13.838761 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m01:46:13.841299 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m01:46:13.849456 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m01:46:13.865757 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m01:46:13.868860 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m01:46:13.874201 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean
FROM raw
  );
[0m01:46:14.425023 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.549 seconds
[0m01:46:14.428775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c90a485-43c5-493a-b790-23a433a6f098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000126737C6B90>]}
[0m01:46:14.433806 [info ] [Thread-1 (]: 8 of 10 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 0.60s]
[0m01:46:14.438769 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m01:46:14.442303 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m01:46:14.442303 [info ] [Thread-1 (]: 9 of 10 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m01:46:14.448398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m01:46:14.450423 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m01:46:14.458902 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m01:46:14.458902 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m01:46:14.468676 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m01:46:14.478709 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m01:46:14.478709 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM public.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m01:46:15.058548 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.577 seconds
[0m01:46:15.065080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c90a485-43c5-493a-b790-23a433a6f098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012672ED4190>]}
[0m01:46:15.068867 [info ] [Thread-1 (]: 9 of 10 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 0.62s]
[0m01:46:15.073166 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m01:46:15.073166 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m01:46:15.078701 [info ] [Thread-1 (]: 10 of 10 START sql view model PUBLIC.stg_transactions .......................... [RUN]
[0m01:46:15.081434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m01:46:15.083924 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m01:46:15.089722 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m01:46:15.089722 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m01:46:15.106631 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m01:46:15.108837 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m01:46:15.115115 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m01:46:15.913243 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.792 seconds
[0m01:46:15.921387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c90a485-43c5-493a-b790-23a433a6f098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012673B1CE90>]}
[0m01:46:15.921387 [info ] [Thread-1 (]: 10 of 10 OK created sql view model PUBLIC.stg_transactions ..................... [[32mSUCCESS 1[0m in 0.84s]
[0m01:46:15.929622 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m01:46:15.938783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:46:15.939390 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m01:46:15.939390 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m01:46:16.589595 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m01:46:16.589595 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m01:46:17.240897 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m01:46:17.240897 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m01:46:17.873520 [info ] [MainThread]: 
[0m01:46:17.878547 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 14.73 seconds (14.73s).
[0m01:46:17.889825 [debug] [MainThread]: Command end result
[0m01:46:17.963201 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:46:17.979629 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:46:17.995763 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m01:46:17.998360 [info ] [MainThread]: 
[0m01:46:17.998360 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:46:18.004274 [info ] [MainThread]: 
[0m01:46:18.008375 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m01:46:18.012399 [debug] [MainThread]: Command `dbt run` succeeded at 01:46:18.012399 after 19.21 seconds
[0m01:46:18.020561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012671AE2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012671AE3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001266C692E10>]}
[0m01:46:18.020561 [debug] [MainThread]: Flushing usage events
[0m01:46:19.458602 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:51:22.997718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193914E3750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193914E2190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193914E1D50>]}


============================== 01:51:23.014184 | 8d97ba4b-0920-4c07-97e4-d13a80045d97 ==============================
[0m01:51:23.014184 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:51:23.014184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:51:24.358721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d97ba4b-0920-4c07-97e4-d13a80045d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193920D4E10>]}
[0m01:51:24.507824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d97ba4b-0920-4c07-97e4-d13a80045d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001939205D6D0>]}
[0m01:51:24.507824 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:51:25.857858 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:51:26.232752 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:51:26.235771 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\net_nrr_grr.sql
[0m01:51:26.237947 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\new_logos.sql
[0m01:51:26.800328 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m01:51:26.808542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d97ba4b-0920-4c07-97e4-d13a80045d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193929CC6D0>]}
[0m01:51:26.987685 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:51:27.004276 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:51:27.077612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d97ba4b-0920-4c07-97e4-d13a80045d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019392A696D0>]}
[0m01:51:27.079140 [info ] [MainThread]: Found 10 models, 474 macros
[0m01:51:27.079140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d97ba4b-0920-4c07-97e4-d13a80045d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019392A43250>]}
[0m01:51:27.096148 [info ] [MainThread]: 
[0m01:51:27.102768 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:51:27.104293 [info ] [MainThread]: 
[0m01:51:27.107891 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:51:27.122436 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m01:51:27.440255 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m01:51:27.440255 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m01:51:27.447769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:51:29.701930 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.254 seconds
[0m01:51:29.710225 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m01:51:29.743250 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m01:51:29.745153 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m01:51:29.745153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:51:31.547911 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.808 seconds
[0m01:51:31.572394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d97ba4b-0920-4c07-97e4-d13a80045d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001938D29D610>]}
[0m01:51:31.588714 [debug] [Thread-1 (]: Began running node model.crb_kpi.churned_new_customers
[0m01:51:31.588714 [info ] [Thread-1 (]: 1 of 10 START sql view model PUBLIC.churned_new_customers ...................... [RUN]
[0m01:51:31.588714 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.churned_new_customers'
[0m01:51:31.588714 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.churned_new_customers
[0m01:51:31.617652 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.churned_new_customers"
[0m01:51:31.621702 [debug] [Thread-1 (]: Began executing node model.crb_kpi.churned_new_customers
[0m01:51:31.720624 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.churned_new_customers"
[0m01:51:31.720624 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.churned_new_customers"
[0m01:51:31.728921 [debug] [Thread-1 (]: On model.crb_kpi.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.churned_new_customers"} */
create or replace   view CRBFITNESS.PUBLIC.churned_new_customers
  
   as (
    SELECT 
    customer_id, 
    'new' AS customer_status, 
    MIN(payment_month) AS first_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MIN(payment_month) IS NOT NULL

UNION ALL

SELECT 
    customer_id, 
    'churned' AS customer_status, 
    MAX(payment_month) AS last_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
  );
[0m01:51:31.737901 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:51:33.690138 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.953 seconds
[0m01:51:33.762438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d97ba4b-0920-4c07-97e4-d13a80045d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019392A174D0>]}
[0m01:51:33.767541 [info ] [Thread-1 (]: 1 of 10 OK created sql view model PUBLIC.churned_new_customers ................. [[32mSUCCESS 1[0m in 2.17s]
[0m01:51:33.774737 [debug] [Thread-1 (]: Finished running node model.crb_kpi.churned_new_customers
[0m01:51:33.778603 [debug] [Thread-1 (]: Began running node model.crb_kpi.cross_sell_product_churn
[0m01:51:33.781258 [info ] [Thread-1 (]: 2 of 10 START sql view model PUBLIC.cross_sell_product_churn ................... [RUN]
[0m01:51:33.787445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.churned_new_customers, now model.crb_kpi.cross_sell_product_churn)
[0m01:51:33.790608 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.cross_sell_product_churn
[0m01:51:33.798538 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.cross_sell_product_churn"
[0m01:51:33.803528 [debug] [Thread-1 (]: Began executing node model.crb_kpi.cross_sell_product_churn
[0m01:51:33.819747 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.cross_sell_product_churn"
[0m01:51:33.819747 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.cross_sell_product_churn"
[0m01:51:33.828567 [debug] [Thread-1 (]: On model.crb_kpi.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.cross_sell_product_churn"} */
create or replace   view CRBFITNESS.PUBLIC.cross_sell_product_churn
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    p.product_family_clean, 
    COUNT(DISTINCT p.product_family_clean) AS cross_sell_count
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
ORDER BY cross_sell_count DESC
LIMIT 10
  );
[0m01:51:34.609514 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.781 seconds
[0m01:51:34.618160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d97ba4b-0920-4c07-97e4-d13a80045d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019393483610>]}
[0m01:51:34.618160 [info ] [Thread-1 (]: 2 of 10 OK created sql view model PUBLIC.cross_sell_product_churn .............. [[32mSUCCESS 1[0m in 0.83s]
[0m01:51:34.629553 [debug] [Thread-1 (]: Finished running node model.crb_kpi.cross_sell_product_churn
[0m01:51:34.631809 [debug] [Thread-1 (]: Began running node model.crb_kpi.net_nrr_grr
[0m01:51:34.633836 [info ] [Thread-1 (]: 3 of 10 START sql view model PUBLIC.net_nrr_grr ................................ [RUN]
[0m01:51:34.637464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.cross_sell_product_churn, now model.crb_kpi.net_nrr_grr)
[0m01:51:34.641845 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.net_nrr_grr
[0m01:51:34.642430 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.net_nrr_grr"
[0m01:51:34.650043 [debug] [Thread-1 (]: Began executing node model.crb_kpi.net_nrr_grr
[0m01:51:34.657679 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.net_nrr_grr"
[0m01:51:34.657679 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.net_nrr_grr"
[0m01:51:34.665727 [debug] [Thread-1 (]: On model.crb_kpi.net_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.net_nrr_grr"} */
create or replace   view CRBFITNESS.PUBLIC.net_nrr_grr
  
   as (
    ALTER SESSION SET TIMESTAMP_INPUT_FORMAT = 'DD-MM-YYYY';
[0m01:51:35.120828 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0265-0004-c0bd-0005-db4b00017592
[0m01:51:35.120828 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 4 unexpected 'ALTER'.
[0m01:51:35.131818 [debug] [Thread-1 (]: Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected 'ALTER'.
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql
[0m01:51:35.134939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d97ba4b-0920-4c07-97e4-d13a80045d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193934B9250>]}
[0m01:51:35.138119 [error] [Thread-1 (]: 3 of 10 ERROR creating sql view model PUBLIC.net_nrr_grr ....................... [[31mERROR[0m in 0.50s]
[0m01:51:35.138119 [debug] [Thread-1 (]: Finished running node model.crb_kpi.net_nrr_grr
[0m01:51:35.143751 [debug] [Thread-1 (]: Began running node model.crb_kpi.new_logos
[0m01:51:35.143751 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.net_nrr_grr' to be skipped because of status 'error'.  Reason: Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected 'ALTER'.
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql.
[0m01:51:35.147401 [info ] [Thread-1 (]: 4 of 10 START sql view model PUBLIC.new_logos .................................. [RUN]
[0m01:51:35.157617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.net_nrr_grr, now model.crb_kpi.new_logos)
[0m01:51:35.157617 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.new_logos
[0m01:51:35.162256 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.new_logos"
[0m01:51:35.170437 [debug] [Thread-1 (]: Began executing node model.crb_kpi.new_logos
[0m01:51:35.178520 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.new_logos"
[0m01:51:35.187770 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.new_logos"
[0m01:51:35.187770 [debug] [Thread-1 (]: On model.crb_kpi.new_logos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.new_logos"} */
create or replace   view CRBFITNESS.PUBLIC.new_logos
  
   as (
    ALTER SESSION SET TIMESTAMP_INPUT_FORMAT = 'DD-MM-YYYY';
[0m01:51:35.601822 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0265-0004-c144-0005-db4b00018536
[0m01:51:35.605392 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 4 unexpected 'ALTER'.
[0m01:51:35.613803 [debug] [Thread-1 (]: Database Error in model new_logos (models\marts\new_logos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected 'ALTER'.
  compiled code at target\run\crb_kpi\models\marts\new_logos.sql
[0m01:51:35.619260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d97ba4b-0920-4c07-97e4-d13a80045d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019393483650>]}
[0m01:51:35.623026 [error] [Thread-1 (]: 4 of 10 ERROR creating sql view model PUBLIC.new_logos ......................... [[31mERROR[0m in 0.46s]
[0m01:51:35.627584 [debug] [Thread-1 (]: Finished running node model.crb_kpi.new_logos
[0m01:51:35.630094 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_customers
[0m01:51:35.630094 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.new_logos' to be skipped because of status 'error'.  Reason: Database Error in model new_logos (models\marts\new_logos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected 'ALTER'.
  compiled code at target\run\crb_kpi\models\marts\new_logos.sql.
[0m01:51:35.630094 [info ] [Thread-1 (]: 5 of 10 START sql view model PUBLIC.ranked_customers ........................... [RUN]
[0m01:51:35.637776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.new_logos, now model.crb_kpi.ranked_customers)
[0m01:51:35.643622 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_customers
[0m01:51:35.647839 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_customers"
[0m01:51:35.657371 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_customers
[0m01:51:35.679015 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_customers"
[0m01:51:35.691636 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_customers"
[0m01:51:35.691636 [debug] [Thread-1 (]: On model.crb_kpi.ranked_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_customers"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_customers
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
GROUP BY t.customer_id, c.customer_name_clean
ORDER BY total_revenue DESC
  );
[0m01:51:36.400718 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.705 seconds
[0m01:51:36.407583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d97ba4b-0920-4c07-97e4-d13a80045d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193935967D0>]}
[0m01:51:36.409016 [info ] [Thread-1 (]: 5 of 10 OK created sql view model PUBLIC.ranked_customers ...................... [[32mSUCCESS 1[0m in 0.77s]
[0m01:51:36.409016 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_customers
[0m01:51:36.416541 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_products
[0m01:51:36.417627 [info ] [Thread-1 (]: 6 of 10 START sql view model PUBLIC.ranked_products ............................ [RUN]
[0m01:51:36.421963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_customers, now model.crb_kpi.ranked_products)
[0m01:51:36.421963 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_products
[0m01:51:36.432659 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_products"
[0m01:51:36.441057 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_products
[0m01:51:36.444227 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_products"
[0m01:51:36.451620 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_products"
[0m01:51:36.451620 [debug] [Thread-1 (]: On model.crb_kpi.ranked_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_products"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_products
  
   as (
    SELECT 
    p.product_family_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY p.product_family_clean
ORDER BY total_revenue DESC
  );
[0m01:51:37.067438 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.611 seconds
[0m01:51:37.080715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d97ba4b-0920-4c07-97e4-d13a80045d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019393595AD0>]}
[0m01:51:37.080715 [info ] [Thread-1 (]: 6 of 10 OK created sql view model PUBLIC.ranked_products ....................... [[32mSUCCESS 1[0m in 0.66s]
[0m01:51:37.091331 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_products
[0m01:51:37.091331 [debug] [Thread-1 (]: Began running node model.crb_kpi.revenue_lost
[0m01:51:37.091331 [info ] [Thread-1 (]: 7 of 10 START sql view model PUBLIC.revenue_lost ............................... [RUN]
[0m01:51:37.099981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_products, now model.crb_kpi.revenue_lost)
[0m01:51:37.099981 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.revenue_lost
[0m01:51:37.107586 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.revenue_lost"
[0m01:51:37.117666 [debug] [Thread-1 (]: Began executing node model.crb_kpi.revenue_lost
[0m01:51:37.132774 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.revenue_lost"
[0m01:51:37.142333 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.revenue_lost"
[0m01:51:37.145326 [debug] [Thread-1 (]: On model.crb_kpi.revenue_lost: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.revenue_lost"} */
create or replace   view CRBFITNESS.PUBLIC.revenue_lost
  
   as (
    SELECT 
    t.payment_month AS period, 
    SUM(t.revenue) AS total_revenue_lost
FROM public.stg_transactions t
WHERE t.customer_id IN (
    SELECT customer_id 
    FROM public.stg_transactions 
    GROUP BY customer_id 
    HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
)
GROUP BY t.payment_month
ORDER BY t.payment_month
  );
[0m01:51:37.772393 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.630 seconds
[0m01:51:37.782313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d97ba4b-0920-4c07-97e4-d13a80045d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193935B5C90>]}
[0m01:51:37.787440 [info ] [Thread-1 (]: 7 of 10 OK created sql view model PUBLIC.revenue_lost .......................... [[32mSUCCESS 1[0m in 0.68s]
[0m01:51:37.791921 [debug] [Thread-1 (]: Finished running node model.crb_kpi.revenue_lost
[0m01:51:37.795690 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m01:51:37.797793 [info ] [Thread-1 (]: 8 of 10 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m01:51:37.804413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.revenue_lost, now model.crb_kpi.stg_customers)
[0m01:51:37.807601 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m01:51:37.814789 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m01:51:37.822377 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m01:51:37.832238 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m01:51:37.838921 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m01:51:37.842481 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean
FROM raw
  );
[0m01:51:38.417370 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.572 seconds
[0m01:51:38.421943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d97ba4b-0920-4c07-97e4-d13a80045d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019393403E90>]}
[0m01:51:38.421943 [info ] [Thread-1 (]: 8 of 10 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 0.62s]
[0m01:51:38.427458 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m01:51:38.430043 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m01:51:38.432827 [info ] [Thread-1 (]: 9 of 10 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m01:51:38.432827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m01:51:38.432827 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m01:51:38.438468 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m01:51:38.438468 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m01:51:38.457620 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m01:51:38.467386 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m01:51:38.467477 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM public.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m01:51:39.077603 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.609 seconds
[0m01:51:39.087570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d97ba4b-0920-4c07-97e4-d13a80045d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019393402750>]}
[0m01:51:39.090589 [info ] [Thread-1 (]: 9 of 10 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 0.65s]
[0m01:51:39.090589 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m01:51:39.090589 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m01:51:39.098775 [info ] [Thread-1 (]: 10 of 10 START sql view model PUBLIC.stg_transactions .......................... [RUN]
[0m01:51:39.100494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m01:51:39.100494 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m01:51:39.107657 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m01:51:39.117314 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m01:51:39.127476 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m01:51:39.135168 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m01:51:39.137776 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m01:51:39.801765 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.661 seconds
[0m01:51:39.807669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d97ba4b-0920-4c07-97e4-d13a80045d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193938008D0>]}
[0m01:51:39.810181 [info ] [Thread-1 (]: 10 of 10 OK created sql view model PUBLIC.stg_transactions ..................... [[32mSUCCESS 1[0m in 0.71s]
[0m01:51:39.810181 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m01:51:39.817821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:51:39.817821 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m01:51:39.817821 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m01:51:40.450415 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m01:51:40.450415 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m01:51:41.130653 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m01:51:41.130653 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m01:51:41.770342 [info ] [MainThread]: 
[0m01:51:41.778517 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 14.66 seconds (14.66s).
[0m01:51:41.778517 [debug] [MainThread]: Command end result
[0m01:51:41.868681 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:51:41.868681 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:51:41.893681 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m01:51:41.897355 [info ] [MainThread]: 
[0m01:51:41.901911 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m01:51:41.901911 [info ] [MainThread]: 
[0m01:51:41.907501 [error] [MainThread]:   Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected 'ALTER'.
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql
[0m01:51:41.910025 [info ] [MainThread]: 
[0m01:51:41.910025 [error] [MainThread]:   Database Error in model new_logos (models\marts\new_logos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected 'ALTER'.
  compiled code at target\run\crb_kpi\models\marts\new_logos.sql
[0m01:51:41.917782 [info ] [MainThread]: 
[0m01:51:41.922775 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
[0m01:51:41.927514 [debug] [MainThread]: Command `dbt run` failed at 01:51:41.927514 after 19.13 seconds
[0m01:51:41.937343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193914EEA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001938C012C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193914C8510>]}
[0m01:51:41.937343 [debug] [MainThread]: Flushing usage events
[0m01:51:43.527750 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:52:55.452235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D4408CC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D4408D7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D4408CA90>]}


============================== 01:52:55.468455 | a7d29eaf-93d8-4b29-a3cc-e7b1d63f3087 ==============================
[0m01:52:55.468455 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:52:55.477189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:52:56.627243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7d29eaf-93d8-4b29-a3cc-e7b1d63f3087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D440B1DD0>]}
[0m01:52:56.740204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7d29eaf-93d8-4b29-a3cc-e7b1d63f3087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D44C5DB50>]}
[0m01:52:56.740204 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:52:57.775694 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:52:58.187675 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:52:58.194011 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\new_logos.sql
[0m01:52:58.194011 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\net_nrr_grr.sql
[0m01:52:58.802989 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m01:52:58.817459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7d29eaf-93d8-4b29-a3cc-e7b1d63f3087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D44CE1610>]}
[0m01:52:58.997209 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:52:59.007519 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:52:59.047515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7d29eaf-93d8-4b29-a3cc-e7b1d63f3087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D45763D90>]}
[0m01:52:59.053871 [info ] [MainThread]: Found 10 models, 474 macros
[0m01:52:59.053871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7d29eaf-93d8-4b29-a3cc-e7b1d63f3087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D455C6A10>]}
[0m01:52:59.057437 [info ] [MainThread]: 
[0m01:52:59.057437 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:52:59.057437 [info ] [MainThread]: 
[0m01:52:59.062373 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:52:59.078913 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m01:52:59.390151 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m01:52:59.390151 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m01:52:59.390151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:53:01.514014 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.119 seconds
[0m01:53:01.522467 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m01:53:01.557540 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m01:53:01.557540 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m01:53:01.557540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:53:03.537526 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.976 seconds
[0m01:53:03.557455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7d29eaf-93d8-4b29-a3cc-e7b1d63f3087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D3FF9D2D0>]}
[0m01:53:03.567302 [debug] [Thread-1 (]: Began running node model.crb_kpi.churned_new_customers
[0m01:53:03.574038 [info ] [Thread-1 (]: 1 of 10 START sql view model PUBLIC.churned_new_customers ...................... [RUN]
[0m01:53:03.577071 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.churned_new_customers'
[0m01:53:03.577071 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.churned_new_customers
[0m01:53:03.590266 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.churned_new_customers"
[0m01:53:03.598399 [debug] [Thread-1 (]: Began executing node model.crb_kpi.churned_new_customers
[0m01:53:03.687134 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.churned_new_customers"
[0m01:53:03.688153 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.churned_new_customers"
[0m01:53:03.688153 [debug] [Thread-1 (]: On model.crb_kpi.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.churned_new_customers"} */
create or replace   view CRBFITNESS.PUBLIC.churned_new_customers
  
   as (
    SELECT 
    customer_id, 
    'new' AS customer_status, 
    MIN(payment_month) AS first_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MIN(payment_month) IS NOT NULL

UNION ALL

SELECT 
    customer_id, 
    'churned' AS customer_status, 
    MAX(payment_month) AS last_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
  );
[0m01:53:03.688153 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:53:05.662911 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.969 seconds
[0m01:53:05.727264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d29eaf-93d8-4b29-a3cc-e7b1d63f3087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D455C7CD0>]}
[0m01:53:05.727264 [info ] [Thread-1 (]: 1 of 10 OK created sql view model PUBLIC.churned_new_customers ................. [[32mSUCCESS 1[0m in 2.15s]
[0m01:53:05.737346 [debug] [Thread-1 (]: Finished running node model.crb_kpi.churned_new_customers
[0m01:53:05.740111 [debug] [Thread-1 (]: Began running node model.crb_kpi.cross_sell_product_churn
[0m01:53:05.743642 [info ] [Thread-1 (]: 2 of 10 START sql view model PUBLIC.cross_sell_product_churn ................... [RUN]
[0m01:53:05.747774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.churned_new_customers, now model.crb_kpi.cross_sell_product_churn)
[0m01:53:05.752081 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.cross_sell_product_churn
[0m01:53:05.757310 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.cross_sell_product_churn"
[0m01:53:05.760357 [debug] [Thread-1 (]: Began executing node model.crb_kpi.cross_sell_product_churn
[0m01:53:05.768574 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.cross_sell_product_churn"
[0m01:53:05.778120 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.cross_sell_product_churn"
[0m01:53:05.782663 [debug] [Thread-1 (]: On model.crb_kpi.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.cross_sell_product_churn"} */
create or replace   view CRBFITNESS.PUBLIC.cross_sell_product_churn
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    p.product_family_clean, 
    COUNT(DISTINCT p.product_family_clean) AS cross_sell_count
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
ORDER BY cross_sell_count DESC
LIMIT 10
  );
[0m01:53:06.550395 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.769 seconds
[0m01:53:06.559398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d29eaf-93d8-4b29-a3cc-e7b1d63f3087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D44C84690>]}
[0m01:53:06.559398 [info ] [Thread-1 (]: 2 of 10 OK created sql view model PUBLIC.cross_sell_product_churn .............. [[32mSUCCESS 1[0m in 0.81s]
[0m01:53:06.567431 [debug] [Thread-1 (]: Finished running node model.crb_kpi.cross_sell_product_churn
[0m01:53:06.567431 [debug] [Thread-1 (]: Began running node model.crb_kpi.net_nrr_grr
[0m01:53:06.575020 [info ] [Thread-1 (]: 3 of 10 START sql view model PUBLIC.net_nrr_grr ................................ [RUN]
[0m01:53:06.577040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.cross_sell_product_churn, now model.crb_kpi.net_nrr_grr)
[0m01:53:06.583136 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.net_nrr_grr
[0m01:53:06.591279 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.net_nrr_grr"
[0m01:53:06.597368 [debug] [Thread-1 (]: Began executing node model.crb_kpi.net_nrr_grr
[0m01:53:06.607361 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.net_nrr_grr"
[0m01:53:06.611498 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.net_nrr_grr"
[0m01:53:06.617188 [debug] [Thread-1 (]: On model.crb_kpi.net_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.net_nrr_grr"} */
create or replace   view CRBFITNESS.PUBLIC.net_nrr_grr
  
   as (
    SELECT 
    SUM(CASE WHEN TO_TIMESTAMP(t.payment_month::VARCHAR) >= DATEADD(YEAR, -1, CURRENT_DATE) 
             THEN t.revenue ELSE 0 END) AS current_revenue,
    
    SUM(CASE WHEN TO_TIMESTAMP(t.payment_month::VARCHAR) < DATEADD(YEAR, -1, CURRENT_DATE) 
             THEN t.revenue ELSE 0 END) AS previous_revenue,

    (SUM(CASE WHEN TO_TIMESTAMP(t.payment_month::VARCHAR) >= DATEADD(YEAR, -1, CURRENT_DATE) 
              THEN t.revenue ELSE 0 END) * 1.0 / 
     NULLIF(SUM(CASE WHEN TO_TIMESTAMP(t.payment_month::VARCHAR) < DATEADD(YEAR, -1, CURRENT_DATE) 
                     THEN t.revenue ELSE 0 END), 0)) AS NRR,

    (SUM(CASE WHEN TO_TIMESTAMP(t.payment_month::VARCHAR) >= DATEADD(YEAR, -1, CURRENT_DATE) 
              THEN t.revenue ELSE 0 END) * 1.0 / 
     NULLIF(SUM(CASE WHEN TO_TIMESTAMP(t.payment_month::VARCHAR) >= DATEADD(YEAR, -1, CURRENT_DATE) 
                     THEN t.revenue ELSE 0 END), 0)) AS GRR
     
FROM public.stg_transactions t
  );
[0m01:53:07.281258 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.662 seconds
[0m01:53:07.289405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d29eaf-93d8-4b29-a3cc-e7b1d63f3087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D45C14A90>]}
[0m01:53:07.297795 [info ] [Thread-1 (]: 3 of 10 OK created sql view model PUBLIC.net_nrr_grr ........................... [[32mSUCCESS 1[0m in 0.71s]
[0m01:53:07.297795 [debug] [Thread-1 (]: Finished running node model.crb_kpi.net_nrr_grr
[0m01:53:07.297795 [debug] [Thread-1 (]: Began running node model.crb_kpi.new_logos
[0m01:53:07.305449 [info ] [Thread-1 (]: 4 of 10 START sql view model PUBLIC.new_logos .................................. [RUN]
[0m01:53:07.307571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.net_nrr_grr, now model.crb_kpi.new_logos)
[0m01:53:07.307571 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.new_logos
[0m01:53:07.313954 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.new_logos"
[0m01:53:07.319210 [debug] [Thread-1 (]: Began executing node model.crb_kpi.new_logos
[0m01:53:07.332098 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.new_logos"
[0m01:53:07.341998 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.new_logos"
[0m01:53:07.343822 [debug] [Thread-1 (]: On model.crb_kpi.new_logos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.new_logos"} */
create or replace   view CRBFITNESS.PUBLIC.new_logos
  
   as (
    SELECT 
    t.customer_id, 
    MIN(EXTRACT(YEAR FROM TO_TIMESTAMP(t.payment_month::VARCHAR))) AS first_fiscal_year
FROM public.stg_transactions t
GROUP BY t.customer_id
  );
[0m01:53:08.000136 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.658 seconds
[0m01:53:08.008344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d29eaf-93d8-4b29-a3cc-e7b1d63f3087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D45EB3F90>]}
[0m01:53:08.008344 [info ] [Thread-1 (]: 4 of 10 OK created sql view model PUBLIC.new_logos ............................. [[32mSUCCESS 1[0m in 0.70s]
[0m01:53:08.017253 [debug] [Thread-1 (]: Finished running node model.crb_kpi.new_logos
[0m01:53:08.017253 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_customers
[0m01:53:08.017253 [info ] [Thread-1 (]: 5 of 10 START sql view model PUBLIC.ranked_customers ........................... [RUN]
[0m01:53:08.027242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.new_logos, now model.crb_kpi.ranked_customers)
[0m01:53:08.027242 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_customers
[0m01:53:08.033448 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_customers"
[0m01:53:08.039278 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_customers
[0m01:53:08.050048 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_customers"
[0m01:53:08.061743 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_customers"
[0m01:53:08.061743 [debug] [Thread-1 (]: On model.crb_kpi.ranked_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_customers"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_customers
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
GROUP BY t.customer_id, c.customer_name_clean
ORDER BY total_revenue DESC
  );
[0m01:53:08.827243 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.766 seconds
[0m01:53:08.837565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d29eaf-93d8-4b29-a3cc-e7b1d63f3087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D45F12FD0>]}
[0m01:53:08.843191 [info ] [Thread-1 (]: 5 of 10 OK created sql view model PUBLIC.ranked_customers ...................... [[32mSUCCESS 1[0m in 0.81s]
[0m01:53:08.847228 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_customers
[0m01:53:08.847228 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_products
[0m01:53:08.851306 [info ] [Thread-1 (]: 6 of 10 START sql view model PUBLIC.ranked_products ............................ [RUN]
[0m01:53:08.851306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_customers, now model.crb_kpi.ranked_products)
[0m01:53:08.857414 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_products
[0m01:53:08.859451 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_products"
[0m01:53:08.867574 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_products
[0m01:53:08.877226 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_products"
[0m01:53:08.883754 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_products"
[0m01:53:08.887379 [debug] [Thread-1 (]: On model.crb_kpi.ranked_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_products"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_products
  
   as (
    SELECT 
    p.product_family_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY p.product_family_clean
ORDER BY total_revenue DESC
  );
[0m01:53:09.480849 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.588 seconds
[0m01:53:09.487379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d29eaf-93d8-4b29-a3cc-e7b1d63f3087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D45C13BD0>]}
[0m01:53:09.490070 [info ] [Thread-1 (]: 6 of 10 OK created sql view model PUBLIC.ranked_products ....................... [[32mSUCCESS 1[0m in 0.63s]
[0m01:53:09.490070 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_products
[0m01:53:09.490070 [debug] [Thread-1 (]: Began running node model.crb_kpi.revenue_lost
[0m01:53:09.490070 [info ] [Thread-1 (]: 7 of 10 START sql view model PUBLIC.revenue_lost ............................... [RUN]
[0m01:53:09.497236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_products, now model.crb_kpi.revenue_lost)
[0m01:53:09.502275 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.revenue_lost
[0m01:53:09.508571 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.revenue_lost"
[0m01:53:09.515129 [debug] [Thread-1 (]: Began executing node model.crb_kpi.revenue_lost
[0m01:53:09.527548 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.revenue_lost"
[0m01:53:09.530072 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.revenue_lost"
[0m01:53:09.530072 [debug] [Thread-1 (]: On model.crb_kpi.revenue_lost: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.revenue_lost"} */
create or replace   view CRBFITNESS.PUBLIC.revenue_lost
  
   as (
    SELECT 
    t.payment_month AS period, 
    SUM(t.revenue) AS total_revenue_lost
FROM public.stg_transactions t
WHERE t.customer_id IN (
    SELECT customer_id 
    FROM public.stg_transactions 
    GROUP BY customer_id 
    HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
)
GROUP BY t.payment_month
ORDER BY t.payment_month
  );
[0m01:53:10.157286 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m01:53:10.160313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d29eaf-93d8-4b29-a3cc-e7b1d63f3087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D45F12C50>]}
[0m01:53:10.168430 [info ] [Thread-1 (]: 7 of 10 OK created sql view model PUBLIC.revenue_lost .......................... [[32mSUCCESS 1[0m in 0.66s]
[0m01:53:10.168430 [debug] [Thread-1 (]: Finished running node model.crb_kpi.revenue_lost
[0m01:53:10.168430 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m01:53:10.176472 [info ] [Thread-1 (]: 8 of 10 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m01:53:10.177505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.revenue_lost, now model.crb_kpi.stg_customers)
[0m01:53:10.177505 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m01:53:10.187157 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m01:53:10.187157 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m01:53:10.207456 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m01:53:10.209490 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m01:53:10.209490 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
)
SELECT 
    customer_id,
    TRIM(LOWER(customername)) AS customer_name_clean
FROM raw
  );
[0m01:53:10.793877 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.578 seconds
[0m01:53:10.802073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d29eaf-93d8-4b29-a3cc-e7b1d63f3087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D454C7B10>]}
[0m01:53:10.802073 [info ] [Thread-1 (]: 8 of 10 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 0.62s]
[0m01:53:10.807219 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m01:53:10.810237 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m01:53:10.810237 [info ] [Thread-1 (]: 9 of 10 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m01:53:10.810237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m01:53:10.818372 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m01:53:10.827282 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m01:53:10.827282 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m01:53:10.843446 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m01:53:10.847686 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m01:53:10.847686 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS (
    SELECT * FROM public.products
)
SELECT 
    product_id,
    TRIM(LOWER(product_family)) AS product_family_clean
FROM raw
  );
[0m01:53:11.370522 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.524 seconds
[0m01:53:11.378617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d29eaf-93d8-4b29-a3cc-e7b1d63f3087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D45EE5E10>]}
[0m01:53:11.387265 [info ] [Thread-1 (]: 9 of 10 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 0.57s]
[0m01:53:11.390184 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m01:53:11.395208 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m01:53:11.397238 [info ] [Thread-1 (]: 10 of 10 START sql view model PUBLIC.stg_transactions .......................... [RUN]
[0m01:53:11.397238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m01:53:11.403237 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m01:53:11.411323 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m01:53:11.411323 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m01:53:11.427437 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m01:53:11.435745 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m01:53:11.437460 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
)
SELECT 
    customer_id,
    product_id,
    CAST(revenue AS FLOAT) AS revenue,
    TO_DATE(payment_month, 'YYYY-MM') AS payment_month  -- Ensure it's a DATE
FROM raw
  );
[0m01:53:12.043496 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.602 seconds
[0m01:53:12.051578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d29eaf-93d8-4b29-a3cc-e7b1d63f3087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D4641EAD0>]}
[0m01:53:12.051578 [info ] [Thread-1 (]: 10 of 10 OK created sql view model PUBLIC.stg_transactions ..................... [[32mSUCCESS 1[0m in 0.65s]
[0m01:53:12.057165 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m01:53:12.059697 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:53:12.059697 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m01:53:12.059697 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m01:53:12.757566 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m01:53:12.757566 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m01:53:13.400345 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m01:53:13.400345 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m01:53:14.018871 [info ] [MainThread]: 
[0m01:53:14.018871 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 14.96 seconds (14.96s).
[0m01:53:14.027536 [debug] [MainThread]: Command end result
[0m01:53:14.107432 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m01:53:14.110532 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m01:53:14.137465 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m01:53:14.137465 [info ] [MainThread]: 
[0m01:53:14.143675 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:53:14.143675 [info ] [MainThread]: 
[0m01:53:14.150476 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m01:53:14.160343 [debug] [MainThread]: Command `dbt run` succeeded at 01:53:14.160343 after 18.92 seconds
[0m01:53:14.160343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D42BAB790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D3EC92E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D3EC12D50>]}
[0m01:53:14.167513 [debug] [MainThread]: Flushing usage events
[0m01:53:15.717036 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:16:32.617230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002716948FE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271694E3790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271694E1AD0>]}


============================== 02:16:32.642330 | b688a6ee-f87c-4f8e-b050-1afdbc232263 ==============================
[0m02:16:32.642330 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:16:32.645881 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:16:34.193626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b688a6ee-f87c-4f8e-b050-1afdbc232263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002716A100310>]}
[0m02:16:34.398586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b688a6ee-f87c-4f8e-b050-1afdbc232263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002716A05DBD0>]}
[0m02:16:34.401573 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:16:35.876690 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:16:36.471558 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m02:16:36.473558 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\net_nrr_grr.sql
[0m02:16:36.475853 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_customers.sql
[0m02:16:36.477847 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_products.sql
[0m02:16:36.479881 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_transactions.sql
[0m02:16:37.265422 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m02:16:37.289496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b688a6ee-f87c-4f8e-b050-1afdbc232263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002716A8B6A10>]}
[0m02:16:37.449219 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m02:16:37.460783 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m02:16:37.537089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b688a6ee-f87c-4f8e-b050-1afdbc232263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002716AB63C90>]}
[0m02:16:37.539100 [info ] [MainThread]: Found 10 models, 474 macros
[0m02:16:37.541090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b688a6ee-f87c-4f8e-b050-1afdbc232263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002716A9AED10>]}
[0m02:16:37.544612 [info ] [MainThread]: 
[0m02:16:37.548655 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:16:37.557230 [info ] [MainThread]: 
[0m02:16:37.563222 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:16:37.575339 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m02:16:38.241540 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m02:16:38.242545 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m02:16:38.245097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:16:41.809079 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.564 seconds
[0m02:16:41.820603 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m02:16:41.845283 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m02:16:41.846282 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m02:16:41.848293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:16:43.873359 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 2.025 seconds
[0m02:16:43.886998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b688a6ee-f87c-4f8e-b050-1afdbc232263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002716A1833D0>]}
[0m02:16:43.917359 [debug] [Thread-1 (]: Began running node model.crb_kpi.churned_new_customers
[0m02:16:43.920359 [info ] [Thread-1 (]: 1 of 10 START sql view model PUBLIC.churned_new_customers ...................... [RUN]
[0m02:16:43.925902 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.churned_new_customers'
[0m02:16:43.927938 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.churned_new_customers
[0m02:16:43.982324 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.churned_new_customers"
[0m02:16:43.991400 [debug] [Thread-1 (]: Began executing node model.crb_kpi.churned_new_customers
[0m02:16:44.074127 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.churned_new_customers"
[0m02:16:44.080169 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.churned_new_customers"
[0m02:16:44.081163 [debug] [Thread-1 (]: On model.crb_kpi.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.churned_new_customers"} */
create or replace   view CRBFITNESS.PUBLIC.churned_new_customers
  
   as (
    SELECT 
    customer_id, 
    'new' AS customer_status, 
    MIN(payment_month) AS first_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MIN(payment_month) IS NOT NULL

UNION ALL

SELECT 
    customer_id, 
    'churned' AS customer_status, 
    MAX(payment_month) AS last_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
  );
[0m02:16:44.083252 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:16:47.275928 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.193 seconds
[0m02:16:47.351056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b688a6ee-f87c-4f8e-b050-1afdbc232263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002716A102F50>]}
[0m02:16:47.353687 [info ] [Thread-1 (]: 1 of 10 OK created sql view model PUBLIC.churned_new_customers ................. [[32mSUCCESS 1[0m in 3.42s]
[0m02:16:47.357648 [debug] [Thread-1 (]: Finished running node model.crb_kpi.churned_new_customers
[0m02:16:47.360954 [debug] [Thread-1 (]: Began running node model.crb_kpi.cross_sell_product_churn
[0m02:16:47.363588 [info ] [Thread-1 (]: 2 of 10 START sql view model PUBLIC.cross_sell_product_churn ................... [RUN]
[0m02:16:47.368547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.churned_new_customers, now model.crb_kpi.cross_sell_product_churn)
[0m02:16:47.371538 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.cross_sell_product_churn
[0m02:16:47.382502 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.cross_sell_product_churn"
[0m02:16:47.388882 [debug] [Thread-1 (]: Began executing node model.crb_kpi.cross_sell_product_churn
[0m02:16:47.408747 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.cross_sell_product_churn"
[0m02:16:47.416303 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.cross_sell_product_churn"
[0m02:16:47.418327 [debug] [Thread-1 (]: On model.crb_kpi.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.cross_sell_product_churn"} */
create or replace   view CRBFITNESS.PUBLIC.cross_sell_product_churn
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    p.product_family_clean, 
    COUNT(DISTINCT p.product_family_clean) AS cross_sell_count
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
ORDER BY cross_sell_count DESC
LIMIT 10
  );
[0m02:16:48.336129 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.916 seconds
[0m02:16:48.344716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b688a6ee-f87c-4f8e-b050-1afdbc232263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002716A131F90>]}
[0m02:16:48.349917 [info ] [Thread-1 (]: 2 of 10 OK created sql view model PUBLIC.cross_sell_product_churn .............. [[32mSUCCESS 1[0m in 0.98s]
[0m02:16:48.353499 [debug] [Thread-1 (]: Finished running node model.crb_kpi.cross_sell_product_churn
[0m02:16:48.356522 [debug] [Thread-1 (]: Began running node model.crb_kpi.net_nrr_grr
[0m02:16:48.359792 [info ] [Thread-1 (]: 3 of 10 START sql view model PUBLIC.net_nrr_grr ................................ [RUN]
[0m02:16:48.363192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.cross_sell_product_churn, now model.crb_kpi.net_nrr_grr)
[0m02:16:48.364738 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.net_nrr_grr
[0m02:16:48.369732 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.net_nrr_grr"
[0m02:16:48.371739 [debug] [Thread-1 (]: Began executing node model.crb_kpi.net_nrr_grr
[0m02:16:48.384914 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.net_nrr_grr"
[0m02:16:48.400606 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.net_nrr_grr"
[0m02:16:48.402602 [debug] [Thread-1 (]: On model.crb_kpi.net_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.net_nrr_grr"} */
create or replace   view CRBFITNESS.PUBLIC.net_nrr_grr
  
   as (
    SELECT 
    t.customer_id, 
    MIN(EXTRACT(YEAR FROM TO_TIMESTAMP(t.payment_month::VARCHAR))) AS first_fiscal_year
FROM public.stg_transactions t
GROUP BY t.customer_id;
[0m02:16:49.023546 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb027e-0004-c0bd-0005-db4b00017602
[0m02:16:49.026537 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 22 unexpected ';'.
[0m02:16:49.037130 [debug] [Thread-1 (]: Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 22 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql
[0m02:16:49.040126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b688a6ee-f87c-4f8e-b050-1afdbc232263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002716B4B8450>]}
[0m02:16:49.043127 [error] [Thread-1 (]: 3 of 10 ERROR creating sql view model PUBLIC.net_nrr_grr ....................... [[31mERROR[0m in 0.68s]
[0m02:16:49.046239 [debug] [Thread-1 (]: Finished running node model.crb_kpi.net_nrr_grr
[0m02:16:49.048252 [debug] [Thread-1 (]: Began running node model.crb_kpi.new_logos
[0m02:16:49.049234 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.net_nrr_grr' to be skipped because of status 'error'.  Reason: Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 22 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql.
[0m02:16:49.051247 [info ] [Thread-1 (]: 4 of 10 START sql view model PUBLIC.new_logos .................................. [RUN]
[0m02:16:49.057527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.net_nrr_grr, now model.crb_kpi.new_logos)
[0m02:16:49.060524 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.new_logos
[0m02:16:49.070876 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.new_logos"
[0m02:16:49.078481 [debug] [Thread-1 (]: Began executing node model.crb_kpi.new_logos
[0m02:16:49.104340 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.new_logos"
[0m02:16:49.117202 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.new_logos"
[0m02:16:49.119234 [debug] [Thread-1 (]: On model.crb_kpi.new_logos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.new_logos"} */
create or replace   view CRBFITNESS.PUBLIC.new_logos
  
   as (
    SELECT 
    t.customer_id, 
    MIN(EXTRACT(YEAR FROM TO_TIMESTAMP(t.payment_month::VARCHAR))) AS first_fiscal_year
FROM public.stg_transactions t
GROUP BY t.customer_id
  );
[0m02:16:49.915649 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.794 seconds
[0m02:16:49.925214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b688a6ee-f87c-4f8e-b050-1afdbc232263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002716B4B47D0>]}
[0m02:16:49.930731 [info ] [Thread-1 (]: 4 of 10 OK created sql view model PUBLIC.new_logos ............................. [[32mSUCCESS 1[0m in 0.87s]
[0m02:16:49.936501 [debug] [Thread-1 (]: Finished running node model.crb_kpi.new_logos
[0m02:16:49.941503 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_customers
[0m02:16:49.946087 [info ] [Thread-1 (]: 5 of 10 START sql view model PUBLIC.ranked_customers ........................... [RUN]
[0m02:16:49.950550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.new_logos, now model.crb_kpi.ranked_customers)
[0m02:16:49.952545 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_customers
[0m02:16:49.962261 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_customers"
[0m02:16:49.965836 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_customers
[0m02:16:49.976533 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_customers"
[0m02:16:49.980510 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_customers"
[0m02:16:49.981504 [debug] [Thread-1 (]: On model.crb_kpi.ranked_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_customers"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_customers
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
GROUP BY t.customer_id, c.customer_name_clean
ORDER BY total_revenue DESC
  );
[0m02:16:50.911954 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.930 seconds
[0m02:16:50.922052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b688a6ee-f87c-4f8e-b050-1afdbc232263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002716B4A96D0>]}
[0m02:16:50.925630 [info ] [Thread-1 (]: 5 of 10 OK created sql view model PUBLIC.ranked_customers ...................... [[32mSUCCESS 1[0m in 0.97s]
[0m02:16:50.930917 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_customers
[0m02:16:50.933550 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_products
[0m02:16:50.937544 [info ] [Thread-1 (]: 6 of 10 START sql view model PUBLIC.ranked_products ............................ [RUN]
[0m02:16:50.942331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_customers, now model.crb_kpi.ranked_products)
[0m02:16:50.946892 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_products
[0m02:16:50.954479 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_products"
[0m02:16:50.958515 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_products
[0m02:16:50.965307 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_products"
[0m02:16:50.969554 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_products"
[0m02:16:50.970908 [debug] [Thread-1 (]: On model.crb_kpi.ranked_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_products"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_products
  
   as (
    SELECT 
    p.product_family_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY p.product_family_clean
ORDER BY total_revenue DESC
  );
[0m02:16:51.954993 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.981 seconds
[0m02:16:51.965616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b688a6ee-f87c-4f8e-b050-1afdbc232263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002716B1CA3D0>]}
[0m02:16:51.970393 [info ] [Thread-1 (]: 6 of 10 OK created sql view model PUBLIC.ranked_products ....................... [[32mSUCCESS 1[0m in 1.02s]
[0m02:16:51.977514 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_products
[0m02:16:51.980517 [debug] [Thread-1 (]: Began running node model.crb_kpi.revenue_lost
[0m02:16:51.985101 [info ] [Thread-1 (]: 7 of 10 START sql view model PUBLIC.revenue_lost ............................... [RUN]
[0m02:16:51.989131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_products, now model.crb_kpi.revenue_lost)
[0m02:16:51.992130 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.revenue_lost
[0m02:16:52.000211 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.revenue_lost"
[0m02:16:52.006104 [debug] [Thread-1 (]: Began executing node model.crb_kpi.revenue_lost
[0m02:16:52.018451 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.revenue_lost"
[0m02:16:52.025152 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.revenue_lost"
[0m02:16:52.028171 [debug] [Thread-1 (]: On model.crb_kpi.revenue_lost: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.revenue_lost"} */
create or replace   view CRBFITNESS.PUBLIC.revenue_lost
  
   as (
    SELECT 
    t.payment_month AS period, 
    SUM(t.revenue) AS total_revenue_lost
FROM public.stg_transactions t
WHERE t.customer_id IN (
    SELECT customer_id 
    FROM public.stg_transactions 
    GROUP BY customer_id 
    HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
)
GROUP BY t.payment_month
ORDER BY t.payment_month
  );
[0m02:16:52.555338 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.524 seconds
[0m02:16:52.564907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b688a6ee-f87c-4f8e-b050-1afdbc232263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002716B4A2AD0>]}
[0m02:16:52.566928 [info ] [Thread-1 (]: 7 of 10 OK created sql view model PUBLIC.revenue_lost .......................... [[32mSUCCESS 1[0m in 0.58s]
[0m02:16:52.569925 [debug] [Thread-1 (]: Finished running node model.crb_kpi.revenue_lost
[0m02:16:52.571928 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m02:16:52.575482 [info ] [Thread-1 (]: 8 of 10 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m02:16:52.577469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.revenue_lost, now model.crb_kpi.stg_customers)
[0m02:16:52.578470 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m02:16:52.583467 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m02:16:52.586015 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m02:16:52.596887 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m02:16:52.603607 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m02:16:52.606458 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
    WHERE customer_id IS NOT NULL  -- Remove rows where customer_id is NULL
      AND customername IS NOT NULL -- Remove rows where customername is NULL
)
SELECT 
    customer_id,
    COALESCE(TRIM(LOWER(customername)), 'Unknown') AS customer_name_clean -- Handle NULLs
FROM raw;
[0m02:16:53.019331 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb027e-0004-c0bd-0005-db4b0001760a
[0m02:16:53.021318 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 8 unexpected ';'.
[0m02:16:53.031055 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql
[0m02:16:53.032063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b688a6ee-f87c-4f8e-b050-1afdbc232263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002716A8507D0>]}
[0m02:16:53.035624 [error] [Thread-1 (]: 8 of 10 ERROR creating sql view model PUBLIC.stg_customers ..................... [[31mERROR[0m in 0.45s]
[0m02:16:53.040644 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m02:16:53.042654 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m02:16:53.045229 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql.
[0m02:16:53.048263 [info ] [Thread-1 (]: 9 of 10 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m02:16:53.053925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m02:16:53.064559 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m02:16:53.075297 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m02:16:53.082325 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m02:16:53.098542 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m02:16:53.101542 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m02:16:53.104047 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS ( 
    SELECT * FROM public.products
    WHERE product_id IS NOT NULL  -- Remove rows where product_id is NULL
      AND product_family IS NOT NULL -- Remove rows where product_family is NULL
)
SELECT 
    product_id,
    COALESCE(TRIM(LOWER(product_family)), 'Unknown') AS product_family_clean -- Handle NULLs
FROM raw;
[0m02:16:53.519139 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb027e-0004-bb9d-0005-db4b0001b016
[0m02:16:53.520159 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 8 unexpected ';'.
[0m02:16:53.528784 [debug] [Thread-1 (]: Database Error in model stg_products (models\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql
[0m02:16:53.530776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b688a6ee-f87c-4f8e-b050-1afdbc232263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002716B5F2010>]}
[0m02:16:53.531771 [error] [Thread-1 (]: 9 of 10 ERROR creating sql view model PUBLIC.stg_products ...................... [[31mERROR[0m in 0.48s]
[0m02:16:53.533285 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m02:16:53.534300 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m02:16:53.535798 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_products (models\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql.
[0m02:16:53.536813 [info ] [Thread-1 (]: 10 of 10 START sql view model PUBLIC.stg_transactions .......................... [RUN]
[0m02:16:53.539817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m02:16:53.540819 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m02:16:53.544353 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m02:16:53.547362 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m02:16:53.551771 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m02:16:53.559347 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m02:16:53.561335 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
    WHERE customer_id IS NOT NULL  -- Remove rows where customer_id is NULL
      AND product_id IS NOT NULL  -- Remove rows where product_id is NULL
      AND revenue IS NOT NULL  -- Remove rows where revenue is NULL
      AND payment_month IS NOT NULL  -- Remove rows where payment_month is NULL
)
SELECT 
    customer_id,
    product_id,
    CAST(COALESCE(revenue, 0) AS FLOAT) AS revenue,  -- Handle NULL revenue
    TO_TIMESTAMP(payment_month, 'DD-YYYY-MM') AS payment_month  -- Convert VARCHAR date
FROM raw;
[0m02:16:53.996426 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb027e-0004-c144-0005-db4b000185ca
[0m02:16:53.996426 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 8 unexpected ';'.
[0m02:16:54.003163 [debug] [Thread-1 (]: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql
[0m02:16:54.004179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b688a6ee-f87c-4f8e-b050-1afdbc232263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002716B5E9BD0>]}
[0m02:16:54.006189 [error] [Thread-1 (]: 10 of 10 ERROR creating sql view model PUBLIC.stg_transactions ................. [[31mERROR[0m in 0.47s]
[0m02:16:54.008899 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m02:16:54.009914 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_transactions' to be skipped because of status 'error'.  Reason: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql.
[0m02:16:54.013152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:16:54.014167 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m02:16:54.015163 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m02:16:54.884597 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m02:16:54.885611 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m02:16:55.858903 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m02:16:55.861043 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m02:16:56.883611 [info ] [MainThread]: 
[0m02:16:56.886647 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 19.32 seconds (19.32s).
[0m02:16:56.891649 [debug] [MainThread]: Command end result
[0m02:16:56.936450 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m02:16:56.944289 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m02:16:56.983075 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m02:16:56.984094 [info ] [MainThread]: 
[0m02:16:57.034359 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m02:16:57.041845 [info ] [MainThread]: 
[0m02:16:57.046420 [error] [MainThread]:   Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 22 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql
[0m02:16:57.054941 [info ] [MainThread]: 
[0m02:16:57.061558 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_customers.sql
[0m02:16:57.064087 [info ] [MainThread]: 
[0m02:16:57.067434 [error] [MainThread]:   Database Error in model stg_products (models\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_products.sql
[0m02:16:57.081365 [info ] [MainThread]: 
[0m02:16:57.113583 [error] [MainThread]:   Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 8 unexpected ';'.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql
[0m02:16:57.121170 [info ] [MainThread]: 
[0m02:16:57.127968 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=4 SKIP=0 TOTAL=10
[0m02:16:57.132413 [debug] [MainThread]: Command `dbt run` failed at 02:16:57.132413 after 24.80 seconds
[0m02:16:57.133927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027164012C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271690AED10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027169188150>]}
[0m02:16:57.134942 [debug] [MainThread]: Flushing usage events
[0m02:16:59.890403 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:19:20.552985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E8C58FB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E8C5C81D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E8C58D990>]}


============================== 02:19:20.562994 | 6fb07137-50c2-4f9d-b79a-1196ab24555c ==============================
[0m02:19:20.562994 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:19:20.573073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:19:21.858853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fb07137-50c2-4f9d-b79a-1196ab24555c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E8C5B1A10>]}
[0m02:19:21.983152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fb07137-50c2-4f9d-b79a-1196ab24555c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E8B4AF0D0>]}
[0m02:19:21.993090 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:19:23.173156 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:19:23.753271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m02:19:23.753271 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_products.sql
[0m02:19:23.753271 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_customers.sql
[0m02:19:23.753271 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_transactions.sql
[0m02:19:24.330999 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m02:19:24.342985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fb07137-50c2-4f9d-b79a-1196ab24555c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E8D400BD0>]}
[0m02:19:24.499013 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m02:19:24.509555 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m02:19:24.589800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fb07137-50c2-4f9d-b79a-1196ab24555c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E8DE63390>]}
[0m02:19:24.591375 [info ] [MainThread]: Found 10 models, 474 macros
[0m02:19:24.593935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fb07137-50c2-4f9d-b79a-1196ab24555c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E8DCB9B90>]}
[0m02:19:24.604536 [info ] [MainThread]: 
[0m02:19:24.607569 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:19:24.609551 [info ] [MainThread]: 
[0m02:19:24.611568 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:19:24.628129 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m02:19:25.083697 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m02:19:25.084731 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m02:19:25.085753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:19:27.361535 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.276 seconds
[0m02:19:27.373136 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m02:19:27.401845 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m02:19:27.404405 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m02:19:27.405445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:19:29.236469 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.831 seconds
[0m02:19:29.251045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fb07137-50c2-4f9d-b79a-1196ab24555c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E8DD1B4D0>]}
[0m02:19:29.266968 [debug] [Thread-1 (]: Began running node model.crb_kpi.churned_new_customers
[0m02:19:29.269962 [info ] [Thread-1 (]: 1 of 10 START sql view model PUBLIC.churned_new_customers ...................... [RUN]
[0m02:19:29.273505 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.churned_new_customers'
[0m02:19:29.276555 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.churned_new_customers
[0m02:19:29.298653 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.churned_new_customers"
[0m02:19:29.300650 [debug] [Thread-1 (]: Began executing node model.crb_kpi.churned_new_customers
[0m02:19:29.395718 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.churned_new_customers"
[0m02:19:29.400716 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.churned_new_customers"
[0m02:19:29.401711 [debug] [Thread-1 (]: On model.crb_kpi.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.churned_new_customers"} */
create or replace   view CRBFITNESS.PUBLIC.churned_new_customers
  
   as (
    SELECT 
    customer_id, 
    'new' AS customer_status, 
    MIN(payment_month) AS first_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MIN(payment_month) IS NOT NULL

UNION ALL

SELECT 
    customer_id, 
    'churned' AS customer_status, 
    MAX(payment_month) AS last_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
  );
[0m02:19:29.401711 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:19:31.369163 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.966 seconds
[0m02:19:31.432027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fb07137-50c2-4f9d-b79a-1196ab24555c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E8D444250>]}
[0m02:19:31.435646 [info ] [Thread-1 (]: 1 of 10 OK created sql view model PUBLIC.churned_new_customers ................. [[32mSUCCESS 1[0m in 2.16s]
[0m02:19:31.439623 [debug] [Thread-1 (]: Finished running node model.crb_kpi.churned_new_customers
[0m02:19:31.441627 [debug] [Thread-1 (]: Began running node model.crb_kpi.cross_sell_product_churn
[0m02:19:31.443328 [info ] [Thread-1 (]: 2 of 10 START sql view model PUBLIC.cross_sell_product_churn ................... [RUN]
[0m02:19:31.446211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.churned_new_customers, now model.crb_kpi.cross_sell_product_churn)
[0m02:19:31.449249 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.cross_sell_product_churn
[0m02:19:31.453841 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.cross_sell_product_churn"
[0m02:19:31.455898 [debug] [Thread-1 (]: Began executing node model.crb_kpi.cross_sell_product_churn
[0m02:19:31.466894 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.cross_sell_product_churn"
[0m02:19:31.471895 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.cross_sell_product_churn"
[0m02:19:31.473485 [debug] [Thread-1 (]: On model.crb_kpi.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.cross_sell_product_churn"} */
create or replace   view CRBFITNESS.PUBLIC.cross_sell_product_churn
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    p.product_family_clean, 
    COUNT(DISTINCT p.product_family_clean) AS cross_sell_count
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
ORDER BY cross_sell_count DESC
LIMIT 10
  );
[0m02:19:32.132257 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.658 seconds
[0m02:19:32.139367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fb07137-50c2-4f9d-b79a-1196ab24555c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E8E4ACF50>]}
[0m02:19:32.142369 [info ] [Thread-1 (]: 2 of 10 OK created sql view model PUBLIC.cross_sell_product_churn .............. [[32mSUCCESS 1[0m in 0.69s]
[0m02:19:32.145798 [debug] [Thread-1 (]: Finished running node model.crb_kpi.cross_sell_product_churn
[0m02:19:32.148802 [debug] [Thread-1 (]: Began running node model.crb_kpi.net_nrr_grr
[0m02:19:32.151790 [info ] [Thread-1 (]: 3 of 10 START sql view model PUBLIC.net_nrr_grr ................................ [RUN]
[0m02:19:32.154341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.cross_sell_product_churn, now model.crb_kpi.net_nrr_grr)
[0m02:19:32.156346 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.net_nrr_grr
[0m02:19:32.161357 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.net_nrr_grr"
[0m02:19:32.164892 [debug] [Thread-1 (]: Began executing node model.crb_kpi.net_nrr_grr
[0m02:19:32.172942 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.net_nrr_grr"
[0m02:19:32.182143 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.net_nrr_grr"
[0m02:19:32.183672 [debug] [Thread-1 (]: On model.crb_kpi.net_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.net_nrr_grr"} */
create or replace   view CRBFITNESS.PUBLIC.net_nrr_grr
  
   as (
    SELECT 
    t.customer_id, 
    MIN(EXTRACT(YEAR FROM TO_TIMESTAMP(t.payment_month::VARCHAR))) AS first_fiscal_year
FROM public.stg_transactions t
GROUP BY t.customer_id;
[0m02:19:32.585778 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0281-0004-c0bd-0005-db4b00017612
[0m02:19:32.586764 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 22 unexpected ';'.
[0m02:19:32.597313 [debug] [Thread-1 (]: Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 22 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql
[0m02:19:32.599355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fb07137-50c2-4f9d-b79a-1196ab24555c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E8E5B51D0>]}
[0m02:19:32.602315 [error] [Thread-1 (]: 3 of 10 ERROR creating sql view model PUBLIC.net_nrr_grr ....................... [[31mERROR[0m in 0.45s]
[0m02:19:32.604421 [debug] [Thread-1 (]: Finished running node model.crb_kpi.net_nrr_grr
[0m02:19:32.606440 [debug] [Thread-1 (]: Began running node model.crb_kpi.new_logos
[0m02:19:32.608445 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.net_nrr_grr' to be skipped because of status 'error'.  Reason: Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 22 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql.
[0m02:19:32.609445 [info ] [Thread-1 (]: 4 of 10 START sql view model PUBLIC.new_logos .................................. [RUN]
[0m02:19:32.615011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.net_nrr_grr, now model.crb_kpi.new_logos)
[0m02:19:32.617031 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.new_logos
[0m02:19:32.622031 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.new_logos"
[0m02:19:32.626608 [debug] [Thread-1 (]: Began executing node model.crb_kpi.new_logos
[0m02:19:32.638300 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.new_logos"
[0m02:19:32.642284 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.new_logos"
[0m02:19:32.643314 [debug] [Thread-1 (]: On model.crb_kpi.new_logos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.new_logos"} */
create or replace   view CRBFITNESS.PUBLIC.new_logos
  
   as (
    SELECT 
    t.customer_id, 
    MIN(EXTRACT(YEAR FROM TO_TIMESTAMP(t.payment_month::VARCHAR))) AS first_fiscal_year
FROM public.stg_transactions t
GROUP BY t.customer_id
  );
[0m02:19:33.172001 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.526 seconds
[0m02:19:33.179178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fb07137-50c2-4f9d-b79a-1196ab24555c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E8E5B3410>]}
[0m02:19:33.182164 [info ] [Thread-1 (]: 4 of 10 OK created sql view model PUBLIC.new_logos ............................. [[32mSUCCESS 1[0m in 0.57s]
[0m02:19:33.185760 [debug] [Thread-1 (]: Finished running node model.crb_kpi.new_logos
[0m02:19:33.186761 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_customers
[0m02:19:33.188735 [info ] [Thread-1 (]: 5 of 10 START sql view model PUBLIC.ranked_customers ........................... [RUN]
[0m02:19:33.192464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.new_logos, now model.crb_kpi.ranked_customers)
[0m02:19:33.194006 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_customers
[0m02:19:33.200016 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_customers"
[0m02:19:33.204623 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_customers
[0m02:19:33.214169 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_customers"
[0m02:19:33.219195 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_customers"
[0m02:19:33.221185 [debug] [Thread-1 (]: On model.crb_kpi.ranked_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_customers"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_customers
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
GROUP BY t.customer_id, c.customer_name_clean
ORDER BY total_revenue DESC
  );
[0m02:19:33.708421 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.485 seconds
[0m02:19:33.716993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fb07137-50c2-4f9d-b79a-1196ab24555c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E8E5AC650>]}
[0m02:19:33.719985 [info ] [Thread-1 (]: 5 of 10 OK created sql view model PUBLIC.ranked_customers ...................... [[32mSUCCESS 1[0m in 0.52s]
[0m02:19:33.724535 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_customers
[0m02:19:33.726571 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_products
[0m02:19:33.729560 [info ] [Thread-1 (]: 6 of 10 START sql view model PUBLIC.ranked_products ............................ [RUN]
[0m02:19:33.734160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_customers, now model.crb_kpi.ranked_products)
[0m02:19:33.736727 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_products
[0m02:19:33.743431 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_products"
[0m02:19:33.748320 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_products
[0m02:19:33.759907 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_products"
[0m02:19:33.767096 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_products"
[0m02:19:33.770104 [debug] [Thread-1 (]: On model.crb_kpi.ranked_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_products"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_products
  
   as (
    SELECT 
    p.product_family_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY p.product_family_clean
ORDER BY total_revenue DESC
  );
[0m02:19:34.308522 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.537 seconds
[0m02:19:34.316119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fb07137-50c2-4f9d-b79a-1196ab24555c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E8D940BD0>]}
[0m02:19:34.319105 [info ] [Thread-1 (]: 6 of 10 OK created sql view model PUBLIC.ranked_products ....................... [[32mSUCCESS 1[0m in 0.58s]
[0m02:19:34.322113 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_products
[0m02:19:34.323116 [debug] [Thread-1 (]: Began running node model.crb_kpi.revenue_lost
[0m02:19:34.325265 [info ] [Thread-1 (]: 7 of 10 START sql view model PUBLIC.revenue_lost ............................... [RUN]
[0m02:19:34.328258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_products, now model.crb_kpi.revenue_lost)
[0m02:19:34.330279 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.revenue_lost
[0m02:19:34.336588 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.revenue_lost"
[0m02:19:34.339418 [debug] [Thread-1 (]: Began executing node model.crb_kpi.revenue_lost
[0m02:19:34.350765 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.revenue_lost"
[0m02:19:34.356334 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.revenue_lost"
[0m02:19:34.358324 [debug] [Thread-1 (]: On model.crb_kpi.revenue_lost: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.revenue_lost"} */
create or replace   view CRBFITNESS.PUBLIC.revenue_lost
  
   as (
    SELECT 
    t.payment_month AS period, 
    SUM(t.revenue) AS total_revenue_lost
FROM public.stg_transactions t
WHERE t.customer_id IN (
    SELECT customer_id 
    FROM public.stg_transactions 
    GROUP BY customer_id 
    HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
)
GROUP BY t.payment_month
ORDER BY t.payment_month
  );
[0m02:19:34.960158 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.599 seconds
[0m02:19:34.967704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fb07137-50c2-4f9d-b79a-1196ab24555c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E8E4AC690>]}
[0m02:19:34.969706 [info ] [Thread-1 (]: 7 of 10 OK created sql view model PUBLIC.revenue_lost .......................... [[32mSUCCESS 1[0m in 0.64s]
[0m02:19:34.973284 [debug] [Thread-1 (]: Finished running node model.crb_kpi.revenue_lost
[0m02:19:34.974234 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m02:19:34.976237 [info ] [Thread-1 (]: 8 of 10 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m02:19:34.979254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.revenue_lost, now model.crb_kpi.stg_customers)
[0m02:19:34.981246 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m02:19:34.986823 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m02:19:34.990831 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m02:19:35.002106 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m02:19:35.007666 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m02:19:35.010681 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
    WHERE customer_id IS NOT NULL  -- Remove rows where customer_id is NULL
      AND customername IS NOT NULL -- Remove rows where customername is NULL
)
SELECT 
    customer_id,
    COALESCE(TRIM(LOWER(customername)), 'Unknown') AS customer_name_clean -- Handle NULLs
FROM raw
  );
[0m02:19:35.640303 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.628 seconds
[0m02:19:35.651825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fb07137-50c2-4f9d-b79a-1196ab24555c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E8E59EB50>]}
[0m02:19:35.654381 [info ] [Thread-1 (]: 8 of 10 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 0.67s]
[0m02:19:35.657384 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m02:19:35.660069 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m02:19:35.662069 [info ] [Thread-1 (]: 9 of 10 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m02:19:35.665482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m02:19:35.667468 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m02:19:35.674040 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m02:19:35.677043 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m02:19:35.690636 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m02:19:35.696164 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m02:19:35.699164 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS ( 
    SELECT * FROM public.products
    WHERE product_id IS NOT NULL  -- Remove rows where product_id is NULL
      AND product_family IS NOT NULL -- Remove rows where product_family is NULL
)
SELECT 
    product_id,
    COALESCE(TRIM(LOWER(product_family)), 'Unknown') AS product_family_clean -- Handle NULLs
FROM raw
  );
[0m02:19:36.180106 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.478 seconds
[0m02:19:36.185665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fb07137-50c2-4f9d-b79a-1196ab24555c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E8EAF2210>]}
[0m02:19:36.187677 [info ] [Thread-1 (]: 9 of 10 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 0.52s]
[0m02:19:36.190668 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m02:19:36.191666 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m02:19:36.194230 [info ] [Thread-1 (]: 10 of 10 START sql view model PUBLIC.stg_transactions .......................... [RUN]
[0m02:19:36.197231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m02:19:36.199235 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m02:19:36.205818 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m02:19:36.208803 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m02:19:36.220376 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m02:19:36.224936 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m02:19:36.226944 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
    WHERE customer_id IS NOT NULL  -- Remove rows where customer_id is NULL
      AND product_id IS NOT NULL  -- Remove rows where product_id is NULL
      AND revenue IS NOT NULL  -- Remove rows where revenue is NULL
      AND payment_month IS NOT NULL  -- Remove rows where payment_month is NULL
)
SELECT 
    customer_id,
    product_id,
    CAST(COALESCE(revenue, 0) AS FLOAT) AS revenue,  -- Handle NULL revenue
    TO_TIMESTAMP(payment_month, 'DD-YYYY-MM') AS payment_month  -- Convert VARCHAR date
FROM raw
  );
[0m02:19:36.717566 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.488 seconds
[0m02:19:36.724120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fb07137-50c2-4f9d-b79a-1196ab24555c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E8EAF06D0>]}
[0m02:19:36.728107 [info ] [Thread-1 (]: 10 of 10 OK created sql view model PUBLIC.stg_transactions ..................... [[32mSUCCESS 1[0m in 0.53s]
[0m02:19:36.732121 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m02:19:36.741985 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:19:36.744532 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m02:19:36.749246 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m02:19:37.373187 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m02:19:37.375579 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m02:19:38.005538 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m02:19:38.006543 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m02:19:38.633064 [info ] [MainThread]: 
[0m02:19:38.635086 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 14.02 seconds (14.02s).
[0m02:19:38.644246 [debug] [MainThread]: Command end result
[0m02:19:38.726203 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m02:19:38.735807 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m02:19:38.758501 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m02:19:38.759506 [info ] [MainThread]: 
[0m02:19:38.761893 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:19:38.764433 [info ] [MainThread]: 
[0m02:19:38.770458 [error] [MainThread]:   Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 22 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql
[0m02:19:38.773998 [info ] [MainThread]: 
[0m02:19:38.777000 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m02:19:38.787684 [debug] [MainThread]: Command `dbt run` failed at 02:19:38.786683 after 18.49 seconds
[0m02:19:38.794236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E87062C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E8C2BBF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E870E2E10>]}
[0m02:19:38.796256 [debug] [MainThread]: Flushing usage events
[0m02:19:40.356744 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:24:59.446336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF18488510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF184E23D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF184E26D0>]}


============================== 02:24:59.463596 | 7ac6f9ae-7815-48d9-ad56-49311fd95294 ==============================
[0m02:24:59.463596 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:24:59.465591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:25:00.363598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ac6f9ae-7815-48d9-ad56-49311fd95294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF16F29350>]}
[0m02:25:00.462343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ac6f9ae-7815-48d9-ad56-49311fd95294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF1905D950>]}
[0m02:25:00.465258 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:25:01.244522 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:25:01.548724 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m02:25:01.550697 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\net_nrr_grr.sql
[0m02:25:01.552212 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\new_logos.sql
[0m02:25:01.937642 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m02:25:01.955910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ac6f9ae-7815-48d9-ad56-49311fd95294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF190F9F10>]}
[0m02:25:02.131114 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m02:25:02.142001 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m02:25:02.208258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ac6f9ae-7815-48d9-ad56-49311fd95294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF19B61650>]}
[0m02:25:02.210232 [info ] [MainThread]: Found 10 models, 474 macros
[0m02:25:02.212768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ac6f9ae-7815-48d9-ad56-49311fd95294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF1851C090>]}
[0m02:25:02.218795 [info ] [MainThread]: 
[0m02:25:02.220774 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:25:02.224165 [info ] [MainThread]: 
[0m02:25:02.229674 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:25:02.256453 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m02:25:02.573106 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m02:25:02.574095 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m02:25:02.576088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:25:04.774477 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.199 seconds
[0m02:25:04.782099 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m02:25:04.804117 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m02:25:04.805118 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m02:25:04.806108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:25:06.597783 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.791 seconds
[0m02:25:06.613713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ac6f9ae-7815-48d9-ad56-49311fd95294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF17BDA110>]}
[0m02:25:06.625410 [debug] [Thread-1 (]: Began running node model.crb_kpi.churned_new_customers
[0m02:25:06.627413 [info ] [Thread-1 (]: 1 of 10 START sql view model PUBLIC.churned_new_customers ...................... [RUN]
[0m02:25:06.630430 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.churned_new_customers'
[0m02:25:06.631999 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.churned_new_customers
[0m02:25:06.649113 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.churned_new_customers"
[0m02:25:06.651120 [debug] [Thread-1 (]: Began executing node model.crb_kpi.churned_new_customers
[0m02:25:06.715752 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.churned_new_customers"
[0m02:25:06.720787 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.churned_new_customers"
[0m02:25:06.722458 [debug] [Thread-1 (]: On model.crb_kpi.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.churned_new_customers"} */
create or replace   view CRBFITNESS.PUBLIC.churned_new_customers
  
   as (
    SELECT 
    customer_id, 
    'new' AS customer_status, 
    MIN(payment_month) AS first_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MIN(payment_month) IS NOT NULL

UNION ALL

SELECT 
    customer_id, 
    'churned' AS customer_status, 
    MAX(payment_month) AS last_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
  );
[0m02:25:06.724365 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:25:08.770962 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.047 seconds
[0m02:25:08.814690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ac6f9ae-7815-48d9-ad56-49311fd95294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF199B6DD0>]}
[0m02:25:08.815706 [info ] [Thread-1 (]: 1 of 10 OK created sql view model PUBLIC.churned_new_customers ................. [[32mSUCCESS 1[0m in 2.18s]
[0m02:25:08.817685 [debug] [Thread-1 (]: Finished running node model.crb_kpi.churned_new_customers
[0m02:25:08.818685 [debug] [Thread-1 (]: Began running node model.crb_kpi.cross_sell_product_churn
[0m02:25:08.819685 [info ] [Thread-1 (]: 2 of 10 START sql view model PUBLIC.cross_sell_product_churn ................... [RUN]
[0m02:25:08.820706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.churned_new_customers, now model.crb_kpi.cross_sell_product_churn)
[0m02:25:08.822073 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.cross_sell_product_churn
[0m02:25:08.825035 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.cross_sell_product_churn"
[0m02:25:08.827025 [debug] [Thread-1 (]: Began executing node model.crb_kpi.cross_sell_product_churn
[0m02:25:08.834154 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.cross_sell_product_churn"
[0m02:25:08.837702 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.cross_sell_product_churn"
[0m02:25:08.838711 [debug] [Thread-1 (]: On model.crb_kpi.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.cross_sell_product_churn"} */
create or replace   view CRBFITNESS.PUBLIC.cross_sell_product_churn
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    p.product_family_clean, 
    COUNT(DISTINCT p.product_family_clean) AS cross_sell_count
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
ORDER BY cross_sell_count DESC
LIMIT 10
  );
[0m02:25:09.480837 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.641 seconds
[0m02:25:09.487381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ac6f9ae-7815-48d9-ad56-49311fd95294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF1A1DC090>]}
[0m02:25:09.489733 [info ] [Thread-1 (]: 2 of 10 OK created sql view model PUBLIC.cross_sell_product_churn .............. [[32mSUCCESS 1[0m in 0.67s]
[0m02:25:09.490749 [debug] [Thread-1 (]: Finished running node model.crb_kpi.cross_sell_product_churn
[0m02:25:09.493288 [debug] [Thread-1 (]: Began running node model.crb_kpi.net_nrr_grr
[0m02:25:09.495289 [info ] [Thread-1 (]: 3 of 10 START sql view model PUBLIC.net_nrr_grr ................................ [RUN]
[0m02:25:09.497293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.cross_sell_product_churn, now model.crb_kpi.net_nrr_grr)
[0m02:25:09.498385 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.net_nrr_grr
[0m02:25:09.504475 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.net_nrr_grr"
[0m02:25:09.508497 [debug] [Thread-1 (]: Began executing node model.crb_kpi.net_nrr_grr
[0m02:25:09.520073 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.net_nrr_grr"
[0m02:25:09.528679 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.net_nrr_grr"
[0m02:25:09.530694 [debug] [Thread-1 (]: On model.crb_kpi.net_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.net_nrr_grr"} */
create or replace   view CRBFITNESS.PUBLIC.net_nrr_grr
  
   as (
    SELECT 
    SUM(CASE 
            WHEN TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') 
                 >= DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END) AS current_revenue,
        
    SUM(CASE 
            WHEN TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') 
                 < DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END) AS previous_revenue,

    (SUM(CASE 
            WHEN TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') 
                 >= DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END) * 1.0 /
     NULLIF(SUM(CASE 
            WHEN TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') 
                 < DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END), 0)) AS NRR,

    (SUM(CASE 
            WHEN TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') 
                 >= DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END) * 1.0 /
     NULLIF(SUM(CASE 
            WHEN TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') 
                 >= DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END), 0)) AS GRR
FROM public.stg_transactions
  );
[0m02:25:10.646259 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.115 seconds
[0m02:25:10.652788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ac6f9ae-7815-48d9-ad56-49311fd95294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF19851A50>]}
[0m02:25:10.653835 [info ] [Thread-1 (]: 3 of 10 OK created sql view model PUBLIC.net_nrr_grr ........................... [[32mSUCCESS 1[0m in 1.16s]
[0m02:25:10.658262 [debug] [Thread-1 (]: Finished running node model.crb_kpi.net_nrr_grr
[0m02:25:10.660263 [debug] [Thread-1 (]: Began running node model.crb_kpi.new_logos
[0m02:25:10.661260 [info ] [Thread-1 (]: 4 of 10 START sql view model PUBLIC.new_logos .................................. [RUN]
[0m02:25:10.664602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.net_nrr_grr, now model.crb_kpi.new_logos)
[0m02:25:10.665612 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.new_logos
[0m02:25:10.672125 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.new_logos"
[0m02:25:10.674151 [debug] [Thread-1 (]: Began executing node model.crb_kpi.new_logos
[0m02:25:10.685389 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.new_logos"
[0m02:25:10.690387 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.new_logos"
[0m02:25:10.692949 [debug] [Thread-1 (]: On model.crb_kpi.new_logos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.new_logos"} */
create or replace   view CRBFITNESS.PUBLIC.new_logos
  
   as (
    SELECT 
    customer_id, 
    MIN(TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM')) AS first_fiscal_year
FROM public.stg_transactions
GROUP BY customer_id
  );
[0m02:25:11.366525 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.672 seconds
[0m02:25:11.373062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ac6f9ae-7815-48d9-ad56-49311fd95294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF1A2E4E90>]}
[0m02:25:11.375075 [info ] [Thread-1 (]: 4 of 10 OK created sql view model PUBLIC.new_logos ............................. [[32mSUCCESS 1[0m in 0.71s]
[0m02:25:11.377077 [debug] [Thread-1 (]: Finished running node model.crb_kpi.new_logos
[0m02:25:11.379518 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_customers
[0m02:25:11.380512 [info ] [Thread-1 (]: 5 of 10 START sql view model PUBLIC.ranked_customers ........................... [RUN]
[0m02:25:11.383052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.new_logos, now model.crb_kpi.ranked_customers)
[0m02:25:11.385056 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_customers
[0m02:25:11.391060 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_customers"
[0m02:25:11.394777 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_customers
[0m02:25:11.404341 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_customers"
[0m02:25:11.409372 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_customers"
[0m02:25:11.410950 [debug] [Thread-1 (]: On model.crb_kpi.ranked_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_customers"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_customers
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
GROUP BY t.customer_id, c.customer_name_clean
ORDER BY total_revenue DESC
  );
[0m02:25:12.049391 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.637 seconds
[0m02:25:12.055708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ac6f9ae-7815-48d9-ad56-49311fd95294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF1A2E7010>]}
[0m02:25:12.057796 [info ] [Thread-1 (]: 5 of 10 OK created sql view model PUBLIC.ranked_customers ...................... [[32mSUCCESS 1[0m in 0.67s]
[0m02:25:12.060964 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_customers
[0m02:25:12.062502 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_products
[0m02:25:12.064520 [info ] [Thread-1 (]: 6 of 10 START sql view model PUBLIC.ranked_products ............................ [RUN]
[0m02:25:12.067523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_customers, now model.crb_kpi.ranked_products)
[0m02:25:12.069518 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_products
[0m02:25:12.076062 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_products"
[0m02:25:12.080065 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_products
[0m02:25:12.088838 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_products"
[0m02:25:12.093374 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_products"
[0m02:25:12.095376 [debug] [Thread-1 (]: On model.crb_kpi.ranked_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_products"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_products
  
   as (
    SELECT 
    p.product_family_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY p.product_family_clean
ORDER BY total_revenue DESC
  );
[0m02:25:12.680837 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.583 seconds
[0m02:25:12.687404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ac6f9ae-7815-48d9-ad56-49311fd95294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF1A2E7010>]}
[0m02:25:12.689398 [info ] [Thread-1 (]: 6 of 10 OK created sql view model PUBLIC.ranked_products ....................... [[32mSUCCESS 1[0m in 0.62s]
[0m02:25:12.691390 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_products
[0m02:25:12.692393 [debug] [Thread-1 (]: Began running node model.crb_kpi.revenue_lost
[0m02:25:12.694806 [info ] [Thread-1 (]: 7 of 10 START sql view model PUBLIC.revenue_lost ............................... [RUN]
[0m02:25:12.696812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_products, now model.crb_kpi.revenue_lost)
[0m02:25:12.698814 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.revenue_lost
[0m02:25:12.704411 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.revenue_lost"
[0m02:25:12.707384 [debug] [Thread-1 (]: Began executing node model.crb_kpi.revenue_lost
[0m02:25:12.714841 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.revenue_lost"
[0m02:25:12.718840 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.revenue_lost"
[0m02:25:12.720840 [debug] [Thread-1 (]: On model.crb_kpi.revenue_lost: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.revenue_lost"} */
create or replace   view CRBFITNESS.PUBLIC.revenue_lost
  
   as (
    SELECT 
    t.payment_month AS period, 
    SUM(t.revenue) AS total_revenue_lost
FROM public.stg_transactions t
WHERE t.customer_id IN (
    SELECT customer_id 
    FROM public.stg_transactions 
    GROUP BY customer_id 
    HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
)
GROUP BY t.payment_month
ORDER BY t.payment_month
  );
[0m02:25:13.259936 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.536 seconds
[0m02:25:13.265448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ac6f9ae-7815-48d9-ad56-49311fd95294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF1A217810>]}
[0m02:25:13.267447 [info ] [Thread-1 (]: 7 of 10 OK created sql view model PUBLIC.revenue_lost .......................... [[32mSUCCESS 1[0m in 0.57s]
[0m02:25:13.270443 [debug] [Thread-1 (]: Finished running node model.crb_kpi.revenue_lost
[0m02:25:13.271958 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m02:25:13.273975 [info ] [Thread-1 (]: 8 of 10 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m02:25:13.276059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.revenue_lost, now model.crb_kpi.stg_customers)
[0m02:25:13.278070 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m02:25:13.284652 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m02:25:13.289675 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m02:25:13.301262 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m02:25:13.305609 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m02:25:13.308022 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
    WHERE customer_id IS NOT NULL  -- Remove rows where customer_id is NULL
      AND customername IS NOT NULL -- Remove rows where customername is NULL
)
SELECT 
    customer_id,
    COALESCE(TRIM(LOWER(customername)), 'Unknown') AS customer_name_clean -- Handle NULLs
FROM raw
  );
[0m02:25:13.778796 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.469 seconds
[0m02:25:13.782392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ac6f9ae-7815-48d9-ad56-49311fd95294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF1A30A910>]}
[0m02:25:13.784346 [info ] [Thread-1 (]: 8 of 10 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 0.51s]
[0m02:25:13.785342 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m02:25:13.787344 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m02:25:13.788342 [info ] [Thread-1 (]: 9 of 10 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m02:25:13.789346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m02:25:13.791350 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m02:25:13.793797 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m02:25:13.796810 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m02:25:13.804467 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m02:25:13.808656 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m02:25:13.810663 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS ( 
    SELECT * FROM public.products
    WHERE product_id IS NOT NULL  -- Remove rows where product_id is NULL
      AND product_family IS NOT NULL -- Remove rows where product_family is NULL
)
SELECT 
    product_id,
    COALESCE(TRIM(LOWER(product_family)), 'Unknown') AS product_family_clean -- Handle NULLs
FROM raw
  );
[0m02:25:14.317187 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.505 seconds
[0m02:25:14.323739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ac6f9ae-7815-48d9-ad56-49311fd95294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF1A821D90>]}
[0m02:25:14.324730 [info ] [Thread-1 (]: 9 of 10 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 0.53s]
[0m02:25:14.327729 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m02:25:14.328736 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m02:25:14.330464 [info ] [Thread-1 (]: 10 of 10 START sql view model PUBLIC.stg_transactions .......................... [RUN]
[0m02:25:14.334000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m02:25:14.335017 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m02:25:14.340784 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m02:25:14.344395 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m02:25:14.353945 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m02:25:14.358946 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m02:25:14.360942 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
    WHERE customer_id IS NOT NULL  -- Remove rows where customer_id is NULL
      AND product_id IS NOT NULL  -- Remove rows where product_id is NULL
      AND revenue IS NOT NULL  -- Remove rows where revenue is NULL
      AND payment_month IS NOT NULL  -- Remove rows where payment_month is NULL
)
SELECT 
    customer_id,
    product_id,
    CAST(COALESCE(revenue, 0) AS FLOAT) AS revenue,  -- Handle NULL revenue
    TO_TIMESTAMP(payment_month, 'DD-YYYY-MM') AS payment_month  -- Convert VARCHAR date
FROM raw
  );
[0m02:25:14.877533 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.514 seconds
[0m02:25:14.883085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ac6f9ae-7815-48d9-ad56-49311fd95294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF1A8233D0>]}
[0m02:25:14.886094 [info ] [Thread-1 (]: 10 of 10 OK created sql view model PUBLIC.stg_transactions ..................... [[32mSUCCESS 1[0m in 0.55s]
[0m02:25:14.889100 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m02:25:14.892095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:25:14.894447 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m02:25:14.896427 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m02:25:15.536804 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m02:25:15.537802 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m02:25:16.173322 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m02:25:16.175343 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m02:25:16.819087 [info ] [MainThread]: 
[0m02:25:16.820091 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 14.59 seconds (14.59s).
[0m02:25:16.828056 [debug] [MainThread]: Command end result
[0m02:25:16.890741 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m02:25:16.897419 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m02:25:16.916441 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m02:25:16.920130 [info ] [MainThread]: 
[0m02:25:16.924411 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:25:16.930041 [info ] [MainThread]: 
[0m02:25:16.933593 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m02:25:16.942853 [debug] [MainThread]: Command `dbt run` succeeded at 02:25:16.942052 after 17.64 seconds
[0m02:25:16.948434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF184ECCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF17FBF750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF17FB7E10>]}
[0m02:25:16.952258 [debug] [MainThread]: Flushing usage events
[0m02:25:18.484770 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:51:57.991821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8ADF8CBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8ADFE3450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8ADF8DB50>]}


============================== 02:51:57.991821 | f5487c75-6bb1-47c5-8d7c-2a601eb482e0 ==============================
[0m02:51:57.991821 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:51:57.991821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m02:51:58.744856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5487c75-6bb1-47c5-8d7c-2a601eb482e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AEE9F850>]}
[0m02:51:58.823290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5487c75-6bb1-47c5-8d7c-2a601eb482e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AC96D310>]}
[0m02:51:58.823290 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:51:59.427247 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:51:59.725480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:51:59.725480 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_transactions.sql
[0m02:52:00.038714 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m02:52:00.040305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5487c75-6bb1-47c5-8d7c-2a601eb482e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AF2D4050>]}
[0m02:52:00.134983 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m02:52:00.140428 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m02:52:00.172120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5487c75-6bb1-47c5-8d7c-2a601eb482e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AF861D50>]}
[0m02:52:00.172120 [info ] [MainThread]: Found 10 models, 474 macros
[0m02:52:00.172120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5487c75-6bb1-47c5-8d7c-2a601eb482e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AF6A9D10>]}
[0m02:52:00.187950 [info ] [MainThread]: 
[0m02:52:00.187950 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:52:00.191735 [info ] [MainThread]: 
[0m02:52:00.194049 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:52:00.202837 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m02:52:00.462099 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m02:52:00.478233 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m02:52:00.479325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:52:03.327018 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.858 seconds
[0m02:52:03.342590 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m02:52:03.358295 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m02:52:03.358295 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m02:52:03.358295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:52:05.792004 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 2.426 seconds
[0m02:52:05.803130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5487c75-6bb1-47c5-8d7c-2a601eb482e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AEE36150>]}
[0m02:52:05.819099 [debug] [Thread-1 (]: Began running node model.crb_kpi.churned_new_customers
[0m02:52:05.819099 [info ] [Thread-1 (]: 1 of 10 START sql view model PUBLIC.churned_new_customers ...................... [RUN]
[0m02:52:05.819099 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.churned_new_customers'
[0m02:52:05.819099 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.churned_new_customers
[0m02:52:05.839063 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.churned_new_customers"
[0m02:52:05.839063 [debug] [Thread-1 (]: Began executing node model.crb_kpi.churned_new_customers
[0m02:52:05.891026 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.churned_new_customers"
[0m02:52:05.899884 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.churned_new_customers"
[0m02:52:05.899884 [debug] [Thread-1 (]: On model.crb_kpi.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.churned_new_customers"} */
create or replace   view CRBFITNESS.PUBLIC.churned_new_customers
  
   as (
    SELECT 
    customer_id, 
    'new' AS customer_status, 
    MIN(payment_month) AS first_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MIN(payment_month) IS NOT NULL

UNION ALL

SELECT 
    customer_id, 
    'churned' AS customer_status, 
    MAX(payment_month) AS last_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
  );
[0m02:52:05.903358 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:52:08.065328 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.166 seconds
[0m02:52:08.112489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5487c75-6bb1-47c5-8d7c-2a601eb482e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AF713C50>]}
[0m02:52:08.112489 [info ] [Thread-1 (]: 1 of 10 OK created sql view model PUBLIC.churned_new_customers ................. [[32mSUCCESS 1[0m in 2.29s]
[0m02:52:08.112489 [debug] [Thread-1 (]: Finished running node model.crb_kpi.churned_new_customers
[0m02:52:08.112489 [debug] [Thread-1 (]: Began running node model.crb_kpi.cross_sell_product_churn
[0m02:52:08.112489 [info ] [Thread-1 (]: 2 of 10 START sql view model PUBLIC.cross_sell_product_churn ................... [RUN]
[0m02:52:08.112489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.churned_new_customers, now model.crb_kpi.cross_sell_product_churn)
[0m02:52:08.112489 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.cross_sell_product_churn
[0m02:52:08.128556 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.cross_sell_product_churn"
[0m02:52:08.131350 [debug] [Thread-1 (]: Began executing node model.crb_kpi.cross_sell_product_churn
[0m02:52:08.138281 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.cross_sell_product_churn"
[0m02:52:08.138281 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.cross_sell_product_churn"
[0m02:52:08.138281 [debug] [Thread-1 (]: On model.crb_kpi.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.cross_sell_product_churn"} */
create or replace   view CRBFITNESS.PUBLIC.cross_sell_product_churn
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    p.product_family_clean, 
    COUNT(DISTINCT p.product_family_clean) AS cross_sell_count
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
ORDER BY cross_sell_count DESC
LIMIT 10
  );
[0m02:52:08.838107 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.702 seconds
[0m02:52:08.838107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5487c75-6bb1-47c5-8d7c-2a601eb482e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AF69A210>]}
[0m02:52:08.838107 [info ] [Thread-1 (]: 2 of 10 OK created sql view model PUBLIC.cross_sell_product_churn .............. [[32mSUCCESS 1[0m in 0.73s]
[0m02:52:08.853883 [debug] [Thread-1 (]: Finished running node model.crb_kpi.cross_sell_product_churn
[0m02:52:08.853883 [debug] [Thread-1 (]: Began running node model.crb_kpi.net_nrr_grr
[0m02:52:08.853883 [info ] [Thread-1 (]: 3 of 10 START sql view model PUBLIC.net_nrr_grr ................................ [RUN]
[0m02:52:08.853883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.cross_sell_product_churn, now model.crb_kpi.net_nrr_grr)
[0m02:52:08.853883 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.net_nrr_grr
[0m02:52:08.853883 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.net_nrr_grr"
[0m02:52:08.853883 [debug] [Thread-1 (]: Began executing node model.crb_kpi.net_nrr_grr
[0m02:52:08.869532 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.net_nrr_grr"
[0m02:52:08.876139 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.net_nrr_grr"
[0m02:52:08.876139 [debug] [Thread-1 (]: On model.crb_kpi.net_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.net_nrr_grr"} */
create or replace   view CRBFITNESS.PUBLIC.net_nrr_grr
  
   as (
    SELECT 
    SUM(CASE 
            WHEN TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') 
                 >= DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END) AS current_revenue,
        
    SUM(CASE 
            WHEN TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') 
                 < DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END) AS previous_revenue,

    (SUM(CASE 
            WHEN TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') 
                 >= DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END) * 1.0 /
     NULLIF(SUM(CASE 
            WHEN TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') 
                 < DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END), 0)) AS NRR,

    (SUM(CASE 
            WHEN TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') 
                 >= DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END) * 1.0 /
     NULLIF(SUM(CASE 
            WHEN TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') 
                 >= DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END), 0)) AS GRR
FROM public.stg_transactions
  );
[0m02:52:09.675146 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.800 seconds
[0m02:52:09.686449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5487c75-6bb1-47c5-8d7c-2a601eb482e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AFEFBD10>]}
[0m02:52:09.690969 [info ] [Thread-1 (]: 3 of 10 OK created sql view model PUBLIC.net_nrr_grr ........................... [[32mSUCCESS 1[0m in 0.83s]
[0m02:52:09.690969 [debug] [Thread-1 (]: Finished running node model.crb_kpi.net_nrr_grr
[0m02:52:09.693792 [debug] [Thread-1 (]: Began running node model.crb_kpi.new_logos
[0m02:52:09.693792 [info ] [Thread-1 (]: 4 of 10 START sql view model PUBLIC.new_logos .................................. [RUN]
[0m02:52:09.696885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.net_nrr_grr, now model.crb_kpi.new_logos)
[0m02:52:09.696885 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.new_logos
[0m02:52:09.701348 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.new_logos"
[0m02:52:09.701348 [debug] [Thread-1 (]: Began executing node model.crb_kpi.new_logos
[0m02:52:09.707056 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.new_logos"
[0m02:52:09.707056 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.new_logos"
[0m02:52:09.707056 [debug] [Thread-1 (]: On model.crb_kpi.new_logos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.new_logos"} */
create or replace   view CRBFITNESS.PUBLIC.new_logos
  
   as (
    SELECT 
    customer_id, 
    MIN(TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM')) AS first_fiscal_year
FROM public.stg_transactions
GROUP BY customer_id
  );
[0m02:52:10.502641 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.783 seconds
[0m02:52:10.502641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5487c75-6bb1-47c5-8d7c-2a601eb482e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AFFC7310>]}
[0m02:52:10.502641 [info ] [Thread-1 (]: 4 of 10 OK created sql view model PUBLIC.new_logos ............................. [[32mSUCCESS 1[0m in 0.81s]
[0m02:52:10.502641 [debug] [Thread-1 (]: Finished running node model.crb_kpi.new_logos
[0m02:52:10.512652 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_customers
[0m02:52:10.513797 [info ] [Thread-1 (]: 5 of 10 START sql view model PUBLIC.ranked_customers ........................... [RUN]
[0m02:52:10.516006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.new_logos, now model.crb_kpi.ranked_customers)
[0m02:52:10.518199 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_customers
[0m02:52:10.523114 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_customers"
[0m02:52:10.523114 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_customers
[0m02:52:10.526630 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_customers"
[0m02:52:10.535830 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_customers"
[0m02:52:10.536500 [debug] [Thread-1 (]: On model.crb_kpi.ranked_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_customers"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_customers
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
GROUP BY t.customer_id, c.customer_name_clean
ORDER BY total_revenue DESC
  );
[0m02:52:11.517899 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.989 seconds
[0m02:52:11.529616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5487c75-6bb1-47c5-8d7c-2a601eb482e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AF69BBD0>]}
[0m02:52:11.534771 [info ] [Thread-1 (]: 5 of 10 OK created sql view model PUBLIC.ranked_customers ...................... [[32mSUCCESS 1[0m in 1.01s]
[0m02:52:11.534771 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_customers
[0m02:52:11.534771 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_products
[0m02:52:11.534771 [info ] [Thread-1 (]: 6 of 10 START sql view model PUBLIC.ranked_products ............................ [RUN]
[0m02:52:11.534771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_customers, now model.crb_kpi.ranked_products)
[0m02:52:11.543214 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_products
[0m02:52:11.547439 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_products"
[0m02:52:11.547439 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_products
[0m02:52:11.559970 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_products"
[0m02:52:11.561117 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_products"
[0m02:52:11.563239 [debug] [Thread-1 (]: On model.crb_kpi.ranked_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_products"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_products
  
   as (
    SELECT 
    p.product_family_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY p.product_family_clean
ORDER BY total_revenue DESC
  );
[0m02:52:12.140348 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.576 seconds
[0m02:52:12.140348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5487c75-6bb1-47c5-8d7c-2a601eb482e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AFDEA910>]}
[0m02:52:12.140348 [info ] [Thread-1 (]: 6 of 10 OK created sql view model PUBLIC.ranked_products ....................... [[32mSUCCESS 1[0m in 0.61s]
[0m02:52:12.148374 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_products
[0m02:52:12.148374 [debug] [Thread-1 (]: Began running node model.crb_kpi.revenue_lost
[0m02:52:12.150525 [info ] [Thread-1 (]: 7 of 10 START sql view model PUBLIC.revenue_lost ............................... [RUN]
[0m02:52:12.152253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_products, now model.crb_kpi.revenue_lost)
[0m02:52:12.154603 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.revenue_lost
[0m02:52:12.158976 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.revenue_lost"
[0m02:52:12.158976 [debug] [Thread-1 (]: Began executing node model.crb_kpi.revenue_lost
[0m02:52:12.169691 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.revenue_lost"
[0m02:52:12.169691 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.revenue_lost"
[0m02:52:12.169691 [debug] [Thread-1 (]: On model.crb_kpi.revenue_lost: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.revenue_lost"} */
create or replace   view CRBFITNESS.PUBLIC.revenue_lost
  
   as (
    SELECT 
    t.payment_month AS period, 
    SUM(t.revenue) AS total_revenue_lost
FROM public.stg_transactions t
WHERE t.customer_id IN (
    SELECT customer_id 
    FROM public.stg_transactions 
    GROUP BY customer_id 
    HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
)
GROUP BY t.payment_month
ORDER BY t.payment_month
  );
[0m02:52:12.738439 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.564 seconds
[0m02:52:12.738439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5487c75-6bb1-47c5-8d7c-2a601eb482e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AFEB9AD0>]}
[0m02:52:12.738439 [info ] [Thread-1 (]: 7 of 10 OK created sql view model PUBLIC.revenue_lost .......................... [[32mSUCCESS 1[0m in 0.59s]
[0m02:52:12.738439 [debug] [Thread-1 (]: Finished running node model.crb_kpi.revenue_lost
[0m02:52:12.750540 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m02:52:12.750540 [info ] [Thread-1 (]: 8 of 10 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m02:52:12.753486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.revenue_lost, now model.crb_kpi.stg_customers)
[0m02:52:12.753486 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m02:52:12.762189 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m02:52:12.763327 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m02:52:12.775090 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m02:52:12.775090 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m02:52:12.781421 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
    WHERE customer_id IS NOT NULL  -- Remove rows where customer_id is NULL
      AND customername IS NOT NULL -- Remove rows where customername is NULL
)
SELECT 
    customer_id,
    COALESCE(TRIM(LOWER(customername)), 'Unknown') AS customer_name_clean -- Handle NULLs
FROM raw
  );
[0m02:52:13.282487 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.505 seconds
[0m02:52:13.282487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5487c75-6bb1-47c5-8d7c-2a601eb482e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AFFB8FD0>]}
[0m02:52:13.282487 [info ] [Thread-1 (]: 8 of 10 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 0.53s]
[0m02:52:13.282487 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m02:52:13.297622 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m02:52:13.299638 [info ] [Thread-1 (]: 9 of 10 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m02:52:13.300375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m02:52:13.302934 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m02:52:13.306863 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m02:52:13.306863 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m02:52:13.322636 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m02:52:13.322636 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m02:52:13.330807 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS ( 
    SELECT * FROM public.products
    WHERE product_id IS NOT NULL  -- Remove rows where product_id is NULL
      AND product_family IS NOT NULL -- Remove rows where product_family is NULL
)
SELECT 
    product_id,
    COALESCE(TRIM(LOWER(product_family)), 'Unknown') AS product_family_clean -- Handle NULLs
FROM raw
  );
[0m02:52:13.894339 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.563 seconds
[0m02:52:13.894339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5487c75-6bb1-47c5-8d7c-2a601eb482e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8B0422C10>]}
[0m02:52:13.894339 [info ] [Thread-1 (]: 9 of 10 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 0.59s]
[0m02:52:13.903058 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m02:52:13.903058 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m02:52:13.903058 [info ] [Thread-1 (]: 10 of 10 START sql view model PUBLIC.stg_transactions .......................... [RUN]
[0m02:52:13.903058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m02:52:13.909074 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m02:52:13.913820 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m02:52:13.914786 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m02:52:13.925563 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m02:52:13.930625 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m02:52:13.930625 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    CREATE OR REPLACE TABLE public.stg_transactions_clean AS
WITH raw AS (
    SELECT * FROM public.transactions
    WHERE customer_id IS NOT NULL  
      AND product_id IS NOT NULL  
      AND revenue IS NOT NULL  
      AND payment_month IS NOT NULL  
)
SELECT 
    customer_id,
    product_id,
    CAST(COALESCE(revenue, 0) AS FLOAT) AS revenue,  -- Handle NULL revenue
    TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') AS payment_month_clean  -- Convert VARCHAR to TIMESTAMP
FROM raw;
[0m02:52:14.302702 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb02a2-0004-c144-0005-db4b00018692
[0m02:52:14.302702 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 4 unexpected 'CREATE'.
syntax error line 12 at position 0 unexpected 'SELECT'.
[0m02:52:14.316906 [debug] [Thread-1 (]: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected 'CREATE'.
  syntax error line 12 at position 0 unexpected 'SELECT'.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql
[0m02:52:14.316906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5487c75-6bb1-47c5-8d7c-2a601eb482e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AFFDCC10>]}
[0m02:52:14.316906 [error] [Thread-1 (]: 10 of 10 ERROR creating sql view model PUBLIC.stg_transactions ................. [[31mERROR[0m in 0.41s]
[0m02:52:14.316906 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m02:52:14.326903 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.stg_transactions' to be skipped because of status 'error'.  Reason: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected 'CREATE'.
  syntax error line 12 at position 0 unexpected 'SELECT'.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql.
[0m02:52:14.329757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:52:14.329757 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m02:52:14.329757 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m02:52:15.020659 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m02:52:15.020659 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m02:52:15.722311 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m02:52:15.722311 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m02:52:16.434239 [info ] [MainThread]: 
[0m02:52:16.434239 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 16.24 seconds (16.24s).
[0m02:52:16.449807 [debug] [MainThread]: Command end result
[0m02:52:16.497213 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m02:52:16.503089 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m02:52:16.513128 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m02:52:16.518543 [info ] [MainThread]: 
[0m02:52:16.524361 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:52:16.526191 [info ] [MainThread]: 
[0m02:52:16.529357 [error] [MainThread]:   Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected 'CREATE'.
  syntax error line 12 at position 0 unexpected 'SELECT'.
  compiled code at target\run\crb_kpi\models\staging\stg_transactions.sql
[0m02:52:16.531198 [info ] [MainThread]: 
[0m02:52:16.532832 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m02:52:16.535779 [debug] [MainThread]: Command `dbt run` failed at 02:52:16.535779 after 18.69 seconds
[0m02:52:16.538498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A8AE2E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A8AE2E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AEEE6390>]}
[0m02:52:16.538498 [debug] [MainThread]: Flushing usage events
[0m02:52:18.584712 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:53:20.044385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CCE8C510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CCEE25D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CCE8D0D0>]}


============================== 02:53:20.044385 | 051cf62b-4a1d-4f11-afb5-75166d689cf4 ==============================
[0m02:53:20.044385 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:53:20.044385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m02:53:20.639846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '051cf62b-4a1d-4f11-afb5-75166d689cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CCEAF2D0>]}
[0m02:53:20.716027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '051cf62b-4a1d-4f11-afb5-75166d689cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CDA5DC10>]}
[0m02:53:20.730114 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:53:21.379623 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:53:21.609052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:53:21.609052 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\staging\stg_transactions.sql
[0m02:53:21.925901 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m02:53:21.928196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '051cf62b-4a1d-4f11-afb5-75166d689cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CDBD5F10>]}
[0m02:53:22.026295 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m02:53:22.026295 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m02:53:22.062952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '051cf62b-4a1d-4f11-afb5-75166d689cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CE461E90>]}
[0m02:53:22.070962 [info ] [MainThread]: Found 10 models, 474 macros
[0m02:53:22.070962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '051cf62b-4a1d-4f11-afb5-75166d689cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CE3B7710>]}
[0m02:53:22.075017 [info ] [MainThread]: 
[0m02:53:22.078029 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:53:22.079486 [info ] [MainThread]: 
[0m02:53:22.081626 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:53:22.081626 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m02:53:22.320183 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m02:53:22.320183 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m02:53:22.320183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:53:24.392977 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.079 seconds
[0m02:53:24.408477 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m02:53:24.408477 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m02:53:24.408477 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m02:53:24.408477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:53:26.460046 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 2.043 seconds
[0m02:53:26.469771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '051cf62b-4a1d-4f11-afb5-75166d689cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CE3FAE50>]}
[0m02:53:26.479817 [debug] [Thread-1 (]: Began running node model.crb_kpi.churned_new_customers
[0m02:53:26.480462 [info ] [Thread-1 (]: 1 of 10 START sql view model PUBLIC.churned_new_customers ...................... [RUN]
[0m02:53:26.482291 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.churned_new_customers'
[0m02:53:26.482291 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.churned_new_customers
[0m02:53:26.496540 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.churned_new_customers"
[0m02:53:26.496540 [debug] [Thread-1 (]: Began executing node model.crb_kpi.churned_new_customers
[0m02:53:26.547250 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.churned_new_customers"
[0m02:53:26.547250 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.churned_new_customers"
[0m02:53:26.547250 [debug] [Thread-1 (]: On model.crb_kpi.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.churned_new_customers"} */
create or replace   view CRBFITNESS.PUBLIC.churned_new_customers
  
   as (
    SELECT 
    customer_id, 
    'new' AS customer_status, 
    MIN(payment_month) AS first_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MIN(payment_month) IS NOT NULL

UNION ALL

SELECT 
    customer_id, 
    'churned' AS customer_status, 
    MAX(payment_month) AS last_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
  );
[0m02:53:26.547250 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:53:28.478854 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.932 seconds
[0m02:53:28.525965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '051cf62b-4a1d-4f11-afb5-75166d689cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CEA05710>]}
[0m02:53:28.525965 [info ] [Thread-1 (]: 1 of 10 OK created sql view model PUBLIC.churned_new_customers ................. [[32mSUCCESS 1[0m in 2.04s]
[0m02:53:28.525965 [debug] [Thread-1 (]: Finished running node model.crb_kpi.churned_new_customers
[0m02:53:28.525965 [debug] [Thread-1 (]: Began running node model.crb_kpi.cross_sell_product_churn
[0m02:53:28.525965 [info ] [Thread-1 (]: 2 of 10 START sql view model PUBLIC.cross_sell_product_churn ................... [RUN]
[0m02:53:28.525965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.churned_new_customers, now model.crb_kpi.cross_sell_product_churn)
[0m02:53:28.537161 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.cross_sell_product_churn
[0m02:53:28.537161 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.cross_sell_product_churn"
[0m02:53:28.541681 [debug] [Thread-1 (]: Began executing node model.crb_kpi.cross_sell_product_churn
[0m02:53:28.547119 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.cross_sell_product_churn"
[0m02:53:28.547119 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.cross_sell_product_churn"
[0m02:53:28.552384 [debug] [Thread-1 (]: On model.crb_kpi.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.cross_sell_product_churn"} */
create or replace   view CRBFITNESS.PUBLIC.cross_sell_product_churn
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    p.product_family_clean, 
    COUNT(DISTINCT p.product_family_clean) AS cross_sell_count
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
ORDER BY cross_sell_count DESC
LIMIT 10
  );
[0m02:53:29.195541 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.644 seconds
[0m02:53:29.202368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '051cf62b-4a1d-4f11-afb5-75166d689cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CEB2F8D0>]}
[0m02:53:29.202368 [info ] [Thread-1 (]: 2 of 10 OK created sql view model PUBLIC.cross_sell_product_churn .............. [[32mSUCCESS 1[0m in 0.68s]
[0m02:53:29.202368 [debug] [Thread-1 (]: Finished running node model.crb_kpi.cross_sell_product_churn
[0m02:53:29.202368 [debug] [Thread-1 (]: Began running node model.crb_kpi.net_nrr_grr
[0m02:53:29.202368 [info ] [Thread-1 (]: 3 of 10 START sql view model PUBLIC.net_nrr_grr ................................ [RUN]
[0m02:53:29.202368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.cross_sell_product_churn, now model.crb_kpi.net_nrr_grr)
[0m02:53:29.212678 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.net_nrr_grr
[0m02:53:29.215382 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.net_nrr_grr"
[0m02:53:29.215382 [debug] [Thread-1 (]: Began executing node model.crb_kpi.net_nrr_grr
[0m02:53:29.225093 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.net_nrr_grr"
[0m02:53:29.225093 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.net_nrr_grr"
[0m02:53:29.225093 [debug] [Thread-1 (]: On model.crb_kpi.net_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.net_nrr_grr"} */
create or replace   view CRBFITNESS.PUBLIC.net_nrr_grr
  
   as (
    SELECT 
    SUM(CASE 
            WHEN TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') 
                 >= DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END) AS current_revenue,
        
    SUM(CASE 
            WHEN TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') 
                 < DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END) AS previous_revenue,

    (SUM(CASE 
            WHEN TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') 
                 >= DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END) * 1.0 /
     NULLIF(SUM(CASE 
            WHEN TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') 
                 < DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END), 0)) AS NRR,

    (SUM(CASE 
            WHEN TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') 
                 >= DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END) * 1.0 /
     NULLIF(SUM(CASE 
            WHEN TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') 
                 >= DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END), 0)) AS GRR
FROM public.stg_transactions
  );
[0m02:53:29.744900 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.525 seconds
[0m02:53:29.760489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '051cf62b-4a1d-4f11-afb5-75166d689cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CEBF9CD0>]}
[0m02:53:29.760489 [info ] [Thread-1 (]: 3 of 10 OK created sql view model PUBLIC.net_nrr_grr ........................... [[32mSUCCESS 1[0m in 0.56s]
[0m02:53:29.767736 [debug] [Thread-1 (]: Finished running node model.crb_kpi.net_nrr_grr
[0m02:53:29.767736 [debug] [Thread-1 (]: Began running node model.crb_kpi.new_logos
[0m02:53:29.767736 [info ] [Thread-1 (]: 4 of 10 START sql view model PUBLIC.new_logos .................................. [RUN]
[0m02:53:29.767736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.net_nrr_grr, now model.crb_kpi.new_logos)
[0m02:53:29.774105 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.new_logos
[0m02:53:29.778238 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.new_logos"
[0m02:53:29.778238 [debug] [Thread-1 (]: Began executing node model.crb_kpi.new_logos
[0m02:53:29.792996 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.new_logos"
[0m02:53:29.792996 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.new_logos"
[0m02:53:29.800095 [debug] [Thread-1 (]: On model.crb_kpi.new_logos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.new_logos"} */
create or replace   view CRBFITNESS.PUBLIC.new_logos
  
   as (
    SELECT 
    customer_id, 
    MIN(TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM')) AS first_fiscal_year
FROM public.stg_transactions
GROUP BY customer_id
  );
[0m02:53:30.339906 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.540 seconds
[0m02:53:30.339906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '051cf62b-4a1d-4f11-afb5-75166d689cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CEEBA090>]}
[0m02:53:30.339906 [info ] [Thread-1 (]: 4 of 10 OK created sql view model PUBLIC.new_logos ............................. [[32mSUCCESS 1[0m in 0.57s]
[0m02:53:30.339906 [debug] [Thread-1 (]: Finished running node model.crb_kpi.new_logos
[0m02:53:30.352739 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_customers
[0m02:53:30.352739 [info ] [Thread-1 (]: 5 of 10 START sql view model PUBLIC.ranked_customers ........................... [RUN]
[0m02:53:30.352739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.new_logos, now model.crb_kpi.ranked_customers)
[0m02:53:30.357610 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_customers
[0m02:53:30.360964 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_customers"
[0m02:53:30.360964 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_customers
[0m02:53:30.373305 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_customers"
[0m02:53:30.375861 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_customers"
[0m02:53:30.380808 [debug] [Thread-1 (]: On model.crb_kpi.ranked_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_customers"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_customers
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
GROUP BY t.customer_id, c.customer_name_clean
ORDER BY total_revenue DESC
  );
[0m02:53:30.986458 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.607 seconds
[0m02:53:30.986458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '051cf62b-4a1d-4f11-afb5-75166d689cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CEEB7A90>]}
[0m02:53:30.986458 [info ] [Thread-1 (]: 5 of 10 OK created sql view model PUBLIC.ranked_customers ...................... [[32mSUCCESS 1[0m in 0.63s]
[0m02:53:30.995817 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_customers
[0m02:53:30.995817 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_products
[0m02:53:30.995817 [info ] [Thread-1 (]: 6 of 10 START sql view model PUBLIC.ranked_products ............................ [RUN]
[0m02:53:30.995817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_customers, now model.crb_kpi.ranked_products)
[0m02:53:30.995817 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_products
[0m02:53:31.002332 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_products"
[0m02:53:31.004922 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_products
[0m02:53:31.008563 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_products"
[0m02:53:31.008563 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_products"
[0m02:53:31.008563 [debug] [Thread-1 (]: On model.crb_kpi.ranked_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_products"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_products
  
   as (
    SELECT 
    p.product_family_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY p.product_family_clean
ORDER BY total_revenue DESC
  );
[0m02:53:31.949555 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.936 seconds
[0m02:53:31.953241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '051cf62b-4a1d-4f11-afb5-75166d689cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CEEADA90>]}
[0m02:53:31.953241 [info ] [Thread-1 (]: 6 of 10 OK created sql view model PUBLIC.ranked_products ....................... [[32mSUCCESS 1[0m in 0.96s]
[0m02:53:31.961105 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_products
[0m02:53:31.961787 [debug] [Thread-1 (]: Began running node model.crb_kpi.revenue_lost
[0m02:53:31.963789 [info ] [Thread-1 (]: 7 of 10 START sql view model PUBLIC.revenue_lost ............................... [RUN]
[0m02:53:31.965655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_products, now model.crb_kpi.revenue_lost)
[0m02:53:31.965655 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.revenue_lost
[0m02:53:31.968631 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.revenue_lost"
[0m02:53:31.968631 [debug] [Thread-1 (]: Began executing node model.crb_kpi.revenue_lost
[0m02:53:31.976200 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.revenue_lost"
[0m02:53:31.976200 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.revenue_lost"
[0m02:53:31.979369 [debug] [Thread-1 (]: On model.crb_kpi.revenue_lost: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.revenue_lost"} */
create or replace   view CRBFITNESS.PUBLIC.revenue_lost
  
   as (
    SELECT 
    t.payment_month AS period, 
    SUM(t.revenue) AS total_revenue_lost
FROM public.stg_transactions t
WHERE t.customer_id IN (
    SELECT customer_id 
    FROM public.stg_transactions 
    GROUP BY customer_id 
    HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
)
GROUP BY t.payment_month
ORDER BY t.payment_month
  );
[0m02:53:32.473255 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.507 seconds
[0m02:53:32.488831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '051cf62b-4a1d-4f11-afb5-75166d689cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CEEBC410>]}
[0m02:53:32.488831 [info ] [Thread-1 (]: 7 of 10 OK created sql view model PUBLIC.revenue_lost .......................... [[32mSUCCESS 1[0m in 0.52s]
[0m02:53:32.496393 [debug] [Thread-1 (]: Finished running node model.crb_kpi.revenue_lost
[0m02:53:32.496393 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m02:53:32.498989 [info ] [Thread-1 (]: 8 of 10 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m02:53:32.500538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.revenue_lost, now model.crb_kpi.stg_customers)
[0m02:53:32.500538 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m02:53:32.504554 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m02:53:32.508546 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m02:53:32.508546 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m02:53:32.508546 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m02:53:32.508546 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
    WHERE customer_id IS NOT NULL  -- Remove rows where customer_id is NULL
      AND customername IS NOT NULL -- Remove rows where customername is NULL
)
SELECT 
    customer_id,
    COALESCE(TRIM(LOWER(customername)), 'Unknown') AS customer_name_clean -- Handle NULLs
FROM raw
  );
[0m02:53:33.040595 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.522 seconds
[0m02:53:33.046562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '051cf62b-4a1d-4f11-afb5-75166d689cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CEEFE650>]}
[0m02:53:33.050498 [info ] [Thread-1 (]: 8 of 10 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 0.55s]
[0m02:53:33.050498 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m02:53:33.050498 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m02:53:33.050498 [info ] [Thread-1 (]: 9 of 10 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m02:53:33.056016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m02:53:33.058252 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m02:53:33.061724 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m02:53:33.067728 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m02:53:33.076316 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m02:53:33.076316 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m02:53:33.076316 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS ( 
    SELECT * FROM public.products
    WHERE product_id IS NOT NULL  -- Remove rows where product_id is NULL
      AND product_family IS NOT NULL -- Remove rows where product_family is NULL
)
SELECT 
    product_id,
    COALESCE(TRIM(LOWER(product_family)), 'Unknown') AS product_family_clean -- Handle NULLs
FROM raw
  );
[0m02:53:33.583113 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.508 seconds
[0m02:53:33.597147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '051cf62b-4a1d-4f11-afb5-75166d689cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CEF21F10>]}
[0m02:53:33.597147 [info ] [Thread-1 (]: 9 of 10 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 0.53s]
[0m02:53:33.599639 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m02:53:33.599639 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m02:53:33.602158 [info ] [Thread-1 (]: 10 of 10 START sql view model PUBLIC.stg_transactions .......................... [RUN]
[0m02:53:33.603615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m02:53:33.603615 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m02:53:33.603615 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m02:53:33.610860 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m02:53:33.615894 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m02:53:33.619310 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m02:53:33.619310 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
    WHERE customer_id IS NOT NULL  
      AND product_id IS NOT NULL  
      AND revenue IS NOT NULL  
      AND payment_month IS NOT NULL  
)
SELECT 
    customer_id,
    product_id,
    CAST(COALESCE(revenue, 0) AS FLOAT) AS revenue,  -- Handle NULL revenue
    TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') AS payment_month_clean  -- Convert VARCHAR to TIMESTAMP
FROM raw
  );
[0m02:53:34.206809 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m02:53:34.215905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '051cf62b-4a1d-4f11-afb5-75166d689cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CEF23C50>]}
[0m02:53:34.215905 [info ] [Thread-1 (]: 10 of 10 OK created sql view model PUBLIC.stg_transactions ..................... [[32mSUCCESS 1[0m in 0.61s]
[0m02:53:34.222928 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m02:53:34.222928 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:53:34.222928 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m02:53:34.222928 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m02:53:34.876294 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m02:53:34.876294 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m02:53:35.785601 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m02:53:35.785601 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m02:53:36.427157 [info ] [MainThread]: 
[0m02:53:36.427157 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 14.35 seconds (14.35s).
[0m02:53:36.432164 [debug] [MainThread]: Command end result
[0m02:53:36.490274 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m02:53:36.492396 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m02:53:36.506210 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m02:53:36.506210 [info ] [MainThread]: 
[0m02:53:36.508826 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:53:36.516630 [info ] [MainThread]: 
[0m02:53:36.518522 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m02:53:36.523371 [debug] [MainThread]: Command `dbt run` succeeded at 02:53:36.523371 after 16.59 seconds
[0m02:53:36.525216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CCEC84D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CCAAEA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2C7A92E90>]}
[0m02:53:36.525216 [debug] [MainThread]: Flushing usage events
[0m02:53:38.154611 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:59:44.115321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0828C8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B082E0F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0828FD10>]}


============================== 02:59:44.115321 | c2f7b719-3310-44e3-bca1-a003b12cd731 ==============================
[0m02:59:44.115321 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:59:44.115321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:59:44.727295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2f7b719-3310-44e3-bca1-a003b12cd731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B08F1F450>]}
[0m02:59:44.801273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2f7b719-3310-44e3-bca1-a003b12cd731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B08E5D910>]}
[0m02:59:44.801273 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:59:45.415797 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:59:45.667771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m02:59:45.669340 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\new_logos.sql
[0m02:59:45.669340 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\net_nrr_grr.sql
[0m02:59:45.973303 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m02:59:45.976448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2f7b719-3310-44e3-bca1-a003b12cd731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B093D5590>]}
[0m02:59:46.065688 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m02:59:46.074164 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m02:59:46.106353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2f7b719-3310-44e3-bca1-a003b12cd731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B09958F90>]}
[0m02:59:46.114750 [info ] [MainThread]: Found 10 models, 474 macros
[0m02:59:46.115868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2f7b719-3310-44e3-bca1-a003b12cd731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B097B6B90>]}
[0m02:59:46.115868 [info ] [MainThread]: 
[0m02:59:46.115868 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:59:46.123828 [info ] [MainThread]: 
[0m02:59:46.128453 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:59:46.129623 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m02:59:46.359514 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m02:59:46.359514 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m02:59:46.368155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:59:48.493467 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.131 seconds
[0m02:59:48.504154 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m02:59:48.517665 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m02:59:48.517665 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m02:59:48.521512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:59:50.526437 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 2.018 seconds
[0m02:59:50.542654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2f7b719-3310-44e3-bca1-a003b12cd731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B098EC5D0>]}
[0m02:59:50.559077 [debug] [Thread-1 (]: Began running node model.crb_kpi.churned_new_customers
[0m02:59:50.559077 [info ] [Thread-1 (]: 1 of 10 START sql view model PUBLIC.churned_new_customers ...................... [RUN]
[0m02:59:50.559077 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.churned_new_customers'
[0m02:59:50.559077 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.churned_new_customers
[0m02:59:50.579210 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.churned_new_customers"
[0m02:59:50.579210 [debug] [Thread-1 (]: Began executing node model.crb_kpi.churned_new_customers
[0m02:59:50.639573 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.churned_new_customers"
[0m02:59:50.643307 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.churned_new_customers"
[0m02:59:50.645246 [debug] [Thread-1 (]: On model.crb_kpi.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.churned_new_customers"} */
create or replace   view CRBFITNESS.PUBLIC.churned_new_customers
  
   as (
    SELECT 
    customer_id, 
    'new' AS customer_status, 
    MIN(payment_month) AS first_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MIN(payment_month) IS NOT NULL

UNION ALL

SELECT 
    customer_id, 
    'churned' AS customer_status, 
    MAX(payment_month) AS last_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
  );
[0m02:59:50.646329 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:59:52.564035 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb02a9-0004-c144-0005-db4b000186e2
[0m02:59:52.569686 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 8
invalid identifier 'PAYMENT_MONTH'
[0m02:59:52.571706 [debug] [Thread-1 (]: Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql
[0m02:59:52.571706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2f7b719-3310-44e3-bca1-a003b12cd731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B09FE87D0>]}
[0m02:59:52.571706 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model PUBLIC.churned_new_customers ............. [[31mERROR[0m in 2.01s]
[0m02:59:52.571706 [debug] [Thread-1 (]: Finished running node model.crb_kpi.churned_new_customers
[0m02:59:52.587383 [debug] [Thread-1 (]: Began running node model.crb_kpi.cross_sell_product_churn
[0m02:59:52.588537 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.churned_new_customers' to be skipped because of status 'error'.  Reason: Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql.
[0m02:59:52.588537 [info ] [Thread-1 (]: 2 of 10 START sql view model PUBLIC.cross_sell_product_churn ................... [RUN]
[0m02:59:52.593842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.churned_new_customers, now model.crb_kpi.cross_sell_product_churn)
[0m02:59:52.596433 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.cross_sell_product_churn
[0m02:59:52.596433 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.cross_sell_product_churn"
[0m02:59:52.596433 [debug] [Thread-1 (]: Began executing node model.crb_kpi.cross_sell_product_churn
[0m02:59:52.604013 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.cross_sell_product_churn"
[0m02:59:52.615683 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.cross_sell_product_churn"
[0m02:59:52.615683 [debug] [Thread-1 (]: On model.crb_kpi.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.cross_sell_product_churn"} */
create or replace   view CRBFITNESS.PUBLIC.cross_sell_product_churn
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    p.product_family_clean, 
    COUNT(DISTINCT p.product_family_clean) AS cross_sell_count
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
ORDER BY cross_sell_count DESC
LIMIT 10
  );
[0m02:59:53.277104 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.660 seconds
[0m02:59:53.307294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2f7b719-3310-44e3-bca1-a003b12cd731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B09379050>]}
[0m02:59:53.307294 [info ] [Thread-1 (]: 2 of 10 OK created sql view model PUBLIC.cross_sell_product_churn .............. [[32mSUCCESS 1[0m in 0.71s]
[0m02:59:53.321024 [debug] [Thread-1 (]: Finished running node model.crb_kpi.cross_sell_product_churn
[0m02:59:53.323039 [debug] [Thread-1 (]: Began running node model.crb_kpi.net_nrr_grr
[0m02:59:53.323039 [info ] [Thread-1 (]: 3 of 10 START sql view model PUBLIC.net_nrr_grr ................................ [RUN]
[0m02:59:53.323039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.cross_sell_product_churn, now model.crb_kpi.net_nrr_grr)
[0m02:59:53.323039 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.net_nrr_grr
[0m02:59:53.323039 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.net_nrr_grr"
[0m02:59:53.330613 [debug] [Thread-1 (]: Began executing node model.crb_kpi.net_nrr_grr
[0m02:59:53.331415 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.net_nrr_grr"
[0m02:59:53.337064 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.net_nrr_grr"
[0m02:59:53.337650 [debug] [Thread-1 (]: On model.crb_kpi.net_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.net_nrr_grr"} */
create or replace   view CRBFITNESS.PUBLIC.net_nrr_grr
  
   as (
    SELECT 
    SUM(CASE 
            WHEN payment_month_clean >= DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END) AS current_revenue,
        
    SUM(CASE 
            WHEN payment_month_clean < DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END) AS previous_revenue,

    (SUM(CASE 
            WHEN payment_month_clean >= DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END) * 1.0 /
     NULLIF(SUM(CASE 
            WHEN payment_month_clean < DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END), 0)) AS NRR,

    (SUM(CASE 
            WHEN payment_month_clean >= DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END) * 1.0 /
     NULLIF(SUM(revenue), 0)) AS GRR
FROM public.stg_transactions;
[0m02:59:53.857417 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb02a9-0004-c152-0005-db4b0001a132
[0m02:59:53.857417 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 29 at position 28 unexpected ';'.
[0m02:59:53.864779 [debug] [Thread-1 (]: Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 28 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql
[0m02:59:53.864779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2f7b719-3310-44e3-bca1-a003b12cd731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B097A4790>]}
[0m02:59:53.864779 [error] [Thread-1 (]: 3 of 10 ERROR creating sql view model PUBLIC.net_nrr_grr ....................... [[31mERROR[0m in 0.54s]
[0m02:59:53.873155 [debug] [Thread-1 (]: Finished running node model.crb_kpi.net_nrr_grr
[0m02:59:53.873155 [debug] [Thread-1 (]: Began running node model.crb_kpi.new_logos
[0m02:59:53.873155 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.net_nrr_grr' to be skipped because of status 'error'.  Reason: Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 28 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql.
[0m02:59:53.876712 [info ] [Thread-1 (]: 4 of 10 START sql view model PUBLIC.new_logos .................................. [RUN]
[0m02:59:53.876712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.net_nrr_grr, now model.crb_kpi.new_logos)
[0m02:59:53.876712 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.new_logos
[0m02:59:53.885106 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.new_logos"
[0m02:59:53.888471 [debug] [Thread-1 (]: Began executing node model.crb_kpi.new_logos
[0m02:59:53.897212 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.new_logos"
[0m02:59:53.897212 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.new_logos"
[0m02:59:53.897212 [debug] [Thread-1 (]: On model.crb_kpi.new_logos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.new_logos"} */
create or replace   view CRBFITNESS.PUBLIC.new_logos
  
   as (
    SELECT 
    customer_id, 
    MIN(payment_month_clean) AS first_fiscal_year
FROM public.stg_transactions
GROUP BY customer_id;
[0m02:59:54.352903 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb02a9-0004-c0bd-0005-db4b00017762
[0m02:59:54.352903 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 20 unexpected ';'.
[0m02:59:54.360560 [debug] [Thread-1 (]: Database Error in model new_logos (models\marts\new_logos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 20 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\new_logos.sql
[0m02:59:54.360560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2f7b719-3310-44e3-bca1-a003b12cd731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0A69E090>]}
[0m02:59:54.360560 [error] [Thread-1 (]: 4 of 10 ERROR creating sql view model PUBLIC.new_logos ......................... [[31mERROR[0m in 0.48s]
[0m02:59:54.367739 [debug] [Thread-1 (]: Finished running node model.crb_kpi.new_logos
[0m02:59:54.369168 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_customers
[0m02:59:54.369168 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.new_logos' to be skipped because of status 'error'.  Reason: Database Error in model new_logos (models\marts\new_logos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 20 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\new_logos.sql.
[0m02:59:54.369168 [info ] [Thread-1 (]: 5 of 10 START sql view model PUBLIC.ranked_customers ........................... [RUN]
[0m02:59:54.375049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.new_logos, now model.crb_kpi.ranked_customers)
[0m02:59:54.376567 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_customers
[0m02:59:54.380383 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_customers"
[0m02:59:54.380383 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_customers
[0m02:59:54.386835 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_customers"
[0m02:59:54.393648 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_customers"
[0m02:59:54.397132 [debug] [Thread-1 (]: On model.crb_kpi.ranked_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_customers"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_customers
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
GROUP BY t.customer_id, c.customer_name_clean
ORDER BY total_revenue DESC
  );
[0m02:59:55.071497 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.674 seconds
[0m02:59:55.076196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2f7b719-3310-44e3-bca1-a003b12cd731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0A6A9910>]}
[0m02:59:55.076196 [info ] [Thread-1 (]: 5 of 10 OK created sql view model PUBLIC.ranked_customers ...................... [[32mSUCCESS 1[0m in 0.71s]
[0m02:59:55.076196 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_customers
[0m02:59:55.076196 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_products
[0m02:59:55.076196 [info ] [Thread-1 (]: 6 of 10 START sql view model PUBLIC.ranked_products ............................ [RUN]
[0m02:59:55.085824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_customers, now model.crb_kpi.ranked_products)
[0m02:59:55.087342 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_products
[0m02:59:55.092091 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_products"
[0m02:59:55.096707 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_products
[0m02:59:55.099054 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_products"
[0m02:59:55.099054 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_products"
[0m02:59:55.099054 [debug] [Thread-1 (]: On model.crb_kpi.ranked_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_products"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_products
  
   as (
    SELECT 
    p.product_family_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY p.product_family_clean
ORDER BY total_revenue DESC
  );
[0m02:59:55.800300 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.693 seconds
[0m02:59:55.800300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2f7b719-3310-44e3-bca1-a003b12cd731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0A6A93D0>]}
[0m02:59:55.800300 [info ] [Thread-1 (]: 6 of 10 OK created sql view model PUBLIC.ranked_products ....................... [[32mSUCCESS 1[0m in 0.71s]
[0m02:59:55.812973 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_products
[0m02:59:55.812973 [debug] [Thread-1 (]: Began running node model.crb_kpi.revenue_lost
[0m02:59:55.816796 [info ] [Thread-1 (]: 7 of 10 START sql view model PUBLIC.revenue_lost ............................... [RUN]
[0m02:59:55.816796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_products, now model.crb_kpi.revenue_lost)
[0m02:59:55.819901 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.revenue_lost
[0m02:59:55.823886 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.revenue_lost"
[0m02:59:55.827179 [debug] [Thread-1 (]: Began executing node model.crb_kpi.revenue_lost
[0m02:59:55.835184 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.revenue_lost"
[0m02:59:55.835184 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.revenue_lost"
[0m02:59:55.844257 [debug] [Thread-1 (]: On model.crb_kpi.revenue_lost: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.revenue_lost"} */
create or replace   view CRBFITNESS.PUBLIC.revenue_lost
  
   as (
    SELECT 
    t.payment_month AS period, 
    SUM(t.revenue) AS total_revenue_lost
FROM public.stg_transactions t
WHERE t.customer_id IN (
    SELECT customer_id 
    FROM public.stg_transactions 
    GROUP BY customer_id 
    HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
)
GROUP BY t.payment_month
ORDER BY t.payment_month
  );
[0m02:59:56.354303 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb02a9-0004-c178-0005-db4b0001962e
[0m02:59:56.354303 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 4
invalid identifier 'T.PAYMENT_MONTH'
[0m02:59:56.354303 [debug] [Thread-1 (]: Database Error in model revenue_lost (models\marts\revenue_lost.sql)
  000904 (42000): SQL compilation error: error line 5 at position 4
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\revenue_lost.sql
[0m02:59:56.354303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2f7b719-3310-44e3-bca1-a003b12cd731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0A6B1BD0>]}
[0m02:59:56.354303 [error] [Thread-1 (]: 7 of 10 ERROR creating sql view model PUBLIC.revenue_lost ...................... [[31mERROR[0m in 0.54s]
[0m02:59:56.354303 [debug] [Thread-1 (]: Finished running node model.crb_kpi.revenue_lost
[0m02:59:56.367544 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m02:59:56.368528 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.revenue_lost' to be skipped because of status 'error'.  Reason: Database Error in model revenue_lost (models\marts\revenue_lost.sql)
  000904 (42000): SQL compilation error: error line 5 at position 4
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\revenue_lost.sql.
[0m02:59:56.370039 [info ] [Thread-1 (]: 8 of 10 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m02:59:56.372768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.revenue_lost, now model.crb_kpi.stg_customers)
[0m02:59:56.375114 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m02:59:56.377072 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m02:59:56.377072 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m02:59:56.386093 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m02:59:56.394771 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m02:59:56.398196 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
    WHERE customer_id IS NOT NULL  -- Remove rows where customer_id is NULL
      AND customername IS NOT NULL -- Remove rows where customername is NULL
)
SELECT 
    customer_id,
    COALESCE(TRIM(LOWER(customername)), 'Unknown') AS customer_name_clean -- Handle NULLs
FROM raw
  );
[0m02:59:57.026714 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.635 seconds
[0m02:59:57.026714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2f7b719-3310-44e3-bca1-a003b12cd731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0A66D3D0>]}
[0m02:59:57.026714 [info ] [Thread-1 (]: 8 of 10 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 0.65s]
[0m02:59:57.043030 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m02:59:57.043030 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m02:59:57.043030 [info ] [Thread-1 (]: 9 of 10 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m02:59:57.043030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m02:59:57.051103 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m02:59:57.054011 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m02:59:57.058012 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m02:59:57.061654 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m02:59:57.065542 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m02:59:57.065542 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS ( 
    SELECT * FROM public.products
    WHERE product_id IS NOT NULL  -- Remove rows where product_id is NULL
      AND product_family IS NOT NULL -- Remove rows where product_family is NULL
)
SELECT 
    product_id,
    COALESCE(TRIM(LOWER(product_family)), 'Unknown') AS product_family_clean -- Handle NULLs
FROM raw
  );
[0m02:59:57.848100 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.786 seconds
[0m02:59:57.848100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2f7b719-3310-44e3-bca1-a003b12cd731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0A667A10>]}
[0m02:59:57.848100 [info ] [Thread-1 (]: 9 of 10 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 0.81s]
[0m02:59:57.859961 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m02:59:57.859961 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m02:59:57.859961 [info ] [Thread-1 (]: 10 of 10 START sql view model PUBLIC.stg_transactions .......................... [RUN]
[0m02:59:57.859961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m02:59:57.863975 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m02:59:57.863975 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m02:59:57.863975 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m02:59:57.863975 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m02:59:57.863975 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m02:59:57.863975 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
    WHERE customer_id IS NOT NULL  
      AND product_id IS NOT NULL  
      AND revenue IS NOT NULL  
      AND payment_month IS NOT NULL  
)
SELECT 
    customer_id,
    product_id,
    CAST(COALESCE(revenue, 0) AS FLOAT) AS revenue,  -- Handle NULL revenue
    TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') AS payment_month_clean  -- Convert VARCHAR to TIMESTAMP
FROM raw
  );
[0m02:59:58.441262 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.567 seconds
[0m02:59:58.441262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2f7b719-3310-44e3-bca1-a003b12cd731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B09FB8E10>]}
[0m02:59:58.441262 [info ] [Thread-1 (]: 10 of 10 OK created sql view model PUBLIC.stg_transactions ..................... [[32mSUCCESS 1[0m in 0.58s]
[0m02:59:58.441262 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m02:59:58.452488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:59:58.452488 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m02:59:58.454507 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m02:59:59.111791 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m02:59:59.111791 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m02:59:59.784197 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m02:59:59.784197 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m03:00:00.418088 [info ] [MainThread]: 
[0m03:00:00.418088 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 14.29 seconds (14.29s).
[0m03:00:00.418088 [debug] [MainThread]: Command end result
[0m03:00:00.469704 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m03:00:00.477584 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m03:00:00.485609 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m03:00:00.492847 [info ] [MainThread]: 
[0m03:00:00.495679 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m03:00:00.497029 [info ] [MainThread]: 
[0m03:00:00.500709 [error] [MainThread]:   Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql
[0m03:00:00.503601 [info ] [MainThread]: 
[0m03:00:00.506755 [error] [MainThread]:   Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 28 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql
[0m03:00:00.510656 [info ] [MainThread]: 
[0m03:00:00.512674 [error] [MainThread]:   Database Error in model new_logos (models\marts\new_logos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 20 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\new_logos.sql
[0m03:00:00.517329 [info ] [MainThread]: 
[0m03:00:00.517329 [error] [MainThread]:   Database Error in model revenue_lost (models\marts\revenue_lost.sql)
  000904 (42000): SQL compilation error: error line 5 at position 4
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\revenue_lost.sql
[0m03:00:00.521045 [info ] [MainThread]: 
[0m03:00:00.521045 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=4 SKIP=0 TOTAL=10
[0m03:00:00.521045 [debug] [MainThread]: Command `dbt run` failed at 03:00:00.521045 after 16.52 seconds
[0m03:00:00.527204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B02E12D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B02E12050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B02E12BD0>]}
[0m03:00:00.527204 [debug] [MainThread]: Flushing usage events
[0m03:00:02.343350 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:00:17.946818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A3F88910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A3F89490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A3F89090>]}


============================== 03:00:17.946818 | 6c9057c3-64d5-4325-96c6-fa0c8ebb6737 ==============================
[0m03:00:17.946818 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:00:17.957333 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:00:18.563387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c9057c3-64d5-4325-96c6-fa0c8ebb6737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A3FB17D0>]}
[0m03:00:18.642699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c9057c3-64d5-4325-96c6-fa0c8ebb6737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A4B5D8D0>]}
[0m03:00:18.642699 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:00:19.265271 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:00:19.517258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m03:00:19.517258 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\net_nrr_grr.sql
[0m03:00:19.517258 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\new_logos.sql
[0m03:00:19.841698 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m03:00:19.851633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c9057c3-64d5-4325-96c6-fa0c8ebb6737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A4E7D3D0>]}
[0m03:00:19.933536 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m03:00:19.936387 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m03:00:19.974322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c9057c3-64d5-4325-96c6-fa0c8ebb6737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A5863650>]}
[0m03:00:19.974322 [info ] [MainThread]: Found 10 models, 474 macros
[0m03:00:19.978893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c9057c3-64d5-4325-96c6-fa0c8ebb6737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A57359D0>]}
[0m03:00:19.981945 [info ] [MainThread]: 
[0m03:00:19.981945 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:00:19.986560 [info ] [MainThread]: 
[0m03:00:19.986560 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:00:19.999370 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m03:00:20.224572 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m03:00:20.240202 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m03:00:20.240858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:00:22.313837 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.073 seconds
[0m03:00:22.321603 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m03:00:22.338037 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m03:00:22.338037 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m03:00:22.342644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:00:24.147303 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.818 seconds
[0m03:00:24.163851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c9057c3-64d5-4325-96c6-fa0c8ebb6737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A53B7390>]}
[0m03:00:24.178736 [debug] [Thread-1 (]: Began running node model.crb_kpi.churned_new_customers
[0m03:00:24.178736 [info ] [Thread-1 (]: 1 of 10 START sql view model PUBLIC.churned_new_customers ...................... [RUN]
[0m03:00:24.181872 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.churned_new_customers'
[0m03:00:24.181872 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.churned_new_customers
[0m03:00:24.197207 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.churned_new_customers"
[0m03:00:24.197207 [debug] [Thread-1 (]: Began executing node model.crb_kpi.churned_new_customers
[0m03:00:24.258173 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.churned_new_customers"
[0m03:00:24.263814 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.churned_new_customers"
[0m03:00:24.263814 [debug] [Thread-1 (]: On model.crb_kpi.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.churned_new_customers"} */
create or replace   view CRBFITNESS.PUBLIC.churned_new_customers
  
   as (
    SELECT 
    customer_id, 
    'new' AS customer_status, 
    MIN(payment_month) AS first_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MIN(payment_month) IS NOT NULL

UNION ALL

SELECT 
    customer_id, 
    'churned' AS customer_status, 
    MAX(payment_month) AS last_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
  );
[0m03:00:24.263814 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:00:26.017553 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb02aa-0004-c152-0005-db4b0001a13a
[0m03:00:26.028939 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 8
invalid identifier 'PAYMENT_MONTH'
[0m03:00:26.036962 [debug] [Thread-1 (]: Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql
[0m03:00:26.039372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c9057c3-64d5-4325-96c6-fa0c8ebb6737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A5EA9D10>]}
[0m03:00:26.039372 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model PUBLIC.churned_new_customers ............. [[31mERROR[0m in 1.86s]
[0m03:00:26.045359 [debug] [Thread-1 (]: Finished running node model.crb_kpi.churned_new_customers
[0m03:00:26.046900 [debug] [Thread-1 (]: Began running node model.crb_kpi.cross_sell_product_churn
[0m03:00:26.046900 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.churned_new_customers' to be skipped because of status 'error'.  Reason: Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql.
[0m03:00:26.046900 [info ] [Thread-1 (]: 2 of 10 START sql view model PUBLIC.cross_sell_product_churn ................... [RUN]
[0m03:00:26.054008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.churned_new_customers, now model.crb_kpi.cross_sell_product_churn)
[0m03:00:26.054008 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.cross_sell_product_churn
[0m03:00:26.054008 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.cross_sell_product_churn"
[0m03:00:26.062070 [debug] [Thread-1 (]: Began executing node model.crb_kpi.cross_sell_product_churn
[0m03:00:26.064167 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.cross_sell_product_churn"
[0m03:00:26.073468 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.cross_sell_product_churn"
[0m03:00:26.073468 [debug] [Thread-1 (]: On model.crb_kpi.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.cross_sell_product_churn"} */
create or replace   view CRBFITNESS.PUBLIC.cross_sell_product_churn
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    p.product_family_clean, 
    COUNT(DISTINCT p.product_family_clean) AS cross_sell_count
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
ORDER BY cross_sell_count DESC
LIMIT 10
  );
[0m03:00:26.821504 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.758 seconds
[0m03:00:26.852706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c9057c3-64d5-4325-96c6-fa0c8ebb6737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A626BD90>]}
[0m03:00:26.852706 [info ] [Thread-1 (]: 2 of 10 OK created sql view model PUBLIC.cross_sell_product_churn .............. [[32mSUCCESS 1[0m in 0.80s]
[0m03:00:26.868533 [debug] [Thread-1 (]: Finished running node model.crb_kpi.cross_sell_product_churn
[0m03:00:26.868533 [debug] [Thread-1 (]: Began running node model.crb_kpi.net_nrr_grr
[0m03:00:26.868533 [info ] [Thread-1 (]: 3 of 10 START sql view model PUBLIC.net_nrr_grr ................................ [RUN]
[0m03:00:26.884088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.cross_sell_product_churn, now model.crb_kpi.net_nrr_grr)
[0m03:00:26.884088 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.net_nrr_grr
[0m03:00:26.886652 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.net_nrr_grr"
[0m03:00:26.889912 [debug] [Thread-1 (]: Began executing node model.crb_kpi.net_nrr_grr
[0m03:00:26.893331 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.net_nrr_grr"
[0m03:00:26.899553 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.net_nrr_grr"
[0m03:00:26.899553 [debug] [Thread-1 (]: On model.crb_kpi.net_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.net_nrr_grr"} */
create or replace   view CRBFITNESS.PUBLIC.net_nrr_grr
  
   as (
    SELECT 
    SUM(CASE 
            WHEN payment_month_clean >= DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END) AS current_revenue,
        
    SUM(CASE 
            WHEN payment_month_clean < DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END) AS previous_revenue,

    (SUM(CASE 
            WHEN payment_month_clean >= DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END) * 1.0 /
     NULLIF(SUM(CASE 
            WHEN payment_month_clean < DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END), 0)) AS NRR,

    (SUM(CASE 
            WHEN payment_month_clean >= DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END) * 1.0 /
     NULLIF(SUM(revenue), 0)) AS GRR
FROM public.stg_transactions
  );
[0m03:00:27.947298 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.058 seconds
[0m03:00:27.962322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c9057c3-64d5-4325-96c6-fa0c8ebb6737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A5EE1C50>]}
[0m03:00:27.962322 [info ] [Thread-1 (]: 3 of 10 OK created sql view model PUBLIC.net_nrr_grr ........................... [[32mSUCCESS 1[0m in 1.08s]
[0m03:00:27.962322 [debug] [Thread-1 (]: Finished running node model.crb_kpi.net_nrr_grr
[0m03:00:27.962322 [debug] [Thread-1 (]: Began running node model.crb_kpi.new_logos
[0m03:00:27.962322 [info ] [Thread-1 (]: 4 of 10 START sql view model PUBLIC.new_logos .................................. [RUN]
[0m03:00:27.962322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.net_nrr_grr, now model.crb_kpi.new_logos)
[0m03:00:27.973737 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.new_logos
[0m03:00:27.978257 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.new_logos"
[0m03:00:27.981056 [debug] [Thread-1 (]: Began executing node model.crb_kpi.new_logos
[0m03:00:27.985330 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.new_logos"
[0m03:00:27.995461 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.new_logos"
[0m03:00:27.998059 [debug] [Thread-1 (]: On model.crb_kpi.new_logos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.new_logos"} */
create or replace   view CRBFITNESS.PUBLIC.new_logos
  
   as (
    SELECT 
    customer_id, 
    MIN(payment_month_clean) AS first_fiscal_year
FROM public.stg_transactions
GROUP BY customer_id
  );
[0m03:00:28.549195 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.557 seconds
[0m03:00:28.549195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c9057c3-64d5-4325-96c6-fa0c8ebb6737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A62C7F90>]}
[0m03:00:28.564704 [info ] [Thread-1 (]: 4 of 10 OK created sql view model PUBLIC.new_logos ............................. [[32mSUCCESS 1[0m in 0.59s]
[0m03:00:28.565924 [debug] [Thread-1 (]: Finished running node model.crb_kpi.new_logos
[0m03:00:28.565924 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_customers
[0m03:00:28.568795 [info ] [Thread-1 (]: 5 of 10 START sql view model PUBLIC.ranked_customers ........................... [RUN]
[0m03:00:28.568795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.new_logos, now model.crb_kpi.ranked_customers)
[0m03:00:28.572083 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_customers
[0m03:00:28.574270 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_customers"
[0m03:00:28.574270 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_customers
[0m03:00:28.585138 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_customers"
[0m03:00:28.585138 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_customers"
[0m03:00:28.585138 [debug] [Thread-1 (]: On model.crb_kpi.ranked_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_customers"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_customers
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
GROUP BY t.customer_id, c.customer_name_clean
ORDER BY total_revenue DESC
  );
[0m03:00:29.288120 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.697 seconds
[0m03:00:29.288120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c9057c3-64d5-4325-96c6-fa0c8ebb6737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A62C4290>]}
[0m03:00:29.288120 [info ] [Thread-1 (]: 5 of 10 OK created sql view model PUBLIC.ranked_customers ...................... [[32mSUCCESS 1[0m in 0.72s]
[0m03:00:29.288120 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_customers
[0m03:00:29.288120 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_products
[0m03:00:29.304114 [info ] [Thread-1 (]: 6 of 10 START sql view model PUBLIC.ranked_products ............................ [RUN]
[0m03:00:29.305127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_customers, now model.crb_kpi.ranked_products)
[0m03:00:29.308297 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_products
[0m03:00:29.312183 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_products"
[0m03:00:29.317732 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_products
[0m03:00:29.319177 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_products"
[0m03:00:29.330669 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_products"
[0m03:00:29.330669 [debug] [Thread-1 (]: On model.crb_kpi.ranked_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_products"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_products
  
   as (
    SELECT 
    p.product_family_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY p.product_family_clean
ORDER BY total_revenue DESC
  );
[0m03:00:29.950455 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m03:00:29.950455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c9057c3-64d5-4325-96c6-fa0c8ebb6737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A530F690>]}
[0m03:00:29.950455 [info ] [Thread-1 (]: 6 of 10 OK created sql view model PUBLIC.ranked_products ....................... [[32mSUCCESS 1[0m in 0.65s]
[0m03:00:29.950455 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_products
[0m03:00:29.966253 [debug] [Thread-1 (]: Began running node model.crb_kpi.revenue_lost
[0m03:00:29.966253 [info ] [Thread-1 (]: 7 of 10 START sql view model PUBLIC.revenue_lost ............................... [RUN]
[0m03:00:29.966253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_products, now model.crb_kpi.revenue_lost)
[0m03:00:29.971503 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.revenue_lost
[0m03:00:29.971503 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.revenue_lost"
[0m03:00:29.971503 [debug] [Thread-1 (]: Began executing node model.crb_kpi.revenue_lost
[0m03:00:29.981929 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.revenue_lost"
[0m03:00:29.986255 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.revenue_lost"
[0m03:00:29.986255 [debug] [Thread-1 (]: On model.crb_kpi.revenue_lost: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.revenue_lost"} */
create or replace   view CRBFITNESS.PUBLIC.revenue_lost
  
   as (
    SELECT 
    t.payment_month AS period, 
    SUM(t.revenue) AS total_revenue_lost
FROM public.stg_transactions t
WHERE t.customer_id IN (
    SELECT customer_id 
    FROM public.stg_transactions 
    GROUP BY customer_id 
    HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
)
GROUP BY t.payment_month
ORDER BY t.payment_month
  );
[0m03:00:30.372809 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb02aa-0004-c144-0005-db4b000186ee
[0m03:00:30.372809 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 4
invalid identifier 'T.PAYMENT_MONTH'
[0m03:00:30.388582 [debug] [Thread-1 (]: Database Error in model revenue_lost (models\marts\revenue_lost.sql)
  000904 (42000): SQL compilation error: error line 5 at position 4
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\revenue_lost.sql
[0m03:00:30.388582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c9057c3-64d5-4325-96c6-fa0c8ebb6737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A5E46490>]}
[0m03:00:30.388582 [error] [Thread-1 (]: 7 of 10 ERROR creating sql view model PUBLIC.revenue_lost ...................... [[31mERROR[0m in 0.42s]
[0m03:00:30.388582 [debug] [Thread-1 (]: Finished running node model.crb_kpi.revenue_lost
[0m03:00:30.388582 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m03:00:30.396102 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.revenue_lost' to be skipped because of status 'error'.  Reason: Database Error in model revenue_lost (models\marts\revenue_lost.sql)
  000904 (42000): SQL compilation error: error line 5 at position 4
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\revenue_lost.sql.
[0m03:00:30.396102 [info ] [Thread-1 (]: 8 of 10 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m03:00:30.396102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.revenue_lost, now model.crb_kpi.stg_customers)
[0m03:00:30.399811 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m03:00:30.399811 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m03:00:30.405768 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m03:00:30.412289 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m03:00:30.414275 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m03:00:30.414275 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
    WHERE customer_id IS NOT NULL  -- Remove rows where customer_id is NULL
      AND customername IS NOT NULL -- Remove rows where customername is NULL
)
SELECT 
    customer_id,
    COALESCE(TRIM(LOWER(customername)), 'Unknown') AS customer_name_clean -- Handle NULLs
FROM raw
  );
[0m03:00:31.439410 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.023 seconds
[0m03:00:31.439410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c9057c3-64d5-4325-96c6-fa0c8ebb6737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A62FBD10>]}
[0m03:00:31.439410 [info ] [Thread-1 (]: 8 of 10 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 1.04s]
[0m03:00:31.439410 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m03:00:31.439410 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m03:00:31.439410 [info ] [Thread-1 (]: 9 of 10 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m03:00:31.455032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m03:00:31.456377 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m03:00:31.456377 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m03:00:31.462839 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m03:00:31.470927 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m03:00:31.475239 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m03:00:31.476449 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS ( 
    SELECT * FROM public.products
    WHERE product_id IS NOT NULL  -- Remove rows where product_id is NULL
      AND product_family IS NOT NULL -- Remove rows where product_family is NULL
)
SELECT 
    product_id,
    COALESCE(TRIM(LOWER(product_family)), 'Unknown') AS product_family_clean -- Handle NULLs
FROM raw
  );
[0m03:00:32.018957 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.551 seconds
[0m03:00:32.034590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c9057c3-64d5-4325-96c6-fa0c8ebb6737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A660B390>]}
[0m03:00:32.034590 [info ] [Thread-1 (]: 9 of 10 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 0.58s]
[0m03:00:32.034590 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m03:00:32.034590 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m03:00:32.034590 [info ] [Thread-1 (]: 10 of 10 START sql view model PUBLIC.stg_transactions .......................... [RUN]
[0m03:00:32.047325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m03:00:32.048855 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m03:00:32.050075 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m03:00:32.050075 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m03:00:32.062682 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m03:00:32.068056 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m03:00:32.068056 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
    WHERE customer_id IS NOT NULL  
      AND product_id IS NOT NULL  
      AND revenue IS NOT NULL  
      AND payment_month IS NOT NULL  
)
SELECT 
    customer_id,
    product_id,
    CAST(COALESCE(revenue, 0) AS FLOAT) AS revenue,  -- Handle NULL revenue
    TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') AS payment_month_clean  -- Convert VARCHAR to TIMESTAMP
FROM raw
  );
[0m03:00:32.645870 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.574 seconds
[0m03:00:32.649114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c9057c3-64d5-4325-96c6-fa0c8ebb6737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A631E450>]}
[0m03:00:32.649114 [info ] [Thread-1 (]: 10 of 10 OK created sql view model PUBLIC.stg_transactions ..................... [[32mSUCCESS 1[0m in 0.61s]
[0m03:00:32.649114 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m03:00:32.655152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:00:32.655152 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m03:00:32.655152 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m03:00:33.291559 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m03:00:33.307186 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m03:00:33.940987 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m03:00:33.940987 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m03:00:34.576585 [info ] [MainThread]: 
[0m03:00:34.576585 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 14.59 seconds (14.59s).
[0m03:00:34.594613 [debug] [MainThread]: Command end result
[0m03:00:34.645972 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m03:00:34.648527 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m03:00:34.655008 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m03:00:34.664107 [info ] [MainThread]: 
[0m03:00:34.664107 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m03:00:34.664107 [info ] [MainThread]: 
[0m03:00:34.664107 [error] [MainThread]:   Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql
[0m03:00:34.664107 [info ] [MainThread]: 
[0m03:00:34.664107 [error] [MainThread]:   Database Error in model revenue_lost (models\marts\revenue_lost.sql)
  000904 (42000): SQL compilation error: error line 5 at position 4
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\revenue_lost.sql
[0m03:00:34.664107 [info ] [MainThread]: 
[0m03:00:34.664107 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
[0m03:00:34.664107 [debug] [MainThread]: Command `dbt run` failed at 03:00:34.664107 after 16.84 seconds
[0m03:00:34.664107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39EA62C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39EAE2E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39EAE2E90>]}
[0m03:00:34.664107 [debug] [MainThread]: Flushing usage events
[0m03:00:36.268606 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:04:32.629179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0E62C85D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0E62C81D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0E6289350>]}


============================== 03:04:32.637205 | ffc299ad-91fe-4b82-9404-c08fb7154238 ==============================
[0m03:04:32.637205 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:04:32.637205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:04:33.266853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffc299ad-91fe-4b82-9404-c08fb7154238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0E70A2390>]}
[0m03:04:33.343405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffc299ad-91fe-4b82-9404-c08fb7154238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0E6F5D750>]}
[0m03:04:33.343405 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:04:33.933929 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:04:34.162693 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m03:04:34.162693 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\net_nrr_grr.sql
[0m03:04:34.172751 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\new_logos.sql
[0m03:04:34.455644 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m03:04:34.461090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffc299ad-91fe-4b82-9404-c08fb7154238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0E7531C90>]}
[0m03:04:34.556464 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m03:04:34.564882 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m03:04:34.597499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffc299ad-91fe-4b82-9404-c08fb7154238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0E79B9190>]}
[0m03:04:34.600201 [info ] [MainThread]: Found 10 models, 474 macros
[0m03:04:34.601462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffc299ad-91fe-4b82-9404-c08fb7154238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0E78B4750>]}
[0m03:04:34.602157 [info ] [MainThread]: 
[0m03:04:34.602157 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:04:34.608423 [info ] [MainThread]: 
[0m03:04:34.611576 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:04:34.613161 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m03:04:34.844493 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m03:04:34.844493 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m03:04:34.848819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:04:37.602009 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.762 seconds
[0m03:04:37.618775 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m03:04:37.633307 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m03:04:37.633307 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m03:04:37.639737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:04:39.570081 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.935 seconds
[0m03:04:39.570081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffc299ad-91fe-4b82-9404-c08fb7154238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0E219D7D0>]}
[0m03:04:39.593543 [debug] [Thread-1 (]: Began running node model.crb_kpi.churned_new_customers
[0m03:04:39.594329 [info ] [Thread-1 (]: 1 of 10 START sql view model PUBLIC.churned_new_customers ...................... [RUN]
[0m03:04:39.597003 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.churned_new_customers'
[0m03:04:39.597003 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.churned_new_customers
[0m03:04:39.606793 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.churned_new_customers"
[0m03:04:39.606793 [debug] [Thread-1 (]: Began executing node model.crb_kpi.churned_new_customers
[0m03:04:39.675782 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.churned_new_customers"
[0m03:04:39.679349 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.churned_new_customers"
[0m03:04:39.679349 [debug] [Thread-1 (]: On model.crb_kpi.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.churned_new_customers"} */
create or replace   view CRBFITNESS.PUBLIC.churned_new_customers
  
   as (
    SELECT 
    customer_id, 
    'new' AS customer_status, 
    MIN(payment_month) AS first_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MIN(payment_month) IS NOT NULL

UNION ALL

SELECT 
    customer_id, 
    'churned' AS customer_status, 
    MAX(payment_month) AS last_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
  );
[0m03:04:39.681861 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:04:41.901140 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb02ae-0004-c152-0005-db4b0001a19e
[0m03:04:41.901140 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 8
invalid identifier 'PAYMENT_MONTH'
[0m03:04:41.903485 [debug] [Thread-1 (]: Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql
[0m03:04:41.909672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffc299ad-91fe-4b82-9404-c08fb7154238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0E753D750>]}
[0m03:04:41.909672 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model PUBLIC.churned_new_customers ............. [[31mERROR[0m in 2.31s]
[0m03:04:41.909672 [debug] [Thread-1 (]: Finished running node model.crb_kpi.churned_new_customers
[0m03:04:41.914186 [debug] [Thread-1 (]: Began running node model.crb_kpi.cross_sell_product_churn
[0m03:04:41.914186 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.churned_new_customers' to be skipped because of status 'error'.  Reason: Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql.
[0m03:04:41.914186 [info ] [Thread-1 (]: 2 of 10 START sql view model PUBLIC.cross_sell_product_churn ................... [RUN]
[0m03:04:41.914186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.churned_new_customers, now model.crb_kpi.cross_sell_product_churn)
[0m03:04:41.914186 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.cross_sell_product_churn
[0m03:04:41.914186 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.cross_sell_product_churn"
[0m03:04:41.914186 [debug] [Thread-1 (]: Began executing node model.crb_kpi.cross_sell_product_churn
[0m03:04:41.914186 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.cross_sell_product_churn"
[0m03:04:41.914186 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.cross_sell_product_churn"
[0m03:04:41.929830 [debug] [Thread-1 (]: On model.crb_kpi.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.cross_sell_product_churn"} */
create or replace   view CRBFITNESS.PUBLIC.cross_sell_product_churn
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    p.product_family_clean, 
    COUNT(DISTINCT p.product_family_clean) AS cross_sell_count
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
ORDER BY cross_sell_count DESC
LIMIT 10
  );
[0m03:04:42.726751 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.797 seconds
[0m03:04:42.771060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffc299ad-91fe-4b82-9404-c08fb7154238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0E4C60A10>]}
[0m03:04:42.771060 [info ] [Thread-1 (]: 2 of 10 OK created sql view model PUBLIC.cross_sell_product_churn .............. [[32mSUCCESS 1[0m in 0.86s]
[0m03:04:42.771060 [debug] [Thread-1 (]: Finished running node model.crb_kpi.cross_sell_product_churn
[0m03:04:42.771060 [debug] [Thread-1 (]: Began running node model.crb_kpi.net_nrr_grr
[0m03:04:42.771060 [info ] [Thread-1 (]: 3 of 10 START sql view model PUBLIC.net_nrr_grr ................................ [RUN]
[0m03:04:42.771060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.cross_sell_product_churn, now model.crb_kpi.net_nrr_grr)
[0m03:04:42.771060 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.net_nrr_grr
[0m03:04:42.786677 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.net_nrr_grr"
[0m03:04:42.788648 [debug] [Thread-1 (]: Began executing node model.crb_kpi.net_nrr_grr
[0m03:04:42.793130 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.net_nrr_grr"
[0m03:04:42.796410 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.net_nrr_grr"
[0m03:04:42.796410 [debug] [Thread-1 (]: On model.crb_kpi.net_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.net_nrr_grr"} */
create or replace   view CRBFITNESS.PUBLIC.net_nrr_grr
  
   as (
    SELECT 
    SUM(CASE 
            WHEN TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') 
                 >= DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END) AS current_revenue,
        
    SUM(CASE 
            WHEN TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') 
                 < DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END) AS previous_revenue,

    (SUM(CASE 
            WHEN TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') 
                 >= DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END) * 1.0 /
     NULLIF(SUM(CASE 
            WHEN TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') 
                 < DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END), 0)) AS NRR,

    (SUM(CASE 
            WHEN TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') 
                 >= DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END) * 1.0 /
     NULLIF(SUM(CASE 
            WHEN TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') 
                 >= DATEADD(YEAR, -1, CURRENT_DATE) 
            THEN revenue ELSE 0 
        END), 0)) AS GRR
FROM public.stg_transactions
  );
[0m03:04:43.188955 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb02ae-0004-bb9d-0005-db4b0001b1be
[0m03:04:43.188955 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 36
invalid identifier 'PAYMENT_MONTH'
[0m03:04:43.196414 [debug] [Thread-1 (]: Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 6 at position 36
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql
[0m03:04:43.196414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffc299ad-91fe-4b82-9404-c08fb7154238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0E80D2990>]}
[0m03:04:43.196414 [error] [Thread-1 (]: 3 of 10 ERROR creating sql view model PUBLIC.net_nrr_grr ....................... [[31mERROR[0m in 0.43s]
[0m03:04:43.205203 [debug] [Thread-1 (]: Finished running node model.crb_kpi.net_nrr_grr
[0m03:04:43.205203 [debug] [Thread-1 (]: Began running node model.crb_kpi.new_logos
[0m03:04:43.205203 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.net_nrr_grr' to be skipped because of status 'error'.  Reason: Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 6 at position 36
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql.
[0m03:04:43.209456 [info ] [Thread-1 (]: 4 of 10 START sql view model PUBLIC.new_logos .................................. [RUN]
[0m03:04:43.211974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.net_nrr_grr, now model.crb_kpi.new_logos)
[0m03:04:43.214615 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.new_logos
[0m03:04:43.216219 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.new_logos"
[0m03:04:43.216219 [debug] [Thread-1 (]: Began executing node model.crb_kpi.new_logos
[0m03:04:43.232735 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.new_logos"
[0m03:04:43.232735 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.new_logos"
[0m03:04:43.237770 [debug] [Thread-1 (]: On model.crb_kpi.new_logos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.new_logos"} */
create or replace   view CRBFITNESS.PUBLIC.new_logos
  
   as (
    SELECT 
    customer_id, 
    MIN(TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM')) AS first_fiscal_year
FROM public.stg_transactions
GROUP BY customer_id
  );
[0m03:04:43.605237 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb02ae-0004-c144-0005-db4b0001872a
[0m03:04:43.605237 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 27
invalid identifier 'PAYMENT_MONTH'
[0m03:04:43.621694 [debug] [Thread-1 (]: Database Error in model new_logos (models\marts\new_logos.sql)
  000904 (42000): SQL compilation error: error line 6 at position 27
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\new_logos.sql
[0m03:04:43.621694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffc299ad-91fe-4b82-9404-c08fb7154238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0E869D250>]}
[0m03:04:43.626517 [error] [Thread-1 (]: 4 of 10 ERROR creating sql view model PUBLIC.new_logos ......................... [[31mERROR[0m in 0.41s]
[0m03:04:43.626517 [debug] [Thread-1 (]: Finished running node model.crb_kpi.new_logos
[0m03:04:43.629276 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_customers
[0m03:04:43.630383 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.new_logos' to be skipped because of status 'error'.  Reason: Database Error in model new_logos (models\marts\new_logos.sql)
  000904 (42000): SQL compilation error: error line 6 at position 27
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\new_logos.sql.
[0m03:04:43.630383 [info ] [Thread-1 (]: 5 of 10 START sql view model PUBLIC.ranked_customers ........................... [RUN]
[0m03:04:43.634904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.new_logos, now model.crb_kpi.ranked_customers)
[0m03:04:43.637534 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_customers
[0m03:04:43.642461 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_customers"
[0m03:04:43.642461 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_customers
[0m03:04:43.654767 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_customers"
[0m03:04:43.654767 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_customers"
[0m03:04:43.658282 [debug] [Thread-1 (]: On model.crb_kpi.ranked_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_customers"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_customers
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
GROUP BY t.customer_id, c.customer_name_clean
ORDER BY total_revenue DESC
  );
[0m03:04:44.364999 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.707 seconds
[0m03:04:44.370078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffc299ad-91fe-4b82-9404-c08fb7154238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0E869FB50>]}
[0m03:04:44.370078 [info ] [Thread-1 (]: 5 of 10 OK created sql view model PUBLIC.ranked_customers ...................... [[32mSUCCESS 1[0m in 0.74s]
[0m03:04:44.370078 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_customers
[0m03:04:44.370078 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_products
[0m03:04:44.370078 [info ] [Thread-1 (]: 6 of 10 START sql view model PUBLIC.ranked_products ............................ [RUN]
[0m03:04:44.370078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_customers, now model.crb_kpi.ranked_products)
[0m03:04:44.382819 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_products
[0m03:04:44.387746 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_products"
[0m03:04:44.389672 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_products
[0m03:04:44.393878 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_products"
[0m03:04:44.397800 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_products"
[0m03:04:44.398392 [debug] [Thread-1 (]: On model.crb_kpi.ranked_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_products"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_products
  
   as (
    SELECT 
    p.product_family_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY p.product_family_clean
ORDER BY total_revenue DESC
  );
[0m03:04:44.977994 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.583 seconds
[0m03:04:44.977994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffc299ad-91fe-4b82-9404-c08fb7154238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0E869F750>]}
[0m03:04:44.977994 [info ] [Thread-1 (]: 6 of 10 OK created sql view model PUBLIC.ranked_products ....................... [[32mSUCCESS 1[0m in 0.61s]
[0m03:04:44.989183 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_products
[0m03:04:44.989183 [debug] [Thread-1 (]: Began running node model.crb_kpi.revenue_lost
[0m03:04:44.989183 [info ] [Thread-1 (]: 7 of 10 START sql view model PUBLIC.revenue_lost ............................... [RUN]
[0m03:04:44.993702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_products, now model.crb_kpi.revenue_lost)
[0m03:04:44.995218 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.revenue_lost
[0m03:04:44.997343 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.revenue_lost"
[0m03:04:44.997343 [debug] [Thread-1 (]: Began executing node model.crb_kpi.revenue_lost
[0m03:04:45.002160 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.revenue_lost"
[0m03:04:45.009678 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.revenue_lost"
[0m03:04:45.009678 [debug] [Thread-1 (]: On model.crb_kpi.revenue_lost: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.revenue_lost"} */
create or replace   view CRBFITNESS.PUBLIC.revenue_lost
  
   as (
    SELECT 
    t.payment_month AS period, 
    SUM(t.revenue) AS total_revenue_lost
FROM public.stg_transactions t
WHERE t.customer_id IN (
    SELECT customer_id 
    FROM public.stg_transactions 
    GROUP BY customer_id 
    HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
)
GROUP BY t.payment_month
ORDER BY t.payment_month
  );
[0m03:04:45.403574 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb02ae-0004-c0bd-0005-db4b000177d6
[0m03:04:45.403574 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 4
invalid identifier 'T.PAYMENT_MONTH'
[0m03:04:45.419602 [debug] [Thread-1 (]: Database Error in model revenue_lost (models\marts\revenue_lost.sql)
  000904 (42000): SQL compilation error: error line 5 at position 4
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\revenue_lost.sql
[0m03:04:45.419602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffc299ad-91fe-4b82-9404-c08fb7154238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0E80FB690>]}
[0m03:04:45.423714 [error] [Thread-1 (]: 7 of 10 ERROR creating sql view model PUBLIC.revenue_lost ...................... [[31mERROR[0m in 0.43s]
[0m03:04:45.423714 [debug] [Thread-1 (]: Finished running node model.crb_kpi.revenue_lost
[0m03:04:45.423714 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m03:04:45.423714 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.revenue_lost' to be skipped because of status 'error'.  Reason: Database Error in model revenue_lost (models\marts\revenue_lost.sql)
  000904 (42000): SQL compilation error: error line 5 at position 4
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\revenue_lost.sql.
[0m03:04:45.429474 [info ] [Thread-1 (]: 8 of 10 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m03:04:45.436942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.revenue_lost, now model.crb_kpi.stg_customers)
[0m03:04:45.439810 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m03:04:45.478486 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m03:04:45.478486 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m03:04:45.499543 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m03:04:45.499543 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m03:04:45.499543 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
    WHERE customer_id IS NOT NULL  -- Remove rows where customer_id is NULL
      AND customername IS NOT NULL -- Remove rows where customername is NULL
)
SELECT 
    customer_id,
    COALESCE(TRIM(LOWER(customername)), 'Unknown') AS customer_name_clean -- Handle NULLs
FROM raw
  );
[0m03:04:46.209682 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.703 seconds
[0m03:04:46.209682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffc299ad-91fe-4b82-9404-c08fb7154238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0E80AA3D0>]}
[0m03:04:46.209682 [info ] [Thread-1 (]: 8 of 10 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 0.77s]
[0m03:04:46.209682 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m03:04:46.218616 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m03:04:46.218616 [info ] [Thread-1 (]: 9 of 10 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m03:04:46.220423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m03:04:46.220423 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m03:04:46.220423 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m03:04:46.225435 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m03:04:46.230543 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m03:04:46.230543 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m03:04:46.230543 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS ( 
    SELECT * FROM public.products
    WHERE product_id IS NOT NULL  -- Remove rows where product_id is NULL
      AND product_family IS NOT NULL -- Remove rows where product_family is NULL
)
SELECT 
    product_id,
    COALESCE(TRIM(LOWER(product_family)), 'Unknown') AS product_family_clean -- Handle NULLs
FROM raw
  );
[0m03:04:46.755127 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.534 seconds
[0m03:04:46.770745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffc299ad-91fe-4b82-9404-c08fb7154238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0E8044FD0>]}
[0m03:04:46.770745 [info ] [Thread-1 (]: 9 of 10 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 0.55s]
[0m03:04:46.777969 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m03:04:46.777969 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m03:04:46.777969 [info ] [Thread-1 (]: 10 of 10 START sql view model PUBLIC.stg_transactions .......................... [RUN]
[0m03:04:46.782859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m03:04:46.783732 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m03:04:46.789314 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m03:04:46.794077 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m03:04:46.795279 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m03:04:46.805585 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m03:04:46.809306 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
    WHERE customer_id IS NOT NULL  
      AND product_id IS NOT NULL  
      AND revenue IS NOT NULL  
      AND payment_month IS NOT NULL  
)
SELECT 
    customer_id,
    product_id,
    CAST(COALESCE(revenue, 0) AS FLOAT) AS revenue,  -- Handle NULL revenue
    TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') AS payment_month_clean  -- Convert VARCHAR to TIMESTAMP
FROM raw
  );
[0m03:04:47.426645 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.629 seconds
[0m03:04:47.442293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffc299ad-91fe-4b82-9404-c08fb7154238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0E86D33D0>]}
[0m03:04:47.442293 [info ] [Thread-1 (]: 10 of 10 OK created sql view model PUBLIC.stg_transactions ..................... [[32mSUCCESS 1[0m in 0.66s]
[0m03:04:47.448502 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m03:04:47.451598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:04:47.451598 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m03:04:47.451598 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m03:04:48.203669 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m03:04:48.203669 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m03:04:48.984185 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m03:04:48.984185 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m03:04:50.004866 [info ] [MainThread]: 
[0m03:04:50.004866 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 15.40 seconds (15.40s).
[0m03:04:50.004866 [debug] [MainThread]: Command end result
[0m03:04:50.060670 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m03:04:50.067970 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m03:04:50.077139 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m03:04:50.083096 [info ] [MainThread]: 
[0m03:04:50.084997 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m03:04:50.086909 [info ] [MainThread]: 
[0m03:04:50.088380 [error] [MainThread]:   Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql
[0m03:04:50.091104 [info ] [MainThread]: 
[0m03:04:50.093048 [error] [MainThread]:   Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 6 at position 36
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql
[0m03:04:50.095488 [info ] [MainThread]: 
[0m03:04:50.096913 [error] [MainThread]:   Database Error in model new_logos (models\marts\new_logos.sql)
  000904 (42000): SQL compilation error: error line 6 at position 27
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\new_logos.sql
[0m03:04:50.101812 [info ] [MainThread]: 
[0m03:04:50.101812 [error] [MainThread]:   Database Error in model revenue_lost (models\marts\revenue_lost.sql)
  000904 (42000): SQL compilation error: error line 5 at position 4
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\revenue_lost.sql
[0m03:04:50.103867 [info ] [MainThread]: 
[0m03:04:50.103867 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=4 SKIP=0 TOTAL=10
[0m03:04:50.109496 [debug] [MainThread]: Command `dbt run` failed at 03:04:50.109496 after 17.62 seconds
[0m03:04:50.111057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0E62E1D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0E8017CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0E5EAEE10>]}
[0m03:04:50.112472 [debug] [MainThread]: Flushing usage events
[0m03:04:51.622458 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:07:21.354306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002359C88C5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002359C8E1F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002359C8E3B10>]}


============================== 03:07:21.354306 | 4d689f5b-3a80-4c5b-93d9-a85e120d031a ==============================
[0m03:07:21.354306 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:07:21.354306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:07:22.101479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d689f5b-3a80-4c5b-93d9-a85e120d031a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002359C22D2D0>]}
[0m03:07:22.184972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d689f5b-3a80-4c5b-93d9-a85e120d031a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002359D45D750>]}
[0m03:07:22.201409 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:07:22.834297 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:07:23.102918 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m03:07:23.102918 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\new_logos.sql
[0m03:07:23.102918 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\net_nrr_grr.sql
[0m03:07:23.484823 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m03:07:23.502335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d689f5b-3a80-4c5b-93d9-a85e120d031a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002359DD553D0>]}
[0m03:07:23.612229 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m03:07:23.617674 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m03:07:23.642367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d689f5b-3a80-4c5b-93d9-a85e120d031a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002359DDFC950>]}
[0m03:07:23.650368 [info ] [MainThread]: Found 10 models, 474 macros
[0m03:07:23.652111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d689f5b-3a80-4c5b-93d9-a85e120d031a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002359D48ED10>]}
[0m03:07:23.652111 [info ] [MainThread]: 
[0m03:07:23.652111 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:07:23.658631 [info ] [MainThread]: 
[0m03:07:23.661127 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:07:23.669141 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m03:07:23.951546 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m03:07:23.951546 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m03:07:23.951546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:07:26.580249 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.632 seconds
[0m03:07:26.597338 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m03:07:26.611853 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m03:07:26.611853 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m03:07:26.620137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:07:28.676670 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 2.060 seconds
[0m03:07:28.685136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d689f5b-3a80-4c5b-93d9-a85e120d031a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002359DCB2F50>]}
[0m03:07:28.693147 [debug] [Thread-1 (]: Began running node model.crb_kpi.churned_new_customers
[0m03:07:28.701579 [info ] [Thread-1 (]: 1 of 10 START sql view model PUBLIC.churned_new_customers ...................... [RUN]
[0m03:07:28.701579 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.churned_new_customers'
[0m03:07:28.701579 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.churned_new_customers
[0m03:07:28.718083 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.churned_new_customers"
[0m03:07:28.720344 [debug] [Thread-1 (]: Began executing node model.crb_kpi.churned_new_customers
[0m03:07:28.770089 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.churned_new_customers"
[0m03:07:28.770089 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.churned_new_customers"
[0m03:07:28.770089 [debug] [Thread-1 (]: On model.crb_kpi.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.churned_new_customers"} */
create or replace   view CRBFITNESS.PUBLIC.churned_new_customers
  
   as (
    SELECT 
    customer_id, 
    'new' AS customer_status, 
    MIN(payment_month) AS first_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MIN(payment_month) IS NOT NULL

UNION ALL

SELECT 
    customer_id, 
    'churned' AS customer_status, 
    MAX(payment_month) AS last_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
  );
[0m03:07:28.770089 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:07:30.670726 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb02b1-0004-c0bd-0005-db4b000177de
[0m03:07:30.680271 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 8
invalid identifier 'PAYMENT_MONTH'
[0m03:07:30.688620 [debug] [Thread-1 (]: Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql
[0m03:07:30.692818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d689f5b-3a80-4c5b-93d9-a85e120d031a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002359D96DA10>]}
[0m03:07:30.692818 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model PUBLIC.churned_new_customers ............. [[31mERROR[0m in 1.99s]
[0m03:07:30.702335 [debug] [Thread-1 (]: Finished running node model.crb_kpi.churned_new_customers
[0m03:07:30.702335 [debug] [Thread-1 (]: Began running node model.crb_kpi.cross_sell_product_churn
[0m03:07:30.702335 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.churned_new_customers' to be skipped because of status 'error'.  Reason: Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql.
[0m03:07:30.708600 [info ] [Thread-1 (]: 2 of 10 START sql view model PUBLIC.cross_sell_product_churn ................... [RUN]
[0m03:07:30.708805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.churned_new_customers, now model.crb_kpi.cross_sell_product_churn)
[0m03:07:30.708805 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.cross_sell_product_churn
[0m03:07:30.721295 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.cross_sell_product_churn"
[0m03:07:30.725754 [debug] [Thread-1 (]: Began executing node model.crb_kpi.cross_sell_product_churn
[0m03:07:30.728726 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.cross_sell_product_churn"
[0m03:07:30.737350 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.cross_sell_product_churn"
[0m03:07:30.738463 [debug] [Thread-1 (]: On model.crb_kpi.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.cross_sell_product_churn"} */
create or replace   view CRBFITNESS.PUBLIC.cross_sell_product_churn
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    p.product_family_clean, 
    COUNT(DISTINCT p.product_family_clean) AS cross_sell_count
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
ORDER BY cross_sell_count DESC
LIMIT 10
  );
[0m03:07:31.586208 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.847 seconds
[0m03:07:31.635387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d689f5b-3a80-4c5b-93d9-a85e120d031a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002359E5EADD0>]}
[0m03:07:31.640694 [info ] [Thread-1 (]: 2 of 10 OK created sql view model PUBLIC.cross_sell_product_churn .............. [[32mSUCCESS 1[0m in 0.93s]
[0m03:07:31.642850 [debug] [Thread-1 (]: Finished running node model.crb_kpi.cross_sell_product_churn
[0m03:07:31.642850 [debug] [Thread-1 (]: Began running node model.crb_kpi.net_nrr_grr
[0m03:07:31.645369 [info ] [Thread-1 (]: 3 of 10 START sql view model PUBLIC.net_nrr_grr ................................ [RUN]
[0m03:07:31.645369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.cross_sell_product_churn, now model.crb_kpi.net_nrr_grr)
[0m03:07:31.645369 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.net_nrr_grr
[0m03:07:31.653534 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.net_nrr_grr"
[0m03:07:31.655487 [debug] [Thread-1 (]: Began executing node model.crb_kpi.net_nrr_grr
[0m03:07:31.659937 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.net_nrr_grr"
[0m03:07:31.673353 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.net_nrr_grr"
[0m03:07:31.673353 [debug] [Thread-1 (]: On model.crb_kpi.net_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.net_nrr_grr"} */
create or replace   view CRBFITNESS.PUBLIC.net_nrr_grr
  
   as (
    SELECT 
    SUM(CASE WHEN payment_month_clean >= DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END) AS current_revenue,
    SUM(CASE WHEN payment_month_clean < DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END) AS previous_revenue,
    (SUM(CASE WHEN payment_month_clean >= DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END) * 1.0 /
     NULLIF(SUM(CASE WHEN payment_month_clean < DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END), 0)) AS NRR,
    (SUM(CASE WHEN payment_month_clean >= DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END) * 1.0 /
     NULLIF(SUM(CASE WHEN payment_month_clean >= DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END), 0)) AS GRR
FROM public.stg_transactions_clean;
[0m03:07:32.037047 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb02b1-0004-c0bd-0005-db4b000177e2
[0m03:07:32.037047 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 34 unexpected ';'.
[0m03:07:32.051538 [debug] [Thread-1 (]: Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 34 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql
[0m03:07:32.051538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d689f5b-3a80-4c5b-93d9-a85e120d031a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002359879D890>]}
[0m03:07:32.051538 [error] [Thread-1 (]: 3 of 10 ERROR creating sql view model PUBLIC.net_nrr_grr ....................... [[31mERROR[0m in 0.41s]
[0m03:07:32.051538 [debug] [Thread-1 (]: Finished running node model.crb_kpi.net_nrr_grr
[0m03:07:32.051538 [debug] [Thread-1 (]: Began running node model.crb_kpi.new_logos
[0m03:07:32.057551 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.net_nrr_grr' to be skipped because of status 'error'.  Reason: Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 34 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql.
[0m03:07:32.059092 [info ] [Thread-1 (]: 4 of 10 START sql view model PUBLIC.new_logos .................................. [RUN]
[0m03:07:32.063732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.net_nrr_grr, now model.crb_kpi.new_logos)
[0m03:07:32.063732 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.new_logos
[0m03:07:32.068130 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.new_logos"
[0m03:07:32.070131 [debug] [Thread-1 (]: Began executing node model.crb_kpi.new_logos
[0m03:07:32.070131 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.new_logos"
[0m03:07:32.070131 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.new_logos"
[0m03:07:32.070131 [debug] [Thread-1 (]: On model.crb_kpi.new_logos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.new_logos"} */
create or replace   view CRBFITNESS.PUBLIC.new_logos
  
   as (
    SELECT 
    customer_id, 
    MIN(payment_month_clean) AS first_fiscal_year
FROM public.stg_transactions_clean
GROUP BY customer_id;
[0m03:07:32.485007 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb02b1-0004-bb9d-0005-db4b0001b1c6
[0m03:07:32.485978 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 20 unexpected ';'.
[0m03:07:32.495010 [debug] [Thread-1 (]: Database Error in model new_logos (models\marts\new_logos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 20 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\new_logos.sql
[0m03:07:32.495010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d689f5b-3a80-4c5b-93d9-a85e120d031a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002359EA58450>]}
[0m03:07:32.495010 [error] [Thread-1 (]: 4 of 10 ERROR creating sql view model PUBLIC.new_logos ......................... [[31mERROR[0m in 0.43s]
[0m03:07:32.495010 [debug] [Thread-1 (]: Finished running node model.crb_kpi.new_logos
[0m03:07:32.502548 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_customers
[0m03:07:32.502548 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.new_logos' to be skipped because of status 'error'.  Reason: Database Error in model new_logos (models\marts\new_logos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 20 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\new_logos.sql.
[0m03:07:32.502548 [info ] [Thread-1 (]: 5 of 10 START sql view model PUBLIC.ranked_customers ........................... [RUN]
[0m03:07:32.502548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.new_logos, now model.crb_kpi.ranked_customers)
[0m03:07:32.502548 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_customers
[0m03:07:32.511072 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_customers"
[0m03:07:32.511072 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_customers
[0m03:07:32.523853 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_customers"
[0m03:07:32.523853 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_customers"
[0m03:07:32.523853 [debug] [Thread-1 (]: On model.crb_kpi.ranked_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_customers"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_customers
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
GROUP BY t.customer_id, c.customer_name_clean
ORDER BY total_revenue DESC
  );
[0m03:07:33.128218 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.596 seconds
[0m03:07:33.140522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d689f5b-3a80-4c5b-93d9-a85e120d031a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002359EACCA90>]}
[0m03:07:33.140522 [info ] [Thread-1 (]: 5 of 10 OK created sql view model PUBLIC.ranked_customers ...................... [[32mSUCCESS 1[0m in 0.64s]
[0m03:07:33.140522 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_customers
[0m03:07:33.140522 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_products
[0m03:07:33.140522 [info ] [Thread-1 (]: 6 of 10 START sql view model PUBLIC.ranked_products ............................ [RUN]
[0m03:07:33.151681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_customers, now model.crb_kpi.ranked_products)
[0m03:07:33.156106 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_products
[0m03:07:33.161720 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_products"
[0m03:07:33.162133 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_products
[0m03:07:33.169492 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_products"
[0m03:07:33.173860 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_products"
[0m03:07:33.175315 [debug] [Thread-1 (]: On model.crb_kpi.ranked_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_products"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_products
  
   as (
    SELECT 
    p.product_family_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY p.product_family_clean
ORDER BY total_revenue DESC
  );
[0m03:07:33.786413 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.616 seconds
[0m03:07:33.798999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d689f5b-3a80-4c5b-93d9-a85e120d031a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002359EA84710>]}
[0m03:07:33.798999 [info ] [Thread-1 (]: 6 of 10 OK created sql view model PUBLIC.ranked_products ....................... [[32mSUCCESS 1[0m in 0.66s]
[0m03:07:33.802205 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_products
[0m03:07:33.802205 [debug] [Thread-1 (]: Began running node model.crb_kpi.revenue_lost
[0m03:07:33.802205 [info ] [Thread-1 (]: 7 of 10 START sql view model PUBLIC.revenue_lost ............................... [RUN]
[0m03:07:33.808428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_products, now model.crb_kpi.revenue_lost)
[0m03:07:33.808428 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.revenue_lost
[0m03:07:33.808428 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.revenue_lost"
[0m03:07:33.820222 [debug] [Thread-1 (]: Began executing node model.crb_kpi.revenue_lost
[0m03:07:33.826558 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.revenue_lost"
[0m03:07:33.826558 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.revenue_lost"
[0m03:07:33.834577 [debug] [Thread-1 (]: On model.crb_kpi.revenue_lost: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.revenue_lost"} */
create or replace   view CRBFITNESS.PUBLIC.revenue_lost
  
   as (
    SELECT 
    t.payment_month AS period, 
    SUM(t.revenue) AS total_revenue_lost
FROM public.stg_transactions t
WHERE t.customer_id IN (
    SELECT customer_id 
    FROM public.stg_transactions 
    GROUP BY customer_id 
    HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
)
GROUP BY t.payment_month
ORDER BY t.payment_month
  );
[0m03:07:34.239295 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb02b1-0004-c152-0005-db4b0001a1ae
[0m03:07:34.239295 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 4
invalid identifier 'T.PAYMENT_MONTH'
[0m03:07:34.255018 [debug] [Thread-1 (]: Database Error in model revenue_lost (models\marts\revenue_lost.sql)
  000904 (42000): SQL compilation error: error line 5 at position 4
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\revenue_lost.sql
[0m03:07:34.255018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d689f5b-3a80-4c5b-93d9-a85e120d031a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002359EA58690>]}
[0m03:07:34.260949 [error] [Thread-1 (]: 7 of 10 ERROR creating sql view model PUBLIC.revenue_lost ...................... [[31mERROR[0m in 0.45s]
[0m03:07:34.260949 [debug] [Thread-1 (]: Finished running node model.crb_kpi.revenue_lost
[0m03:07:34.260949 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m03:07:34.260949 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.revenue_lost' to be skipped because of status 'error'.  Reason: Database Error in model revenue_lost (models\marts\revenue_lost.sql)
  000904 (42000): SQL compilation error: error line 5 at position 4
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\revenue_lost.sql.
[0m03:07:34.266410 [info ] [Thread-1 (]: 8 of 10 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m03:07:34.266410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.revenue_lost, now model.crb_kpi.stg_customers)
[0m03:07:34.266410 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m03:07:34.274348 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m03:07:34.277405 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m03:07:34.288353 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m03:07:34.293444 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m03:07:34.294935 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
    WHERE customer_id IS NOT NULL  -- Remove rows where customer_id is NULL
      AND customername IS NOT NULL -- Remove rows where customername is NULL
)
SELECT 
    customer_id,
    COALESCE(TRIM(LOWER(customername)), 'Unknown') AS customer_name_clean -- Handle NULLs
FROM raw
  );
[0m03:07:34.855170 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.560 seconds
[0m03:07:34.861869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d689f5b-3a80-4c5b-93d9-a85e120d031a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002359EAA3D90>]}
[0m03:07:34.866397 [info ] [Thread-1 (]: 8 of 10 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 0.60s]
[0m03:07:34.871755 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m03:07:34.873195 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m03:07:34.873977 [info ] [Thread-1 (]: 9 of 10 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m03:07:34.875660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m03:07:34.875660 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m03:07:34.881706 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m03:07:34.885473 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m03:07:34.889999 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m03:07:34.894988 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m03:07:34.898940 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS ( 
    SELECT * FROM public.products
    WHERE product_id IS NOT NULL  -- Remove rows where product_id is NULL
      AND product_family IS NOT NULL -- Remove rows where product_family is NULL
)
SELECT 
    product_id,
    COALESCE(TRIM(LOWER(product_family)), 'Unknown') AS product_family_clean -- Handle NULLs
FROM raw
  );
[0m03:07:35.455162 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.559 seconds
[0m03:07:35.455162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d689f5b-3a80-4c5b-93d9-a85e120d031a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002359E5EB4D0>]}
[0m03:07:35.467682 [info ] [Thread-1 (]: 9 of 10 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 0.58s]
[0m03:07:35.469793 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m03:07:35.469793 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m03:07:35.474013 [info ] [Thread-1 (]: 10 of 10 START sql view model PUBLIC.stg_transactions .......................... [RUN]
[0m03:07:35.475316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m03:07:35.475316 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m03:07:35.480680 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m03:07:35.482810 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m03:07:35.486349 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m03:07:35.494575 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m03:07:35.495689 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
    WHERE customer_id IS NOT NULL  
      AND product_id IS NOT NULL  
      AND revenue IS NOT NULL  
      AND payment_month IS NOT NULL  
)
SELECT 
    customer_id,
    product_id,
    CAST(COALESCE(revenue, 0) AS FLOAT) AS revenue,  -- Handle NULL revenue
    TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') AS payment_month_clean  -- Convert VARCHAR to TIMESTAMP
FROM raw
  );
[0m03:07:36.137471 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.641 seconds
[0m03:07:36.145512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d689f5b-3a80-4c5b-93d9-a85e120d031a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002359EB17110>]}
[0m03:07:36.145512 [info ] [Thread-1 (]: 10 of 10 OK created sql view model PUBLIC.stg_transactions ..................... [[32mSUCCESS 1[0m in 0.67s]
[0m03:07:36.152532 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m03:07:36.161457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:07:36.162563 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m03:07:36.162563 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m03:07:37.119855 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m03:07:37.134383 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m03:07:37.826266 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m03:07:37.834759 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m03:07:39.269540 [info ] [MainThread]: 
[0m03:07:39.270751 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 15.60 seconds (15.60s).
[0m03:07:39.278042 [debug] [MainThread]: Command end result
[0m03:07:39.327804 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m03:07:39.336515 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m03:07:39.352831 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m03:07:39.353937 [info ] [MainThread]: 
[0m03:07:39.354966 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m03:07:39.356146 [info ] [MainThread]: 
[0m03:07:39.356146 [error] [MainThread]:   Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql
[0m03:07:39.360278 [info ] [MainThread]: 
[0m03:07:39.360278 [error] [MainThread]:   Database Error in model net_nrr_grr (models\marts\net_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 34 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\net_nrr_grr.sql
[0m03:07:39.362235 [info ] [MainThread]: 
[0m03:07:39.362235 [error] [MainThread]:   Database Error in model new_logos (models\marts\new_logos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 20 unexpected ';'.
  compiled code at target\run\crb_kpi\models\marts\new_logos.sql
[0m03:07:39.365283 [info ] [MainThread]: 
[0m03:07:39.365283 [error] [MainThread]:   Database Error in model revenue_lost (models\marts\revenue_lost.sql)
  000904 (42000): SQL compilation error: error line 5 at position 4
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\revenue_lost.sql
[0m03:07:39.368292 [info ] [MainThread]: 
[0m03:07:39.369462 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=4 SKIP=0 TOTAL=10
[0m03:07:39.369462 [debug] [MainThread]: Command `dbt run` failed at 03:07:39.369462 after 18.13 seconds
[0m03:07:39.369462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002359DE87A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023597261FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023597262050>]}
[0m03:07:39.369462 [debug] [MainThread]: Flushing usage events
[0m03:07:40.998280 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:07:59.526819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F62CB8C050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F62CBC81D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F62CB8D8D0>]}


============================== 03:07:59.542911 | fc631e89-770a-4c8d-a8b0-b82aa2015387 ==============================
[0m03:07:59.542911 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:07:59.542911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:08:00.141749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc631e89-770a-4c8d-a8b0-b82aa2015387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F62CE0DE90>]}
[0m03:08:00.221109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc631e89-770a-4c8d-a8b0-b82aa2015387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F62B56D4D0>]}
[0m03:08:00.221109 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:08:00.810630 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:08:01.048041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m03:08:01.057232 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\new_logos.sql
[0m03:08:01.057232 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\net_nrr_grr.sql
[0m03:08:01.360547 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m03:08:01.365761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc631e89-770a-4c8d-a8b0-b82aa2015387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F62E32B390>]}
[0m03:08:01.458808 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m03:08:01.466832 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m03:08:01.503119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc631e89-770a-4c8d-a8b0-b82aa2015387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F62E463690>]}
[0m03:08:01.503789 [info ] [MainThread]: Found 10 models, 474 macros
[0m03:08:01.506124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc631e89-770a-4c8d-a8b0-b82aa2015387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F62E2C2250>]}
[0m03:08:01.507053 [info ] [MainThread]: 
[0m03:08:01.512525 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:08:01.514822 [info ] [MainThread]: 
[0m03:08:01.517399 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:08:01.521557 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m03:08:01.748672 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m03:08:01.748672 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m03:08:01.760559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:08:04.146375 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.390 seconds
[0m03:08:04.156897 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m03:08:04.168367 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m03:08:04.168367 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m03:08:04.176735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:08:06.088023 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.920 seconds
[0m03:08:06.104156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc631e89-770a-4c8d-a8b0-b82aa2015387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F62DAAFA10>]}
[0m03:08:06.114328 [debug] [Thread-1 (]: Began running node model.crb_kpi.churned_new_customers
[0m03:08:06.114328 [info ] [Thread-1 (]: 1 of 10 START sql view model PUBLIC.churned_new_customers ...................... [RUN]
[0m03:08:06.117876 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.churned_new_customers'
[0m03:08:06.119891 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.churned_new_customers
[0m03:08:06.119891 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.churned_new_customers"
[0m03:08:06.119891 [debug] [Thread-1 (]: Began executing node model.crb_kpi.churned_new_customers
[0m03:08:06.183048 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.churned_new_customers"
[0m03:08:06.188055 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.churned_new_customers"
[0m03:08:06.188055 [debug] [Thread-1 (]: On model.crb_kpi.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.churned_new_customers"} */
create or replace   view CRBFITNESS.PUBLIC.churned_new_customers
  
   as (
    SELECT 
    customer_id, 
    'new' AS customer_status, 
    MIN(payment_month) AS first_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MIN(payment_month) IS NOT NULL

UNION ALL

SELECT 
    customer_id, 
    'churned' AS customer_status, 
    MAX(payment_month) AS last_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
  );
[0m03:08:06.188055 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:08:08.014890 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb02b2-0004-c178-0005-db4b000196ae
[0m03:08:08.014890 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 8
invalid identifier 'PAYMENT_MONTH'
[0m03:08:08.031544 [debug] [Thread-1 (]: Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql
[0m03:08:08.035411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc631e89-770a-4c8d-a8b0-b82aa2015387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F62EA58B50>]}
[0m03:08:08.035411 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model PUBLIC.churned_new_customers ............. [[31mERROR[0m in 1.91s]
[0m03:08:08.035411 [debug] [Thread-1 (]: Finished running node model.crb_kpi.churned_new_customers
[0m03:08:08.035411 [debug] [Thread-1 (]: Began running node model.crb_kpi.cross_sell_product_churn
[0m03:08:08.035411 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.churned_new_customers' to be skipped because of status 'error'.  Reason: Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql.
[0m03:08:08.043673 [info ] [Thread-1 (]: 2 of 10 START sql view model PUBLIC.cross_sell_product_churn ................... [RUN]
[0m03:08:08.046311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.churned_new_customers, now model.crb_kpi.cross_sell_product_churn)
[0m03:08:08.047574 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.cross_sell_product_churn
[0m03:08:08.051047 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.cross_sell_product_churn"
[0m03:08:08.051047 [debug] [Thread-1 (]: Began executing node model.crb_kpi.cross_sell_product_churn
[0m03:08:08.057086 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.cross_sell_product_churn"
[0m03:08:08.057086 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.cross_sell_product_churn"
[0m03:08:08.057086 [debug] [Thread-1 (]: On model.crb_kpi.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.cross_sell_product_churn"} */
create or replace   view CRBFITNESS.PUBLIC.cross_sell_product_churn
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    p.product_family_clean, 
    COUNT(DISTINCT p.product_family_clean) AS cross_sell_count
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
ORDER BY cross_sell_count DESC
LIMIT 10
  );
[0m03:08:08.692726 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.638 seconds
[0m03:08:08.739550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc631e89-770a-4c8d-a8b0-b82aa2015387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F62EAA0F10>]}
[0m03:08:08.739550 [info ] [Thread-1 (]: 2 of 10 OK created sql view model PUBLIC.cross_sell_product_churn .............. [[32mSUCCESS 1[0m in 0.69s]
[0m03:08:08.739550 [debug] [Thread-1 (]: Finished running node model.crb_kpi.cross_sell_product_churn
[0m03:08:08.739550 [debug] [Thread-1 (]: Began running node model.crb_kpi.net_nrr_grr
[0m03:08:08.739550 [info ] [Thread-1 (]: 3 of 10 START sql view model PUBLIC.net_nrr_grr ................................ [RUN]
[0m03:08:08.755168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.cross_sell_product_churn, now model.crb_kpi.net_nrr_grr)
[0m03:08:08.755168 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.net_nrr_grr
[0m03:08:08.757253 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.net_nrr_grr"
[0m03:08:08.761966 [debug] [Thread-1 (]: Began executing node model.crb_kpi.net_nrr_grr
[0m03:08:08.762512 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.net_nrr_grr"
[0m03:08:08.768975 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.net_nrr_grr"
[0m03:08:08.772698 [debug] [Thread-1 (]: On model.crb_kpi.net_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.net_nrr_grr"} */
create or replace   view CRBFITNESS.PUBLIC.net_nrr_grr
  
   as (
    SELECT 
    SUM(CASE WHEN payment_month_clean >= DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END) AS current_revenue,
    SUM(CASE WHEN payment_month_clean < DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END) AS previous_revenue,
    (SUM(CASE WHEN payment_month_clean >= DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END) * 1.0 /
     NULLIF(SUM(CASE WHEN payment_month_clean < DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END), 0)) AS NRR,
    (SUM(CASE WHEN payment_month_clean >= DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END) * 1.0 /
     NULLIF(SUM(CASE WHEN payment_month_clean >= DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END), 0)) AS GRR
FROM public.stg_transactions
  );
[0m03:08:09.373986 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.612 seconds
[0m03:08:09.389708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc631e89-770a-4c8d-a8b0-b82aa2015387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F62EE5C1D0>]}
[0m03:08:09.389708 [info ] [Thread-1 (]: 3 of 10 OK created sql view model PUBLIC.net_nrr_grr ........................... [[32mSUCCESS 1[0m in 0.63s]
[0m03:08:09.397014 [debug] [Thread-1 (]: Finished running node model.crb_kpi.net_nrr_grr
[0m03:08:09.397014 [debug] [Thread-1 (]: Began running node model.crb_kpi.new_logos
[0m03:08:09.397014 [info ] [Thread-1 (]: 4 of 10 START sql view model PUBLIC.new_logos .................................. [RUN]
[0m03:08:09.397014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.net_nrr_grr, now model.crb_kpi.new_logos)
[0m03:08:09.403774 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.new_logos
[0m03:08:09.405797 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.new_logos"
[0m03:08:09.405797 [debug] [Thread-1 (]: Began executing node model.crb_kpi.new_logos
[0m03:08:09.405797 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.new_logos"
[0m03:08:09.405797 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.new_logos"
[0m03:08:09.405797 [debug] [Thread-1 (]: On model.crb_kpi.new_logos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.new_logos"} */
create or replace   view CRBFITNESS.PUBLIC.new_logos
  
   as (
    SELECT 
    customer_id, 
    MIN(payment_month_clean) AS first_fiscal_year
FROM public.stg_transactions
GROUP BY customer_id
  );
[0m03:08:10.382621 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.975 seconds
[0m03:08:10.398739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc631e89-770a-4c8d-a8b0-b82aa2015387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F62EAD9C90>]}
[0m03:08:10.398739 [info ] [Thread-1 (]: 4 of 10 OK created sql view model PUBLIC.new_logos ............................. [[32mSUCCESS 1[0m in 1.00s]
[0m03:08:10.404048 [debug] [Thread-1 (]: Finished running node model.crb_kpi.new_logos
[0m03:08:10.404048 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_customers
[0m03:08:10.404048 [info ] [Thread-1 (]: 5 of 10 START sql view model PUBLIC.ranked_customers ........................... [RUN]
[0m03:08:10.404048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.new_logos, now model.crb_kpi.ranked_customers)
[0m03:08:10.411496 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_customers
[0m03:08:10.414545 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_customers"
[0m03:08:10.417372 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_customers
[0m03:08:10.422997 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_customers"
[0m03:08:10.428521 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_customers"
[0m03:08:10.428521 [debug] [Thread-1 (]: On model.crb_kpi.ranked_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_customers"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_customers
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
GROUP BY t.customer_id, c.customer_name_clean
ORDER BY total_revenue DESC
  );
[0m03:08:11.104229 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.680 seconds
[0m03:08:11.104229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc631e89-770a-4c8d-a8b0-b82aa2015387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F62EEBFCD0>]}
[0m03:08:11.104229 [info ] [Thread-1 (]: 5 of 10 OK created sql view model PUBLIC.ranked_customers ...................... [[32mSUCCESS 1[0m in 0.70s]
[0m03:08:11.104229 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_customers
[0m03:08:11.119859 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_products
[0m03:08:11.121127 [info ] [Thread-1 (]: 6 of 10 START sql view model PUBLIC.ranked_products ............................ [RUN]
[0m03:08:11.121127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_customers, now model.crb_kpi.ranked_products)
[0m03:08:11.121127 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_products
[0m03:08:11.121127 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_products"
[0m03:08:11.121127 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_products
[0m03:08:11.121127 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_products"
[0m03:08:11.137616 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_products"
[0m03:08:11.138566 [debug] [Thread-1 (]: On model.crb_kpi.ranked_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_products"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_products
  
   as (
    SELECT 
    p.product_family_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY p.product_family_clean
ORDER BY total_revenue DESC
  );
[0m03:08:11.828017 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.688 seconds
[0m03:08:11.830979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc631e89-770a-4c8d-a8b0-b82aa2015387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F62EEBFCD0>]}
[0m03:08:11.830979 [info ] [Thread-1 (]: 6 of 10 OK created sql view model PUBLIC.ranked_products ....................... [[32mSUCCESS 1[0m in 0.71s]
[0m03:08:11.830979 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_products
[0m03:08:11.830979 [debug] [Thread-1 (]: Began running node model.crb_kpi.revenue_lost
[0m03:08:11.830979 [info ] [Thread-1 (]: 7 of 10 START sql view model PUBLIC.revenue_lost ............................... [RUN]
[0m03:08:11.837444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_products, now model.crb_kpi.revenue_lost)
[0m03:08:11.837444 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.revenue_lost
[0m03:08:11.841371 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.revenue_lost"
[0m03:08:11.843858 [debug] [Thread-1 (]: Began executing node model.crb_kpi.revenue_lost
[0m03:08:11.843858 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.revenue_lost"
[0m03:08:11.850052 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.revenue_lost"
[0m03:08:11.850052 [debug] [Thread-1 (]: On model.crb_kpi.revenue_lost: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.revenue_lost"} */
create or replace   view CRBFITNESS.PUBLIC.revenue_lost
  
   as (
    SELECT 
    t.payment_month AS period, 
    SUM(t.revenue) AS total_revenue_lost
FROM public.stg_transactions t
WHERE t.customer_id IN (
    SELECT customer_id 
    FROM public.stg_transactions 
    GROUP BY customer_id 
    HAVING MAX(payment_month) < DATEADD(MONTH, -6, CURRENT_DATE)
)
GROUP BY t.payment_month
ORDER BY t.payment_month
  );
[0m03:08:12.264376 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb02b2-0004-c0bd-0005-db4b000177f2
[0m03:08:12.264376 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 4
invalid identifier 'T.PAYMENT_MONTH'
[0m03:08:12.280451 [debug] [Thread-1 (]: Database Error in model revenue_lost (models\marts\revenue_lost.sql)
  000904 (42000): SQL compilation error: error line 5 at position 4
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\revenue_lost.sql
[0m03:08:12.280451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc631e89-770a-4c8d-a8b0-b82aa2015387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F62DF0F4D0>]}
[0m03:08:12.285984 [error] [Thread-1 (]: 7 of 10 ERROR creating sql view model PUBLIC.revenue_lost ...................... [[31mERROR[0m in 0.44s]
[0m03:08:12.287322 [debug] [Thread-1 (]: Finished running node model.crb_kpi.revenue_lost
[0m03:08:12.287322 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m03:08:12.287322 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.revenue_lost' to be skipped because of status 'error'.  Reason: Database Error in model revenue_lost (models\marts\revenue_lost.sql)
  000904 (42000): SQL compilation error: error line 5 at position 4
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\revenue_lost.sql.
[0m03:08:12.290826 [info ] [Thread-1 (]: 8 of 10 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m03:08:12.290826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.revenue_lost, now model.crb_kpi.stg_customers)
[0m03:08:12.294278 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m03:08:12.295830 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m03:08:12.297822 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m03:08:12.303606 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m03:08:12.306100 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m03:08:12.306100 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
    WHERE customer_id IS NOT NULL  -- Remove rows where customer_id is NULL
      AND customername IS NOT NULL -- Remove rows where customername is NULL
)
SELECT 
    customer_id,
    COALESCE(TRIM(LOWER(customername)), 'Unknown') AS customer_name_clean -- Handle NULLs
FROM raw
  );
[0m03:08:12.851833 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.544 seconds
[0m03:08:12.851833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc631e89-770a-4c8d-a8b0-b82aa2015387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F62EAB1AD0>]}
[0m03:08:12.851833 [info ] [Thread-1 (]: 8 of 10 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 0.56s]
[0m03:08:12.851833 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m03:08:12.851833 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m03:08:12.851833 [info ] [Thread-1 (]: 9 of 10 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m03:08:12.851833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m03:08:12.851833 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m03:08:12.851833 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m03:08:12.866389 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m03:08:12.870555 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m03:08:12.870555 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m03:08:12.870555 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS ( 
    SELECT * FROM public.products
    WHERE product_id IS NOT NULL  -- Remove rows where product_id is NULL
      AND product_family IS NOT NULL -- Remove rows where product_family is NULL
)
SELECT 
    product_id,
    COALESCE(TRIM(LOWER(product_family)), 'Unknown') AS product_family_clean -- Handle NULLs
FROM raw
  );
[0m03:08:13.455872 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.591 seconds
[0m03:08:13.469338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc631e89-770a-4c8d-a8b0-b82aa2015387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F62DFD4750>]}
[0m03:08:13.471856 [info ] [Thread-1 (]: 9 of 10 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 0.62s]
[0m03:08:13.471856 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m03:08:13.474743 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m03:08:13.474743 [info ] [Thread-1 (]: 10 of 10 START sql view model PUBLIC.stg_transactions .......................... [RUN]
[0m03:08:13.474743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m03:08:13.474743 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m03:08:13.474743 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m03:08:13.474743 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m03:08:13.490099 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m03:08:13.493021 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m03:08:13.493021 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
    WHERE customer_id IS NOT NULL  
      AND product_id IS NOT NULL  
      AND revenue IS NOT NULL  
      AND payment_month IS NOT NULL  
)
SELECT 
    customer_id,
    product_id,
    CAST(COALESCE(revenue, 0) AS FLOAT) AS revenue,  -- Handle NULL revenue
    TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') AS payment_month_clean  -- Convert VARCHAR to TIMESTAMP
FROM raw
  );
[0m03:08:14.069559 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.583 seconds
[0m03:08:14.085195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc631e89-770a-4c8d-a8b0-b82aa2015387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F62F204790>]}
[0m03:08:14.085195 [info ] [Thread-1 (]: 10 of 10 OK created sql view model PUBLIC.stg_transactions ..................... [[32mSUCCESS 1[0m in 0.59s]
[0m03:08:14.089544 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m03:08:14.091756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:08:14.091756 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m03:08:14.091756 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m03:08:14.986106 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m03:08:14.986106 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m03:08:15.645867 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m03:08:15.645867 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m03:08:16.343537 [info ] [MainThread]: 
[0m03:08:16.343537 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 14.83 seconds (14.83s).
[0m03:08:16.362098 [debug] [MainThread]: Command end result
[0m03:08:16.406836 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m03:08:16.406836 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m03:08:16.428554 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m03:08:16.428554 [info ] [MainThread]: 
[0m03:08:16.428554 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m03:08:16.428554 [info ] [MainThread]: 
[0m03:08:16.428554 [error] [MainThread]:   Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql
[0m03:08:16.428554 [info ] [MainThread]: 
[0m03:08:16.437804 [error] [MainThread]:   Database Error in model revenue_lost (models\marts\revenue_lost.sql)
  000904 (42000): SQL compilation error: error line 5 at position 4
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\revenue_lost.sql
[0m03:08:16.439902 [info ] [MainThread]: 
[0m03:08:16.439902 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
[0m03:08:16.439902 [debug] [MainThread]: Command `dbt run` failed at 03:08:16.439902 after 17.03 seconds
[0m03:08:16.439902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F627662BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F627662010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F627662D10>]}
[0m03:08:16.439902 [debug] [MainThread]: Flushing usage events
[0m03:08:17.971432 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:10:04.011931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ABC48A2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ABC0AE850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ABC4E2890>]}


============================== 03:10:04.019907 | 0ef271f7-eb11-4f2b-8428-8e76de65b178 ==============================
[0m03:10:04.019907 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:10:04.019907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m03:10:04.597325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ef271f7-eb11-4f2b-8428-8e76de65b178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ABC4B1A10>]}
[0m03:10:04.679450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ef271f7-eb11-4f2b-8428-8e76de65b178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ABCE6D910>]}
[0m03:10:04.687356 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:10:05.299889 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:10:05.536991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m03:10:05.536991 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\churned_new_customers.sql
[0m03:10:05.536991 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\revenue_lost.sql
[0m03:10:05.863196 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m03:10:05.865711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ef271f7-eb11-4f2b-8428-8e76de65b178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ABDB35C90>]}
[0m03:10:05.964909 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m03:10:05.973686 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m03:10:06.004208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ef271f7-eb11-4f2b-8428-8e76de65b178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ABDBB7810>]}
[0m03:10:06.004966 [info ] [MainThread]: Found 10 models, 474 macros
[0m03:10:06.006817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ef271f7-eb11-4f2b-8428-8e76de65b178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ABDA57CD0>]}
[0m03:10:06.008874 [info ] [MainThread]: 
[0m03:10:06.012758 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:10:06.016137 [info ] [MainThread]: 
[0m03:10:06.020630 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:10:06.028603 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m03:10:06.240104 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m03:10:06.240104 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m03:10:06.250309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:10:08.583141 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.347 seconds
[0m03:10:08.604601 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m03:10:08.614638 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m03:10:08.614638 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m03:10:08.624781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:10:10.712127 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 2.091 seconds
[0m03:10:10.712127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ef271f7-eb11-4f2b-8428-8e76de65b178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ABE28BC90>]}
[0m03:10:10.731551 [debug] [Thread-1 (]: Began running node model.crb_kpi.churned_new_customers
[0m03:10:10.731551 [info ] [Thread-1 (]: 1 of 10 START sql view model PUBLIC.churned_new_customers ...................... [RUN]
[0m03:10:10.731551 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.churned_new_customers'
[0m03:10:10.731551 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.churned_new_customers
[0m03:10:10.747376 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.churned_new_customers"
[0m03:10:10.757894 [debug] [Thread-1 (]: Began executing node model.crb_kpi.churned_new_customers
[0m03:10:10.813320 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.churned_new_customers"
[0m03:10:10.822799 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.churned_new_customers"
[0m03:10:10.822799 [debug] [Thread-1 (]: On model.crb_kpi.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.churned_new_customers"} */
create or replace   view CRBFITNESS.PUBLIC.churned_new_customers
  
   as (
    SELECT 
    customer_id, 
    'new' AS customer_status, 
    MIN(payment_month) AS first_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MIN(payment_month_clean) IS NOT NULL

UNION ALL

SELECT 
    customer_id, 
    'churned' AS customer_status, 
    MAX(payment_month_clean) AS last_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MAX(payment_month_clean) < DATEADD(MONTH, -6, CURRENT_DATE)
  );
[0m03:10:10.822799 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:10:12.983913 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb02b4-0004-c144-0005-db4b00018742
[0m03:10:12.983913 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 8
invalid identifier 'PAYMENT_MONTH'
[0m03:10:12.990731 [debug] [Thread-1 (]: Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql
[0m03:10:12.997053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ef271f7-eb11-4f2b-8428-8e76de65b178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ABD70D650>]}
[0m03:10:12.997053 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model PUBLIC.churned_new_customers ............. [[31mERROR[0m in 2.26s]
[0m03:10:12.997053 [debug] [Thread-1 (]: Finished running node model.crb_kpi.churned_new_customers
[0m03:10:12.997053 [debug] [Thread-1 (]: Began running node model.crb_kpi.cross_sell_product_churn
[0m03:10:12.997053 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.churned_new_customers' to be skipped because of status 'error'.  Reason: Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql.
[0m03:10:13.005328 [info ] [Thread-1 (]: 2 of 10 START sql view model PUBLIC.cross_sell_product_churn ................... [RUN]
[0m03:10:13.011181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.churned_new_customers, now model.crb_kpi.cross_sell_product_churn)
[0m03:10:13.012961 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.cross_sell_product_churn
[0m03:10:13.014851 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.cross_sell_product_churn"
[0m03:10:13.014851 [debug] [Thread-1 (]: Began executing node model.crb_kpi.cross_sell_product_churn
[0m03:10:13.030585 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.cross_sell_product_churn"
[0m03:10:13.030585 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.cross_sell_product_churn"
[0m03:10:13.030585 [debug] [Thread-1 (]: On model.crb_kpi.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.cross_sell_product_churn"} */
create or replace   view CRBFITNESS.PUBLIC.cross_sell_product_churn
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    p.product_family_clean, 
    COUNT(DISTINCT p.product_family_clean) AS cross_sell_count
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
ORDER BY cross_sell_count DESC
LIMIT 10
  );
[0m03:10:13.775103 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.747 seconds
[0m03:10:13.806289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ef271f7-eb11-4f2b-8428-8e76de65b178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ABE104950>]}
[0m03:10:13.806289 [info ] [Thread-1 (]: 2 of 10 OK created sql view model PUBLIC.cross_sell_product_churn .............. [[32mSUCCESS 1[0m in 0.80s]
[0m03:10:13.820385 [debug] [Thread-1 (]: Finished running node model.crb_kpi.cross_sell_product_churn
[0m03:10:13.820385 [debug] [Thread-1 (]: Began running node model.crb_kpi.net_nrr_grr
[0m03:10:13.822399 [info ] [Thread-1 (]: 3 of 10 START sql view model PUBLIC.net_nrr_grr ................................ [RUN]
[0m03:10:13.822399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.cross_sell_product_churn, now model.crb_kpi.net_nrr_grr)
[0m03:10:13.824781 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.net_nrr_grr
[0m03:10:13.824781 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.net_nrr_grr"
[0m03:10:13.824781 [debug] [Thread-1 (]: Began executing node model.crb_kpi.net_nrr_grr
[0m03:10:13.830016 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.net_nrr_grr"
[0m03:10:13.830016 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.net_nrr_grr"
[0m03:10:13.830016 [debug] [Thread-1 (]: On model.crb_kpi.net_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.net_nrr_grr"} */
create or replace   view CRBFITNESS.PUBLIC.net_nrr_grr
  
   as (
    SELECT 
    SUM(CASE WHEN payment_month_clean >= DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END) AS current_revenue,
    SUM(CASE WHEN payment_month_clean < DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END) AS previous_revenue,
    (SUM(CASE WHEN payment_month_clean >= DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END) * 1.0 /
     NULLIF(SUM(CASE WHEN payment_month_clean < DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END), 0)) AS NRR,
    (SUM(CASE WHEN payment_month_clean >= DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END) * 1.0 /
     NULLIF(SUM(CASE WHEN payment_month_clean >= DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END), 0)) AS GRR
FROM public.stg_transactions
  );
[0m03:10:14.497671 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.667 seconds
[0m03:10:14.506694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ef271f7-eb11-4f2b-8428-8e76de65b178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ABE886350>]}
[0m03:10:14.510390 [info ] [Thread-1 (]: 3 of 10 OK created sql view model PUBLIC.net_nrr_grr ........................... [[32mSUCCESS 1[0m in 0.68s]
[0m03:10:14.510390 [debug] [Thread-1 (]: Finished running node model.crb_kpi.net_nrr_grr
[0m03:10:14.510390 [debug] [Thread-1 (]: Began running node model.crb_kpi.new_logos
[0m03:10:14.510390 [info ] [Thread-1 (]: 4 of 10 START sql view model PUBLIC.new_logos .................................. [RUN]
[0m03:10:14.510390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.net_nrr_grr, now model.crb_kpi.new_logos)
[0m03:10:14.510390 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.new_logos
[0m03:10:14.518412 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.new_logos"
[0m03:10:14.518412 [debug] [Thread-1 (]: Began executing node model.crb_kpi.new_logos
[0m03:10:14.529200 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.new_logos"
[0m03:10:14.534705 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.new_logos"
[0m03:10:14.534705 [debug] [Thread-1 (]: On model.crb_kpi.new_logos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.new_logos"} */
create or replace   view CRBFITNESS.PUBLIC.new_logos
  
   as (
    SELECT 
    customer_id, 
    MIN(payment_month_clean) AS first_fiscal_year
FROM public.stg_transactions
GROUP BY customer_id
  );
[0m03:10:15.375296 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.842 seconds
[0m03:10:15.375296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ef271f7-eb11-4f2b-8428-8e76de65b178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ABE8AA350>]}
[0m03:10:15.375296 [info ] [Thread-1 (]: 4 of 10 OK created sql view model PUBLIC.new_logos ............................. [[32mSUCCESS 1[0m in 0.86s]
[0m03:10:15.387318 [debug] [Thread-1 (]: Finished running node model.crb_kpi.new_logos
[0m03:10:15.388834 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_customers
[0m03:10:15.388834 [info ] [Thread-1 (]: 5 of 10 START sql view model PUBLIC.ranked_customers ........................... [RUN]
[0m03:10:15.388834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.new_logos, now model.crb_kpi.ranked_customers)
[0m03:10:15.388834 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_customers
[0m03:10:15.388834 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_customers"
[0m03:10:15.388834 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_customers
[0m03:10:15.404484 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_customers"
[0m03:10:15.408744 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_customers"
[0m03:10:15.411319 [debug] [Thread-1 (]: On model.crb_kpi.ranked_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_customers"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_customers
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
GROUP BY t.customer_id, c.customer_name_clean
ORDER BY total_revenue DESC
  );
[0m03:10:16.121583 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.707 seconds
[0m03:10:16.126096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ef271f7-eb11-4f2b-8428-8e76de65b178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ABE8A9B90>]}
[0m03:10:16.128163 [info ] [Thread-1 (]: 5 of 10 OK created sql view model PUBLIC.ranked_customers ...................... [[32mSUCCESS 1[0m in 0.74s]
[0m03:10:16.129431 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_customers
[0m03:10:16.129431 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_products
[0m03:10:16.129431 [info ] [Thread-1 (]: 6 of 10 START sql view model PUBLIC.ranked_products ............................ [RUN]
[0m03:10:16.129431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_customers, now model.crb_kpi.ranked_products)
[0m03:10:16.136533 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_products
[0m03:10:16.142057 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_products"
[0m03:10:16.143923 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_products
[0m03:10:16.149216 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_products"
[0m03:10:16.151329 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_products"
[0m03:10:16.152943 [debug] [Thread-1 (]: On model.crb_kpi.ranked_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_products"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_products
  
   as (
    SELECT 
    p.product_family_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY p.product_family_clean
ORDER BY total_revenue DESC
  );
[0m03:10:16.754328 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.603 seconds
[0m03:10:16.754328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ef271f7-eb11-4f2b-8428-8e76de65b178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ABDB34990>]}
[0m03:10:16.754328 [info ] [Thread-1 (]: 6 of 10 OK created sql view model PUBLIC.ranked_products ....................... [[32mSUCCESS 1[0m in 0.62s]
[0m03:10:16.754328 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_products
[0m03:10:16.767668 [debug] [Thread-1 (]: Began running node model.crb_kpi.revenue_lost
[0m03:10:16.769689 [info ] [Thread-1 (]: 7 of 10 START sql view model PUBLIC.revenue_lost ............................... [RUN]
[0m03:10:16.770869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_products, now model.crb_kpi.revenue_lost)
[0m03:10:16.773598 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.revenue_lost
[0m03:10:16.778407 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.revenue_lost"
[0m03:10:16.779325 [debug] [Thread-1 (]: Began executing node model.crb_kpi.revenue_lost
[0m03:10:16.788215 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.revenue_lost"
[0m03:10:16.788215 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.revenue_lost"
[0m03:10:16.794712 [debug] [Thread-1 (]: On model.crb_kpi.revenue_lost: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.revenue_lost"} */
create or replace   view CRBFITNESS.PUBLIC.revenue_lost
  
   as (
    SELECT 
    t.payment_month AS period, 
    SUM(t.revenue) AS total_revenue_lost
FROM public.stg_transactions t
WHERE t.customer_id IN (
    SELECT customer_id 
    FROM public.stg_transactions 
    GROUP BY customer_id 
    HAVING MAX(payment_month_clean) < DATEADD(MONTH, -6, CURRENT_DATE)
)
GROUP BY t.payment_month
ORDER BY t.payment_month
  );
[0m03:10:17.365930 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb02b4-0004-c144-0005-db4b0001874a
[0m03:10:17.365930 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 4
invalid identifier 'T.PAYMENT_MONTH'
[0m03:10:17.374891 [debug] [Thread-1 (]: Database Error in model revenue_lost (models\marts\revenue_lost.sql)
  000904 (42000): SQL compilation error: error line 5 at position 4
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\revenue_lost.sql
[0m03:10:17.374891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ef271f7-eb11-4f2b-8428-8e76de65b178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ABE8A3AD0>]}
[0m03:10:17.381911 [error] [Thread-1 (]: 7 of 10 ERROR creating sql view model PUBLIC.revenue_lost ...................... [[31mERROR[0m in 0.60s]
[0m03:10:17.381911 [debug] [Thread-1 (]: Finished running node model.crb_kpi.revenue_lost
[0m03:10:17.381911 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m03:10:17.381911 [debug] [Thread-4 (]: Marking all children of 'model.crb_kpi.revenue_lost' to be skipped because of status 'error'.  Reason: Database Error in model revenue_lost (models\marts\revenue_lost.sql)
  000904 (42000): SQL compilation error: error line 5 at position 4
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\revenue_lost.sql.
[0m03:10:17.386869 [info ] [Thread-1 (]: 8 of 10 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m03:10:17.389377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.revenue_lost, now model.crb_kpi.stg_customers)
[0m03:10:17.389920 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m03:10:17.393554 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m03:10:17.399920 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m03:10:17.406101 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m03:10:17.406101 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m03:10:17.411921 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
    WHERE customer_id IS NOT NULL  -- Remove rows where customer_id is NULL
      AND customername IS NOT NULL -- Remove rows where customername is NULL
)
SELECT 
    customer_id,
    COALESCE(TRIM(LOWER(customername)), 'Unknown') AS customer_name_clean -- Handle NULLs
FROM raw
  );
[0m03:10:17.945226 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.531 seconds
[0m03:10:17.945226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ef271f7-eb11-4f2b-8428-8e76de65b178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ABE383A10>]}
[0m03:10:17.945226 [info ] [Thread-1 (]: 8 of 10 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 0.56s]
[0m03:10:17.955157 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m03:10:17.955157 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m03:10:17.959209 [info ] [Thread-1 (]: 9 of 10 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m03:10:17.960751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m03:10:17.960751 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m03:10:17.968415 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m03:10:17.968987 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m03:10:17.976683 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m03:10:17.978348 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m03:10:17.978348 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS ( 
    SELECT * FROM public.products
    WHERE product_id IS NOT NULL  -- Remove rows where product_id is NULL
      AND product_family IS NOT NULL -- Remove rows where product_family is NULL
)
SELECT 
    product_id,
    COALESCE(TRIM(LOWER(product_family)), 'Unknown') AS product_family_clean -- Handle NULLs
FROM raw
  );
[0m03:10:18.571029 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.591 seconds
[0m03:10:18.571029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ef271f7-eb11-4f2b-8428-8e76de65b178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ABE8DEF50>]}
[0m03:10:18.571029 [info ] [Thread-1 (]: 9 of 10 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 0.61s]
[0m03:10:18.586650 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m03:10:18.586650 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m03:10:18.586650 [info ] [Thread-1 (]: 10 of 10 START sql view model PUBLIC.stg_transactions .......................... [RUN]
[0m03:10:18.586650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m03:10:18.586650 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m03:10:18.586650 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m03:10:18.586650 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m03:10:18.605944 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m03:10:18.613586 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m03:10:18.616731 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
    WHERE customer_id IS NOT NULL  
      AND product_id IS NOT NULL  
      AND revenue IS NOT NULL  
      AND payment_month IS NOT NULL  
)
SELECT 
    customer_id,
    product_id,
    CAST(COALESCE(revenue, 0) AS FLOAT) AS revenue,  -- Handle NULL revenue
    TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') AS payment_month_clean  -- Convert VARCHAR to TIMESTAMP
FROM raw
  );
[0m03:10:19.170516 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.565 seconds
[0m03:10:19.185540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ef271f7-eb11-4f2b-8428-8e76de65b178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ABE8DCA90>]}
[0m03:10:19.185540 [info ] [Thread-1 (]: 10 of 10 OK created sql view model PUBLIC.stg_transactions ..................... [[32mSUCCESS 1[0m in 0.60s]
[0m03:10:19.192186 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m03:10:19.192186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:10:19.192186 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m03:10:19.192186 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m03:10:19.835680 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m03:10:19.835680 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m03:10:20.487081 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m03:10:20.487081 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m03:10:21.160183 [info ] [MainThread]: 
[0m03:10:21.161901 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 15.14 seconds (15.14s).
[0m03:10:21.161901 [debug] [MainThread]: Command end result
[0m03:10:21.191592 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m03:10:21.191592 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m03:10:21.211089 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m03:10:21.211089 [info ] [MainThread]: 
[0m03:10:21.211089 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m03:10:21.211089 [info ] [MainThread]: 
[0m03:10:21.211089 [error] [MainThread]:   Database Error in model churned_new_customers (models\marts\churned_new_customers.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\churned_new_customers.sql
[0m03:10:21.211089 [info ] [MainThread]: 
[0m03:10:21.211089 [error] [MainThread]:   Database Error in model revenue_lost (models\marts\revenue_lost.sql)
  000904 (42000): SQL compilation error: error line 5 at position 4
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\crb_kpi\models\marts\revenue_lost.sql
[0m03:10:21.223268 [info ] [MainThread]: 
[0m03:10:21.223268 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
[0m03:10:21.223268 [debug] [MainThread]: Command `dbt run` failed at 03:10:21.223268 after 17.33 seconds
[0m03:10:21.228409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ABC09B850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AB88CFC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ABC48A2D0>]}
[0m03:10:21.228409 [debug] [MainThread]: Flushing usage events
[0m03:10:23.096072 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:11:15.687240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B46048C350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4604E2310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4604E2710>]}


============================== 03:11:15.687240 | 40a16131-d1bf-42a0-886f-18c5c74c1676 ==============================
[0m03:11:15.687240 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:11:15.687240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\crb_project\\crb_kpi\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:11:16.280353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40a16131-d1bf-42a0-886f-18c5c74c1676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B460509D90>]}
[0m03:11:16.363043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40a16131-d1bf-42a0-886f-18c5c74c1676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B46125D610>]}
[0m03:11:16.363043 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:11:16.973016 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:11:17.224339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m03:11:17.224339 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\revenue_lost.sql
[0m03:11:17.224339 [debug] [MainThread]: Partial parsing: updated file: crb_kpi://models\marts\churned_new_customers.sql
[0m03:11:17.538224 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crb_kpi.example
[0m03:11:17.553634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40a16131-d1bf-42a0-886f-18c5c74c1676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B46138F190>]}
[0m03:11:17.652865 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m03:11:17.661348 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m03:11:17.692651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40a16131-d1bf-42a0-886f-18c5c74c1676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B461D63110>]}
[0m03:11:17.692651 [info ] [MainThread]: Found 10 models, 474 macros
[0m03:11:17.704089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40a16131-d1bf-42a0-886f-18c5c74c1676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B461D0C350>]}
[0m03:11:17.704089 [info ] [MainThread]: 
[0m03:11:17.709723 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:11:17.711180 [info ] [MainThread]: 
[0m03:11:17.715400 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:11:17.724556 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS'
[0m03:11:17.952551 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS"
[0m03:11:17.952551 [debug] [ThreadPool]: On list_CRBFITNESS: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS"} */
show terse schemas in database CRBFITNESS
    limit 10000
[0m03:11:17.952551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:11:20.032490 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.068 seconds
[0m03:11:20.043522 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CRBFITNESS_PUBLIC'
[0m03:11:20.060772 [debug] [ThreadPool]: Using snowflake connection "list_CRBFITNESS_PUBLIC"
[0m03:11:20.063724 [debug] [ThreadPool]: On list_CRBFITNESS_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "connection_name": "list_CRBFITNESS_PUBLIC"} */
show objects in CRBFITNESS.PUBLIC limit 10000;
[0m03:11:20.063724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:11:21.842778 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.781 seconds
[0m03:11:21.842778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40a16131-d1bf-42a0-886f-18c5c74c1676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B45F117B10>]}
[0m03:11:21.865400 [debug] [Thread-1 (]: Began running node model.crb_kpi.churned_new_customers
[0m03:11:21.865400 [info ] [Thread-1 (]: 1 of 10 START sql view model PUBLIC.churned_new_customers ...................... [RUN]
[0m03:11:21.869318 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.crb_kpi.churned_new_customers'
[0m03:11:21.869318 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.churned_new_customers
[0m03:11:21.874134 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.churned_new_customers"
[0m03:11:21.887370 [debug] [Thread-1 (]: Began executing node model.crb_kpi.churned_new_customers
[0m03:11:21.932194 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.churned_new_customers"
[0m03:11:21.941907 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.churned_new_customers"
[0m03:11:21.941907 [debug] [Thread-1 (]: On model.crb_kpi.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.churned_new_customers"} */
create or replace   view CRBFITNESS.PUBLIC.churned_new_customers
  
   as (
    SELECT 
    customer_id, 
    'new' AS customer_status, 
    MIN(payment_month_clean) AS first_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MIN(payment_month_clean) IS NOT NULL

UNION ALL

SELECT 
    customer_id, 
    'churned' AS customer_status, 
    MAX(payment_month_clean) AS last_transaction_month
FROM public.stg_transactions
GROUP BY customer_id
HAVING MAX(payment_month_clean) < DATEADD(MONTH, -6, CURRENT_DATE)
  );
[0m03:11:21.943700 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:11:26.184237 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.241 seconds
[0m03:11:26.215294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a16131-d1bf-42a0-886f-18c5c74c1676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4623D2390>]}
[0m03:11:26.215294 [info ] [Thread-1 (]: 1 of 10 OK created sql view model PUBLIC.churned_new_customers ................. [[32mSUCCESS 1[0m in 4.35s]
[0m03:11:26.220312 [debug] [Thread-1 (]: Finished running node model.crb_kpi.churned_new_customers
[0m03:11:26.220312 [debug] [Thread-1 (]: Began running node model.crb_kpi.cross_sell_product_churn
[0m03:11:26.222886 [info ] [Thread-1 (]: 2 of 10 START sql view model PUBLIC.cross_sell_product_churn ................... [RUN]
[0m03:11:26.222886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.churned_new_customers, now model.crb_kpi.cross_sell_product_churn)
[0m03:11:26.222886 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.cross_sell_product_churn
[0m03:11:26.222886 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.cross_sell_product_churn"
[0m03:11:26.222886 [debug] [Thread-1 (]: Began executing node model.crb_kpi.cross_sell_product_churn
[0m03:11:26.234593 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.cross_sell_product_churn"
[0m03:11:26.234593 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.cross_sell_product_churn"
[0m03:11:26.238542 [debug] [Thread-1 (]: On model.crb_kpi.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.cross_sell_product_churn"} */
create or replace   view CRBFITNESS.PUBLIC.cross_sell_product_churn
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    p.product_family_clean, 
    COUNT(DISTINCT p.product_family_clean) AS cross_sell_count
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY t.customer_id, c.customer_name_clean, p.product_family_clean
ORDER BY cross_sell_count DESC
LIMIT 10
  );
[0m03:11:26.845708 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.610 seconds
[0m03:11:26.845708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a16131-d1bf-42a0-886f-18c5c74c1676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4623A0810>]}
[0m03:11:26.845708 [info ] [Thread-1 (]: 2 of 10 OK created sql view model PUBLIC.cross_sell_product_churn .............. [[32mSUCCESS 1[0m in 0.62s]
[0m03:11:26.860102 [debug] [Thread-1 (]: Finished running node model.crb_kpi.cross_sell_product_churn
[0m03:11:26.860102 [debug] [Thread-1 (]: Began running node model.crb_kpi.net_nrr_grr
[0m03:11:26.860102 [info ] [Thread-1 (]: 3 of 10 START sql view model PUBLIC.net_nrr_grr ................................ [RUN]
[0m03:11:26.865731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.cross_sell_product_churn, now model.crb_kpi.net_nrr_grr)
[0m03:11:26.865731 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.net_nrr_grr
[0m03:11:26.867992 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.net_nrr_grr"
[0m03:11:26.873206 [debug] [Thread-1 (]: Began executing node model.crb_kpi.net_nrr_grr
[0m03:11:26.880035 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.net_nrr_grr"
[0m03:11:26.883187 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.net_nrr_grr"
[0m03:11:26.884165 [debug] [Thread-1 (]: On model.crb_kpi.net_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.net_nrr_grr"} */
create or replace   view CRBFITNESS.PUBLIC.net_nrr_grr
  
   as (
    SELECT 
    SUM(CASE WHEN payment_month_clean >= DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END) AS current_revenue,
    SUM(CASE WHEN payment_month_clean < DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END) AS previous_revenue,
    (SUM(CASE WHEN payment_month_clean >= DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END) * 1.0 /
     NULLIF(SUM(CASE WHEN payment_month_clean < DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END), 0)) AS NRR,
    (SUM(CASE WHEN payment_month_clean >= DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END) * 1.0 /
     NULLIF(SUM(CASE WHEN payment_month_clean >= DATEADD(YEAR, -1, CURRENT_DATE) THEN revenue ELSE 0 END), 0)) AS GRR
FROM public.stg_transactions
  );
[0m03:11:27.464238 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.579 seconds
[0m03:11:27.464238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a16131-d1bf-42a0-886f-18c5c74c1676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4623BBE50>]}
[0m03:11:27.472420 [info ] [Thread-1 (]: 3 of 10 OK created sql view model PUBLIC.net_nrr_grr ........................... [[32mSUCCESS 1[0m in 0.60s]
[0m03:11:27.473052 [debug] [Thread-1 (]: Finished running node model.crb_kpi.net_nrr_grr
[0m03:11:27.473052 [debug] [Thread-1 (]: Began running node model.crb_kpi.new_logos
[0m03:11:27.473052 [info ] [Thread-1 (]: 4 of 10 START sql view model PUBLIC.new_logos .................................. [RUN]
[0m03:11:27.478065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.net_nrr_grr, now model.crb_kpi.new_logos)
[0m03:11:27.478065 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.new_logos
[0m03:11:27.483253 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.new_logos"
[0m03:11:27.483253 [debug] [Thread-1 (]: Began executing node model.crb_kpi.new_logos
[0m03:11:27.493802 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.new_logos"
[0m03:11:27.500431 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.new_logos"
[0m03:11:27.502404 [debug] [Thread-1 (]: On model.crb_kpi.new_logos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.new_logos"} */
create or replace   view CRBFITNESS.PUBLIC.new_logos
  
   as (
    SELECT 
    customer_id, 
    MIN(payment_month_clean) AS first_fiscal_year
FROM public.stg_transactions
GROUP BY customer_id
  );
[0m03:11:28.326151 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.820 seconds
[0m03:11:28.328324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a16131-d1bf-42a0-886f-18c5c74c1676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4626C52D0>]}
[0m03:11:28.328324 [info ] [Thread-1 (]: 4 of 10 OK created sql view model PUBLIC.new_logos ............................. [[32mSUCCESS 1[0m in 0.85s]
[0m03:11:28.331980 [debug] [Thread-1 (]: Finished running node model.crb_kpi.new_logos
[0m03:11:28.331980 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_customers
[0m03:11:28.331980 [info ] [Thread-1 (]: 5 of 10 START sql view model PUBLIC.ranked_customers ........................... [RUN]
[0m03:11:28.331980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.new_logos, now model.crb_kpi.ranked_customers)
[0m03:11:28.336114 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_customers
[0m03:11:28.337799 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_customers"
[0m03:11:28.337799 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_customers
[0m03:11:28.344859 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_customers"
[0m03:11:28.348334 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_customers"
[0m03:11:28.350021 [debug] [Thread-1 (]: On model.crb_kpi.ranked_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_customers"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_customers
  
   as (
    SELECT 
    t.customer_id, 
    c.customer_name_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_customers c ON t.customer_id = c.customer_id
GROUP BY t.customer_id, c.customer_name_clean
ORDER BY total_revenue DESC
  );
[0m03:11:29.048970 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.699 seconds
[0m03:11:29.055119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a16131-d1bf-42a0-886f-18c5c74c1676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B461B991D0>]}
[0m03:11:29.055119 [info ] [Thread-1 (]: 5 of 10 OK created sql view model PUBLIC.ranked_customers ...................... [[32mSUCCESS 1[0m in 0.72s]
[0m03:11:29.060040 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_customers
[0m03:11:29.061691 [debug] [Thread-1 (]: Began running node model.crb_kpi.ranked_products
[0m03:11:29.063265 [info ] [Thread-1 (]: 6 of 10 START sql view model PUBLIC.ranked_products ............................ [RUN]
[0m03:11:29.064545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_customers, now model.crb_kpi.ranked_products)
[0m03:11:29.066181 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.ranked_products
[0m03:11:29.071346 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.ranked_products"
[0m03:11:29.071346 [debug] [Thread-1 (]: Began executing node model.crb_kpi.ranked_products
[0m03:11:29.085246 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.ranked_products"
[0m03:11:29.088795 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.ranked_products"
[0m03:11:29.088795 [debug] [Thread-1 (]: On model.crb_kpi.ranked_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.ranked_products"} */
create or replace   view CRBFITNESS.PUBLIC.ranked_products
  
   as (
    SELECT 
    p.product_family_clean, 
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM public.stg_transactions t
LEFT JOIN public.stg_products p ON t.product_id = p.product_id
GROUP BY p.product_family_clean
ORDER BY total_revenue DESC
  );
[0m03:11:30.530116 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.443 seconds
[0m03:11:30.530116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a16131-d1bf-42a0-886f-18c5c74c1676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B461D0F810>]}
[0m03:11:30.530116 [info ] [Thread-1 (]: 6 of 10 OK created sql view model PUBLIC.ranked_products ....................... [[32mSUCCESS 1[0m in 1.47s]
[0m03:11:30.530116 [debug] [Thread-1 (]: Finished running node model.crb_kpi.ranked_products
[0m03:11:30.545661 [debug] [Thread-1 (]: Began running node model.crb_kpi.revenue_lost
[0m03:11:30.546919 [info ] [Thread-1 (]: 7 of 10 START sql view model PUBLIC.revenue_lost ............................... [RUN]
[0m03:11:30.546919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.ranked_products, now model.crb_kpi.revenue_lost)
[0m03:11:30.549603 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.revenue_lost
[0m03:11:30.551826 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.revenue_lost"
[0m03:11:30.551826 [debug] [Thread-1 (]: Began executing node model.crb_kpi.revenue_lost
[0m03:11:30.561640 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.revenue_lost"
[0m03:11:30.563855 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.revenue_lost"
[0m03:11:30.563855 [debug] [Thread-1 (]: On model.crb_kpi.revenue_lost: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.revenue_lost"} */
create or replace   view CRBFITNESS.PUBLIC.revenue_lost
  
   as (
    SELECT 
    t.payment_month_clean AS period, 
    SUM(t.revenue) AS total_revenue_lost
FROM public.stg_transactions t
WHERE t.customer_id IN (
    SELECT customer_id 
    FROM public.stg_transactions 
    GROUP BY customer_id 
    HAVING MAX(payment_month_clean) < DATEADD(MONTH, -6, CURRENT_DATE)
)
GROUP BY t.payment_month_clean
ORDER BY t.payment_month_clean
  );
[0m03:11:31.279716 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.713 seconds
[0m03:11:31.284785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a16131-d1bf-42a0-886f-18c5c74c1676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4623A6BD0>]}
[0m03:11:31.284785 [info ] [Thread-1 (]: 7 of 10 OK created sql view model PUBLIC.revenue_lost .......................... [[32mSUCCESS 1[0m in 0.74s]
[0m03:11:31.284785 [debug] [Thread-1 (]: Finished running node model.crb_kpi.revenue_lost
[0m03:11:31.292303 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_customers
[0m03:11:31.292303 [info ] [Thread-1 (]: 8 of 10 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m03:11:31.294745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.revenue_lost, now model.crb_kpi.stg_customers)
[0m03:11:31.294745 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_customers
[0m03:11:31.300022 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_customers"
[0m03:11:31.300022 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_customers
[0m03:11:31.309990 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_customers"
[0m03:11:31.309990 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_customers"
[0m03:11:31.318629 [debug] [Thread-1 (]: On model.crb_kpi.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_customers"} */
create or replace   view CRBFITNESS.PUBLIC.stg_customers
  
   as (
    WITH raw AS (
    SELECT * FROM public.customers
    WHERE customer_id IS NOT NULL  -- Remove rows where customer_id is NULL
      AND customername IS NOT NULL -- Remove rows where customername is NULL
)
SELECT 
    customer_id,
    COALESCE(TRIM(LOWER(customername)), 'Unknown') AS customer_name_clean -- Handle NULLs
FROM raw
  );
[0m03:11:32.309380 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.001 seconds
[0m03:11:32.325014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a16131-d1bf-42a0-886f-18c5c74c1676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4617A8A90>]}
[0m03:11:32.325014 [info ] [Thread-1 (]: 8 of 10 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 1.03s]
[0m03:11:32.330034 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_customers
[0m03:11:32.332157 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_products
[0m03:11:32.332157 [info ] [Thread-1 (]: 9 of 10 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m03:11:32.335950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_customers, now model.crb_kpi.stg_products)
[0m03:11:32.335950 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_products
[0m03:11:32.341092 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_products"
[0m03:11:32.343777 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_products
[0m03:11:32.357209 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_products"
[0m03:11:32.358325 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_products"
[0m03:11:32.362996 [debug] [Thread-1 (]: On model.crb_kpi.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_products"} */
create or replace   view CRBFITNESS.PUBLIC.stg_products
  
   as (
    WITH raw AS ( 
    SELECT * FROM public.products
    WHERE product_id IS NOT NULL  -- Remove rows where product_id is NULL
      AND product_family IS NOT NULL -- Remove rows where product_family is NULL
)
SELECT 
    product_id,
    COALESCE(TRIM(LOWER(product_family)), 'Unknown') AS product_family_clean -- Handle NULLs
FROM raw
  );
[0m03:11:33.621620 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.266 seconds
[0m03:11:33.636667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a16131-d1bf-42a0-886f-18c5c74c1676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B462719AD0>]}
[0m03:11:33.636667 [info ] [Thread-1 (]: 9 of 10 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 1.30s]
[0m03:11:33.636667 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_products
[0m03:11:33.636667 [debug] [Thread-1 (]: Began running node model.crb_kpi.stg_transactions
[0m03:11:33.636667 [info ] [Thread-1 (]: 10 of 10 START sql view model PUBLIC.stg_transactions .......................... [RUN]
[0m03:11:33.636667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crb_kpi.stg_products, now model.crb_kpi.stg_transactions)
[0m03:11:33.636667 [debug] [Thread-1 (]: Began compiling node model.crb_kpi.stg_transactions
[0m03:11:33.652319 [debug] [Thread-1 (]: Writing injected SQL for node "model.crb_kpi.stg_transactions"
[0m03:11:33.652319 [debug] [Thread-1 (]: Began executing node model.crb_kpi.stg_transactions
[0m03:11:33.658270 [debug] [Thread-1 (]: Writing runtime sql for node "model.crb_kpi.stg_transactions"
[0m03:11:33.667915 [debug] [Thread-1 (]: Using snowflake connection "model.crb_kpi.stg_transactions"
[0m03:11:33.670037 [debug] [Thread-1 (]: On model.crb_kpi.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "crb_kpi", "target_name": "dev", "node_id": "model.crb_kpi.stg_transactions"} */
create or replace   view CRBFITNESS.PUBLIC.stg_transactions
  
   as (
    WITH raw AS (
    SELECT * FROM public.transactions
    WHERE customer_id IS NOT NULL  
      AND product_id IS NOT NULL  
      AND revenue IS NOT NULL  
      AND payment_month IS NOT NULL  
)
SELECT 
    customer_id,
    product_id,
    CAST(COALESCE(revenue, 0) AS FLOAT) AS revenue,  -- Handle NULL revenue
    TO_TIMESTAMP(RIGHT(payment_month, 4) || '-' || SUBSTR(payment_month, 4, 2), 'YYYY-MM') AS payment_month_clean  -- Convert VARCHAR to TIMESTAMP
FROM raw
  );
[0m03:11:34.194808 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.526 seconds
[0m03:11:34.194808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a16131-d1bf-42a0-886f-18c5c74c1676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B462718FD0>]}
[0m03:11:34.194808 [info ] [Thread-1 (]: 10 of 10 OK created sql view model PUBLIC.stg_transactions ..................... [[32mSUCCESS 1[0m in 0.56s]
[0m03:11:34.206984 [debug] [Thread-1 (]: Finished running node model.crb_kpi.stg_transactions
[0m03:11:34.212089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:11:34.212089 [debug] [MainThread]: Connection 'list_CRBFITNESS' was left open.
[0m03:11:34.214304 [debug] [MainThread]: On list_CRBFITNESS: Close
[0m03:11:34.850097 [debug] [MainThread]: Connection 'list_CRBFITNESS_PUBLIC' was left open.
[0m03:11:34.850097 [debug] [MainThread]: On list_CRBFITNESS_PUBLIC: Close
[0m03:11:35.493385 [debug] [MainThread]: Connection 'model.crb_kpi.stg_transactions' was left open.
[0m03:11:35.493385 [debug] [MainThread]: On model.crb_kpi.stg_transactions: Close
[0m03:11:36.122326 [info ] [MainThread]: 
[0m03:11:36.122326 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 18.41 seconds (18.41s).
[0m03:11:36.138053 [debug] [MainThread]: Command end result
[0m03:11:36.198502 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\manifest.json
[0m03:11:36.198502 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ADMIN\crb_project\crb_kpi\target\semantic_manifest.json
[0m03:11:36.215216 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ADMIN\crb_project\crb_kpi\target\run_results.json
[0m03:11:36.216484 [info ] [MainThread]: 
[0m03:11:36.216484 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:11:36.219922 [info ] [MainThread]: 
[0m03:11:36.219922 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m03:11:36.219922 [debug] [MainThread]: Command `dbt run` succeeded at 03:11:36.219922 after 20.64 seconds
[0m03:11:36.226534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4604C87D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B45B292E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B45B292E90>]}
[0m03:11:36.226534 [debug] [MainThread]: Flushing usage events
[0m03:11:38.242662 [debug] [MainThread]: An error was encountered while trying to flush usage events
